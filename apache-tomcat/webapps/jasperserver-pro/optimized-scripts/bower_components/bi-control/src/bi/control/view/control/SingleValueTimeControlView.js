define(["require","exports","module","jquery.timepicker.addon","../BaseInputControlView","jquery","underscore","logger","text!../../template/singleValueTimeTemplate.htm","text!../../template/calendarIconSpanTemplate.htm","settings!dateTimeSettings","common/util/parse/date"],function(e,t,i){function n(e){var t=e.toUpperCase().replace(/([\s]+$|^[\s]+)/g,"");return t.replace(/[\s]*(\+|\-)[\s]*/g,"$1")}e("jquery.timepicker.addon");var a=e("../BaseInputControlView"),r=e("jquery"),o=e("underscore"),s=(e("logger").register(i),e("text!../../template/singleValueTimeTemplate.htm")),l=e("text!../../template/calendarIconSpanTemplate.htm"),u=e("settings!dateTimeSettings"),m=e("common/util/parse/date");return a.extend({template:s,initialize:function(e){this.renderStructure(e),this.renderState(),this.model.get("visible")&&(this.setupCalendar(),this.bindCustomEventListeners())},setupCalendar:function(){var e=this.$el.find("input");e.timepicker({showOn:"button",timeFormat:u.timepicker.timeFormat,showSecond:!0,disabled:e[0].disabled,onClose:o.bind(this.updateState,this),beforeShow:r.datepicker.movePickerRelativelyToTriggerIcon,constrainInput:!1}),e.change(o.bind(function(e){e.stopPropagation();var t=r(e.target),i=n(t.val());t.val(i),this.updateState(i)},this)),e.after("&nbsp;");var t=this.$el.find("button");t.wrap(l).empty()},updateValue:function(e){var t=m.isoTimeToLocalizedTime(e);this.$el.find("input").attr("value",t)},updateState:function(e){this.model.changeState(m.localizedTimeToIsoTime(e))},bindCustomEventListeners:function(){this.listenTo(this.model.state,"change:value",function(e,t){this.updateValue(t)},this)},remove:function(){this.$el.off("change","input").timepicker("destroy"),a.prototype.remove.call(this)}})});