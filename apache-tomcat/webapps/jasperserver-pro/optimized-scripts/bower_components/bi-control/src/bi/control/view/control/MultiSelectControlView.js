define(["require","exports","module","../BaseInputControlView","../../util/resizer","jquery","underscore","common/component/multiSelect/view/MultiSelect","common/component/singleSelect/dataprovider/CacheableDataProvider","mustache","../../util/inputControlHelpers","text!../../template/multiSelectTemplate.htm","logger"],function(e,t,i){{var s=e("../BaseInputControlView"),l=e("../../util/resizer"),n=e("jquery"),o=(e("underscore"),e("common/component/multiSelect/view/MultiSelect")),a=e("common/component/singleSelect/dataprovider/CacheableDataProvider"),r=e("mustache"),c=e("../../util/inputControlHelpers"),h=e("text!../../template/multiSelectTemplate.htm");e("logger").register(i)}return s.extend({template:h,INITIAL_MAX_HEIGHT:"240px",renderStructure:function(){this.multiSelect||(this.dataProvider=new a,this.multiSelect=new o({getData:this.dataProvider.getData,visibleItemsCount:this.getAmountOfLinesToDisplay()}).setDisabled(this.model.get("readOnly"))),this.template&&(this.multiSelect.undelegateEvents(),this.$el.html(n(r.to_html(this.template,this.model.toJSON()))),this.multiSelect.render().renderData(),this.$el.find(".msPlaceholder").append(this.multiSelect.el),this.multiSelect.delegateEvents(),this.makeResizable(),this.updateOptionsSelection())},updateOptionsSelection:function(){var e=this.model.state.options.toJSON();this.dataProvider.setData(e);var t=this;this.multiSelect.fetch(function(){var i=c.extractSelection(e);t.multiSelect.setValue(i,{silent:!0}),t.checkSelectionSize(i)},{keepPosition:!0})},bindCustomEventListeners:function(){this.multiSelect.off("selection:change").on("selection:change",function(e){this.model.changeState(e),this.checkSelectionSize(e)},this),this.model.state.options.on("reset",this.updateOptionsSelection,this),this.model.state.options.on("change:selected",this.updateOptionsSelection,this)},checkSelectionSize:function(e){var t=0;for(var i in e)if(e.hasOwnProperty(i)&&t++>=4)break;5>t&&this.$el[0].clientHeight<125?(this.$el.find(".sizer").addClass("hidden"),this.$el.find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.$el.find(".sizer").removeClass("hidden"),this.$el.find(".inputSet").addClass("sizable"))},makeResizable:function(){this.resizable=!0;var e=this.$el.find(".sList"),t=e.parents(".leaf").find(".sizer");l.createSizer(e,t,{axis:"s","max-height":this.INITIAL_MAX_HEIGHT})},remove:function(){this.multiSelect.remove(),this.model.state.options.off("reset",this.updateOptionsSelection,this),this.model.state.options.off("change:selected",this.updateOptionsSelection,this),s.prototype.remove.call(this)}})});