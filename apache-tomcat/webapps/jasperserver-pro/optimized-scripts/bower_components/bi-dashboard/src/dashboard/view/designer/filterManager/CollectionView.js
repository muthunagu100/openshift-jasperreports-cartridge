define(["require","backbone","underscore"],function(e){var i=e("backbone"),t=e("underscore");return i.View.extend({el:function(){return this._template(this._templateOptions)},constructor:function(e){e||(e={}),this.collection=e.collection||new i.Collection,this._template=t.template(e.template||"<div></div>"),this._templateOptions=e.templateOptions||{},this._modelView=e.modelView||i.View,this._modelViewOptions=e.modelViewOptions||{},this._subviews=[],i.View.apply(this,arguments),this._$subviewsContainer=e.contentContainer?this.$(e.contentContainer):this.$el,this.initCollectionEventHandlers()},initCollectionEventHandlers:function(){this.listenTo(this.collection,"add",this.addSubview),this.listenTo(this.collection,"remove",this.removeSubview)},addSubview:function(e){var i=new this._modelView(t.extend({},this._modelViewOptions,{model:e}));return this._$subviewsContainer.append(i.render().$el),this._subviews.push(i),i},removeSubview:function(e){var i=this.getSubviewByModel(e);if(i){var n=t.indexOf(this._subviews,i);this._subviews.splice(n,1),i.remove()}},getSubviewByModel:function(e){return t.find(this._subviews,function(i){return i.model===e})},render:function(){return t.invoke(this._subviews,"remove"),this._subviews=[],this._$subviewsContainer.empty(),this.collection.forEach(t.bind(this.addSubview,this)),this},remove:function(){t.invoke(this._subviews,"remove"),this._subviews=[],i.View.prototype.remove.apply(this,arguments)}})});