define(["require","!domReady","dashboard.runtime","controls.base","jrs.configs","jquery","underscore","utils.common"],function(e){var r=e("!domReady"),t=e("dashboard.runtime"),a=e("controls.base"),n=e("jrs.configs"),o=e("jquery"),d=e("underscore");e("utils.common"),r(function(){window.Prototype&&(delete Object.prototype.toJSON,delete Array.prototype.toJSON,delete Hash.prototype.toJSON,delete String.prototype.toJSON),n.dashboardRuntime.isRunInFrame&&("undefined"==typeof JRS&&(JRS={}),JRS.number_of_charts=0,JRS.charts_rendered=0,o('div[id^="textFrameContainer_text_"]').each(function(){var e=o(this),r=e.width();e.css("width",r+3+"px")}),o(window).bind("chart_rendered",function(){JRS.charts_rendered++,JRS.charts_rendered==JRS.number_of_charts&&(o("#managedPrintLoader").hide(),pageDimmer.hide(),alert("Page is ready to print."))}),o(window).bind("managed_print_request",function(){JRS.number_of_charts++,pageDimmer.show(),o("#managedPrintLoader").show()}),window.requestBrowserUpdate=function(){0==JRS.number_of_charts&&alert("To print our Flash based charts please update to a HTML5 capable browser such as IE9."),JRS.number_of_charts++}),d.extend(t,n.dashboardRuntime.localContext),d.extend(a,n.inputControlConstants),d.each(n.dashboardRuntime.frames,function(e){o("#contentFrame_"+e).on("load",function(){t._updateIFrameLoadingStatus("containerOverlay_"+e)})}),d.each(n.dashboardRuntime.contentFrames,function(e){var r="customResourceType"===e.resourceType?"":n.contextPath,a=""===r&&""===e.uri?"":"&fid=contentFrame_"+e.frameName;e.src=r+e.source+e.uri+a,e.autoRefresh&&t.setRefreshTimer(e.frameName,e.autoRefresh)}),d.isArray(n.dashboardRuntime.hiddenParams)&&d.each(n.dashboardRuntime.hiddenParams,function(e){e.paramName=getTextAfterSubstring(e.originalParamName,t.HIDDEN_PARAM_PREFIX)}),t.loadDashboard()})});