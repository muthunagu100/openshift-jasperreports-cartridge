define(["require","underscore","adhoc/filter/valueEditor/AbstractValueEditor","adhoc/filter/format/OlapFilterValueFormatter","adhoc/filter/format/filterValueFormatter","common/component/singleSelect/view/SingleSelectNew","settings!adhocFilterSettings"],function(e){var t=e("underscore"),i=e("adhoc/filter/valueEditor/AbstractValueEditor"),a=e("adhoc/filter/format/OlapFilterValueFormatter"),l=e("adhoc/filter/format/filterValueFormatter"),s=e("common/component/singleSelect/view/SingleSelectNew"),r=e("settings!adhocFilterSettings");return i.extend({tagName:"div",className:"values",initialize:function(){r=t.defaults(r||{},{preloadAvailableValuesOlap:"false",preloadAvailableValues:"true"}),this.list=this.createList(),i.prototype.initialize.apply(this,arguments)},createList:function(){return new s({getData:t.bind(this.model.dataProvider.getData,this.model),formatValue:this.model.isOlap?new a(this.model.get("isFirstLevelInHierarchyAll")).format:l})},registerEvents:function(){this.listenTo(this.list,"selection:change",t.bind(function(e,i){i&&this.model.set("isAnyValue",i.isTrueAll,{silent:!0}),this.setValue(t.isArray(e)?t.reject(e,function(e){return void 0==e}):e)},this))},render:function(){return this.$el.empty(),this.list.$el.hide(),this.$el.append(this.list.el),this.$el.append('<span class="message warning" data-validation-field="value"></span>'),this.list.render(),this},renderData:function(){this.list.renderData()},_setValueToList:function(e){this.list.setValue(this.getValue(),e)},_loadAvailableValuesImmediately:function(){return this.model.isOlap?"true"===r.preloadAvailableValuesOlap:"true"===r.preloadAvailableValues},_removeAvailableData:function(){this.model.isOlap&&(this.model.removeAvailableData(),this.list.reset({silent:!0}))},updateData:function(){this._removeAvailableData();var e={};this._loadAvailableValuesImmediately()?(this.model.setShowLoading(!1),this.list.once("selection:change",t.bind(this.model.setShowLoading,this.model,!0))):e={modelOptions:{silent:!0}},this._setValueToList(e),this.list.$el.show(),this.trigger("rendered",this)},remove:function(){this.removeView(),i.prototype.remove.call(this),this.list.remove()}})});