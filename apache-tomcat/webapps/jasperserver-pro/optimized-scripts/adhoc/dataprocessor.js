!function(e,a){var r={debug:!1,fn:{load:function(e){var a=r;a.data=e.data,a.metadata=e.metadata,a.treeNodeAxes=e.treeNodes,a.fn.load_common(),r.debug&&(console.info("Data Processor State:"),console.info(a))},load_common:function(){var e=r;if(e.measureAxis=e.metadata.measureAxis,e.nonMeasureAxis=0==e.measureAxis?1:0,e.metadata.axes.length&&(e.measureLevelNumber=e.fn.getMeasureLevelNumber.call(e),e.metadata.isOLAP&&(e.measureDimensionNumber=0,e.dimensionMappings=[],e.dimensionAllMappings=new Array(2),e.dimensionLevels=new Array(2),e.rowDimensionMapping=e.fn.dimensionMapping(0),e.dimensionMappings.push(e.rowDimensionMapping),e.colDimensionMapping=e.fn.dimensionMapping(1),e.dimensionMappings.push(e.colDimensionMapping)),e.lastRowNonMeasureLevel=0,e.lastColumnNonMeasureLevel=0,e.rowSliderLevelCount=e.metadata.axes[0].length+1-(0==e.metadata.measureAxis?1:0),e.colSliderLevelCount=e.metadata.axes[1].length+1-(1==e.metadata.measureAxis?1:0),e.rowGroupMapping=e.fn.groupMapping.call(e,0),e.colGroupMapping=e.fn.groupMapping.call(e,1)),e.treeNodeAxes.length&&(e.fn.createTreeNodeStructure.call(e,e.treeNodeAxes[0]),e.fn.createTreeNodeStructure.call(e,e.treeNodeAxes[1])),e.data.length){if("undefined"==typeof e.measureAxis)throw"AdhocDataProcessor.load_common  missing measureAxis metadata !";if(e.measureAxis>1)throw"AdhocDataProcessor.load_common  measureAxis > 1 !";if(e.measureAxis<0)throw"AdhocDataProcessor.load_common  measureAxis < 0 !";if("undefined"==typeof e.measureLevelNumber)throw"AdhocDataProcessor.load_common  measureLevelNumber undetermined !";if(e.measureLevelNumber<=0)throw"AdhocDataProcessor.load_common  measureLevelNumber <= 0 !"}},getOLAPDimensionInfo:function(){for(var e=r,a=new Array(2),n=0;2>n;n++){var t=[],o=e.dimensionMappings[n],s=e.measureAxis===n;if(o.length<=0);else for(var l=e.dimensionAllMappings[n],i=0;i<o.length;i++){var d=o[i];if(!(s&&d.length>0&&"Measures"===d[0].dimension)){var u=!1;l[i]===!0&&(u=!0);var m={};m.levels=[];var v=0;u&&m.levels.push({label:"(All)",levelName:"(All)",levelNumber:v}),v=1;for(var f=0;f<d.length;f++){var g=d[f];m.dimension=g.dimension,g.name&&"(All)"===g.name||(m.levels.push({label:g.label,levelName:g.name,levelNumber:v}),v++)}t.push(m)}}a[n]=t}return r.debug&&(console.log("AdhocDataProcessor.getOLAPDimensionInfo: 4098h  olapAxes"),console.log(a)),a},getMeasureLevelNumber:function(){for(var e=this.metadata.axes[this.metadata.measureAxis],a=0;a<e.length;a++)if("Measures"==e[a].label)return a+1},groupMapping:function(e){var a,n=r,t=[0],o=1,s=n.metadata.axes[e];for(a=0;a<s.length;a++)"Measures"!=s[a].label&&(t[o++]=a+1);return t},dimensionMapping:function(e){var a=r;if(!a.metadata.isOLAP)return null;var n=a.metadata.axes[e],t=1,o=[],s=[];if(a.metadata.axes[e].length<=0)return o;var l=0,i=!1,d=n[0].dimension,u=d;d||alert("dataprocessor.js  ERROR ! 0983jhrn   null dimension in axis "+e);for(var m=[],v=[],f=[],g=t,L=0;L<n.length;L++)if(u=n[L].dimension,"Measures"===u&&(a.measureDimensionNumber=l,a.measureLevelNumber=t),u!==d&&(s.push(i?!0:!1),f.push({dimension:d,startLevel:g,endLevel:t-1}),o.push(m),l++,m=[],i=!1,d=u,g=t),"(All)"!==n[L].label&&"(ALL)"!==n[L].label||(i=!0,!(L<n.length-1&&u===n[L+1].dimension))){var h={dimension:n[L].dimension,label:n[L].label,name:n[L].name,levelNumber:t};m.push(h),v.push(h),t++}return s.push(i?!0:!1),o.push(m),f.push({dimension:u,startLevel:g,endLevel:t-1}),a.metadata.axes[e]=v,a.dimensionAllMappings[e]=s,a.dimensionLevels[e]=f,r.debug&&(console.log("AdhocDataProcessor.dimensionMapping:49e8h  dimensions for axis "+e),console.log(o)),o},createTreeNodeStructure:function(e){var a=e;a.parent=null,a.children?this.fn.connectParentNode.call(this,a,a.children):a.children=[]},connectParentNode:function(e,a){var r,n;for(r=0;r<a.length;r++)n=a[r],n.parent=e,n.children?(grandChildren=n.children,grandChildren.length&&this.fn.connectParentNode.call(this,n,grandChildren)):n.children=[]},getDataStyle:function(){var e=r;return 0==e.metadata.axes[e.nonMeasureAxis].length?0:e.metadata.axes[e.nonMeasureAxis].length>0&&e.metadata.axes[e.measureAxis].length>1?2:1},getNodeListForSliderLevel:function(e,a){var n=r,t=n.metadata.axes[e].length,o=[];o.push({startLevel:0,endLevel:a,leafLevel:t});var s=n.fn.getNodeListForDimLevels(e,o);return r.debug&&(console.log("AdhocDataProcessor.getNodeListForSliderLevel: 4088h  nodeList for axisIndex="+e+" sliderLevel="+a),console.log(s)),s},getNodeListForDimLevelRadio:function(e,a){var n=r;if(!n.metadata.isOLAP)throw"dataprocessor.getNodeListForDimLevelRadio called RadioButton method for non-OLAP query !";if(null===a)throw"dataprocessor.getNodeListForDimLevelRadio.js  y5g59i8y  NULL radioLevel input !";var t=n.dimensionMappings[e];if(!t)throw"dataprocessor.getNodeListForDimLevelRadio.js 0oi098  no dimensionMappings for axis "+e;if(t.length<=0)return n.fn.getEmptyAxisResult();if(a.length>t.length)throw"dataprocessor.getNodeListForDimLevelRadio.js  98hu for axis: "+e+", number of input dimensionss from radio buttons: "+a.length+", exceeds the number of dimensions in the chart data: "+t.length;if(a.length+(e==n.metadata.measureAxis?1:0)<t.length){r.debug&&console.log("AdhocDataProcessor.getNodeListForDimLevelRadio.js need to add  Radio Dimensions padding");for(var o=a.length,s=o;s<t.length;s++){var l=t[s];"Measures"!==l.dimension&&a.push({level:l.length})}}var i=[],d=(n.metadata.axes[e],t.length,0),u=0,m=!1,v=t[0],f="Measures"===v[0].dimension,g=0;if(f&&(g=1),f&&0==a.length)i.push({startLevel:0,endLevel:1,leafLevel:1});else for(var L=0;L<a.length;L++){var l=t[L+g];if(null===l)throw"dataprocessor.getNodeListForDimLevelRadio.js 98hn8 metadata  no dimension for number "+L;if(d++,n.metadata.measureAxis===e&&0>=g){if(L+2>t.length)throw"dataprocessor.getNodeListForDimLevelRadio.js  43098h  we were expecting dimensions to be at least "+(L+2)+" in length, instead it is "+t.length;var h=t[L+1];"Measures"===h[0].dimension&&(m=!0,g=1)}var c=l.length,p=u,A=u+a[L].level,N=u+c;(f||m)&&((A===N||f)&&A++,N++,f=!1,m=!1),i.push({startLevel:p,endLevel:A,leafLevel:N}),u=N}var x=n.fn.getNodeListForDimLevels(e,i);return r.debug&&(console.log("AdhocDataProcessor.getNodeListForDimLevelRadio: 39uh  nodeList for axis="+e+" radioDims, dimLevels "),console.log(a),console.log(i),console.log(x)),x},getNodeListForDimLevels:function(e,a){var n=r;if(0==n.metadata.axes[0].length&&0==n.metadata.axes[1].length)return null;var t=n.metadata.axes[e].length;if(t>0){var o=n.fn.getNodeListForDimensionLevelsMeasure(e,a);return o}return n.fn.getEmptyAxisResult()},getNodeListForSliderLevelGroupMeasure:function(e,a){var n=r,t=n.metadata.axes[e].length;if(t>0){var o=[];return o.push({startLevel:0,endLevel:a,leafLevel:t}),n.fn.getNodeListForDimensionLevelsMeasure(e,o)}return n.fn.getEmptyAxisResult()},getEmptyAxisResult:function(){var e=r;if(!e.emptyAxisResult){var a={isAll:!1,label:"(empty axis)",level:0,axisCoordinate:0};e.emptyAxisResult=[],e.emptyAxisResult.push(a)}return e.emptyAxisResult},getNodeListForDimensionLevelsMeasure:function(e,a){var n=r,t=!1;e===n.metadata.measureAxis&&(t=!0);var o=0==e?n.rowGroupMapping:n.colGroupMapping,s=n.treeNodeAxes[e],l=[];l.push(s);for(var i=0;i<a.length;i++){var d=a[i].startLevel,u=a[i].endLevel,m=a[i].leafLevel;r.debug&&console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure: 93287h  begin qualifying nodes for dim="+i+" startlevel="+d+", endLevel="+u+"localLeafLevel="+m);var v=!1;n.metadata.isOLAP?u===m&&(v=!0):i>=a.length-1&&(0==e?u>=n.rowSliderLevelCount-1&&(v=!0):u>=n.colSliderLevelCount-1&&(v=!0));var f=[];if(v){var g=m;n.metadata.isOLAP||i===a.length-1&&(g=n.metadata.axes[e].length),n.fn.getNodeListForActualLevel(e,l,g,f),r.debug&&(console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure: we9iuhf  LeafLevel nodeList for targetLevel="+g),console.log(f));var L=[],h=0;n.metadata.isOLAP&&(h=d);for(var c=0;c<f.length;c++){var p=f[c];if(p.isAll!==!0)for(var A=p.parent;null!=A;){if(A.level<=h){L.push(p);break}if(A.isAll===!0)break;A=A.parent}}l=L,r.debug&&(console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure:  er83   qualifiedChildren"),console.log(l))}else{var g=o[u+1];n.metadata.isOLAP&&(g=u+1),1==a.length&&0==g?f.push(s):l&&n.fn.getNodeListForActualLevel(e,l,g,f);for(var N=[],c=0;c<f.length;c++){var p=f[c],x=!1;if(p.level<=0)throw"dataprocessor.getNodeListForDimensionLevelsMeasure  leaf  node.level is unexpectedly less or equal to zero !";if(0!=p.level&&p.isAll===!0&&(x=!0),x){if(!p.parent)throw"AdhocDataProcessor.getNodeListForDimensionLevelsMeasure Unexpected missing node.parent in axis "+e;var b=p.parent;if(t&&p.parent.level==n.measureLevelNumber&&n.measureLevelNumber>1){if(!p.parent.parent)throw"AdhocDataProcessor.getNodeListForDimensionLevelsMeasure Unexpected missing node.parent.parent in axis "+e;b=p.parent.parent}b.level>d&&b.isAll===!0&&(x=!1)}x&&(p.level===m?N.push(p):n.fn.chaseAllNodesToLeafToList(p.parent,p,m,N))}l=N,r.debug&&(console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure: 3w948h  non-LeafLevel qualified children    X"),console.log(l))}}return l},getNodeListForActualLevel:function(e,a,n,t){for(var o=r,s=0;s<a.length;s++){var l=a[s];l.level==n?t.push(l):l.children&&o.fn.getNodeListForActualLevel(e,l.children,n,t)}},chaseAllNodesToLeafToList:function(e,a,n,t){var o=r;if(a.level<n&&"children"in a&&a.children.length>0)for(var s=0;s<a.children.length;s++){var l=a.children[s],i=!1;if(l.isAll===!1?l.level==o.measureLevelNumber&&(i=!0):i=!0,i){var d=o.fn.chaseAllNodesToLeafToList(e,l,n,t);d.level===n&&t.push(d)}}return a},recurseLeafArrayFromSimpleNode:function(e,a){var n=r;if(e.children.length>0)for(var t=e.children,o=0;o<t.length;o++)n.fn.recurseLeafArrayFromSimpleNode(t[o],a);else a.push(e)},getDataFromRowColumn:function(e,a){if(!e)throw"dataprocessor.getDataFromRowColumn   NULL row object !";if(e.axisCoordinate<0)throw"dataprocessor.getDataFromRowColumn   row Coordinate < 0 !";if(!a)throw"dataprocessor.getDataFromRowColumn   NULL column object !";if(a.axisCoordinate<0)throw"dataprocessor.getDataFromRowColumn   column Coordinate < 0 !";return r.data[e.axisCoordinate][a.axisCoordinate]},getLabelNameArray:function(e,a){var n=r,t=[];if(null===a)return t;var o=a;if(n.metadata.isOLAP){var s=(a.level,n.dimensionLevels[e]),l=0;if(s)for(var i=0;i<s.length;i++)if(l=i,o.level>=s[i].startLevel&&o.level<=s[i].endLevel){for(;o.parent;){if(!o.isAll){t.push(o.label);break}if(!o.parent)break;if(o=o.parent,o.level<s[i].startLevel)break}break}for(var i=l-1;i>=0;i--){var d=s[i].startLevel,u=s[i].endLevel;for(o=a;o.parent;)if(o=o.parent,o.level<=u&&o.level>=d&&o.level>0&&!o.isAll){t.push(o.label);break}}}else{for(;null!=o.parent;)o.isAll!==!0&&t.push(o.label),o=o.parent;o.level>0&&t.push(o.label)}return t.length<=0&&t.push("Totals"),t},isOLAP:function(){var e=r;return e.metadata.isOLAP},isMeasuresLastOnAxis:function(e){var a=r;if(e!==a.measureAxis)return!1;if(a.fn.isOLAP()){var n=a.dimensionMappings[e];if(n.length<=0)return!1;var t=n[n.length-1],o=t[0];return"Measures"===o.dimension?!0:!1}var s=a.metadata.axes[e];return"Measures"===s[s.length-1].label?!0:!1},doPathsMatch:function(e,a){for(;e.parent;){if(0===e.parent.level)return 0===a.parent.level?!0:!1;if(!a.parent)return!1;if(e=e.parent,a=a.parent,e.level!==a.level)return!1;if(e.label!==a.label)return!1}return a.parent?!1:!0},getLevelsWithoutMeasures:function(e){return a.filter(e,function(e){return"Measures"!=e.dimension})},getLevelIndex:function(e,a){for(var r=0;r<e.length;r++)if(e[r].name===a.name)return r;throw"Specified level was not found."},levelsToLevelNumbers:function(e,a){var n=r.fn,t=[];if(n.isOLAP()){var o=n.getOLAPDimensionInfo();t=n._getOlapLevelNumbers(e,o[a])}else t=n._getNonOlapDataProcessorLevelNumber(e,r.metadata.axes[a]);return t},_getOlapLevelNumbers:function(e,n){var t=r.fn;return a.map(e,function(e){var r=a.find(n,function(a){return a.dimension===e.dimension});return{level:t._getOlapDataProcessorLevelNumber(e,r)}})},_getOlapDataProcessorLevelNumber:function(e,a){for(var r=0;r<a.levels.length;r++)if(a.levels[r].levelName===e.name)return a.levels[r].levelNumber;throw"No olap info found for specified level = "+e.name},_getNonOlapDataProcessorLevelNumber:function(e,a){var n=r.fn;if(0==e.length)return 0;var t=n.getLevelsWithoutMeasures(a);return n.getLevelIndex(t,e[0])+1}}};e.AdhocDataProcessor={load:r.fn.load,levelsToLevelNumbers:r.fn.levelsToLevelNumbers,getLevelIndex:r.fn.getLevelIndex,getLevelsWithoutMeasures:r.fn.getLevelsWithoutMeasures,getOLAPDimensionInfo:r.fn.getOLAPDimensionInfo,getDataFromRowColumn:r.fn.getDataFromRowColumn,getLabelNameArray:r.fn.getLabelNameArray,isMeasuresLastOnAxis:r.fn.isMeasuresLastOnAxis,getDataStyle:r.fn.getDataStyle,getNodeListForDimLevelRadio:r.fn.getNodeListForDimLevelRadio,getNodeListForSliderLevel:r.fn.getNodeListForSliderLevel,getColumnSliderLevelCount:function(){return r.colSliderLevelCount},getRowSliderLevelCount:function(){return r.rowSliderLevelCount}}}(this,_);