function isMacOS(){return isOS("mac")}function isWindowsOS(){return isOS("win")}function isLinuxOS(){return isOS("linux")}function isOS(e){return navigator.appVersion.toLowerCase().include(e)}function isSupportsTouch(){return isIPad()||isAndroid()}function isMozilla(){return"Netscape"===navigator.appName}function isFirefox(){return navigator.userAgent.toLowerCase().include("firefox")}function isWebKitEngine(){return Prototype.Browser.WebKit}function isChrome(){return navigator.userAgent.toLowerCase().include("chrome")}function isIPad(){return"iPad"==navigator.platform}function isAndroid(){return navigator.userAgent.toLowerCase().include("android")}function isIE(){return"Microsoft Internet Explorer"===navigator.appName||navigator.userAgent.indexOf("Trident/")>=0}function isIE6(){return isIEVersion(6)}function isIE7(){return isIEVersion(7)}function isIE8(){return isIEVersion(8)}function isIE9(){return isIEVersion(9)}function isIE10(){return isIEVersion(10)}function isIE11(){return isIEVersion(11)}function isIEVersion7Upwards(){return getIEVersion()>=7}function isIEVersion(e){return getIEVersion()===e}function getIEVersion(){var e=0;if(getIEVersion.version>=0)return getIEVersion.version;if(isIE())if("Netscape"===navigator.appName){var t=navigator.userAgent,i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}else{var n=navigator.appVersion.split("MSIE")[1];e=parseFloat(n)}return getIEVersion.version=e,e}function doNothing(){}function addDataToForm(e,t){var i=function(t,i){var n=jQuery("<input>").attr("type","hidden").attr("name",t).val(i);jQuery(e).append(jQuery(n))};_.each(t,function(e,t){_.isArray(e)?_.each(e,function(e){i(t,e)}):i(t,e)})}function updateYearMonth(e,t,i){return e&&(e.setFullYear(t),e.setMonth(i),e.getMonth()!==i&&e.setMonth(i)),e}function getTZOffset(e,t){if(!e)return 0;var i,n={"africa/abidjan":{utc:0,utc_dst:0},"africa/accra":{utc:0,utc_dst:0},"africa/addis_ababa":{utc:3,utc_dst:3},"africa/algiers":{utc:1,utc_dst:1},"africa/asmara":{utc:3,utc_dst:3},"africa/asmera":{utc:3,utc_dst:3},"africa/bamako":{utc:0,utc_dst:0},"africa/bangui":{utc:1,utc_dst:1},"africa/banjul":{utc:0,utc_dst:0},"africa/bissau":{utc:0,utc_dst:0},"africa/blantyre":{utc:2,utc_dst:2},"africa/brazzaville":{utc:1,utc_dst:1},"africa/bujumbura":{utc:2,utc_dst:2},"africa/cairo":{utc:2,utc_dst:2},"africa/casablanca":{utc:0,utc_dst:1},"africa/ceuta":{utc:1,utc_dst:2},"africa/conakry":{utc:0,utc_dst:0},"africa/dakar":{utc:0,utc_dst:0},"africa/dar_es_salaam":{utc:3,utc_dst:3},"africa/djibouti":{utc:3,utc_dst:3},"africa/douala":{utc:1,utc_dst:1},"africa/el_aaiun":{utc:0,utc_dst:0},"africa/freetown":{utc:0,utc_dst:0},"africa/gaborone":{utc:2,utc_dst:2},"africa/harare":{utc:2,utc_dst:2},"africa/johannesburg":{utc:2,utc_dst:2},"africa/juba":{utc:3,utc_dst:3},"africa/kampala":{utc:3,utc_dst:3},"africa/khartoum":{utc:3,utc_dst:3},"africa/kigali":{utc:2,utc_dst:2},"africa/kinshasa":{utc:1,utc_dst:1},"africa/lagos":{utc:1,utc_dst:1},"africa/libreville":{utc:1,utc_dst:1},"africa/lome":{utc:0,utc_dst:0},"africa/luanda":{utc:1,utc_dst:1},"africa/lubumbashi":{utc:2,utc_dst:2},"africa/lusaka":{utc:2,utc_dst:2},"africa/malabo":{utc:1,utc_dst:1},"africa/maputo":{utc:2,utc_dst:2},"africa/maseru":{utc:2,utc_dst:2},"africa/mbabane":{utc:2,utc_dst:2},"africa/mogadishu":{utc:3,utc_dst:3},"africa/monrovia":{utc:0,utc_dst:0},"africa/nairobi":{utc:3,utc_dst:3},"africa/ndjamena":{utc:1,utc_dst:1},"africa/niamey":{utc:1,utc_dst:1},"africa/nouakchott":{utc:0,utc_dst:0},"africa/ouagadougou":{utc:0,utc_dst:0},"africa/porto-novo":{utc:1,utc_dst:1},"africa/sao_tome":{utc:0,utc_dst:0},"africa/timbuktu":{utc:0,utc_dst:0},"africa/tripoli":{utc:2,utc_dst:2},"africa/tunis":{utc:1,utc_dst:1},"africa/windhoek":{utc:1,utc_dst:2},akst9akdt:{utc:-9,utc_dst:-8},"america/adak":{utc:-10,utc_dst:-9},"america/anchorage":{utc:-9,utc_dst:-8},"america/anguilla":{utc:-4,utc_dst:-4},"america/antigua":{utc:-4,utc_dst:-4},"america/araguaina":{utc:-3,utc_dst:-3},"america/argentina/buenos_aires":{utc:-3,utc_dst:-3},"america/argentina/catamarca":{utc:-3,utc_dst:-3},"america/argentina/comodrivadavia":{utc:-3,utc_dst:-3},"america/argentina/cordoba":{utc:-3,utc_dst:-3},"america/argentina/jujuy":{utc:-3,utc_dst:-3},"america/argentina/la_rioja":{utc:-3,utc_dst:-3},"america/argentina/mendoza":{utc:-3,utc_dst:-3},"america/argentina/rio_gallegos":{utc:-3,utc_dst:-3},"america/argentina/salta":{utc:-3,utc_dst:-3},"america/argentina/san_juan":{utc:-3,utc_dst:-3},"america/argentina/san_luis":{utc:-3,utc_dst:-3},"america/argentina/tucuman":{utc:-3,utc_dst:-3},"america/argentina/ushuaia":{utc:-3,utc_dst:-3},"america/aruba":{utc:-4,utc_dst:-4},"america/asuncion":{utc:-4,utc_dst:-3},"america/atikokan":{utc:-5,utc_dst:-5},"america/atka":{utc:-10,utc_dst:-9},"america/bahia":{utc:-3,utc_dst:-2},"america/bahia_banderas":{utc:-6,utc_dst:-5},"america/barbados":{utc:-4,utc_dst:-4},"america/belem":{utc:-3,utc_dst:-3},"america/belize":{utc:-6,utc_dst:-6},"america/blanc-sablon":{utc:-4,utc_dst:-4},"america/boa_vista":{utc:-4,utc_dst:-4},"america/bogota":{utc:-5,utc_dst:-5},"america/boise":{utc:-7,utc_dst:-6},"america/buenos_aires":{utc:-3,utc_dst:-3},"america/cambridge_bay":{utc:-7,utc_dst:-6},"america/campo_grande":{utc:-4,utc_dst:-3},"america/cancun":{utc:-6,utc_dst:-5},"america/caracas":{utc:-4,utc_dst:-4},"america/catamarca":{utc:-3,utc_dst:-3},"america/cayenne":{utc:-3,utc_dst:-3},"america/cayman":{utc:-5,utc_dst:-5},"america/chicago":{utc:-6,utc_dst:-5},"america/chihuahua":{utc:-7,utc_dst:-6},"america/coral_harbour":{utc:-5,utc_dst:-5},"america/cordoba":{utc:-3,utc_dst:-3},"america/costa_rica":{utc:-6,utc_dst:-6},"america/creston":{utc:-7,utc_dst:-7},"america/cuiaba":{utc:-4,utc_dst:-3},"america/curacao":{utc:-4,utc_dst:-4},"america/danmarkshavn":{utc:0,utc_dst:0},"america/dawson":{utc:-8,utc_dst:-7},"america/dawson_creek":{utc:-7,utc_dst:-7},"america/denver":{utc:-7,utc_dst:-6},"america/detroit":{utc:-5,utc_dst:-4},"america/dominica":{utc:-4,utc_dst:-4},"america/edmonton":{utc:-7,utc_dst:-6},"america/eirunepe":{utc:-4,utc_dst:-4},"america/el_salvador":{utc:-6,utc_dst:-6},"america/ensenada":{utc:-8,utc_dst:-7},"america/fort_wayne":{utc:-5,utc_dst:-4},"america/fortaleza":{utc:-3,utc_dst:-3},"america/glace_bay":{utc:-4,utc_dst:-3},"america/godthab":{utc:-3,utc_dst:-2},"america/goose_bay":{utc:-4,utc_dst:-3},"america/grand_turk":{utc:-5,utc_dst:-4},"america/grenada":{utc:-4,utc_dst:-4},"america/guadeloupe":{utc:-4,utc_dst:-4},"america/guatemala":{utc:-6,utc_dst:-6},"america/guayaquil":{utc:-5,utc_dst:-5},"america/guyana":{utc:-4,utc_dst:-4},"america/halifax":{utc:-4,utc_dst:-3},"america/havana":{utc:-5,utc_dst:-4},"america/hermosillo":{utc:-7,utc_dst:-7},"america/indiana/indianapolis":{utc:-5,utc_dst:-4},"america/indiana/knox":{utc:-6,utc_dst:-5},"america/indiana/marengo":{utc:-5,utc_dst:-4},"america/indiana/petersburg":{utc:-5,utc_dst:-4},"america/indiana/tell_city":{utc:-6,utc_dst:-5},"america/indiana/vevay":{utc:-5,utc_dst:-4},"america/indiana/vincennes":{utc:-5,utc_dst:-4},"america/indiana/winamac":{utc:-5,utc_dst:-4},"america/indianapolis":{utc:-5,utc_dst:-4},"america/inuvik":{utc:-7,utc_dst:-6},"america/iqaluit":{utc:-5,utc_dst:-4},"america/jamaica":{utc:-5,utc_dst:-5},"america/jujuy":{utc:-3,utc_dst:-3},"america/juneau":{utc:-9,utc_dst:-8},"america/kentucky/louisville":{utc:-5,utc_dst:-4},"america/kentucky/monticello":{utc:-5,utc_dst:-4},"america/knox_in":{utc:-6,utc_dst:-5},"america/kralendijk":{utc:-4,utc_dst:-4},"america/la_paz":{utc:-4,utc_dst:-4},"america/lima":{utc:-5,utc_dst:-5},"america/los_angeles":{utc:-8,utc_dst:-7},"america/louisville":{utc:-5,utc_dst:-4},"america/lower_princes":{utc:-4,utc_dst:-4},"america/maceio":{utc:-3,utc_dst:-3},"america/managua":{utc:-6,utc_dst:-6},"america/manaus":{utc:-4,utc_dst:-4},"america/marigot":{utc:-4,utc_dst:-4},"america/martinique":{utc:-4,utc_dst:-4},"america/matamoros":{utc:-6,utc_dst:-5},"america/mazatlan":{utc:-7,utc_dst:-6},"america/mendoza":{utc:-3,utc_dst:-3},"america/menominee":{utc:-6,utc_dst:-5},"america/merida":{utc:-6,utc_dst:-5},"america/metlakatla":{utc:-8,utc_dst:-8},"america/mexico_city":{utc:-6,utc_dst:-5},"america/miquelon":{utc:-3,utc_dst:-2},"america/moncton":{utc:-4,utc_dst:-3},"america/monterrey":{utc:-6,utc_dst:-5},"america/montevideo":{utc:-3,utc_dst:-2},"america/montreal":{utc:-5,utc_dst:-4},"america/montserrat":{utc:-4,utc_dst:-4},"america/nassau":{utc:-5,utc_dst:-4},"america/new_york":{utc:-5,utc_dst:-4},"america/nipigon":{utc:-5,utc_dst:-4},"america/nome":{utc:-9,utc_dst:-8},"america/noronha":{utc:-2,utc_dst:-2},"america/north_dakota/beulah":{utc:-6,utc_dst:-5},"america/north_dakota/center":{utc:-6,utc_dst:-5},"america/north_dakota/new_salem":{utc:-6,utc_dst:-5},"america/ojinaga":{utc:-7,utc_dst:-6},"america/panama":{utc:-5,utc_dst:-5},"america/pangnirtung":{utc:-5,utc_dst:-4},"america/paramaribo":{utc:-3,utc_dst:-3},"america/phoenix":{utc:-7,utc_dst:-7},"america/port_of_spain":{utc:-4,utc_dst:-4},"america/port-au-prince":{utc:-5,utc_dst:-4},"america/porto_acre":{utc:-4,utc_dst:-4},"america/porto_velho":{utc:-4,utc_dst:-4},"america/puerto_rico":{utc:-4,utc_dst:-4},"america/rainy_river":{utc:-6,utc_dst:-5},"america/rankin_inlet":{utc:-6,utc_dst:-5},"america/recife":{utc:-3,utc_dst:-3},"america/regina":{utc:-6,utc_dst:-6},"america/resolute":{utc:-6,utc_dst:-5},"america/rio_branco":{utc:-4,utc_dst:-4},"america/rosario":{utc:-3,utc_dst:-3},"america/santa_isabel":{utc:-8,utc_dst:-7},"america/santarem":{utc:-3,utc_dst:-3},"america/santiago":{utc:-4,utc_dst:-3},"america/santo_domingo":{utc:-4,utc_dst:-4},"america/sao_paulo":{utc:-3,utc_dst:-2},"america/scoresbysund":{utc:-1,utc_dst:0},"america/shiprock":{utc:-7,utc_dst:-6},"america/sitka":{utc:-9,utc_dst:-8},"america/st_barthelemy":{utc:-4,utc_dst:-4},"america/st_johns":{utc:-3,utc_dst:-2},"america/st_kitts":{utc:-4,utc_dst:-4},"america/st_lucia":{utc:-4,utc_dst:-4},"america/st_thomas":{utc:-4,utc_dst:-4},"america/st_vincent":{utc:-4,utc_dst:-4},"america/swift_current":{utc:-6,utc_dst:-6},"america/tegucigalpa":{utc:-6,utc_dst:-6},"america/thule":{utc:-4,utc_dst:-3},"america/thunder_bay":{utc:-5,utc_dst:-4},"america/tijuana":{utc:-8,utc_dst:-7},"america/toronto":{utc:-5,utc_dst:-4},"america/tortola":{utc:-4,utc_dst:-4},"america/vancouver":{utc:-8,utc_dst:-7},"america/virgin":{utc:-4,utc_dst:-4},"america/whitehorse":{utc:-8,utc_dst:-7},"america/winnipeg":{utc:-6,utc_dst:-5},"america/yakutat":{utc:-9,utc_dst:-8},"america/yellowknife":{utc:-7,utc_dst:-6},"antarctica/casey":{utc:11,utc_dst:8},"antarctica/davis":{utc:5,utc_dst:7},"antarctica/dumontdurville":{utc:10,utc_dst:10},"antarctica/macquarie":{utc:11,utc_dst:11},"antarctica/mawson":{utc:5,utc_dst:5},"antarctica/mcmurdo":{utc:12,utc_dst:13},"antarctica/palmer":{utc:-4,utc_dst:-3},"antarctica/rothera":{utc:-3,utc_dst:-3},"antarctica/south_pole":{utc:12,utc_dst:13},"antarctica/syowa":{utc:3,utc_dst:3},"antarctica/vostok":{utc:6,utc_dst:6},"arctic/longyearbyen":{utc:1,utc_dst:2},"asia/aden":{utc:3,utc_dst:3},"asia/almaty":{utc:6,utc_dst:6},"asia/amman":{utc:2,utc_dst:3},"asia/anadyr":{utc:12,utc_dst:12},"asia/aqtau":{utc:5,utc_dst:5},"asia/aqtobe":{utc:5,utc_dst:5},"asia/ashgabat":{utc:5,utc_dst:5},"asia/ashkhabad":{utc:5,utc_dst:5},"asia/baghdad":{utc:3,utc_dst:3},"asia/bahrain":{utc:3,utc_dst:3},"asia/baku":{utc:4,utc_dst:5},"asia/bangkok":{utc:7,utc_dst:7},"asia/beirut":{utc:2,utc_dst:3},"asia/bishkek":{utc:6,utc_dst:6},"asia/brunei":{utc:8,utc_dst:8},"asia/calcutta":{utc:5,utc_dst:5},"asia/choibalsan":{utc:8,utc_dst:8},"asia/chongqing":{utc:8,utc_dst:8},"asia/chungking":{utc:8,utc_dst:8},"asia/colombo":{utc:5,utc_dst:5},"asia/dacca":{utc:6,utc_dst:6},"asia/damascus":{utc:2,utc_dst:3},"asia/dhaka":{utc:6,utc_dst:6},"asia/dili":{utc:9,utc_dst:9},"asia/dubai":{utc:4,utc_dst:4},"asia/dushanbe":{utc:5,utc_dst:5},"asia/gaza":{utc:2,utc_dst:3},"asia/harbin":{utc:8,utc_dst:8},"asia/hebron":{utc:2,utc_dst:3},"asia/ho_chi_minh":{utc:7,utc_dst:7},"asia/hong_kong":{utc:8,utc_dst:8},"asia/hovd":{utc:7,utc_dst:7},"asia/irkutsk":{utc:9,utc_dst:9},"asia/istanbul":{utc:2,utc_dst:3},"asia/jakarta":{utc:7,utc_dst:7},"asia/jayapura":{utc:9,utc_dst:9},"asia/jerusalem":{utc:2,utc_dst:3},"asia/kabul":{utc:4,utc_dst:4},"asia/kamchatka":{utc:12,utc_dst:12},"asia/karachi":{utc:5,utc_dst:5},"asia/kashgar":{utc:8,utc_dst:8},"asia/kathmandu":{utc:5,utc_dst:5},"asia/katmandu":{utc:5,utc_dst:5},"asia/kolkata":{utc:5,utc_dst:5},"asia/krasnoyarsk":{utc:8,utc_dst:8},"asia/kuala_lumpur":{utc:8,utc_dst:8},"asia/kuching":{utc:8,utc_dst:8},"asia/kuwait":{utc:3,utc_dst:3},"asia/macao":{utc:8,utc_dst:8},"asia/macau":{utc:8,utc_dst:8},"asia/magadan":{utc:12,utc_dst:12},"asia/makassar":{utc:8,utc_dst:8},"asia/manila":{utc:8,utc_dst:8},"asia/muscat":{utc:4,utc_dst:4},"asia/nicosia":{utc:2,utc_dst:3},"asia/novokuznetsk":{utc:7,utc_dst:7},"asia/novosibirsk":{utc:7,utc_dst:7},"asia/omsk":{utc:7,utc_dst:7},"asia/oral":{utc:5,utc_dst:5},"asia/phnom_penh":{utc:7,utc_dst:7},"asia/pontianak":{utc:7,utc_dst:7},"asia/pyongyang":{utc:9,utc_dst:9},"asia/qatar":{utc:3,utc_dst:3},"asia/qyzylorda":{utc:6,utc_dst:6},"asia/rangoon":{utc:6,utc_dst:6},"asia/riyadh":{utc:3,utc_dst:3},"asia/saigon":{utc:7,utc_dst:7},"asia/sakhalin":{utc:11,utc_dst:11},"asia/samarkand":{utc:5,utc_dst:5},"asia/seoul":{utc:9,utc_dst:9},"asia/shanghai":{utc:8,utc_dst:8},"asia/singapore":{utc:8,utc_dst:8},"asia/taipei":{utc:8,utc_dst:8},"asia/tashkent":{utc:5,utc_dst:5},"asia/tbilisi":{utc:4,utc_dst:4},"asia/tehran":{utc:3,utc_dst:4},"asia/tel_aviv":{utc:2,utc_dst:3},"asia/thimbu":{utc:6,utc_dst:6},"asia/thimphu":{utc:6,utc_dst:6},"asia/tokyo":{utc:9,utc_dst:9},"asia/ujung_pandang":{utc:8,utc_dst:8},"asia/ulaanbaatar":{utc:8,utc_dst:8},"asia/ulan_bator":{utc:8,utc_dst:8},"asia/urumqi":{utc:8,utc_dst:8},"asia/vientiane":{utc:7,utc_dst:7},"asia/vladivostok":{utc:11,utc_dst:11},"asia/yakutsk":{utc:10,utc_dst:10},"asia/yekaterinburg":{utc:6,utc_dst:6},"asia/yerevan":{utc:4,utc_dst:4},"atlantic/azores":{utc:-1,utc_dst:0},"atlantic/bermuda":{utc:-4,utc_dst:-3},"atlantic/canary":{utc:0,utc_dst:1},"atlantic/cape_verde":{utc:-1,utc_dst:-1},"atlantic/faeroe":{utc:0,utc_dst:1},"atlantic/faroe":{utc:0,utc_dst:1},"atlantic/jan_mayen":{utc:1,utc_dst:2},"atlantic/madeira":{utc:0,utc_dst:1},"atlantic/reykjavik":{utc:0,utc_dst:0},"atlantic/south_georgia":{utc:-2,utc_dst:-2},"atlantic/st_helena":{utc:0,utc_dst:0},"atlantic/stanley":{utc:-3,utc_dst:-3},"australia/act":{utc:10,utc_dst:11},"australia/adelaide":{utc:9,utc_dst:10},"australia/brisbane":{utc:10,utc_dst:10},"australia/broken_hill":{utc:9,utc_dst:10},"australia/canberra":{utc:10,utc_dst:11},"australia/currie":{utc:10,utc_dst:11},"australia/darwin":{utc:9,utc_dst:9},"australia/eucla":{utc:8,utc_dst:8},"australia/hobart":{utc:10,utc_dst:11},"australia/lhi":{utc:10,utc_dst:11},"australia/lindeman":{utc:10,utc_dst:10},"australia/lord_howe":{utc:10,utc_dst:11},"australia/melbourne":{utc:10,utc_dst:11},"australia/north":{utc:9,utc_dst:9},"australia/nsw":{utc:10,utc_dst:11},"australia/perth":{utc:8,utc_dst:8},"australia/queensland":{utc:10,utc_dst:10},"australia/south":{utc:9,utc_dst:10},"australia/sydney":{utc:10,utc_dst:11},"australia/tasmania":{utc:10,utc_dst:11},"australia/victoria":{utc:10,utc_dst:11},"australia/west":{utc:8,utc_dst:8},"australia/yancowinna":{utc:9,utc_dst:10},"brazil/acre":{utc:-4,utc_dst:-4},"brazil/denoronha":{utc:-2,utc_dst:-2},"brazil/east":{utc:-3,utc_dst:-2},"brazil/west":{utc:-4,utc_dst:-4},"canada/atlantic":{utc:-4,utc_dst:-3},"canada/central":{utc:-6,utc_dst:-5},"canada/eastern":{utc:-5,utc_dst:-4},"canada/east-saskatchewan":{utc:-6,utc_dst:-6},"canada/mountain":{utc:-7,utc_dst:-6},"canada/newfoundland":{utc:-3,utc_dst:-2},"canada/pacific":{utc:-8,utc_dst:-7},"canada/saskatchewan":{utc:-6,utc_dst:-6},"canada/yukon":{utc:-8,utc_dst:-7},cet:{utc:1,utc_dst:2},"chile/continental":{utc:-4,utc_dst:-3},"chile/easterisland":{utc:-6,utc_dst:-5},cst6cdt:{utc:-6,utc_dst:-5},cuba:{utc:-5,utc_dst:-4},eet:{utc:2,utc_dst:3},egypt:{utc:2,utc_dst:2},eire:{utc:0,utc_dst:1},est:{utc:-5,utc_dst:-5},est5edt:{utc:-5,utc_dst:-4},"etc/gmt":{utc:0,utc_dst:0},"etc/gmt+0":{utc:0,utc_dst:0},"etc/uct":{utc:0,utc_dst:0},"etc/universal":{utc:0,utc_dst:0},"etc/utc":{utc:0,utc_dst:0},"etc/zulu":{utc:0,utc_dst:0},"europe/amsterdam":{utc:1,utc_dst:2},"europe/andorra":{utc:1,utc_dst:2},"europe/athens":{utc:2,utc_dst:3},"europe/belfast":{utc:0,utc_dst:1},"europe/belgrade":{utc:1,utc_dst:2},"europe/berlin":{utc:1,utc_dst:2},"europe/bratislava":{utc:1,utc_dst:2},"europe/brussels":{utc:1,utc_dst:2},"europe/bucharest":{utc:2,utc_dst:3},"europe/budapest":{utc:1,utc_dst:2},"europe/chisinau":{utc:2,utc_dst:3},"europe/copenhagen":{utc:1,utc_dst:2},"europe/dublin":{utc:0,utc_dst:1},"europe/gibraltar":{utc:1,utc_dst:2},"europe/guernsey":{utc:0,utc_dst:1},"europe/helsinki":{utc:2,utc_dst:3},"europe/isle_of_man":{utc:0,utc_dst:1},"europe/istanbul":{utc:2,utc_dst:3},"europe/jersey":{utc:0,utc_dst:1},"europe/kaliningrad":{utc:3,utc_dst:3},"europe/kiev":{utc:2,utc_dst:3},"europe/lisbon":{utc:0,utc_dst:1},"europe/ljubljana":{utc:1,utc_dst:2},"europe/london":{utc:0,utc_dst:1},"europe/luxembourg":{utc:1,utc_dst:2},"europe/madrid":{utc:1,utc_dst:2},"europe/malta":{utc:1,utc_dst:2},"europe/mariehamn":{utc:2,utc_dst:3},"europe/minsk":{utc:3,utc_dst:3},"europe/monaco":{utc:1,utc_dst:2},"europe/moscow":{utc:4,utc_dst:4},"europe/nicosia":{utc:2,utc_dst:3},"europe/oslo":{utc:1,utc_dst:2},"europe/paris":{utc:1,utc_dst:2},"europe/podgorica":{utc:1,utc_dst:2},"europe/prague":{utc:1,utc_dst:2},"europe/riga":{utc:2,utc_dst:3},"europe/rome":{utc:1,utc_dst:2},"europe/samara":{utc:4,utc_dst:4},"europe/san_marino":{utc:1,utc_dst:2},"europe/sarajevo":{utc:1,utc_dst:2},"europe/simferopol":{utc:2,utc_dst:3},"europe/skopje":{utc:1,utc_dst:2},"europe/sofia":{utc:2,utc_dst:3},"europe/stockholm":{utc:1,utc_dst:2},"europe/tallinn":{utc:2,utc_dst:3},"europe/tirane":{utc:1,utc_dst:2},"europe/tiraspol":{utc:2,utc_dst:3},"europe/uzhgorod":{utc:2,utc_dst:3},"europe/vaduz":{utc:1,utc_dst:2},"europe/vatican":{utc:1,utc_dst:2},"europe/vienna":{utc:1,utc_dst:2},"europe/vilnius":{utc:2,utc_dst:3},"europe/volgograd":{utc:4,utc_dst:4},"europe/warsaw":{utc:1,utc_dst:2},"europe/zagreb":{utc:1,utc_dst:2},"europe/zaporozhye":{utc:2,utc_dst:3},"europe/zurich":{utc:1,utc_dst:2},gb:{utc:0,utc_dst:1},"gb-eire":{utc:0,utc_dst:1},gmt:{utc:0,utc_dst:0},"gmt+0":{utc:0,utc_dst:0},gmt0:{utc:0,utc_dst:0},"gmt-0":{utc:0,utc_dst:0},greenwich:{utc:0,utc_dst:0},hongkong:{utc:8,utc_dst:8},hst:{utc:-10,utc_dst:-10},iceland:{utc:0,utc_dst:0},"indian/antananarivo":{utc:3,utc_dst:3},"indian/chagos":{utc:6,utc_dst:6},"indian/christmas":{utc:7,utc_dst:7},"indian/cocos":{utc:6,utc_dst:6},"indian/comoro":{utc:3,utc_dst:3},"indian/kerguelen":{utc:5,utc_dst:5},"indian/mahe":{utc:4,utc_dst:4},"indian/maldives":{utc:5,utc_dst:5},"indian/mauritius":{utc:4,utc_dst:4},"indian/mayotte":{utc:3,utc_dst:3},"indian/reunion":{utc:4,utc_dst:4},iran:{utc:3,utc_dst:4},israel:{utc:2,utc_dst:3},jamaica:{utc:-5,utc_dst:-5},japan:{utc:9,utc_dst:9},"jst-9":{utc:9,utc_dst:9},kwajalein:{utc:12,utc_dst:12},libya:{utc:2,utc_dst:2},met:{utc:1,utc_dst:2},"mexico/bajanorte":{utc:-8,utc_dst:-7},"mexico/bajasur":{utc:-7,utc_dst:-6},"mexico/general":{utc:-6,utc_dst:-5},mst:{utc:-7,utc_dst:-7},mst7mdt:{utc:-7,utc_dst:-6},navajo:{utc:-7,utc_dst:-6},nz:{utc:12,utc_dst:13},"nz-chat":{utc:12,utc_dst:13},"pacific/apia":{utc:13,utc_dst:14},"pacific/auckland":{utc:12,utc_dst:13},"pacific/chatham":{utc:12,utc_dst:13},"pacific/chuuk":{utc:10,utc_dst:10},"pacific/easter":{utc:-6,utc_dst:-5},"pacific/efate":{utc:11,utc_dst:11},"pacific/enderbury":{utc:13,utc_dst:13},"pacific/fakaofo":{utc:13,utc_dst:13},"pacific/fiji":{utc:12,utc_dst:13},"pacific/funafuti":{utc:12,utc_dst:12},"pacific/galapagos":{utc:-6,utc_dst:-6},"pacific/gambier":{utc:-9,utc_dst:-9},"pacific/guadalcanal":{utc:11,utc_dst:11},"pacific/guam":{utc:10,utc_dst:10},"pacific/honolulu":{utc:-10,utc_dst:-10},"pacific/johnston":{utc:-10,utc_dst:-10},"pacific/kiritimati":{utc:14,utc_dst:14},"pacific/kosrae":{utc:11,utc_dst:11},"pacific/kwajalein":{utc:12,utc_dst:12},"pacific/majuro":{utc:12,utc_dst:12},"pacific/marquesas":{utc:-9,utc_dst:-9},"pacific/midway":{utc:-11,utc_dst:-11},"pacific/nauru":{utc:12,utc_dst:12},"pacific/niue":{utc:-11,utc_dst:-11},"pacific/norfolk":{utc:11,utc_dst:11},"pacific/noumea":{utc:11,utc_dst:11},"pacific/pago_pago":{utc:-11,utc_dst:-11},"pacific/palau":{utc:9,utc_dst:9},"pacific/pitcairn":{utc:-8,utc_dst:-8},"pacific/pohnpei":{utc:11,utc_dst:11},"pacific/ponape":{utc:11,utc_dst:11},"pacific/port_moresby":{utc:10,utc_dst:10},"pacific/rarotonga":{utc:-10,utc_dst:-10},"pacific/saipan":{utc:10,utc_dst:10},"pacific/samoa":{utc:-11,utc_dst:-11},"pacific/tahiti":{utc:-10,utc_dst:-10},"pacific/tarawa":{utc:12,utc_dst:12},"pacific/tongatapu":{utc:13,utc_dst:13},"pacific/truk":{utc:10,utc_dst:10},"pacific/wake":{utc:12,utc_dst:12},"pacific/wallis":{utc:12,utc_dst:12},"pacific/yap":{utc:10,utc_dst:10},poland:{utc:1,utc_dst:2},portugal:{utc:0,utc_dst:1},prc:{utc:8,utc_dst:8},pst8pdt:{utc:-8,utc_dst:-7},roc:{utc:8,utc_dst:8},rok:{utc:9,utc_dst:9},singapore:{utc:8,utc_dst:8},turkey:{utc:2,utc_dst:3},uct:{utc:0,utc_dst:0},universal:{utc:0,utc_dst:0},"us/alaska":{utc:-9,utc_dst:-8},"us/aleutian":{utc:-10,utc_dst:-9},"us/arizona":{utc:-7,utc_dst:-7},"us/central":{utc:-6,utc_dst:-5},"us/eastern":{utc:-5,utc_dst:-4},"us/east-indiana":{utc:-5,utc_dst:-4},"us/hawaii":{utc:-10,utc_dst:-10},"us/indiana-starke":{utc:-6,utc_dst:-5},"us/michigan":{utc:-5,utc_dst:-4},"us/mountain":{utc:-7,utc_dst:-6},"us/pacific":{utc:-8,utc_dst:-7},"us/pacific-new":{utc:-8,utc_dst:-7},"us/samoa":{utc:-11,utc_dst:-11},utc:{utc:0,utc_dst:0},wet:{utc:0,utc_dst:1},"w-su":{utc:4,utc_dst:4},zulu:{utc:0,utc_dst:0}};if(e=e.toLowerCase(),"undefined"==typeof n[e])return 0;i=n[e].utc;var o=require("moment");return o(t).isDST()&&(i=n[e].utc_dst),i}function exists(e){return!Object.isUndefined(e)}function isArray(e){return Object.isArray(e)}function isNumber(e){return Object.isNumber(e)}function isNotNullORUndefined(e){return"undefined"!=typeof e&&null!=e}function hasDisabledAttributeSet(e){var t=e.getAttribute("disabled");return isNotNullORUndefined(t)?"0"==t||"false"==t||""==t?!1:!0:!1}function getParentDiv(e){return e.up("div")}function getParentRow(){return elem.up("tr")}function getParentCell(){return elem.up("td")}function getParentTable(){return elem.up("table")}function getAbsoluteParent(e){for(var t=e;!t.style||"absolute"!==t.style.position;){if("body"===t.tagName.toLowerCase())return null;t=t.up()}return t}function getElementWithIdAndTagAndParent(e,t,i){for(var n=i.getElementsByTagName(t),o=0;o<n.length;o++)if(n[o].getAttribute("id")===e)return n[o];return null}function getClosestAncestor(e,t){for(var i;!i;)if(i=$(e).up(t),!i&&(e=e.parentNode,!e||"DIV"!==e.tagName))return null;return i}function isDescendantOf(e,t){for(;"BODY"!=e.tagName;){if(e==t)return!0;e=e.parentNode}return!1}function getCellIndex(e){return e.cellIndex}function getRowIndex(e){return e.rowIndex}function isDisabled(e){if(!e.readAttribute)return!1;if(Draggables&&Draggables.activeDraggable&&Draggables.activeDraggable.dragging&&matchAny(Draggables.activeDraggable.element,[".sizer.dragging"],!1))return!1;var t=!!e.readAttribute("disabled")||e.ancestors().any(function(e){return e.readAttribute("disabled")}),i=matchAny(e,[".disabled"],!0);return t||i}function matchAny(e,t,i){if(!e)return null;for(var n=0;n<t.length;++n)if(e.match&&e.match(t[n]))return e;if(i)for(var n=0;n<t.length;++n){var o=e.up&&e.up(t[n]);if(o)return o}return null}function matchMeOrUp(e,t){for(var i;e&&!i;)i=e.match&&e.match(t)&&e,e=e.parentNode;return i}function stylesMatch(e,t,i){return $(e).getStyle(i)===$(t).getStyle(i)}function getNextMatchingSibling(e,t){for(;e=e.nextSibling;)if(e.match&&e.match(t))return e;return null}function getNextNonMatchingSibling(e,t){for(;e=e.nextSibling;)if(e.match&&!e.match(t))return e;return null}function getPreviousMatchingSibling(e,t){for(;e=e.previousSibling;)if(e.match&&e.match(t))return e;return null}function getPreviousNonMatchingSibling(e,t){for(;e=e.previousSibling;)if(e.match&&!e.match(t))return e;return null}function getAbsoluteOffsets(e){for(var t=e.offsetLeft,i=e.offsetTop,n=e.offsetParent;"BODY"!=n.tagName.toUpperCase()&&"absolute"!=n.style.position;){var t=t+n.offsetLeft,i=i+n.offsetTop;n=n.offsetParent}return"absolute"==n.style.position&&(t+=n.offsetLeft,i+=n.offsetTop),isIE()&&(i+=1),new Array(t,i,t+e.offsetWidth,i+e.offsetHeight)}function getAbsoluteTopOffset(e){for(var t=e.offsetTop,i=e.offsetParent;"BODY"!=i.tagName.toUpperCase()&&"absolute"!=i.style.position;){var t=t+i.offsetTop;i=i.offsetParent}return"absolute"==i.style.position&&(t+=i.offsetTop),isIE()&&(t+=1),t}function getBoxOffsets(e,t){var i=$(e).cumulativeOffset(),n=i[0],o=i[1];if(t){var s=$(e).cumulativeScrollOffset();n-=s[0],o-=s[1]}return new Array(n,o)}function getInnerText(e){return isNotNullORUndefined(e.innerText)?e.innerText:e.textContent}function isPointOverlayingObject(e,t,i){return Position.within(i,e,t)}function boxesOverlap(e,t,i,n,o,s,r,a){return!(t>a||s>n||e>r||o>i)}function boxesOverlapVertically(e,t,i,n){return!(e>=n||i>=t)}function boxesOverlapHorizontally(e,t,i,n){return!(e>=n||i>=t)}function getOuterHeight(e){return e.clientHeight?new Number(e.getStyle("height").replace(/[^\d\.]/g,""))+getBufferHeight(e,!0):0}function getOuterWidth(e){return e.clientWidth?new Number(e.getStyle("width").replace(/[^\d\.]/g,""))+getBufferWidth(e,!0):0}function getBufferHeight(e,t){if(!e.visible())return 0;var i=0,n=/[^\d\.]/g;if(t){var o=e.getStyle("marginTop"),s=e.getStyle("marginBottom");o=null==o?"0px":o,s=null==s?"0px":s,o=o.replace(n,""),s=s.replace(n,""),i=new Number(o).ceil()+new Number(s).ceil()}return i+=new Number(e.getStyle("borderBottomWidth").replace(n,"")).ceil()+new Number(e.getStyle("borderTopWidth").replace(n,"")).ceil()+new Number(e.getStyle("paddingTop").replace(n,"")).ceil()+new Number(e.getStyle("paddingBottom").replace(n,"")).ceil()}function getBufferWidth(e,t){if(!e.visible())return 0;var i=0,n=/[^\d\.]/g;if(t){var o=e.getStyle("marginLeft"),s=e.getStyle("marginRight");o=null==o?"0px":o,s=null==s?"0px":s,o=o.replace(n,""),s=s.replace(n,""),i=new Number(o).ceil()+new Number(s).ceil()}return i+=new Number(e.getStyle("borderLeftWidth").replace(n,"")).ceil()+new Number(e.getStyle("borderRightWidth").replace(n,"")).ceil()+new Number(e.getStyle("paddingLeft").replace(n,"")).ceil()+new Number(e.getStyle("paddingRight").replace(n,"")).ceil()}function getDimensionInPx(e,t){var i={left:"width",right:"width",width:"width",top:"height",bottom:"height",height:"height"},n=e.getStyle(t);if(n.include("%")){var o=e.parentNode,s=o.getStyle(i[t]);if(!s.include("px"))throw"cannot convert to px , because parent dimension not measured in px";return parseInt(n)*parseInt(s)/100}if(n.include("px"))return parseInt(n);throw"cannot convert to px, because unit is neither px or %"}function getActualDimension(e,t){var i={width:"clientWidth",height:"clientHeight"};return e[i[t]]}function purgeChildElements(e){try{var t=e&&e.children;if(!t)return;for(var i=0,n=t.length;n>i;i++)purge(t[i]),purgeChildElements(t[i]),t[i]=null,t[i]=e.removeChild(t[i]);return 0==e.children.length}catch(o){}}function purge(e){var t,i,n,o=e.attributes;if(o)for(i=o.length,t=0;i>t;t+=1)n=o[t].name,"function"==typeof e[n]&&(e[n]=null);if(o=e.childNodes)for(i=o.length,t=0;i>t;t+=1)purge(e.childNodes[t])}function getCaret(e){if(!e)return 0;if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var i=e.createTextRange(),n=i.duplicate();return i.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",i),n.text.length}return 0}function isAlmostInView(e,t){var i=parseInt(getBoxOffsets(e)[1]),n=$(e).cumulativeScrollOffset()[1],o=getWindowHeight();return n+o+t>i}function getTouchedElement(e){var t=e.changedTouches;return t&&t.length>0?$(document.elementFromPoint(t[0].clientX,t[0].clientY)):e.element()}function centerLayer(e){e.style.left=parseInt((getWindowWidth()-parseInt(e.clientWidth))/2+getScrollLeft())+"px",e.style.top=parseInt((getWindowHeight()-parseInt(e.clientHeight))/2+getScrollTop())+"px"}function centerElement(e,t){if(e){if(e.jquery&&(e=$(e.get(0))),t.horz){if(!e.hasClassName("centered_horz"))throw"Element's className "+e.className+" must include 'centered_horz' for function centerLayer to work with these arguments";var i=e.getWidth()||e.getStyle("min-width");if(i){var n=parseInt(i),o=n+getBufferWidth(e,!0),s=e.up().getWidth();s>o&&(e.style.marginLeft=-(n/2)+"px",e.style.left="50%")}}if(t.vert){if(!e.hasClassName("centered_vert"))throw"Element's className "+e.className+" must include 'centered_vert' for function centerLayer to work with these arguments";var r=e.getHeight()||e.getStyle("min-height");if(r){var a=parseInt(r),l=a+getBufferHeight(e,!0),c=e.up().getHeight();c>l&&(e.style.marginTop=-(a/2)+"px",e.style.top="50%")}}}}function parseFunc(e,t){var i=e.className,n=i.indexOf(t);if(n>-1){var o=i.substring(n).split(" ");if(o.length>0){var s=o[0].replace(t,"");return"function"==typeof window[s]?window[s]:null}}return null}function cascadeElement(e,t){var i=parseInt(e.getStyle("width")),n=i+getBufferWidth(e,!0),o=e.up().getWidth(),s=-(t.horzOffset*t.number/2)+t.position*t.horzOffset;o>n&&(e.style.left=(o-n)/2+s+"px");var r=parseInt(e.getStyle("height")),a=r+getBufferHeight(e,!0),l=e.up().getHeight(),c=-(t.vertOffset*t.number/2)+t.position*t.vertOffset;l>a&&(e.style.top=(l-a)/2+c+"px")}function fitObjectIntoScreen(e,t,i,n,o){var s=parseInt(t?t:e.offsetLeft),r=parseInt(i?i:e.offsetTop),a=parseInt(n?n:e.clientWidth),l=parseInt(o?o:e.clientHeight),c=getScrollLeft(),d=getScrollTop(),u=getWindowWidth(),h=getWindowHeight();a+=20,l+=20,r+l>d+h&&(r=d+h-l),d>r&&(r=d),s+a>c+u&&(s=c+u-a),c>s&&(s=c),e.style.left=s+"px",e.style.top=r+"px"}function setWidthStyleByReflection(e,t){e=t?$(e).select(t)[0]:e,e&&(e.style.width=(e.clientWidth||e.offsetWidth)+"px")}function focusOn(e){$(e).focus()}function selectAndFocusOn(e){var t=$(e);t.select(),t.focus()}function renderHazeLayer(e,t){var i=document.body;return renderOverlay(e,t,i.scrollWidth,i.scrollHeight,"haze")}function renderOverlay(e,t,i,n,o){var s=document.createElement("DIV");return s.className=o,s.style.position="absolute",s.style.left=e,s.style.top=t,s.style.width=i,s.style.height=n,document.body.appendChild(s),s}function removeOverlay(e){e&&e.parentNode&&e.parentNode.removeChild(e),e&&(e=null)}function reParent(e,t){e&&(e.parentNode&&e.parentNode==t||t.appendChild(e))}function getScrollLeftForAbsoluteParent(e){return isIE()?e.scrollLeft:0}function getScrollTopForAbsoluteParent(e){return isIE()?e.scrollTop:0}function renderTransparentIFrame(e,t,i,n){var o=5,s=document.createElement("IFRAME");return s.frameBorder=0,s.style.filter="alpha(opacity=0)",s.style.position="absolute",s.style.left=e-o,s.style.top=t-o,s.style.width=i-2*o,s.style.height=n-2*o,document.body.appendChild(s),s}function pushOverlayObject(e,t,i){var n=getAbsoluteOffsets($(e));pushOverlayObjectAtOffsets(n,t,i)}function pushTotalOverlayObject(e,t){var i=new Array(0,0,document.body.scrollWidth,document.body.scrollHeight);pushOverlayObjectAtOffsets(i,e,t)}function pushOverlayObjectAtOffsets(e,t,i){if(isIE()){var n=renderTransparentIFrame(e[0],e[1],e[2]-e[0],e[3]-e[1]);overlayObjectStack.push(n)}var o=renderOverlay(e[0],e[1],e[2]-e[0],e[3]-e[1],t);i&&(o.style.zIndex=i),overlayObjectStack.push(o)}function popOverlayObject(){if(overlayObjectStack.length>0){var e=overlayObjectStack.pop();removeOverlay(e),isIE()&&overlayObjectStack.length>0&&removeOverlay(overlayObjectStack.pop())}}function popAllOverlayObjects(){for(;overlayObjectStack.length>0;){var e=overlayObjectStack.pop();removeOverlay(e)}}function disableSelection(e){e&&("undefined"!=typeof e.style.KhtmlUserSelect?e.onselectstart=function(e){return e.stopPropagation(),!1
}:"undefined"!=typeof e.onselectstart?e.onselectstart=function(e){return e=e?e:window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1}:"undefined"!=typeof e.style.MozUserSelect&&(e.style.MozUserSelect="-moz-none"),e.style.cursor="default")}function disableSelectionWithoutCursorStyle(e){e&&("undefined"!=typeof e.style.KhtmlUserSelect?e.onselectstart=function(e){return e.stopPropagation(),!1}:"undefined"!=typeof e.onselectstart?e.onselectstart=function(e){return e=e?e:window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1}:"undefined"!=typeof e.style.MozUserSelect&&(e.style.MozUserSelect="-moz-none"))}function enableSelection(e){e&&("undefined"!=typeof e.style.KhtmlUserSelect?e.onselectstart=function(e){return e.stopPropagation(),!0}:"undefined"!=typeof e.onselectstart?e.onselectstart=function(e){return e=e?e:window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!0}:"undefined"!=typeof e.style.MozUserSelect&&(e.style.MozUserSelect="text"),e.style.cursor="default")}function setCursor(e){document.body.style.cursor=e}function cursorDefault(){setCursor("default")}function cursorPointer(){setCursor("pointer")}function cursorWait(){setCursor("wait")}function getCellAtColumn(e,t){for(columnCount=0,i=0;i<e.length;i++)if(columnCount+=e.colspan,columnCount>=t)return e[i];return null}function getCellAtRow(e,t,n){for(rowCount=0,i=0;i<e.length;i++){var o=e[i].cells[t];rowCount+=o.rowspan}return null}function copyTable(e,t,i,n){var o=n?e:$(e).select("tbody")[0],s=n?t:$(t).select("tbody.copyTo")[0];i&&clearTable(t);try{s.insert(o.innerHTML)}catch(r){}}function copyTableJquery(e,t,i,n){var o=n?e:e.find("tbody:first"),s=n?t:jQuery("tobody.copyTo:first",t);i&&clearTable(t);try{jQuery(s).append(o.html())}catch(r){}}function clearTable(e){if(document.all)for(;e.rows[0];)e.deleteRow(0);else e.innerHTML=""}function getWindowWidth(){var e=jQuery(window).width();return isIE9()&&(e+=17),e}function getWindowHeight(){var e=jQuery(window).height();return isIE9()&&(e+=17),e}function getScrollLeft(){return"number"==typeof window.scrollX?window.scrollX:document.body.scrollLeft}function getScrollTop(){return"number"==typeof window.scrollY?window.scrollY:document.body.scrollTop}function scrollXToMiddle(e){var t=e.scrollWidth-getWindowWidth();t>0&&(e.scrollLeft=t/2)}function launchNewWindow(e){window.open(e)}function getIFrameDocument(e){var t=e.contentWindow||e.contentDocument;return t.document&&(t=t.document),t}function getEvent(e){return e?e:window.event}function popEvent(e){cancelEventBubbling(e?e:event)}function triggerNativeEvent(e,t){var i,n=isIE();t=t||(n?document.documentElement:window),document.createEvent?(i=document.createEvent("Event"),i.initEvent(e,!0,!0),t.dispatchEvent(i)):t.fireEvent("on"+e,document.createEventObject())}function relatedTargetInElementSubtree(e,t){return e.relatedTarget?t===e.relatedTarget?!0:e.relatedTarget.descendantOf(t):!1}function cancelEventBubbling(e){e=getEvent(e),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}function cancelEventAndPreventDefault(e){e.preventDefault(),e.stop()}function enterKeyHit(e){var t=whichKeyHit(e);return 13==t||3==t}function whichKeyHit(e){e=getEvent(e);var t=e.charCode?e.charCode:e.which?e.which:e.keyCode;return t}function isCtrlHeld(e){return e=getEvent(e),!(!e||!e.ctrlKey)}function isShiftHeld(e){return e=getEvent(e),!(!e||!e.shiftKey)}function getEventTarget(e){return e=getEvent(e),e&&(e.target||e.srcElement)}function isNavigationInput(e){e=getEvent(e);var t=e.keyCode?e.keyCode:e.which;return t==Keys.DOM_VK_LEFT||t==Keys.DOM_VK_RIGHT||t==Keys.DOM_VK_TAB||t==Keys.DOM_VK_BACK_SPACE||t==Keys.DOM_VK_ENTER}function verifyIsDigitInput(e){e=getEvent(e);var t=e.keyCode?e.keyCode:e.which;return t>=Keys.DOM_VK_0&&t<=Keys.DOM_VK_9||isNavigationInput(e)}function verifyIsInputNumericGroupSeparator(e){e=getEvent(e);var t=e.keyCode?e.keyCode:e.which,i=String.fromCharCode(t);return i===groupingSeparator}function verifyIsInputNumericDecimalSeparator(e){e=getEvent(e);var t=e.keyCode?e.keyCode:e.which,i=String.fromCharCode(t);return i===decimalSeparator}function numberOfDecimals(e){for(var t=e.length,i=0,n=0;t>n;n++)e.charAt(n)===decimalSeparator&&i++;return i}function macOSKeyboardRightClick(e){var e=getEvent(e);return e.ctrlKey?0==e.button||1==e.button||2==e.button:!1}function macOSMouseRightClick(e){var e=getEvent(e),t=!1;return e=e||window.event,e.which?t=3==e.which:e.button&&(t=2==e.button),t}function isRightClick(e){if(isMacOS()){var t=macOSKeyboardRightClick(e),i=macOSMouseRightClick(e);return t||i}return Event.isRightClick(e)}function isLeftClick(e){return Event.isLeftClick(e)}function isMetaHeld(e,t){var e=getEvent(e);return getEvent(e)?isMacOS()?t?e.altKey:e.metaKey:isCtrlHeld(e):!1}function trim(e){return e.strip()}function startsWith(e,t){return e.startsWith(t)}function getTextAfterUnderscore(e){return getTextAfterSubstring(e,"_")}function getTextBeforeUnderscore(e){return getTextBeforeSubstring(e,"_")}function extractNumber(e){var t=e.match(/\d/g);return t=t.join("")}function getTextAfterSubstring(e,t){var i=e.toLowerCase().indexOf(t.toLowerCase());return-1==i?null:e.substring(i+t.length)}function getTextBeforeSubstring(e,t){var i=e.toLowerCase().indexOf(t.toLowerCase());return-1==i?e:e.substring(0,i)}function removeTrailingSlash(e){var t=e.substring(e.length-1);return"/"==t?e.substring(0,e.length-1):e}function removeTrailingPound(e){var t=e.substring(e.length-1);return"#"==t?e.substring(0,e.length-1):e}function removeChars(e,t){var i=0;for(i;i<t.length;i++)for(;e.indexOf(t[i])>-1;)e=e.replace(t[i],"");return e}function replaceAll(e,t,i){e.gsub(t,i)}function jsHash(){var e=new Array;e.clazz="Hash";for(var t=0;t<arguments.length;t+=2)"undefined"!=typeof arguments[t+1]&&(e[arguments[t]]=arguments[t+1],e.push(arguments[t]));return e}function textCounter(e,t){return e.value.length>t?(e.value=e.value.substring(0,t),!1):!0}function saveAndClear(e,t){e=t,t=""}function escapeString(e,t,i){if(!e||!t||void 0===i||null===i)return e;var n="string"==typeof i||Object.isArray(i)&&i.length<t.length,o=Object.isArray(i)?i.first():i;return Object.isArray(t)?(t.each(function(t,s){var r=n?o:i[s];e=e.replace(t,r)}),e):e.replace(t,o)}function formatString(e){var t,i,n,o=Array.prototype.slice.call(arguments,1),s=[];if(o.length<3){for(var r=0;r<o.length;r++)e=e.replace("{"+r+"}",o[r]);return e}if(t=(e||"").match(/[{]\d+[}]/g),!t)return e;i=e.split(/[{]\d+[}]/);for(var a=0;a<i.length;a+=1)n=a<t.length?o[t[a].slice(1,-1)]:"",s.push(i[a],n);return s.join("")}function removeWhitespacesFromTable(e){return e.replace(/>\s+<\/table/g,"></table").replace(/>\s+<thead/g,"><thead").replace(/>\s+<\/thead/g,"></thead").replace(/>\s+<tbody/g,"><tbody").replace(/>\s+<\/tbody/g,"></tbody").replace(/>\s+<caption/g,"><caption").replace(/>\s+<\/caption/g,"></caption").replace(/>\s+<tr/g,"><tr").replace(/>\s+<\/tr/g,"></tr").replace(/>\s+<th/g,"><th").replace(/>\s+<\/th/g,"></th").replace(/>\s+<td/g,"><td").replace(/>\s+<\/td/g,"></td")}function splitText(e,t){var i={left:"",right:e};return t=parseInt(t,10),_.isNaN(t)?i:0===t?i:(i.left=e.substr(0,t),i.right=e.substr(t),i)}function escapeTags(e){return e.replace(/</g,"&lt")}function redirectToUrl(e){if(isIE8()){var t=document.createElement("a");t.href=e,document.body.appendChild(t),t.click()}else window.location.href=e}function checkURLProtocol(e,t){if(!t)return e;if(startsWith(e,"/"))return e;for(var i=new Array("http://","https://","file://","mailto://","ftp://"),n=0;n<i.length;n++)if(startsWith(e,i[n]))return e;return i[0]+e}function getSymbolToAppendNextParam(e){var t=e.substring(e.length-1);return"?"==t||"&"==t?"":e.indexOf("?")>-1?"&":"?"}function showBusyCursor(){theBody.style.cursor="wait"}function restoreDefaultCursor(){theBody.style.cursor=""}function encodeText(e){return encodeURIComponent(encodeURIComponent(e))}function decodeText(e){return decodeURIComponent(e)}function constrain(e,t,i){return e>i?i:t>e?t:e}function deepClone(e){if(null==e)return null;if("object"!=typeof e)return e;var t=Object.isArray(e)?[]:{};for(var i in e)t[i]="object"==typeof e[i]?deepClone(e[i]):e[i];return t}function cloneCustomAttributes(e,t){var i=e?e.attributes:{};for(var n in i){var o=i[n]&&i[n].name;o&&o.startsWith("data")&&$(t).writeAttribute(o,$(e).readAttribute(o))}}function initLog(){log=""}function logIt(e){log=log+"||"+e+"-"+(new Date).getTime()}function debug(e){window.console&&window.console.debug(e)}function startTimer(e){window.console&&window.console.time?console.time(e):timer[e]=+new Date}function stopTimer(e){if(window.console&&window.console.timeEnd)console.timeEnd(e);else if(timer[e]){var t=e+": "+(+new Date-timer[e]);timer[e]=void 0,window.console?console.log(t):window.status=t}}function toBlockNotation(e){return e?e.split(".").map(function(e){return"['"+e+"']"}).join(""):""}function toFunction(theFunction){if("string"!=typeof theFunction)return theFunction;var blockReference=toBlockNotation(theFunction);return eval("window"+blockReference)}function BusyMonitor(e,t){this.waitTime=e,this.theFunction=t,this.timer=null}function InPlaceEditor(e){this.elem=$(e),this.id=e.identify(),this.editing=!1,this.value=getInnerText(e)}function evaluateScripts(e){var t;t=e?$(e):document;var i=t.getElementsByTagName("SCRIPT");if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];o&&o.text&&globalEval(o.text)}}function evaluateScript(e){var t=$(e);t&&t.text&&globalEval(t.text)}function globalEval(e){window.eval.call(window,e)}function loadJSFiles(e){e&&Object.isArray(e)&&e.each(function(e){loadJSFile(e)})}function loadJSFile(e){$(e)&&$(e).parentNode.removeChild($(e));var t=new Element("script");t.setAttribute("id",e),t.setAttribute("type","text/javascript"),t.setAttribute("src",e),$$("head")[0].appendChild(t)}function unloadAllScripts(){var e=document.getElementsByTagName("SCRIPT");if(null!=e)for(var t=0;t<e.length;t++){var i=e[t];i.parentNode.removeChild(i)}}function loadCSSFiles(e,t){e&&Object.isArray(e)&&e.each(function(e){loadCSSFile(e,t)})}function loadCSSFile(e,t){unloadCSSFile(e);var i=new Element("link");i.setAttribute("id",escape(e)),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",e),t&&document.body?document.body.appendChild(i):$$("head")[0].insert(i,"bottom")}function unloadCSSFiles(e){e&&Object.isArray(e)&&e.each(function(e){unloadCSSFile(e)})}function unloadCSSFile(e){if($(escape(e)))try{$(escape(e)).parentNode.removeChild($(escape(e)))}catch(t){alert(t)}}function createCSSRule(e){var t=document.createElement("style");t.type="text/css",t.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(t)}function getFirstMatch(e){return $$(e)[0]}function dialogOnMouseDown(e){var t=null!=e?e:window.event;cancelEventDragTarget&&cancelEventDragTarget==getEventTarget(t)||new Dragger(t,[getAbsoluteParent(window.event?t.srcElement:t.target)],!0,!0,2,new DragListener)}function cancelEventDrag(e){cancelEventDragTarget=getEventTarget(e)}function encodeUriParameter(e){return encodeURIComponent(encodeURIComponent(e))}function replaceHTML(e,t){if(isIE())return void(e.innerHTML=t);var e=$(e),i=e.nextSibling,n=e.parentNode;n.removeChild(e),e.innerHTML=t,i?n.insertBefore(e,i):n.appendChild(e)}function gotoDefaultLocation(e){window.location.href="flow.html?_flowId=searchFlow"+(e?"&"+e:"")}function gotoFolderExplorer(e){window.location.href="flow.html?_flowId=searchFlow",document.location="flow.html?_flowId=searchFlow&showFolder="+e}function switchDesign(e){var t=document.location.href,i=t.include("&decorator");"old"===e?i?t=t.replace("main","mainOld"):t+="&decorator=mainOld&confirm=true":i?t=t.replace("mainOld","main"):t+="&decorator=main&confirm=true",redirectToUrl(t)}function showDiv(e){var t=document.getElementById(e),i=(document.body.clientWidth,document.body.clientHeight,t.style.zIndex);t.style.zIndex=-100,t.style.display="block",centerLayer(t),t.style.zIndex=i}function hideDiv(e){var t=document.getElementById(e);return t.style.display="none",!0}function borderImage(e,t){(document.all||document.getElementById)&&(e.style.borderColor=t)}function resetRadio(e){var t=!1;if(e.length)for(var i=0;i<e.length;++i)e[i].checked&&(e[i].checked=!1,t=!0);else e.checked&&(e.checked=!1,t=!0);return t}function launchAboutDlg(){var e=document.getElementById("about");e.style.display="block",centerLayer(e)}function hideAboutDlg(){var e=document.getElementById("about");e.style.display="none"}function unescapeBackslash(e){return e?e.replace(/\\\\/g,"\\"):e}function ajaxIframeDownload(e,t){var i=$("ajax-download-iframe");t&&(i.onload=t.onload),i.src=e}function parseAsDate(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])}function parseAsDateTime(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])}function padNumber(e){var t=String(e);return 1===t.length&&(t="0"+t),t}function toTimestampString(e){return e.getUTCFullYear()+"-"+padNumber(e.getMonth()+1)+"-"+padNumber(e.getDate())+" "+padNumber(e.getHours())+":"+padNumber(e.getMinutes())+":"+padNumber(e.getSeconds())}function isProVersion(){return __jrsConfigs__.isProVersion}function AjaxRequester(e,t,i,n){this.url=e||document.location.toString(),this.params=t,this.xmlhttp=getXMLHTTP();var o=this.processResponse(this);this.xmlhttp.onreadystatechange=o,this.postData=i,this.async=!n,this.requestTime=+new Date}function handleResponse(e){checkForErrors(e)||e.responseHandler(e),ajaxRequestEnded(e),JRS&&JRS.vars&&(JRS.vars.ajax_in_progress=!1),document.getElementById("mainTableContainerOverlay")&&(document.getElementById("mainTableContainerOverlay").className="hidden")}function targettedResponseHandler(e){var t=e.xmlhttp,i=e.params[0],n=e.params[1],o=e.params[2],s=(e.params[3],$(i));n?(s.innerHTML="",updateUsingResponseSubset(t,n,s)):s.innerHTML=t.responseText,invokeCallbacks(o,s)}function cumulativeResponseHandler(e){var t=e.xmlhttp,i=e.params[0],n=e.params[1],o=e.params[2],s=$(i);n?updateUsingResponseSubset(t,n,s):s.insert(t.responseText,{position:"after"}),invokeCallbacks(o)}function rowCopyResponseHandler(e){var t=e.xmlhttp,i=e.params[0],n=e.params[2],o=$(i);if("TABLE"!==o.tagName)return void alert("Ajax Exception: rowCopyResponseHandler will not work for container "+o.tagName);var s=Builder.node("DIV");s.innerHTML=t.responseText,copyTable(s.getElementsByTagName("table")[0],o,!1,!1),invokeCallbacks(n)}function updateUsingResponseSubset(e,t,i){function n(){if(!(d>=c)){var e=jQuery(l.get(d));e.attr("src")?(d++,o(e.attr("data-custname"),e.attr("src"),n)):(d++,s(e.html(),n))}}function o(e,t,i){var n=i||!1,o=document.createElement("script");window.jr_scripts||(window.jr_scripts={}),window.jr_scripts[e]||"jr_jq_min"===e?n&&i():(o.setAttribute("type","text/javascript"),o.readyState?o.onreadystatechange=function(){("loaded"===o.readyState||"complete"===o.readyState)&&(o.onreadystatechange=null,n&&i())}:o.onload=function(){n&&i()},o.src=t,document.getElementsByTagName("head")[0].appendChild(o),window.jr_scripts[e]=t)}function s(e,t){var i=t||!1;if(e){var n=e.match(/^.*((\r\n|\n|\r)|$)/gm);window.eval(n.join("\n")),i&&t()}}var r=jQuery(e.responseText),a=r.filter("#"+t);if("TABLE"==i.tagName&&"TABLE"==$(t).tagName?copyTableJquery(a,i,!0):jQuery(i).append(a.html()),"undefined"!=typeof jQuery){var l=r.filter("script.jasperreports"),c=l.size(),d=0;n()}}function invokeCallbacks(callback,customArg){callback&&("string"==typeof callback?eval(callback):callback(customArg))}function ajaxClobberredUpdate(e,t){t.responseHandler=clobberingResponseHandler,ajaxUpdate(e,t)}function ajaxTargettedUpdate(url,options){var responseHandler;responseHandler=options.mode==AjaxRequester.prototype.CUMULATIVE_UPDATE?cumulativeResponseHandler:options.mode==AjaxRequester.prototype.ROW_COPY_UPDATE?rowCopyResponseHandler:options.mode==AjaxRequester.prototype.EVAL_JSON?evalJSONResponseHandler:targettedResponseHandler,options.responseHandler=function(requester,params){options.preFillAction?"string"==typeof options.preFillAction?eval(options.preFillAction):options.preFillAction(responseHandler(requester,params)):responseHandler(requester,options.params)},ajaxUpdate(url,options)}function ajaxNonReturningUpdate(e,t){t.responseHandler=null,ajaxUpdate(e,t)}function ajaxClobberedFormSubmit(e,t,i){var n=getPostData(e,extraPostData);i.postData=appendPostData(n,extraPostData),i.responseHandler=clobberingResponseHandler,ajaxUpdate(t,i)}function ajaxTargettedFormSubmit(e,t,i){var n=getPostData(e,i.extraPostData);i.postData=appendPostData(n,i.extraPostData),i.responseHandler=targettedResponseHandler,ajaxUpdate(t,i)}function ajaxErrorHandler(){showMessageDialog(ajaxError,ajaxErrorHeader)}function doNothing(){}function ajaxUpdate(e,t){var i=!0,n=new AjaxRequester(e,[t.fillLocation,t.fromLocation,t.callback,t.isAutomaticRefresh],t.postData,t.synchronous);isIPad()&&"adhoc"==JRS.vars.current_flow&&(JRS.vars.ajax_in_progress||(JRS.vars.ajax_in_progress=!0)),i&&(n.busyCursor=!t.silent,n.showLoading=!t.silent&&!t.hideLoader,n.responseHandler=t.responseHandler||doNothing,n.responseHandler!=doNothing&&ajaxRequestStarted(n),t.errorHandler&&(n.errorHandler=t.errorHandler),n.xmlhttp&&(t.postData?n.doPost():n.doGet()))}function checkForErrors(e){var t=e.errorHandler;return t(e.xmlhttp)}function getPostData(e,t){"string"==typeof e&&(e=document.forms[e]);for(var i="",n=0;n<e.elements.length;++n){var o=e.elements[n];!o.name||t&&t[o.name]||(i=appendFormInput(i,o))}return i}function appendPostData(e,t){for(name in t)e=appendFormValue(e,name,t[name]);return e}function appendFormInput(e,t){if(t.name){var i,n=!1;switch(t.type){case"checkbox":case"radio":n=t.checked,i=t.value;break;case"hidden":case"password":case"text":case"Textarea":n=!0,i=t.value;break;case"select-one":case"select-multiple":i=new Array;for(var o=0;o<t.options.length;++o){var s=t.options[o];s.selected&&(n=!0,i.push(s.value))}}if(n)if(i.shift)for(;i.length>0;)e=appendFormValue(e,t.name,i.shift());else e=appendFormValue(e,t.name,i)}return e}function appendFormValue(e,t,i){return e.length>0&&(e+="&"),e+=t+"="+encodeURIComponent(i)}function baseErrorHandler(e){if(500==e.status)return showErrorPopup(e.responseText),!0;var t=e.getResponseHeader("LoginRequested");if(t){var i=".";return document.location=i,!0}var n=e.getResponseHeader("JasperServerError");if(n){var o=e.getResponseHeader("SuppressError");if(!o){var s=jQuery(".dashboardViewFrame");if(1==s.length){document.body.innerHTML=e.responseText;var r=jQuery("#"+JRS.fid,window.parent.document);r.removeClass("hidden").show()}else showErrorPopup(e.responseText)}return!0}return!1}function showErrorPopup(e,t){(e&&e.indexOf("sessionAttributeMissingException"))>-1?dialogs.clusterErrorPopup.show(e):dialogs.errorPopup.show(e,!1,t)}function hideErrorPopup(){popOverlayObject();var e=document.getElementById(ERROR_POPUP_DIV);e.style.display="none"}function ajaxRequestStarted(e){++ajax.ajaxRequestCount,e.busyCursor&&(document.body.style.cursor="wait"),!isIPad()&&e.showLoading&&e.startResponseTimer()}function ajaxRequestEnded(e){e.cancelResponseTimer(),ajax.ajaxRequestCount<=1?(document.body.style.cursor="auto",ajax.ajaxRequestCount=0,dialogs.popup.hide($(ajax.LOADING_ID))):ajax.ajaxRequestCount--}function isValidJsonResponse(e){var t=e.getResponseHeader("Content-Type");return 200==e.status&&null!=t&&t.indexOf("application/json")>=0}function getXMLHTTP(){var e,t;if(!t&&!e)try{t=new XMLHttpRequest}catch(i){alert("You need a browser which supports an XMLHttpRequest Object.\nMozilla build 0.9.5 has this Object and IE5 and above, others may do, I don't know, any info jim@jibbering.com")}return t}function moveTo(e,t,i,n){new Effect.Move($(e),{sync:!1,x:t,y:i,mode:"absolute",duration:n?n:.2})}function move(e,t,i,n){new Effect.Move($(e),{sync:!1,x:t,y:i,mode:"relative",duration:n?n:.2})}function moveMany(e,t,i,n){for(var o=[],s=0;s<e.length;++s)o[s]=new Effect.Move(e[s],{sync:!0,x:t,y:i,mode:"relative"});new Effect.Parallel(o,{duration:n?n:1})}function fade(e,t,i){$(e).fade({duration:t?t:1,from:1,to:i?i:0})}function fadeMany(e,t,i){for(var n=[],o=0;o<e.length;++o)n[o]=new Effect.Fade(e[o],{sync:!0,from:1,to:i?i:0});new Effect.Parallel(n,{duration:t?t:1})}function appear(e,t,i){$(e).appear({duration:t?t:1,from:0,to:i?i:1})}function appearMany(e,t,i){for(var n=[],o=0;o<e.length;++o)n[o]=new Effect.Appear(e[o],{sync:!0,from:0,to:i?i:1});new Effect.Parallel(n,{duration:t?t:1})}function pulsate(e,t,i){var n=$(e).identify();Effect.Pulsate(n,{pulses:t?t:5,duration:i?i:2})}function renderImageOverMousePointer(e,t){var e=$(e);return e.show(),e.style.left=t.clientX,e.style.top=t.clientY,e}function JSTooltip(e,t){if(e){if(this.srcElement=e,t&&(this.label=t.label,this.text=t.text,this.offsets=t.offsets,this.showBelow=!!t.showBelow,this.templateId=t.templateId,this.loadTextCallback=t.loadTextCallback,this.loadTextExecuted=!1),this.templateId)this._toAttribute(this.TOOLTIP_TEMPLATE,this.templateId);else{var i=this._fromAttribute(this.TOOLTIP_TEMPLATE);this.templateId=i&&i.length>0?i:this.TOOLTIP_TEMPLATE_ID}this.label?this._toAttribute(this.TOOLTIP_LABEL,this.label):this.label=this._fromAttribute(this.TOOLTIP_LABEL),this.text?this._toAttribute(this.TOOLTIP_TEXT,this.text):this.text=this._fromAttribute(this.TOOLTIP_TEXT),this.srcElement.jsTooltip=this,tooltipModule.tooltips.push(this)}}function replaceNbsps(e){var t=new RegExp("&nbsp;","g");return e.replace(t," ")}function fireMenuAction(e){var t=getAsFunction(e);t&&t()}function fireMenuActionWithEvent(e,t){var i,n=toFunction(t);n=n||(i=toFunction("localContext."+t)),n&&(e=_.isArray(e)?e:[e],n.apply(i?localContext:null,e))}function getMenuMouseupFunction(e,t,i,n,o){if(!e)return null;if(t){var s=resolveReservedStringsInArray(t,i,n,o);return function(){fireMenuActionWithEvent(s,e,o)}}return function(){fireMenuAction(e,o)}}function evaluateTest(e,t,i,n,o,s){var r=null!=s?s:!0,a=getAsFunction(e);return a&&(r=a.apply(this,resolveReservedStringsInArray(t,i,n,null)),o&&(r=!r)),r}function resolveReservedStringsInArray(e,t,i,n){return e?e.collect(function(e){return resolveReservedStrings(e,t,i,n)}):[]}function resolveReservedStrings(e,t,i,n){return e==actionModel.RES_SELECTED?actionModel.selObjects:e==actionModel.RES_LABEL?t:e==actionModel.RES_ID?i:e==actionModel.EVENT?n:e}function getRandomId(){var e=Math.round(50*Math.random(10));return"_"+e}function makeCustomTooltip(e,t){hideCustomTooltip(e);var e=e?e:window.event,i=document.getElementById("customTooltipTemplate").cloneNode(!0);return i.style.display=t?"block":"none",i.setAttribute("id",customTooltip.TOOLTIP_ID),i.innerHTML=t,i.onmouseover=function(e){hideCustomTooltip(e)},i}function addCustomTooltip(e){document.body.appendChild(e),fitObjectIntoScreen(e,e.style.left,e.style.top,e.clientWidth,e.clientWidth)}function showCustomTooltip(e,t,i,n,o,s){var r=makeCustomTooltip(e,t);return i&&(r.style.maxWidth=i),o&&(r.style.backgroundColor=o),n&&(r.style.color=n),r.style.left=e.clientX+getScrollLeft(),r.style.top=e.clientY+getScrollTop()+5+(s?s:0),addCustomTooltip(r),r}function showCustomTooltipBelowObject(e,t,i,n,o){if(o.parentNode){var s=makeCustomTooltip(e,t);i&&(s.style.maxWidth=i),n&&(s.className=n);var r=getBoxOffsets(o),a=r[1]+o.clientHeight+5;return s.style.left=r[0],s.style.top=a,addCustomTooltip(s),s}}function updateCustomTooltip(e){var t=document.getElementById(customTooltip.TOOLTIP_ID);if(t){var i=t.getElementsByTagName("TD")[0];i.innerHTML=e,t.style.display="block",fitObjectIntoScreen(t,t.style.left,t.style.top,i.offsetWidth,i.offsetHeight)}}function hideCustomTooltip(e){var e=e?e:window.event,t=e.explicitOriginalTarget?getParentDiv(e.explicitOriginalTarget):null;if(!t||t.getAttribute("id")!=customTooltip.TOOLTIP_ID){var i=document.getElementById(customTooltip.TOOLTIP_ID);i&&(i.parentNode&&i.parentNode.removeChild(i),i=null)}}function DragListener(){this.agents=[],this.currentAgentName=null,this.dragger}function Dragger(e,t,i,n,o,s,r){var e=e?e:event;this.originalX=new Array,this.originalY=new Array,this.draggingObjs=t,this.dragsX=i,this.dragsY=n,this.sigMove=o,this.dragListener=s,this.cleanUpUtil=r,this.dragListener&&(this.dragListener.dragger=this);for(var a=0;a<t.length;a++)this.originalX[a]=parseInt(t[a].style.left),this.originalY[a]=parseInt(t[a].style.top);this.mouseX=e.clientX,this.mouseY=e.clientY,this.isDragging=!1,this.initDragger(e)}function SelectedFormula(){this.reset()}function SelectionCategory(){this.area="",this.reset=function(){this.area=""}}function showMessageDialog(e,t){alert(e+"\n"+t)}function getSessionExpireTime(){return function(){var e,t=new Date,i=t.getHours()%12;0==i&&(i=12);var n=t.getMinutes()+(MILL_PER_MIN>delayBeforeSessionTimeoutWarning?1:MIN_WARN_BEFORE_TIMEOUT);return e=10>n||n>59?"0"+n%60:n," "+i+":"+e}()}function rom_init(){rom_orgMode=null!=organizationId&&""!=organizationId,rom_showRoot=!rom_orgMode}define("domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=d;l&&t.length&&(d=[],e(t))}function i(){l||(l=!0,r&&clearInterval(r),t())}function n(e){return l?e(c):d.push(e),n}var o,s,r,a="undefined"!=typeof window&&window.document,l=!a,c=a?document:null,d=[];if(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1);else if(window.attachEvent){window.attachEvent("onload",i),s=document.createElement("div");try{o=null===window.frameElement}catch(u){}s.doScroll&&o&&window.external&&(r=setInterval(function(){try{s.doScroll(),i()}catch(e){}},30))}"complete"===document.readyState&&i()}return n.version="2.0.1",n.load=function(e,t,i,o){o.isBuild?i(null):n(i)},n}),function(){function e(t,n){function s(e){if(s[e]!==g)return s[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=s("json-stringify")&&s("json-parse");else{var i,o='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=n.stringify,d="function"==typeof l&&b;if(d){(i=function(){return 1}).toJSON=i;try{d="0"===l(0)&&"0"===l(new r)&&'""'==l(new a)&&l(_)===g&&l(g)===g&&l()===g&&"1"===l(i)&&"[1]"==l([i])&&"[null]"==l([g])&&"null"==l(null)&&"[null,null,null]"==l([g,_,null])&&l({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==o&&"1"===l(null,i)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(u){d=!1}}t=d}if("json-parse"==e){var h=n.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){i=h(o);var p=5==i.a.length&&1===i.a[0];if(p){try{p=!h('"	"')}catch(u){}if(p)try{p=1!==h("01")}catch(u){}if(p)try{p=1!==h("1.")}catch(u){}}}}catch(u){p=!1}t=p}}return s[e]=!!t}t||(t=o.Object()),n||(n=o.Object());var r=t.Number||o.Number,a=t.String||o.String,l=t.Object||o.Object,c=t.Date||o.Date,d=t.SyntaxError||o.SyntaxError,u=t.TypeError||o.TypeError,h=t.Math||o.Math,p=t.JSON||o.JSON;"object"==typeof p&&p&&(n.stringify=p.stringify,n.parse=p.parse);var m,f,g,v=l.prototype,_=v.toString,b=new c(-0xc782b5b800cec);try{b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(y){}if(!s("json")){var T="[object Function]",S="[object Date]",A="[object Number]",C="[object String]",E="[object Array]",x="[object Boolean]",M=s("bug-string-char-index");if(!b)var w=h.floor,D=[0,31,59,90,120,151,181,212,243,273,304,334],I=function(e,t){return D[t]+365*(e-1970)+w((e-1969+(t=+(t>1)))/4)-w((e-1901+t)/100)+w((e-1601+t)/400)};if((m=v.hasOwnProperty)||(m=function(e){var t,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=_?m=function(e){var t=this.__proto__,i=e in(this.__proto__=null,this);return this.__proto__=t,i}:(t=i.constructor,m=function(e){var i=(this.constructor||t).prototype;return e in this&&!(e in i&&this[e]===i[e])}),i=null,m.call(this,e)}),f=function(e,t){var n,o,s,r=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,o=new n;for(s in o)m.call(o,s)&&r++;return n=o=null,r?f=2==r?function(e,t){var i,n={},o=_.call(e)==T;for(i in e)o&&"prototype"==i||m.call(n,i)||!(n[i]=1)||!m.call(e,i)||t(i)}:function(e,t){var i,n,o=_.call(e)==T;for(i in e)o&&"prototype"==i||!m.call(e,i)||(n="constructor"===i)||t(i);(n||m.call(e,i="constructor"))&&t(i)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(e,t){var n,s,r=_.call(e)==T,a=!r&&"function"!=typeof e.constructor&&i[typeof e.hasOwnProperty]&&e.hasOwnProperty||m;for(n in e)r&&"prototype"==n||!a.call(e,n)||t(n);for(s=o.length;n=o[--s];a.call(e,n)&&t(n));}),f(e,t)},!s("json-stringify")){var O={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},L="000000",N=function(e,t){return(L+(t||0)).slice(-e)},R="\\u00",k=function(e){for(var t='"',i=0,n=e.length,o=!M||n>10,s=o&&(M?e.split(""):e);n>i;i++){var r=e.charCodeAt(i);switch(r){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=O[r];break;default:if(32>r){t+=R+N(2,r.toString(16));break}t+=o?s[i]:e.charAt(i)}}return t+'"'},P=function(e,t,i,n,o,s,r){var a,l,c,d,h,p,v,b,y,T,M,D,O,L,R,F;try{a=t[e]}catch(H){}if("object"==typeof a&&a)if(l=_.call(a),l!=S||m.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=A&&l!=C&&l!=E||m.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&1/0>a){if(I){for(h=w(a/864e5),c=w(h/365.2425)+1970-1;I(c+1,0)<=h;c++);for(d=w((h-I(c,0))/30.42);I(c,d+1)<=h;d++);h=1+h-I(c,d),p=(a%864e5+864e5)%864e5,v=w(p/36e5)%24,b=w(p/6e4)%60,y=w(p/1e3)%60,T=p%1e3}else c=a.getUTCFullYear(),d=a.getUTCMonth(),h=a.getUTCDate(),v=a.getUTCHours(),b=a.getUTCMinutes(),y=a.getUTCSeconds(),T=a.getUTCMilliseconds();a=(0>=c||c>=1e4?(0>c?"-":"+")+N(6,0>c?-c:c):N(4,c))+"-"+N(2,d+1)+"-"+N(2,h)+"T"+N(2,v)+":"+N(2,b)+":"+N(2,y)+"."+N(3,T)+"Z"}else a=null;if(i&&(a=i.call(t,e,a)),null===a)return"null";if(l=_.call(a),l==x)return""+a;if(l==A)return a>-1/0&&1/0>a?""+a:"null";if(l==C)return k(""+a);if("object"==typeof a){for(L=r.length;L--;)if(r[L]===a)throw u();if(r.push(a),M=[],R=s,s+=o,l==E){for(O=0,L=a.length;L>O;O++)D=P(O,a,i,n,o,s,r),M.push(D===g?"null":D);F=M.length?o?"[\n"+s+M.join(",\n"+s)+"\n"+R+"]":"["+M.join(",")+"]":"[]"}else f(n||a,function(e){var t=P(e,a,i,n,o,s,r);t!==g&&M.push(k(e)+":"+(o?" ":"")+t)}),F=M.length?o?"{\n"+s+M.join(",\n"+s)+"\n"+R+"}":"{"+M.join(",")+"}":"{}";return r.pop(),F}};n.stringify=function(e,t,n){var o,s,r,a;if(i[typeof t]&&t)if((a=_.call(t))==T)s=t;else if(a==E){r={};for(var l,c=0,d=t.length;d>c;l=t[c++],a=_.call(l),(a==C||a==A)&&(r[l]=1));}if(n)if((a=_.call(n))==A){if((n-=n%1)>0)for(o="",n>10&&(n=10);o.length<n;o+=" ");}else a==C&&(o=n.length<=10?n:n.slice(0,10));return P("",(l={},l[""]=e,l),s,r,o,"",[])}}if(!s("json-parse")){var F,H,B=a.fromCharCode,V={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},U=function(){throw F=H=null,d()},j=function(){for(var e,t,i,n,o,s=H,r=s.length;r>F;)switch(o=s.charCodeAt(F)){case 9:case 10:case 13:case 32:F++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=M?s.charAt(F):s[F],F++,e;case 34:for(e="@",F++;r>F;)if(o=s.charCodeAt(F),32>o)U();else if(92==o)switch(o=s.charCodeAt(++F)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=V[o],F++;break;case 117:for(t=++F,i=F+4;i>F;F++)o=s.charCodeAt(F),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||U();e+=B("0x"+s.slice(t,F));break;default:U()}else{if(34==o)break;for(o=s.charCodeAt(F),t=F;o>=32&&92!=o&&34!=o;)o=s.charCodeAt(++F);e+=s.slice(t,F)}if(34==s.charCodeAt(F))return F++,e;U();default:if(t=F,45==o&&(n=!0,o=s.charCodeAt(++F)),o>=48&&57>=o){for(48==o&&(o=s.charCodeAt(F+1),o>=48&&57>=o)&&U(),n=!1;r>F&&(o=s.charCodeAt(F),o>=48&&57>=o);F++);if(46==s.charCodeAt(F)){for(i=++F;r>i&&(o=s.charCodeAt(i),o>=48&&57>=o);i++);i==F&&U(),F=i}if(o=s.charCodeAt(F),101==o||69==o){for(o=s.charCodeAt(++F),(43==o||45==o)&&F++,i=F;r>i&&(o=s.charCodeAt(i),o>=48&&57>=o);i++);i==F&&U(),F=i}return+s.slice(t,F)}if(n&&U(),"true"==s.slice(F,F+4))return F+=4,!0;if("false"==s.slice(F,F+5))return F+=5,!1;if("null"==s.slice(F,F+4))return F+=4,null;
U()}return"$"},z=function(e){var t,i;if("$"==e&&U(),"string"==typeof e){if("@"==(M?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=j(),"]"!=e;i||(i=!0))i&&(","==e?(e=j(),"]"==e&&U()):U()),","==e&&U(),t.push(z(e));return t}if("{"==e){for(t={};e=j(),"}"!=e;i||(i=!0))i&&(","==e?(e=j(),"}"==e&&U()):U()),(","==e||"string"!=typeof e||"@"!=(M?e.charAt(0):e[0])||":"!=j())&&U(),t[e.slice(1)]=z(j());return t}U()}return e},G=function(e,t,i){var n=W(e,t,i);n===g?delete e[t]:e[t]=n},W=function(e,t,i){var n,o=e[t];if("object"==typeof o&&o)if(_.call(o)==E)for(n=o.length;n--;)G(o,n,i);else f(o,function(e){G(o,e,i)});return i.call(e,t,o)};n.parse=function(e,t){var i,n;return F=0,H=""+e,i=z(j()),"$"!=j()&&U(),F=H=null,t&&_.call(t)==T?W((n={},n[""]=i,n),"",t):i}}}return n.runInContext=e,n}var t="function"==typeof define&&define.amd,i={"function":!0,object:!0},n=i[typeof exports]&&exports&&!exports.nodeType&&exports,o=i[typeof window]&&window||this,s=n&&i[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!s||s.global!==s&&s.window!==s&&s.self!==s||(o=s),n&&!t)e(o,n);else{var r=o.JSON,a=o.JSON3,l=!1,c=e(o,o.JSON3={noConflict:function(){return l||(l=!0,o.JSON=r,o.JSON3=a,r=a=null),c}});o.JSON={parse:c.parse,stringify:c.stringify}}t&&define("json3",[],function(){return c})}.call(this),define("commons.bare.main",["require","prototype","!domReady"],function(e){e("prototype"),e("!domReady")}),function(){function e(e,t,i){for(var n=(i||0)-1,o=e?e.length:0;++n<o;)if(e[n]===t)return n;return-1}function t(e,t){for(var i=e.criteria,n=t.criteria,o=-1,s=i.length;++o<s;){var r=i[o],a=n[o];if(r!==a){if(r>a||"undefined"==typeof r)return 1;if(a>r||"undefined"==typeof a)return-1}}return e.index-t.index}function i(e){return"\\"+Di[e]}function n(){return ci.pop()||[]}function o(e){e.length=0,ci.length<pi&&ci.push(e)}function s(e,t,i){t||(t=0),"undefined"==typeof i&&(i=e?e.length:0);for(var n=-1,o=i-t||0,s=Array(0>o?0:o);++n<o;)s[n]=e[t+n];return s}function r(e){return e instanceof r?e:new a(e)}function a(e,t){this.__chain__=!!t,this.__wrapped__=e}function l(e){function t(){if(n){var e=s(n);zi.apply(e,arguments)}if(this instanceof t){var r=d(i.prototype),a=i.apply(r,e||arguments);return B(a)?a:r}return i.apply(o,e||arguments)}var i=e[0],n=e[2],o=e[4];return t}function c(e,t,i,r,a){if(i){var l=i(e);if("undefined"!=typeof l)return l}var d=B(e);if(!d)return e;var u=Hi.call(e);if(!Mi[u])return e;var h=Zi[u];switch(u){case yi:case Ti:return new h(+e);case Ai:case xi:return new h(e);case Ei:return l=h(e.source,mi.exec(e)),l.lastIndex=e.lastIndex,l}var p=tn(e);if(t){var m=!r;r||(r=n()),a||(a=n());for(var f=r.length;f--;)if(r[f]==e)return a[f];l=p?h(e.length):{}}else l=p?s(e):E({},e);return p&&(ji.call(e,"index")&&(l.index=e.index),ji.call(e,"input")&&(l.input=e.input)),t?(r.push(e),a.push(l),(p?tt:dn)(e,function(e,n){l[n]=c(e,t,i,r,a)}),m&&(o(r),o(a)),l):l}function d(e){return B(e)?Wi(e):{}}function u(e,t,i){if("function"!=typeof e)return Yt;if("undefined"==typeof t||!("prototype"in e))return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,o){return e.call(t,i,n,o)};case 4:return function(i,n,o,s){return e.call(t,i,n,o,s)}}return kt(e,t)}function h(e){function t(){var e=c?a:this;if(o){var g=s(o);zi.apply(g,arguments)}if((r||p)&&(g||(g=s(arguments)),r&&zi.apply(g,r),p&&g.length<l))return n|=16,h([i,m?n:-4&n,g,null,a,l]);if(g||(g=arguments),u&&(i=e[f]),this instanceof t){e=d(i.prototype);var v=i.apply(e,g);return B(v)?v:e}return i.apply(e,g)}var i=e[0],n=e[1],o=e[2],r=e[3],a=e[4],l=e[5],c=1&n,u=2&n,p=4&n,m=8&n,f=i;return t}function p(e,t){for(var i=-1,n=T(),o=e?e.length:0,s=[];++i<o;){var r=e[i];n(t,r)<0&&s.push(r)}return s}function m(e,t,i,n){for(var o=(n||0)-1,s=e?e.length:0,r=[];++o<s;){var a=e[o];if(a&&"object"==typeof a&&"number"==typeof a.length&&(tn(a)||C(a))){t||(a=m(a,t,i));var l=-1,c=a.length,d=r.length;for(r.length+=c;++l<c;)r[d++]=a[l]}else i||r.push(a)}return r}function f(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;var o=typeof e,s=typeof t;if(!(e!==e||e&&wi[o]||t&&wi[s]))return!1;if(null==e||null==t)return e===t;var a=Hi.call(e),l=Hi.call(t);if(a!=l)return!1;switch(a){case yi:case Ti:return+e==+t;case Ai:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case Ei:case xi:return e==String(t)}var c=a==bi;if(!c){var d=e instanceof r,u=t instanceof r;if(d||u)return f(d?e.__wrapped__:e,u?t.__wrapped__:t,i,n);if(a!=Ci)return!1;var h=e.constructor,p=t.constructor;if(h!=p&&!(H(h)&&h instanceof h&&H(p)&&p instanceof p)&&"constructor"in e&&"constructor"in t)return!1}i||(i=[]),n||(n=[]);for(var m=i.length;m--;)if(i[m]==e)return n[m]==t;var g=!0,v=0;if(i.push(e),n.push(t),c){if(v=t.length,g=v==e.length)for(;v--&&(g=f(e[v],t[v],i,n)););}else cn(t,function(t,o,s){return ji.call(s,o)?(v++,!(g=ji.call(e,o)&&f(e[o],t,i,n))&&ui):void 0}),g&&cn(e,function(e,t,i){return ji.call(i,t)?!(g=--v>-1)&&ui:void 0});return i.pop(),n.pop(),g}function g(e,t){return e+Ui(Ji()*(t-e+1))}function v(e,t,i){for(var n=-1,o=T(),s=e?e.length:0,r=[],a=i?[]:r;++n<s;){var l=e[n],c=i?i(l,n,e):l;(t?!n||a[a.length-1]!==c:o(a,c)<0)&&(i&&a.push(c),r.push(l))}return r}function _(e){return function(t,i,n){var o={};i=$t(i,n,3);var s=-1,r=t?t.length:0;if("number"==typeof r)for(;++s<r;){var a=t[s];e(o,a,i(a,s,t),t)}else dn(t,function(t,n,s){e(o,t,i(t,n,s),s)});return o}}function b(e,t,i,n,o,s){var r=2&t,a=16&t,c=32&t;if(!r&&!H(e))throw new TypeError;a&&!i.length&&(t&=-17,a=i=!1),c&&!n.length&&(t&=-33,c=n=!1);var d=1==t||17===t?l:h;return d([e,t,i,n,o,s])}function y(e){return sn[e]}function T(){var t=(t=r.indexOf)===Tt?e:t;return t}function S(e){return"function"==typeof e&&Bi.test(e)}function A(e){return rn[e]}function C(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Hi.call(e)==_i||!1}function E(e){if(!e)return e;for(var t=1,i=arguments.length;i>t;t++){var n=arguments[t];if(n)for(var o in n)e[o]=n[o]}return e}function x(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i=t,t=!1),c(e,t,"function"==typeof i&&u(i,n,1))}function M(e,t,i){return c(e,!0,"function"==typeof t&&u(t,i,1))}function w(e){if(!e)return e;for(var t=1,i=arguments.length;i>t;t++){var n=arguments[t];if(n)for(var o in n)"undefined"==typeof e[o]&&(e[o]=n[o])}return e}function D(e){var t=[];return cn(e,function(e,i){H(e)&&t.push(i)}),t.sort()}function I(e,t){return e?ji.call(e,t):!1}function O(e){for(var t=-1,i=on(e),n=i.length,o={};++t<n;){var s=i[t];o[e[s]]=s}return o}function L(e){return e===!0||e===!1||e&&"object"==typeof e&&Hi.call(e)==yi||!1}function N(e){return e&&"object"==typeof e&&Hi.call(e)==Ti||!1}function R(e){return e&&1===e.nodeType||!1}function k(e){if(!e)return!0;if(tn(e)||G(e))return!e.length;for(var t in e)if(ji.call(e,t))return!1;return!0}function P(e,t){return f(e,t)}function F(e){return qi(e)&&!Yi(parseFloat(e))}function H(e){return"function"==typeof e}function B(e){return!(!e||!wi[typeof e])}function V(e){return j(e)&&e!=+e}function U(e){return null===e}function j(e){return"number"==typeof e||e&&"object"==typeof e&&Hi.call(e)==Ai||!1}function z(e){return e&&wi[typeof e]&&Hi.call(e)==Ei||!1}function G(e){return"string"==typeof e||e&&"object"==typeof e&&Hi.call(e)==xi||!1}function W(e){return"undefined"==typeof e}function $(e){var t=[];cn(e,function(e,i){t.push(i)}),t=p(t,m(arguments,!0,!1,1));for(var i=-1,n=t.length,o={};++i<n;){var s=t[i];o[s]=e[s]}return o}function q(e){for(var t=-1,i=on(e),n=i.length,o=Array(n);++t<n;){var s=i[t];o[t]=[s,e[s]]}return o}function Y(e){for(var t=-1,i=m(arguments,!0,!1,1),n=i.length,o={};++t<n;){var s=i[t];s in e&&(o[s]=e[s])}return o}function X(e){for(var t=-1,i=on(e),n=i.length,o=Array(n);++t<n;)o[t]=e[i[t]];return o}function K(e,t){var i=T(),n=e?e.length:0,o=!1;return n&&"number"==typeof n?o=i(e,t)>-1:dn(e,function(e){return(o=e===t)&&ui}),o}function Q(e,t,i){var n=!0;t=$t(t,i,3);var o=-1,s=e?e.length:0;if("number"==typeof s)for(;++o<s&&(n=!!t(e[o],o,e)););else dn(e,function(e,i,o){return!(n=!!t(e,i,o))&&ui});return n}function J(e,t,i){var n=[];t=$t(t,i,3);var o=-1,s=e?e.length:0;if("number"==typeof s)for(;++o<s;){var r=e[o];t(r,o,e)&&n.push(r)}else dn(e,function(e,i,o){t(e,i,o)&&n.push(e)});return n}function Z(e,t,i){t=$t(t,i,3);var n=-1,o=e?e.length:0;if("number"!=typeof o){var s;return dn(e,function(e,i,n){return t(e,i,n)?(s=e,ui):void 0}),s}for(;++n<o;){var r=e[n];if(t(r,n,e))return r}}function et(e,t){return gt(e,t,!0)}function tt(e,t,i){var n=-1,o=e?e.length:0;if(t=t&&"undefined"==typeof i?t:u(t,i,3),"number"==typeof o)for(;++n<o&&t(e[n],n,e)!==ui;);else dn(e,t)}function it(e,t){var i=e?e.length:0;if("number"==typeof i)for(;i--&&t(e[i],i,e)!==!1;);else{var n=on(e);i=n.length,dn(e,function(e,o,s){return o=n?n[--i]:--i,t(s[o],o,s)===!1&&ui})}}function nt(e,t){var i=s(arguments,2),n=-1,o="function"==typeof t,r=e?e.length:0,a=Array("number"==typeof r?r:0);return tt(e,function(e){a[++n]=(o?t:e[t]).apply(e,i)}),a}function ot(e,t,i){var n=-1,o=e?e.length:0;if(t=$t(t,i,3),"number"==typeof o)for(var s=Array(o);++n<o;)s[n]=t(e[n],n,e);else s=[],dn(e,function(e,i,o){s[++n]=t(e,i,o)});return s}function st(e,t,i){var n=-1/0,o=n;"function"!=typeof t&&i&&i[t]===e&&(t=null);var s=-1,r=e?e.length:0;if(null==t&&"number"==typeof r)for(;++s<r;){var a=e[s];a>o&&(o=a)}else t=$t(t,i,3),tt(e,function(e,i,s){var r=t(e,i,s);r>n&&(n=r,o=e)});return o}function rt(e,t,i){var n=1/0,o=n;"function"!=typeof t&&i&&i[t]===e&&(t=null);var s=-1,r=e?e.length:0;if(null==t&&"number"==typeof r)for(;++s<r;){var a=e[s];o>a&&(o=a)}else t=$t(t,i,3),tt(e,function(e,i,s){var r=t(e,i,s);n>r&&(n=r,o=e)});return o}function at(e,t,i,n){if(!e)return i;var o=arguments.length<3;t=$t(t,n,4);var s=-1,r=e.length;if("number"==typeof r)for(o&&(i=e[++s]);++s<r;)i=t(i,e[s],s,e);else dn(e,function(e,n,s){i=o?(o=!1,e):t(i,e,n,s)});return i}function lt(e,t,i,n){var o=arguments.length<3;return t=$t(t,n,4),it(e,function(e,n,s){i=o?(o=!1,e):t(i,e,n,s)}),i}function ct(e,t,i){return t=$t(t,i,3),J(e,function(e,i,n){return!t(e,i,n)})}function dt(e,t,i){if(e&&"number"!=typeof e.length&&(e=X(e)),null==t||i)return e?e[g(0,e.length-1)]:li;var n=ut(e);return n.length=Qi(Ki(0,t),n.length),n}function ut(e){var t=-1,i=e?e.length:0,n=Array("number"==typeof i?i:0);return tt(e,function(e){var i=g(0,++t);n[t]=n[i],n[i]=e}),n}function ht(e){var t=e?e.length:0;return"number"==typeof t?t:on(e).length}function pt(e,t,i){var n;t=$t(t,i,3);var o=-1,s=e?e.length:0;if("number"==typeof s)for(;++o<s&&!(n=t(e[o],o,e)););else dn(e,function(e,i,o){return(n=t(e,i,o))&&ui});return!!n}function mt(e,i,n){var o=-1,s=e?e.length:0,r=Array("number"==typeof s?s:0);for(i=$t(i,n,3),tt(e,function(e,t,n){r[++o]={criteria:[i(e,t,n)],index:o,value:e}}),s=r.length,r.sort(t);s--;)r[s]=r[s].value;return r}function ft(e){return tn(e)?s(e):e&&"number"==typeof e.length?ot(e):X(e)}function gt(e,t,i){return i&&k(t)?li:(i?Z:J)(e,t)}function vt(e){for(var t=-1,i=e?e.length:0,n=[];++t<i;){var o=e[t];o&&n.push(o)}return n}function _t(e){return p(e,m(arguments,!0,!0,1))}function bt(e,t,i){var n=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var r=-1;for(t=$t(t,i,3);++r<o&&t(e[r],r,e);)n++}else if(n=t,null==n||i)return e?e[0]:li;return s(e,0,Qi(Ki(0,n),o))}function yt(e,t){return m(e,t)}function Tt(t,i,n){if("number"==typeof n){var o=t?t.length:0;n=0>n?Ki(0,o+n):n||0}else if(n){var s=wt(t,i);return t[s]===i?s:-1}return e(t,i,n)}function St(e,t,i){var n=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var r=o;for(t=$t(t,i,3);r--&&t(e[r],r,e);)n++}else n=null==t||i?1:t||n;return s(e,0,Qi(Ki(0,o-n),o))}function At(){for(var e=[],t=-1,i=arguments.length;++t<i;){var n=arguments[t];(tn(n)||C(n))&&e.push(n)}var o=e[0],s=-1,r=T(),a=o?o.length:0,l=[];e:for(;++s<a;)if(n=o[s],r(l,n)<0){for(var t=i;--t;)if(r(e[t],n)<0)continue e;l.push(n)}return l}function Ct(e,t,i){var n=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var r=o;for(t=$t(t,i,3);r--&&t(e[r],r,e);)n++}else if(n=t,null==n||i)return e?e[o-1]:li;return s(e,Ki(0,o-n))}function Et(e,t,i){var n=e?e.length:0;for("number"==typeof i&&(n=(0>i?Ki(0,n+i):Qi(i,n-1))+1);n--;)if(e[n]===t)return n;return-1}function xt(e,t,i){e=+e||0,i=+i||1,null==t&&(t=e,e=0);for(var n=-1,o=Ki(0,Vi((t-e)/i)),s=Array(o);++n<o;)s[n]=e,e+=i;return s}function Mt(e,t,i){if("number"!=typeof t&&null!=t){var n=0,o=-1,r=e?e.length:0;for(t=$t(t,i,3);++o<r&&t(e[o],o,e);)n++}else n=null==t||i?1:Ki(0,t);return s(e,n)}function wt(e,t,i,n){var o=0,s=e?e.length:o;for(i=i?$t(i,n,1):Yt,t=i(t);s>o;){var r=o+s>>>1;i(e[r])<t?o=r+1:s=r}return o}function Dt(){return v(m(arguments,!0,!0))}function It(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i="function"!=typeof t&&n&&n[t]===e?null:t,t=!1),null!=i&&(i=$t(i,n,3)),v(e,t,i)}function Ot(e){return p(e,s(arguments,1))}function Lt(){for(var e=-1,t=st(mn(arguments,"length")),i=Array(0>t?0:t);++e<t;)i[e]=mn(arguments,e);return i}function Nt(e,t){var i=-1,n=e?e.length:0,o={};for(t||!n||tn(e[0])||(t=[]);++i<n;){var s=e[i];t?o[s]=t[i]:s&&(o[s[0]]=s[1])}return o}function Rt(e,t){if(!H(t))throw new TypeError;return function(){return--e<1?t.apply(this,arguments):void 0}}function kt(e,t){return arguments.length>2?b(e,17,s(arguments,2),null,t):b(e,1,null,null,t)}function Pt(e){for(var t=arguments.length>1?m(arguments,!0,!1,1):D(e),i=-1,n=t.length;++i<n;){var o=t[i];e[o]=b(e[o],1,null,null,e)}return e}function Ft(){for(var e=arguments,t=e.length;t--;)if(!H(e[t]))throw new TypeError;return function(){for(var t=arguments,i=e.length;i--;)t=[e[i].apply(this,t)];return t[0]}}function Ht(e,t,i){var n,o,s,r,a,l,c,d=0,u=!1,h=!0;if(!H(e))throw new TypeError;if(t=Ki(0,t)||0,i===!0){var p=!0;h=!1}else B(i)&&(p=i.leading,u="maxWait"in i&&(Ki(t,i.maxWait)||0),h="trailing"in i?i.trailing:h);var m=function(){var i=t-(fn()-r);if(0>=i){o&&clearTimeout(o);var u=c;o=l=c=li,u&&(d=fn(),s=e.apply(a,n),l||o||(n=a=null))}else l=setTimeout(m,i)},f=function(){l&&clearTimeout(l),o=l=c=li,(h||u!==t)&&(d=fn(),s=e.apply(a,n),l||o||(n=a=null))};return function(){if(n=arguments,r=fn(),a=this,c=h&&(l||!p),u===!1)var i=p&&!l;else{o||p||(d=r);var g=u-(r-d),v=0>=g;v?(o&&(o=clearTimeout(o)),d=r,s=e.apply(a,n)):o||(o=setTimeout(f,g))}return v&&l?l=clearTimeout(l):l||t===u||(l=setTimeout(m,t)),i&&(v=!0,s=e.apply(a,n)),!v||l||o||(n=a=null),s}}function Bt(e){if(!H(e))throw new TypeError;var t=s(arguments,1);return setTimeout(function(){e.apply(li,t)},1)}function Vt(e,t){if(!H(e))throw new TypeError;var i=s(arguments,2);return setTimeout(function(){e.apply(li,i)},t)}function Ut(e,t){var i={};return function(){var n=t?t.apply(this,arguments):hi+arguments[0];return ji.call(i,n)?i[n]:i[n]=e.apply(this,arguments)}}function jt(e){var t,i;if(!H(e))throw new TypeError;return function(){return t?i:(t=!0,i=e.apply(this,arguments),e=null,i)}}function zt(e){return b(e,16,s(arguments,1))}function Gt(e,t,i){var n=!0,o=!0;if(!H(e))throw new TypeError;return i===!1?n=!1:B(i)&&(n="leading"in i?i.leading:n,o="trailing"in i?i.trailing:o),i={},i.leading=n,i.maxWait=t,i.trailing=o,Ht(e,t,i)}function Wt(e,t){return b(t,16,[e])}function $t(e,t,i){var n=typeof e;if(null==e||"function"==n)return u(e,t,i);if("object"!=n)return Qt(e);var o=on(e);return function(t){for(var i=o.length,n=!1;i--&&(n=t[o[i]]===e[o[i]]););return n}}function qt(e){return null==e?"":String(e).replace(ln,y)}function Yt(e){return e}function Xt(e){tt(D(e),function(t){var i=r[t]=e[t];r.prototype[t]=function(){var e=[this.__wrapped__];zi.apply(e,arguments);var t=i.apply(r,e);return this.__chain__?new a(t,!0):t}})}function Kt(){return Ii._=Fi,this}function Qt(e){return function(t){return t[e]}}function Jt(e,t){return null==e&&null==t&&(t=1),e=+e||0,null==t?(t=e,e=0):t=+t||0,e+Ui(Ji()*(t-e+1))}function Zt(e,t){if(e){var i=e[t];return H(i)?e[t]():i}}function ei(e,t,n){var o=r,s=o.templateSettings;e=String(e||""),n=w({},n,s);var a=0,l="__p += '",c=n.variable,d=RegExp((n.escape||gi).source+"|"+(n.interpolate||gi).source+"|"+(n.evaluate||gi).source+"|$","g");e.replace(d,function(t,n,o,s,r){return l+=e.slice(a,r).replace(vi,i),n&&(l+="' +\n_.escape("+n+") +\n'"),s&&(l+="';\n"+s+";\n__p += '"),o&&(l+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),a=r+t.length,t}),l+="';\n",c||(c="obj",l="with ("+c+" || {}) {\n"+l+"\n}\n"),l="function("+c+") {\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n"+l+"return __p\n}";try{var u=Function("_","return "+l)(o)}catch(h){throw h.source=l,h}return t?u(t):(u.source=l,u)}function ti(e,t,i){e=(e=+e)>-1?e:0;var n=-1,o=Array(e);for(t=u(t,i,1);++n<e;)o[n]=t(n);return o}function ii(e){return null==e?"":String(e).replace(an,A)}function ni(e){var t=++di+"";return e?e+t:t}function oi(e){return e=new a(e),e.__chain__=!0,e}function si(e,t){return t(e),e}function ri(){return this.__chain__=!0,this}function ai(){return this.__wrapped__}var li,ci=[],di=0,ui={},hi=+new Date+"",pi=40,mi=/\w*$/,fi=/<%=([\s\S]+?)%>/g,gi=/($^)/,vi=/['\n\r\t\u2028\u2029\\]/g,_i="[object Arguments]",bi="[object Array]",yi="[object Boolean]",Ti="[object Date]",Si="[object Function]",Ai="[object Number]",Ci="[object Object]",Ei="[object RegExp]",xi="[object String]",Mi={};Mi[Si]=!1,Mi[_i]=Mi[bi]=Mi[yi]=Mi[Ti]=Mi[Ai]=Mi[Ci]=Mi[Ei]=Mi[xi]=!0;var wi={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Di={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},Ii=wi[typeof window]&&window||this,Oi=wi[typeof exports]&&exports&&!exports.nodeType&&exports,Li=wi[typeof module]&&module&&!module.nodeType&&module,Ni=Li&&Li.exports===Oi&&Oi,Ri=wi[typeof global]&&global;!Ri||Ri.global!==Ri&&Ri.window!==Ri||(Ii=Ri);var ki=[],Pi=Object.prototype,Fi=Ii._,Hi=Pi.toString,Bi=RegExp("^"+String(Hi).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Vi=Math.ceil,Ui=Math.floor,ji=Pi.hasOwnProperty,zi=ki.push,Gi=Pi.propertyIsEnumerable,Wi=S(Wi=Object.create)&&Wi,$i=S($i=Array.isArray)&&$i,qi=Ii.isFinite,Yi=Ii.isNaN,Xi=S(Xi=Object.keys)&&Xi,Ki=Math.max,Qi=Math.min,Ji=Math.random,Zi={};Zi[bi]=Array,Zi[yi]=Boolean,Zi[Ti]=Date,Zi[Si]=Function,Zi[Ci]=Object,Zi[Ai]=Number,Zi[Ei]=RegExp,Zi[xi]=String,a.prototype=r.prototype;var en={};!function(){var e={0:1,length:1};en.spliceObjects=(ki.splice.call(e,0,1),!e[0])}(1),r.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:fi,variable:""},Wi||(d=function(){function e(){}return function(t){if(B(t)){e.prototype=t;var i=new e;e.prototype=null}return i||Ii.Object()}}()),C(arguments)||(C=function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&ji.call(e,"callee")&&!Gi.call(e,"callee")||!1});var tn=$i||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Hi.call(e)==bi||!1},nn=function(e){var t,i=e,n=[];if(!i)return n;if(!wi[typeof e])return n;for(t in i)ji.call(i,t)&&n.push(t);return n},on=Xi?function(e){return B(e)?Xi(e):[]}:nn,sn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},rn=O(sn),an=RegExp("("+on(rn).join("|")+")","g"),ln=RegExp("["+on(sn).join("")+"]","g"),cn=function(e,t){var i,n=e,o=n;if(!n)return o;if(!wi[typeof n])return o;for(i in n)if(t(n[i],i,e)===ui)return o;return o},dn=function(e,t){var i,n=e,o=n;if(!n)return o;if(!wi[typeof n])return o;for(i in n)if(ji.call(n,i)&&t(n[i],i,e)===ui)return o;return o};H(/x/)&&(H=function(e){return"function"==typeof e&&Hi.call(e)==Si});var un=_(function(e,t,i){ji.call(e,i)?e[i]++:e[i]=1}),hn=_(function(e,t,i){(ji.call(e,i)?e[i]:e[i]=[]).push(t)}),pn=_(function(e,t,i){e[i]=t}),mn=ot,fn=S(fn=Date.now)&&fn||function(){return(new Date).getTime()};r.after=Rt,r.bind=kt,r.bindAll=Pt,r.chain=oi,r.compact=vt,r.compose=Ft,r.countBy=un,r.debounce=Ht,r.defaults=w,r.defer=Bt,r.delay=Vt,r.difference=_t,r.filter=J,r.flatten=yt,r.forEach=tt,r.functions=D,r.groupBy=hn,r.indexBy=pn,r.initial=St,r.intersection=At,r.invert=O,r.invoke=nt,r.keys=on,r.map=ot,r.max=st,r.memoize=Ut,r.min=rt,r.omit=$,r.once=jt,r.pairs=q,r.partial=zt,r.pick=Y,r.pluck=mn,r.range=xt,r.reject=ct,r.rest=Mt,r.shuffle=ut,r.sortBy=mt,r.tap=si,r.throttle=Gt,r.times=ti,r.toArray=ft,r.union=Dt,r.uniq=It,r.values=X,r.where=gt,r.without=Ot,r.wrap=Wt,r.zip=Lt,r.collect=ot,r.drop=Mt,r.each=tt,r.extend=E,r.methods=D,r.object=Nt,r.select=J,r.tail=Mt,r.unique=It,r.clone=x,r.cloneDeep=M,r.contains=K,r.escape=qt,r.every=Q,r.find=Z,r.has=I,r.identity=Yt,r.indexOf=Tt,r.isArguments=C,r.isArray=tn,r.isBoolean=L,r.isDate=N,r.isElement=R,r.isEmpty=k,r.isEqual=P,r.isFinite=F,r.isFunction=H,r.isNaN=V,r.isNull=U,r.isNumber=j,r.isObject=B,r.isRegExp=z,r.isString=G,r.isUndefined=W,r.lastIndexOf=Et,r.mixin=Xt,r.noConflict=Kt,r.random=Jt,r.reduce=at,r.reduceRight=lt,r.result=Zt,r.size=ht,r.some=pt,r.sortedIndex=wt,r.template=ei,r.unescape=ii,r.uniqueId=ni,r.all=Q,r.any=pt,r.detect=Z,r.findWhere=et,r.foldl=at,r.foldr=lt,r.include=K,r.inject=at,r.first=bt,r.last=Ct,r.sample=dt,r.take=bt,r.head=bt,Xt(r),r.VERSION="2.4.1",r.prototype.chain=ri,r.prototype.value=ai,tt(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=ki[e];r.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),en.spliceObjects||0!==e.length||delete e[0],this}}),tt(["concat","join","slice"],function(e){var t=ki[e];r.prototype[e]=function(){var e=this.__wrapped__,i=t.apply(e,arguments);return this.__chain__&&(i=new a(i),i.__chain__=!0),i}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ii._=r,define("lodash.custom",[],function(){return r})):Oi&&Li?Ni?(Li.exports=r)._=r:Oi._=r:Ii._=r}.call(this),!function(e,t){var i=t.prototype.trim,n=t.prototype.trimRight,o=t.prototype.trimLeft,s=function(e){return 1*e||0},r=function(e,t){if(1>t)return"";for(var i="";t>0;)1&t&&(i+=e),t>>=1,e+=e;return i},a=[].slice,l=function(e){return null==e?"\\s":e.source?e.source:"["+p.escapeRegExp(e)+"]"},c={lt:"<",gt:">",quot:'"',apos:"'",amp:"&"},d={};for(var u in c)d[c[u]]=u;var h=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var i=r,n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,o){var s,r,a,l,c,d,u,p=1,m=n.length,f="",g=[];for(r=0;m>r;r++)if(f=e(n[r]),"string"===f)g.push(n[r]);else if("array"===f){if(l=n[r],l[2])for(s=o[p],a=0;a<l[2].length;a++){if(!s.hasOwnProperty(l[2][a]))throw new Error(h('[_.sprintf] property "%s" does not exist',l[2][a]));s=s[l[2][a]]}else s=l[1]?o[l[1]]:o[p++];if(/[^s]/.test(l[8])&&"number"!=e(s))throw new Error(h("[_.sprintf] expecting number but found %s",e(s)));switch(l[8]){case"b":s=s.toString(2);break;case"c":s=t.fromCharCode(s);break;case"d":s=parseInt(s,10);break;case"e":s=l[7]?s.toExponential(l[7]):s.toExponential();break;case"f":s=l[7]?parseFloat(s).toFixed(l[7]):parseFloat(s);break;case"o":s=s.toString(8);break;case"s":s=(s=t(s))&&l[7]?s.substring(0,l[7]):s;break;case"u":s=Math.abs(s);break;case"x":s=s.toString(16);break;case"X":s=s.toString(16).toUpperCase()}s=/[def]/.test(l[8])&&l[3]&&s>=0?"+"+s:s,d=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",u=l[6]-t(s).length,c=l[6]?i(d,u):"",g.push(l[5]?s+c:c+s)}return g.join("")},n.cache={},n.parse=function(e){for(var t=e,i=[],n=[],o=0;t;){if(null!==(i=/^[^\x25]+/.exec(t)))n.push(i[0]);else if(null!==(i=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(i=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw new Error("[_.sprintf] huh?");if(i[2]){o|=1;var s=[],r=i[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(r)))throw new Error("[_.sprintf] huh?");for(s.push(a[1]);""!==(r=r.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(r)))s.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(r)))throw new Error("[_.sprintf] huh?");s.push(a[1])}i[2]=s}else o|=2;if(3===o)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");n.push(i)}t=t.substring(i[0].length)}return n},n}(),p={VERSION:"2.3.0",isBlank:function(e){return null==e&&(e=""),/^\s*$/.test(e)},stripTags:function(e){return null==e?"":t(e).replace(/<\/?[^>]+>/g,"")},capitalize:function(e){return e=null==e?"":t(e),e.charAt(0).toUpperCase()+e.slice(1)},chop:function(e,i){return null==e?[]:(e=t(e),i=~~i,i>0?e.match(new RegExp(".{1,"+i+"}","g")):[e])},clean:function(e){return p.strip(e).replace(/\s+/g," ")},count:function(e,i){return null==e||null==i?0:t(e).split(i).length-1},chars:function(e){return null==e?[]:t(e).split("")},swapCase:function(e){return null==e?"":t(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})},escapeHTML:function(e){return null==e?"":t(e).replace(/[&<>"']/g,function(e){return"&"+d[e]+";"})},unescapeHTML:function(e){return null==e?"":t(e).replace(/\&([^;]+);/g,function(e,i){var n;return i in c?c[i]:(n=i.match(/^#x([\da-fA-F]+)$/))?t.fromCharCode(parseInt(n[1],16)):(n=i.match(/^#(\d+)$/))?t.fromCharCode(~~n[1]):e})},escapeRegExp:function(e){return null==e?"":t(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(e,t,i,n){var o=p.chars(e);return o.splice(~~t,~~i,n),o.join("")},insert:function(e,t,i){return p.splice(e,t,0,i)},include:function(e,i){return""===i?!0:null==e?!1:-1!==t(e).indexOf(i)},join:function(){var e=a.call(arguments),t=e.shift();return null==t&&(t=""),e.join(t)},lines:function(e){return null==e?[]:t(e).split("\n")},reverse:function(e){return p.chars(e).reverse().join("")},startsWith:function(e,i){return""===i?!0:null==e||null==i?!1:(e=t(e),i=t(i),e.length>=i.length&&e.slice(0,i.length)===i)},endsWith:function(e,i){return""===i?!0:null==e||null==i?!1:(e=t(e),i=t(i),e.length>=i.length&&e.slice(e.length-i.length)===i)},succ:function(e){return null==e?"":(e=t(e),e.slice(0,-1)+t.fromCharCode(e.charCodeAt(e.length-1)+1))},titleize:function(e){return null==e?"":t(e).replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})},camelize:function(e){return p.trim(e).replace(/[-_\s]+(.)?/g,function(e,t){return t.toUpperCase()})},underscored:function(e){return p.trim(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(e){return p.trim(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(e){return p.titleize(t(e).replace(/_/g," ")).replace(/\s/g,"")},humanize:function(e){return p.capitalize(p.underscored(e).replace(/_id$/,"").replace(/_/g," "))},trim:function(e,n){return null==e?"":!n&&i?i.call(e):(n=l(n),t(e).replace(new RegExp("^"+n+"+|"+n+"+$","g"),""))},ltrim:function(e,i){return null==e?"":!i&&o?o.call(e):(i=l(i),t(e).replace(new RegExp("^"+i+"+"),""))},rtrim:function(e,i){return null==e?"":!i&&n?n.call(e):(i=l(i),t(e).replace(new RegExp(i+"+$"),""))},truncate:function(e,i,n){return null==e?"":(e=t(e),n=n||"...",i=~~i,e.length>i?e.slice(0,i)+n:e)},prune:function(e,i,n){if(null==e)return"";if(e=t(e),i=~~i,n=null!=n?t(n):"...",e.length<=i)return e;var o=function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "},s=e.slice(0,i+1).replace(/.(?=\W*\w*$)/g,o);return s=s.slice(s.length-2).match(/\w\w/)?s.replace(/\s*\S+$/,""):p.rtrim(s.slice(0,s.length-1)),(s+n).length>e.length?e:e.slice(0,s.length)+n},words:function(e,t){return p.isBlank(e)?[]:p.trim(e,t).split(t||/\s+/)},pad:function(e,i,n,o){e=null==e?"":t(e),i=~~i;var s=0;switch(n?n.length>1&&(n=n.charAt(0)):n=" ",o){case"right":return s=i-e.length,e+r(n,s);case"both":return s=i-e.length,r(n,Math.ceil(s/2))+e+r(n,Math.floor(s/2));default:return s=i-e.length,r(n,s)+e}},lpad:function(e,t,i){return p.pad(e,t,i)},rpad:function(e,t,i){return p.pad(e,t,i,"right")},lrpad:function(e,t,i){return p.pad(e,t,i,"both")},sprintf:h,vsprintf:function(e,t){return t.unshift(e),h.apply(null,t)},toNumber:function(e,i){if(null==e||""==e)return 0;e=t(e);var n=s(s(e).toFixed(~~i));return 0!==n||e.match(/^0+$/)?n:Number.NaN},numberFormat:function(e,t,i,n){if(isNaN(e)||null==e)return"";e=e.toFixed(~~t),n=n||",";var o=e.split("."),s=o[0],r=o[1]?(i||".")+o[1]:"";return s.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+n)+r},strRight:function(e,i){if(null==e)return"";e=t(e),i=null!=i?t(i):i;var n=i?e.indexOf(i):-1;return~n?e.slice(n+i.length,e.length):e},strRightBack:function(e,i){if(null==e)return"";e=t(e),i=null!=i?t(i):i;var n=i?e.lastIndexOf(i):-1;return~n?e.slice(n+i.length,e.length):e},strLeft:function(e,i){if(null==e)return"";e=t(e),i=null!=i?t(i):i;var n=i?e.indexOf(i):-1;return~n?e.slice(0,n):e},strLeftBack:function(e,t){if(null==e)return"";e+="",t=null!=t?""+t:t;var i=e.lastIndexOf(t);return~i?e.slice(0,i):e},toSentence:function(e,t,i,n){t=t||", ",i=i||" and ";var o=e.slice(),s=o.pop();return e.length>2&&n&&(i=p.rtrim(t)+i),o.length?o.join(t)+i+s:s},toSentenceSerial:function(){var e=a.call(arguments);return e[3]=!0,p.toSentence.apply(p,e)},slugify:function(e){if(null==e)return"";var i="ąàáäâãåæćęèéëêìíïîłńòóöôõøùúüûñçżź",n="aaaaaaaaceeeeeiiiilnoooooouuuunczz",o=new RegExp(l(i),"g");return e=t(e).toLowerCase().replace(o,function(e){var t=i.indexOf(e);return n.charAt(t)||"-"}),p.dasherize(e.replace(/[^\w\s-]/g,""))},surround:function(e,t){return[t,e,t].join("")},quote:function(e){return p.surround(e,'"')},exports:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&!t.match(/^(?:include|contains|reverse)$/)&&(e[t]=this[t]);return e},repeat:function(e,i,n){if(null==e)return"";if(i=~~i,null==n)return r(t(e),i);for(var o=[];i>0;o[--i]=e);return o.join(n)},levenshtein:function(e,i){if(null==e&&null==i)return 0;if(null==e)return t(i).length;if(null==i)return t(e).length;e=t(e),i=t(i);for(var n,o,s=[],r=0;r<=i.length;r++)for(var a=0;a<=e.length;a++)o=r&&a?e.charAt(a-1)===i.charAt(r-1)?n:Math.min(s[a],s[a-1],n)+1:r+a,n=s[a],s[a]=o;return s.pop()}};p.strip=p.trim,p.lstrip=p.ltrim,p.rstrip=p.rtrim,p.center=p.lrpad,p.rjust=p.lpad,p.ljust=p.rpad,p.contains=p.include,p.q=p.quote,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=p),exports._s=p):"function"==typeof define&&define.amd?define("underscore.string",[],function(){return p}):(e._=e._||{},e._.string=e._.str=p)}(this,String),define("underscore",["require","lodash.custom","underscore.string"],function(e){var t=e("lodash.custom");return t.str=e("underscore.string"),t.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},t.mixin(t.str.exports()),t});var log="";Function.prototype.addMethod=function(e,t){return this.prototype[e]=t,this},Function.prototype.addVar=function(e,t){return this.prototype[e]=t,this},Function.prototype.compose=function(e){var t=this;return function(){return t.call(this,e.apply(this,arguments))}};var overlayObjectStack=new Array;"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.strip()});var timer={},inspect=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+" = "+e[i]);return t.join("\n")},getAsFunction=function(e){return toFunction(e)||toFunction("localContext."+e)};BusyMonitor.prototype.run=function(){var e=arguments;null!=this.timer&&clearTimeout(this.timer);var t=function(){this.theFunction.apply(null,e)};this.timer=setTimeout(t.bind(this),this.waitTime)},BusyMonitor.prototype.cancel=function(){this.timer&&clearTimeout(this.timer)},InPlaceEditor.prototype.makeEditable=function(e){var t=this,i=this.elem.id+"Input",n=this.value.strip(),o=Builder.node("input",{className:"control input text",id:i,value:n});this.elem.update(o),this.editing=!0;var s=jQuery("#"+i);if(isIE()){var r=!1;s.hover(function(){!r&&n&&n===this.value&&(this.select(),this.focus(),r=!0)},function(){})}if(s.focus(),s.select(),e){if(e.blur&&($(i).onblur=function(i){i=i?i:window.event;var n=e.blur,o=getAsFunction(n);o.call(t,i)}),(e.onEnter||e.onTab)&&($(i).onkeypress=function(i){var n=null,o=null;i=i?i:window.event,enterKeyHit(i)?(n=e.onEnter,o=getAsFunction(n),o.call(t,i)):i.keyCode==Event.KEY_TAB&&(n=e.onTab,o=getAsFunction(n),o.call(t,i))}),e.onMouseup){var a=function(n){if(n=n?n:window.event,$(Event.element(n))!=$(i)){var o=e.onMouseup,s=getAsFunction(o);s.call(t,n)}};isIPad()?document.body.ontouchend=a:document.body.onmousedown=a
}e.onEsc&&(document.body.onkeydown=function(i){if(i=i?i:window.event,i.keyCode==Event.KEY_ESC){var n=e.onEsc,o=getAsFunction(n);o.call(t,i)}})}},InPlaceEditor.prototype.makeNonEditable=function(e){if(this.elem&&this.elem.firstDescendant()&&this.editing){var t=this.elem.firstDescendant().value;t=t.replace(/"/g,"'"),e&&(t=t.replace(/<\/?[^>]+(>|$)/g,""),t=t.replace("<>","")),this.elem.update(t),this.editing=!1}},InPlaceEditor.prototype.revertEdit=function(){this.elem.update(this.value),this.editing=!1};var cancelEventDragTarget=null;String.prototype.times=function(e){return 1>e?"":new Array(e+1).join(this)};var tracer={nativeCodeEx:/\[native code\]/,indentCount:-4,tracing:[],traceMe:function(e,t){var i=function(){var i=+new Date,n=" ".times(tracer.indentCount+=4);console.info(n+t+"("+Array.prototype.slice.call(arguments).join(", ")+")");var o=e.apply(this,arguments);return console.info(n+t,"-> ",o,"(",new Date-i,"ms",")"),tracer.indentCount-=4,o};i.traceOff=e;for(var n in e)i[n]=e[n];return console.log("tracing "+t),i},traceAll:function(e,t){if(e!=window&&("object"==typeof e||"function"==typeof e))for(var i in e)if(e.hasOwnProperty(i)&&e[i]!=e){var n=e[i];"function"==typeof n&&(this==e||n.traceOff||this.nativeCodeEx.test(n)||(e[i]=this.traceMe(e[i],i),this.tracing.push({obj:e,methodName:i}))),t&&this.traceAll(n,!0)}},untraceAll:function(){for(var e=0;e<this.tracing.length;++e){var t=this.tracing[e];t.obj[t.methodName]=t.obj[t.methodName].traceOff}console.log("tracing disabled"),tracer.tracing=[]}},ValidationModule={validate:function(e,t){var i=this;if(!isArray(e))return this.validateEntry(e,t);var n=!0;return _.each(e,function(e){n=i.validateEntry(e,t)&&n}),n},validateEntry:function(e,t){if(e.validator)return this.validateLegacy(e,t);if(!e.selector){var i=this._validateElement(e.element,e,t);return null==i}for(var n=jQuery(e.element).find(e.selector),o=!0,s=0;s<n.length;s++){var i=this._validateElement(n[s],e,t);o=o&&null==i}return o},_validateElement:function(e,t,i){var n;if(t.method)n=this._runValidatorOnElement(t.method,e,t.messages,t.options);else for(var o=t.validators,s=0;s<o.length;s++){var r=o[s];if(n=this._runValidatorOnElement(r.method,e,r.messages,r.options),null!=n)break}return i!==!1&&(n?this.showError(e,n):this.hideError(e)),n},_runValidatorOnElement:function(e,t,i,n){_.isString(e)&&(e=this.methods[e]);var o=e.call(this,t.value,i,n);return _.isObject(o)?o.isValid?null:o.errorMessage:o},attachOnEvent:function(e,t){_.isArray(t)||(t=[t]),_.each(t,function(t){jQuery(t.element).on(e,function(){ValidationModule.validateEntry(t)})})},_getMessage:function(e,t,i,n){(_.isArray(i)||void 0===i)&&(n=i,i=this.defaultMessages);var o=null;return t&&(o=t[e]),!o&&i&&(o=i[e]),o&&n&&(o=this.fillPlaceholders(o,n)),o||e},fillPlaceholders:function(e,t){for(var i=0;i<t.length;i++)e=e.replace("{"+i+"}",t[i]);return e},defaultMessages:{mandatory:"Field is mandatory",tooSmall:"Value is too small, at least {0} required",tooBig:"Value is too big, at most {0} allowed",tooShort:"Value is too short, at least {0} characters required",tooLong:"Value is too long, at most {0} characters allowed",wordInvalidChars:"Value should contain only word characters (letters, digits and underscore)",shouldStartWithLetter:"Value should start with letter"},methods:{mandatory:function(e,t){return jQuery.trim(e)?null:this._getMessage("mandatory",t)},minMax:function(e,t,i){var n=jQuery.trim(e);if(!n)return null;var n=parseFloat(n);return isNaN(n)?this._getMessage("notANumber",t):void 0!==i.min&&n<i.min?this._getMessage("tooSmall",t,[i.min]):void 0!==i.max&&n>i.max?this._getMessage("tooBig",t,[i.max]):void 0},minMaxLength:function(e,t,i){return i.minLength&&e.length<i.minLength?this._getMessage("tooShort",t,[i.minLength]):i.maxLength&&e.length>i.maxLength?this._getMessage("tooLong",t,[i.maxLength]):void 0},resourceIdChars:function(e,t){if(!localContext||!localContext.initOptions||!localContext.initOptions.resourceIdNotSupportedSymbols)throw"There is no resourceIdNotSupportedSymbols property in init options.";return new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g").test(e)?this._getMessage("resourceIdInvalidChars",t):void 0},wordChars:function(e,t){return e.search(/\W/)>=0?this._getMessage("wordInvalidChars",t):void 0},startsWithLetter:function(e,t){return e.substr(0,1).match(/[A-Za-z]/)?void 0:this._getMessage("shouldStartWithLetter",t)},isDecimal:function(e){return _.isNumber(e)||_.isString(e)&&!isNaN(Number(e))?null:"defaultErrorMessage"},isInteger:function(e){return _.isNumber(e)||_.isString(e)&&/^[-+]?\d+$/.test(e)?null:"defaultErrorMessage"}},validateLegacy:function(e,t){var i=!0,n=[];return e=isArray(e)?e:[e],t=t!==!1,e.each(function(e){var o=e.validator.call(ValidationModule,e.element.getValue());o.isValid?e.onValid&&e.onValid(e):e.onInvalid&&e.onInvalid(e),o.isValid||n.include(e.element)?n.include(e.element)||t&&ValidationModule.hideError(e.element):(n.push(e.element),t&&ValidationModule.showError(e.element,o.errorMessage),i=!1)}),i},_showMessage:function(e,t,i,n){var o=e.validatorMessageContainer||e.parentNode,s=$(o).select(n)[0];s=s||$(o).select(layoutModule.MESSAGE_PATTERN)[0],s||(s=document.createElement("span"),o.appendChild(s)),s.className="";for(var r=n.split("."),a=0;a<r.length;a++)s.addClassName(r[a].trim());0==s.children.length?s.update(t):s.children[0].update(t),o.addClassName(i)},showError:function(e,t,i){if(this._showMessage(e,t,layoutModule.ERROR_CLASS,layoutModule.MESSAGE_WARNING_PATTERN),i){var n=e.validatorMessageContainer||e.parentNode,o=$(n).select(layoutModule.DETAILS_PATTERN)[0];o&&o.stopObserving("click").observe("click",function(){dialogs.errorPopup.show(i,!0)}.bindAsEventListener(this))}},showSuccess:function(e,t){this._showMessage(e,t,layoutModule.SUCCESS_CLASS,layoutModule.MESSAGE_SUCCESS_PATTERN)},hideError:function(e){var t=e.validatorMessageContainer||e.parentNode;$(t).removeClassName(layoutModule.ERROR_CLASS)},hideSuccess:function(e){var t=e.validatorMessageContainer||e.parentNode;$(t).removeClassName(layoutModule.SUCCESS_CLASS)}},ClassNameBuilder=function(e){return this.element=$(e),this.element.classNameBuilder?this.element.classNameBuilder:(this.names=this.element.className.split(" "),this.names=this.names.compact().uniq(),void(this.element.classNameBuilder=this))};ClassNameBuilder.addMethod("add",function(e){var t=[];if(Object.isString(e))t=e.split(" ");else{if(!isArray(e))return this;t=e}return t.each(function(e){this.names.include(e)||this.names.push(e)}.bind(this)),this}).addMethod("remove",function(e){return this.names=this.names.without(e),this}).addMethod("clean",function(){return this.names=[],this}).addMethod("toClassName",function(){return this.element.className=this.names.join(" "),this.element.className});var JSCookie=function(e,t,i){if(!Object.isString(e))throw"Invalid name";this.name=e,this.value=t,Object.isUndefined(t)?this.value=this._getCookies()[e]:this._setCookie(this.name,this.value,i)};JSCookie.addVar("daysToExpiration",30),JSCookie.addVar("getCookieTemplate",function(){return _.template("{{= name}}={{= value}}; expires={{= expires}}; path=/;")}),JSCookie.addMethod("_getCookies",function(){var e={};return document.cookie.split(";").invoke("strip").each(function(t){var i=t.split("=");e[i[0].strip()]=decodeURI(i[1])}),e}),JSCookie.addMethod("set",function(e,t){this.value=e,this._setCookie(this.name,this.value,t)}),JSCookie.addMethod("get",function(){return this.value}),JSCookie.addMethod("_setCookie",function(e,t,i){document.cookie=this.getCookieTemplate()({name:e,value:encodeURI(new String(t)),expires:this._getExpiresDate(i).toGMTString()})}),JSCookie.addMethod("_getExpiresDate",function(e){var t=new Date;return t.setTime(t.getTime()+(e?e:24*this.daysToExpiration*60*60*1e3)),t});var sessionManager={RESET_SESSION_MIN_TIME:1e3,resetSession:function(e){var t=(new Date).getTime();if(!(this._lastSessionResetTime&&t-this._lastSessionResetTime<this.RESET_SESSION_MIN_TIME)){this._lastSessionResetTime=t;var i=buildActionUrl({flowExecutionKey:e,eventId:"resetSession"}),n={errorHandler:this.errorHandler};ajaxNonReturningUpdate(i,n)}},errorHandler:function(e){var t=e.getResponseHeader("LoginRequested");return t?(document.location=urlContext,!0):void 0}},buildActionUrl=function(e){if(e){var t=deepClone(e);return $w("flowId flowExecutionKey eventId").each(function(e){t[e]&&(t["_"+e]=t[e],delete t[e])}),"flow.html?"+Object.toQueryString(t)}},pageDimmer={DOM_ID:"#pageDimmer",show:function(e){if(jQuery(this.DOM_ID).removeClass("hidden"),e&&e.match(layoutModule.DIALOG_PATTERN)){var t=e.getStyle("zIndex");t=t?parseInt(t,10):0,t>0&&this.setZindex(t-1)}},hide:function(){jQuery(this.DOM_ID).addClass("hidden")},setZindex:function(e){jQuery(this.DOM_ID).css({zIndex:e})}},fileSender={};fileSender.upload=function(e,t,i,n){return fileSender.uploadMultiple([e],t,i,n)},fileSender.uploadMultiple=function(e,t,i,n){for(var o=Builder.node("FORM",{action:"flow.html?_flowId="+t,method:"post",enctype:"multipart/form-data"}),s=0;s<e.length;s++){var r=e[s],a=r.cloneNode(!0);r.writeAttribute("id",null),r.addClassName("hidden"),o.file&&o.file.remove(),fileSender.moveEventHandlers(r,a),r.insert({after:a}),r.remove(),o.insert(r);for(var l in i){var c=Builder.node("INPUT",{type:"hidden",name:l,value:i[l]});o.insert(c)}}return o.addClassName("hidden"),document.body.insert(o),fileSender.submit(o,{onStart:null,onComplete:n}),o.submit(),o},fileSender.moveEventHandlers=function(e,t){var i=Event.cache,n=fileSender.getUniqueElementID(e),o=i[n];delete i[n],o&&(_.each(o,function(e,i){"element"!==i&&_.each(e,function(e){t.observe(i,e.handler)})}),o=null)},fileSender.getUniqueElementID=function(e){return e===window?0:"uniqueID"in document.createElement("div")?e==document?1:e.uniqueID:("undefined"==typeof e._prototypeUID&&(e._prototypeUID=Element.Storage.UID++),e._prototypeUID)},fileSender.frame=function(e){var t="f"+Math.floor(99999*Math.random()),i=$("ajax-upload-iframe").cloneNode(!0);i.writeAttribute("id",t),i.writeAttribute("name",t),document.body.insert(i);var n=function(){fileSender.loaded(t)};return i.observe("load",n),e&&"function"==typeof e.onComplete&&(i.onComplete=e.onComplete),t},fileSender.form=function(e,t){e.setAttribute("target",t)},fileSender.submit=function(e,t){return fileSender.form(e,fileSender.frame(t)),t&&"function"==typeof t.onStart?t.onStart():!0},fileSender.loaded=function(e){var t,i=document.getElementById(e);t=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:window.frames[e].document,"about:blank"!=t.location.href&&(fileSender.sessionTimeoutHandler(t)||"function"==typeof i.onComplete&&i.onComplete(t.body.innerHTML))},fileSender.sessionTimeoutHandler=function(e){for(var t=e.getElementsByTagName("meta"),i=0;i<t.length;i++)if("pageHeading"==t[i].name&&"LOGIN PAGE"==t[i].content)return document.location=".",!0;return!1},Keys=new Object,Keys.DOM_VK_BACK_SPACE=8,Keys.DOM_VK_ENTER=13,Keys.DOM_VK_PAGE_UP=33,Keys.DOM_VK_DOWN=40,Keys.DOM_VK_INSERT=45,Keys.DOM_VK_DELETE=46,Keys.DOM_VK_0=48,Keys.DOM_VK_9=57,Keys.DOM_VK_NUMPAD0=96,Keys.DOM_VK_NUMPAD9=105,Keys.DOM_VK_DECIMAL=110,Keys.DOM_VK_COMMA=188,Keys.DOM_VK_PERIOD=190,Keys.DOM_VK_CANCEL=3,Keys.DOM_VK_HELP=6,Keys.DOM_VK_TAB=9,Keys.DOM_VK_CLEAR=12,Keys.DOM_VK_RETURN=13,Keys.DOM_VK_SHIFT=16,Keys.DOM_VK_CONTROL=17,Keys.DOM_VK_ALT=18,Keys.DOM_VK_PAUSE=19,Keys.DOM_VK_CAPS_LOCK=20,Keys.DOM_VK_ESCAPE=27,Keys.DOM_VK_SPACE=32,Keys.DOM_VK_PAGE_DOWN=34,Keys.DOM_VK_END=35,Keys.DOM_VK_HOME=36,Keys.DOM_VK_LEFT=37,Keys.DOM_VK_UP=38,Keys.DOM_VK_RIGHT=39,Keys.DOM_VK_PRINTSCREEN=44,Keys.DOM_VK_1=49,Keys.DOM_VK_2=50,Keys.DOM_VK_3=51,Keys.DOM_VK_4=52,Keys.DOM_VK_5=53,Keys.DOM_VK_6=54,Keys.DOM_VK_7=55,Keys.DOM_VK_8=56,Keys.DOM_VK_SEMICOLON=59,Keys.DOM_VK_EQUALS=61,Keys.DOM_VK_A=65,Keys.DOM_VK_B=66,Keys.DOM_VK_C=67,Keys.DOM_VK_D=68,Keys.DOM_VK_E=69,Keys.DOM_VK_F=70,Keys.DOM_VK_G=71,Keys.DOM_VK_H=72,Keys.DOM_VK_I=73,Keys.DOM_VK_J=74,Keys.DOM_VK_K=75,Keys.DOM_VK_L=76,Keys.DOM_VK_M=77,Keys.DOM_VK_N=78,Keys.DOM_VK_O=79,Keys.DOM_VK_P=80,Keys.DOM_VK_Q=81,Keys.DOM_VK_R=82,Keys.DOM_VK_S=83,Keys.DOM_VK_T=84,Keys.DOM_VK_U=85,Keys.DOM_VK_V=86,Keys.DOM_VK_W=87,Keys.DOM_VK_X=88,Keys.DOM_VK_Y=89,Keys.DOM_VK_Z=90,Keys.DOM_VK_CONTEXT_MENU=93,Keys.DOM_VK_NUMPAD1=97,Keys.DOM_VK_NUMPAD2=98,Keys.DOM_VK_NUMPAD3=99,Keys.DOM_VK_NUMPAD4=100,Keys.DOM_VK_NUMPAD5=101,Keys.DOM_VK_NUMPAD6=102,Keys.DOM_VK_NUMPAD7=103,Keys.DOM_VK_NUMPAD8=104,Keys.DOM_VK_MULTIPLY=106,Keys.DOM_VK_ADD=107,Keys.DOM_VK_SEPARATOR=108,Keys.DOM_VK_SUBTRACT=109,Keys.DOM_VK_SUBTRACT_UNDERSCORE_IE=189,Keys.DOM_VK_DIVIDE=111,Keys.DOM_VK_F1=112,Keys.DOM_VK_F2=113,Keys.DOM_VK_F3=114,Keys.DOM_VK_F4=115,Keys.DOM_VK_F5=116,Keys.DOM_VK_F6=117,Keys.DOM_VK_F7=118,Keys.DOM_VK_F8=119,Keys.DOM_VK_F9=120,Keys.DOM_VK_F10=121,Keys.DOM_VK_F11=122,Keys.DOM_VK_F12=123,Keys.DOM_VK_F13=124,Keys.DOM_VK_F14=125,Keys.DOM_VK_F15=126,Keys.DOM_VK_F16=127,Keys.DOM_VK_F17=128,Keys.DOM_VK_F18=129,Keys.DOM_VK_F19=130,Keys.DOM_VK_F20=131,Keys.DOM_VK_F21=132,Keys.DOM_VK_F22=133,Keys.DOM_VK_F23=134,Keys.DOM_VK_F24=135,Keys.DOM_VK_NUM_LOCK=144,Keys.DOM_VK_SCROLL_LOCK=145,Keys.DOM_VK_SLASH=191,Keys.DOM_VK_BACK_QUOTE=192,Keys.DOM_VK_OPEN_BRACKET=219,Keys.DOM_VK_BACK_SLASH=220,Keys.DOM_VK_CLOSE_BRACKET=221,Keys.DOM_VK_QUOTE=222,Keys.DOM_VK_META=224,compileTemplate=function(e){if(e){var t=_.templateSettings;_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g};var i=_.template(jQuery(e).html());return _.templateSettings=t,i}},define("utils.common",["prototype","jquery","underscore"],function(e){return function(){var t;return t||e.jQuery}}(this));var Builder={NODEMAP:{AREA:"map",CAPTION:"table",COL:"table",COLGROUP:"table",LEGEND:"fieldset",OPTGROUP:"select",OPTION:"select",PARAM:"object",TBODY:"table",TD:"table",TFOOT:"table",TH:"table",THEAD:"table",TR:"table"},node:function(e){e=e.toUpperCase();var t=this.NODEMAP[e]||"div",i=document.createElement(t);try{i.innerHTML="<"+e+"></"+e+">"}catch(n){}var o=i.firstChild||null;if(o&&o.tagName.toUpperCase()!=e&&(o=o.getElementsByTagName(e)[0]),o||(o=document.createElement(e)),o){if(arguments[1])if(this._isStringOrNumber(arguments[1])||arguments[1]instanceof Array||arguments[1].tagName)this._children(o,arguments[1]);else{var s=this._attributes(arguments[1]);if(s.length){try{i.innerHTML="<"+e+" "+s+"></"+e+">"}catch(n){}if(o=i.firstChild||null,!o){o=document.createElement(e);for(attr in arguments[1])o["class"==attr?"className":attr]=arguments[1][attr]}o.tagName.toUpperCase()!=e&&(o=i.getElementsByTagName(e)[0])}}return arguments[2]&&this._children(o,arguments[2]),$(o)}},_text:function(e){return document.createTextNode(e)},ATTR_MAP:{className:"class",htmlFor:"for"},_attributes:function(e){var t=[];for(attribute in e)t.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+e[attribute].toString().escapeHTML().gsub(/"/,"&quot;")+'"');return t.join(" ")},_children:function(e,t){return t.tagName?void e.appendChild(t):void("object"==typeof t?t.flatten().each(function(t){"object"==typeof t?e.appendChild(t):Builder._isStringOrNumber(t)&&e.appendChild(Builder._text(t))}):Builder._isStringOrNumber(t)&&e.appendChild(Builder._text(t)))},_isStringOrNumber:function(e){return"string"==typeof e||"number"==typeof e},build:function(e){var t=this.node("div");return $(t).update(e.strip()),t.down()},dump:function(e){"object"!=typeof e&&"function"!=typeof e&&(e=window);var t="A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR".split(/\s+/);t.each(function(t){e[t]=function(){return Builder.node.apply(Builder,[t].concat($A(arguments)))}})}};define("builder",["prototype"],function(e){return function(){var t;return t||e.Builder}}(this)),define("jrs.configs",[],function(){return"undefined"!=typeof __jrsConfigs__?__jrsConfigs__:{contextPath:"",userLocale:"en"}}),define("jquery.ui",["require","jquery"],function(e){var t=e("jquery");return function(e,t){function i(t,i){var o,s,r,a=t.nodeName.toLowerCase();return"area"===a?(o=t.parentNode,s=o.name,t.href&&s&&"map"===o.nodeName.toLowerCase()?(r=e("img[usemap=#"+s+"]")[0],!!r&&n(r)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var n,o,s=e(this[0]);s.length&&s[0]!==document;){if(n=s.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(o=parseInt(s.css("zIndex"),10),!isNaN(o)&&0!==o))return o;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),o=isNaN(n);return(o||n>=0)&&i(t,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,n){function o(t,i,n,o){return e.each(s,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var s="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?a["inner"+n].call(this):this.each(function(){e(this).css(r,o(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(r,o(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,n){var o,s=e.ui[t].prototype;for(o in n)s.plugins[o]=s.plugins[o]||[],s.plugins[o].push([i,n[o]])},call:function(e,t,i){var n,o=e.plugins[t];if(o&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(n=0;n<o.length;n++)e.options[o[n][0]]&&o[n][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return t[n]>0?!0:(t[n]=1,o=t[n]>0,t[n]=0,o)}})}(t),function(e,t){var i=0,n=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(s){}o(t)},e.widget=function(t,i,n){var o,s,r,a,l={},c=t.split(".")[0];t=t.split(".")[1],o=c+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[c]=e[c]||{},s=e[c][t],r=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new r(e,t)},e.extend(r,s,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},o=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,s=this._superApply;return this._super=e,this._superApply=o,t=n.apply(this,arguments),this._super=i,this._superApply=s,t}}()):void(l[t]=n)}),r.prototype=e.widget.extend(a,{widgetEventPrefix:s?a.widgetEventPrefix||t:t},l,{constructor:r,namespace:c,widgetName:t,widgetFullName:o}),s?(e.each(s._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete s._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r)},e.widget.extend=function(i){for(var o,s,r=n.call(arguments,1),a=0,l=r.length;l>a;a++)for(o in r[a])s=r[a][o],r[a].hasOwnProperty(o)&&s!==t&&(i[o]=e.isPlainObject(s)?e.isPlainObject(i[o])?e.widget.extend({},i[o],s):e.widget.extend({},s):s);return i},e.widget.bridge=function(i,o){var s=o.prototype.widgetFullName||i;e.fn[i]=function(r){var a="string"==typeof r,l=n.call(arguments,1),c=this;return r=!a&&l.length?e.widget.extend.apply(null,[r].concat(l)):r,this.each(a?function(){var n,o=e.data(this,s);return o?e.isFunction(o[r])&&"_"!==r.charAt(0)?(n=o[r].apply(o,l),n!==o&&n!==t?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+r+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+r+"'")}:function(){var t=e.data(this,s);t?t.option(r||{})._init():e.data(this,s,new o(r,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,n){var o,s,r,a=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(a={},o=i.split("."),i=o.shift(),o.length){for(s=a[i]=e.widget.extend({},this.options[i]),r=0;r<o.length-1;r++)s[o[r]]=s[o[r]]||{},s=s[o[r]];if(i=o.pop(),1===arguments.length)return s[i]===t?null:s[i];s[i]=n}else{if(1===arguments.length)return this.options[i]===t?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i,n){var o,s=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=o=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),e.each(n,function(n,r){function a(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof r?s[r]:r).apply(s,arguments):void 0}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||e.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+s.eventNamespace,d=l[2];d?o.delegate(d,c,a):i.bind(c,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var o,s,r=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(o in s)o in i||(i[o]=s[o]);return this.element.trigger(i,n),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,o,s){"string"==typeof o&&(o={effect:o});var r,a=o?o===!0||"number"==typeof o?i:o.effect||i:t;o=o||{},"number"==typeof o&&(o={duration:o}),r=!e.isEmptyObject(o),o.complete=s,o.delay&&n.delay(o.delay),r&&e.effects&&e.effects.effect[a]?n[t](o):a!==t&&n[a]?n[a](o.duration,o.easing,s):n.queue(function(i){e(this)[t](),s&&s.call(n[0]),i()})}})}(t),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,o=1===i.which,s="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return o&&!s&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(t),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)
},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,o=this.options;return o.containment?"window"===o.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),i=e(o.containment),n=i[0],void(n&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i))):void(this.containment=null)},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:o.scrollTop(),left:o.scrollLeft()}),{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*n}},_generatePosition:function(t){var i,n,o,s,r=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,c=t.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),r.grid&&(o=r.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,c=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-r.grid[1]:o+r.grid[1]:o,s=r.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-r.grid[0]:s+r.grid[0]:s)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var n=e(this).data("ui-draggable"),o=n.options,s=e.extend({},i,{item:n.element});n.sortables=[],e(o.connectToSortable).each(function(){var i=e.data(this,"ui-sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,s))})},stop:function(t,i){var n=e(this).data("ui-draggable"),o=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,i){var n=e(this).data("ui-draggable"),o=this;e.each(n.sortables,function(){var s=!1,r=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==r&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(r.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("ui-draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){var n=e(i.helper),o=e(this).data("ui-draggable").options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(t,i){var n=e(this).data("ui-draggable").options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("ui-draggable"),n=i.options,o=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=o=i.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=o=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=o=i.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=o=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(document).scrollTop()<n.scrollSensitivity?o=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(o=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(document).scrollLeft()<n.scrollSensitivity?o=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(o=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=e(this),n=i.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(t,i){var n,o,s,r,a,l,c,d,u,h,p=e(this).data("ui-draggable"),m=p.options,f=m.snapTolerance,g=i.offset.left,v=g+p.helperProportions.width,_=i.offset.top,b=_+p.helperProportions.height;for(u=p.snapElements.length-1;u>=0;u--)a=p.snapElements[u].left,l=a+p.snapElements[u].width,c=p.snapElements[u].top,d=c+p.snapElements[u].height,a-f>v||g>l+f||c-f>b||_>d+f||!e.contains(p.snapElements[u].item.ownerDocument,p.snapElements[u].item)?(p.snapElements[u].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=!1):("inner"!==m.snapMode&&(n=Math.abs(c-b)<=f,o=Math.abs(d-_)<=f,s=Math.abs(a-v)<=f,r=Math.abs(l-g)<=f,n&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),o&&(i.position.top=p._convertPositionTo("relative",{top:d,left:0}).top-p.margins.top),s&&(i.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left),r&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),h=n||o||s||r,"outer"!==m.snapMode&&(n=Math.abs(c-_)<=f,o=Math.abs(d-b)<=f,s=Math.abs(a-g)<=f,r=Math.abs(l-v)<=f,n&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),o&&(i.position.top=p._convertPositionTo("relative",{top:d-p.helperProportions.height,left:0}).top-p.margins.top),s&&(i.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left),r&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[u].snapping&&(n||o||s||r||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=n||o||s||r||h)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,i=this.data("ui-draggable").options,n=e.makeArray(e(i.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});n.length&&(t=parseInt(e(n[0]).css("zIndex"),10)||0,e(n).each(function(i){e(this).css("zIndex",t+i)}),this.css("zIndex",t+n.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var n=e(i.helper),o=e(this).data("ui-draggable").options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(t,i){var n=e(this).data("ui-draggable").options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}})}(t),function(e){function t(e,t,i){return e>t&&t+i>e}e.widget("ui.droppable",{version:"@VERSION",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},e.ui.ddmanager.droppables[i.scope]=e.ui.ddmanager.droppables[i.scope]||[],e.ui.ddmanager.droppables[i.scope].push(this),i.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,i=e.ui.ddmanager.droppables[this.options.scope];t<i.length;t++)i[t]===this&&i.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){"accept"===t&&(this.accept=e.isFunction(i)?i:function(e){return e.is(i)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var n=i||e.ui.ddmanager.current,o=!1;return n&&(n.currentItem||n.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&e.ui.intersect(n,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(o=!0,!1):void 0}),o?!1:this.accept.call(this.element[0],n.currentItem||n.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(n)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,i,n){if(!i.offset)return!1;var o,s,r=(e.positionAbs||e.position.absolute).left,a=(e.positionAbs||e.position.absolute).top,l=r+e.helperProportions.width,c=a+e.helperProportions.height,d=i.offset.left,u=i.offset.top,h=d+i.proportions().width,p=u+i.proportions().height;switch(n){case"fit":return r>=d&&h>=l&&a>=u&&p>=c;case"intersect":return d<r+e.helperProportions.width/2&&l-e.helperProportions.width/2<h&&u<a+e.helperProportions.height/2&&c-e.helperProportions.height/2<p;case"pointer":return o=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,s=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,t(s,u,i.proportions().height)&&t(o,d,i.proportions().width);case"touch":return(a>=u&&p>=a||c>=u&&p>=c||u>a&&c>p)&&(r>=d&&h>=r||l>=d&&h>=l||d>r&&l>h);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var n,o,s=e.ui.ddmanager.droppables[t.options.scope]||[],r=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<s.length;n++)if(!(s[n].options.disabled||t&&!s[n].accept.call(s[n].element[0],t.currentItem||t.element))){for(o=0;o<a.length;o++)if(a[o]===s[n].element[0]){s[n].proportions().height=0;continue e}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===r&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(t,i){var n=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,o,s,r=e.ui.intersect(t,this,this.options.tolerance),a=!r&&this.isover?"isout":r&&!this.isover?"isover":null;a&&(this.options.greedy&&(o=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===o}),s.length&&(n=e.data(s[0],"ui-droppable"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}}}(t),function(e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){function t(e){return a._mouseDown(e)}var i,n,o,s,r,a=this,l=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!l.aspectRatio,aspectRatio:l.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:l.helper||l.ghost||l.animate?l.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=l.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},n=0;n<i.length;n++)o=e.trim(i[n]),r="ui-resizable-"+o,s=e("<div class='ui-resizable-handle "+r+"'></div>"),s.css({zIndex:l.zIndex}),"se"===o&&s.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[o]=".ui-resizable-"+o,this.element.append(s);this._renderAxis=function(t){var i,n,o,s;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=e(this.handles[i]+":last",this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=e(this.handles[i],this.element),s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),o=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(o,s),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element);for(n in this.handles)this._handles=this._handles.add(this.handles[n]);if(this._handles.disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(s=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=s&&s[1]?s[1]:"se")}),l.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){l.disabled||(e(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){l.disabled||a.resizing||(e(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit(),l.handles.constructor!==String)for(n in l.handles)o=l.handles[n],o instanceof e&&o.bind("mousedown."+this.widgetName,t)},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,n,o=!1;for(i in this.handles)n=e(this.handles[i])[0],(n===t.target||e.contains(n,t.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(i){var n,o,s,r=this.options,a=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy(),n=t(this.helper.css("left")),o=t(this.helper.css("top")),r.containment&&(n+=e(r.containment).scrollLeft()||0,o+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:o},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:n,top:o},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof r.aspectRatio?r.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===s?this.axis+"-resize":s),l.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(t){var i,n=this.helper,o={},s=this.originalMousePosition,r=this.axis,a=this.position.top,l=this.position.left,c=this.size.width,d=this.size.height,u=t.pageX-s.left||0,h=t.pageY-s.top||0,p=this._change[r];return p?(i=p.apply(this,[t,u,h]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),this.position.top!==a&&(o.top=this.position.top+"px"),this.position.left!==l&&(o.left=this.position.left+"px"),this.size.width!==c&&(o.width=this.size.width+"px"),this.size.height!==d&&(o.height=this.size.height+"px"),n.css(o),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(o)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,n,o,s,r,a,l,c=this.options,d=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),o=n&&e.ui.hasScroll(i[0],"left")?0:d.sizeDiff.height,s=n?0:d.sizeDiff.width,r={width:d.helper.width()-s,height:d.helper.height()-o},a=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,l=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null,c.animate||this.element.css(e.extend(r,{top:l,left:a})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,o,s,r,a=this.options;r={minWidth:i(a.minWidth)?a.minWidth:0,maxWidth:i(a.maxWidth)?a.maxWidth:1/0,minHeight:i(a.minHeight)?a.minHeight:0,maxHeight:i(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=r.minHeight*this.aspectRatio,o=r.minWidth/this.aspectRatio,n=r.maxHeight*this.aspectRatio,s=r.maxWidth/this.aspectRatio,t>r.minWidth&&(r.minWidth=t),o>r.minHeight&&(r.minHeight=o),n<r.maxWidth&&(r.maxWidth=n),s<r.maxHeight&&(r.maxHeight=s)),this._vBoundaries=r},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,o=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===o&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===o&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,o=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,s=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,r=i(e.width)&&t.minWidth&&t.minWidth>e.width,a=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,d=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return r&&(e.width=t.minWidth),a&&(e.height=t.minHeight),o&&(e.width=t.maxWidth),s&&(e.height=t.maxHeight),r&&d&&(e.left=l-t.minWidth),o&&d&&(e.left=l-t.maxWidth),a&&u&&(e.top=c-t.minHeight),s&&u&&(e.top=c-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,n,o,s=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(o=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[o.css("borderTopWidth"),o.css("borderRightWidth"),o.css("borderBottomWidth"),o.css("borderLeftWidth")],n=[o.css("paddingTop"),o.css("paddingRight"),o.css("paddingBottom"),o.css("paddingLeft")],t=0;t<i.length;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(n[t],10)||0);o.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;
return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,o=this.originalPosition;return{top:o.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("ui-resizable"),n=i.options,o=i._proportionallyResizeElements,s=o.length&&/textarea/i.test(o[0].nodeName),r=s&&e.ui.hasScroll(o[0],"left")?0:i.sizeDiff.height,a=s?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-r},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,d=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,d&&c?{top:d,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};o&&o.length&&e(o[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var i,n,o,s,r,a,l,c=e(this).data("ui-resizable"),d=c.options,u=c.element,h=d.containment,p=h instanceof e?h.get(0):/parent/.test(h)?u.parent().get(0):h;p&&(c.containerElement=e(p),/document/.test(h)||h===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(i=e(p),n=[],e(["Top","Right","Left","Bottom"]).each(function(e,o){n[e]=t(i.css("padding"+o))}),c.containerOffset=i.offset(),c.containerPosition=i.position(),c.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]},o=c.containerOffset,s=c.containerSize.height,r=c.containerSize.width,a=e.ui.hasScroll(p,"left")?p.scrollWidth:r,l=e.ui.hasScroll(p)?p.scrollHeight:s,c.parentData={element:p,left:o.left,top:o.top,width:a,height:l}))},resize:function(t){var i,n,o,s,r=e(this).data("ui-resizable"),a=r.options,l=r.containerOffset,c=r.position,d=r._aspectRatio||t.shiftKey,u={top:0,left:0},h=r.containerElement;h[0]!==document&&/static/.test(h.css("position"))&&(u=l),c.left<(r._helper?l.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-l.left:r.position.left-u.left),d&&(r.size.height=r.size.width/r.aspectRatio),r.position.left=a.helper?l.left:0),c.top<(r._helper?l.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-l.top:r.position.top),d&&(r.size.width=r.size.height*r.aspectRatio),r.position.top=r._helper?l.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top,i=Math.abs((r._helper?r.offset.left-u.left:r.offset.left-u.left)+r.sizeDiff.width),n=Math.abs((r._helper?r.offset.top-u.top:r.offset.top-l.top)+r.sizeDiff.height),o=r.containerElement.get(0)===r.element.parent().get(0),s=/relative|absolute/.test(r.containerElement.css("position")),o&&s&&(i-=Math.abs(r.parentData.left)),i+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-i,d&&(r.size.height=r.size.width/r.aspectRatio)),n+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-n,d&&(r.size.width=r.size.height*r.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),i=t.options,n=t.containerOffset,o=t.containerPosition,s=t.containerElement,r=e(t.helper),a=r.offset(),l=r.outerWidth()-t.sizeDiff.width,c=r.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(s.css("position"))&&e(this).css({left:a.left-o.left-n.left,width:l,height:c}),t._helper&&!i.animate&&/static/.test(s.css("position"))&&e(this).css({left:a.left-o.left-n.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,n=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):e.each(i.alsoResize,function(e){n(e)})},resize:function(t,i){var n=e(this).data("ui-resizable"),o=n.options,s=n.originalSize,r=n.originalPosition,a={height:n.size.height-s.height||0,width:n.size.width-s.width||0,top:n.position.top-r.top||0,left:n.position.left-r.left||0},l=function(t,n){e(t).each(function(){var t=e(this),o=e(this).data("ui-resizable-alsoresize"),s={},r=n&&n.length?n:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(r,function(e,t){var i=(o[t]||0)+(a[t]||0);i&&i>=0&&(s[t]=i||null)}),t.css(s)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?l(o.alsoResize):e.each(o.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),i=t.options,n=t.size,o=t.originalSize,s=t.originalPosition,r=t.axis,a="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=a[0]||1,c=a[1]||1,d=Math.round((n.width-o.width)/l)*l,u=Math.round((n.height-o.height)/c)*c,h=o.width+d,p=o.height+u,m=i.maxWidth&&i.maxWidth<h,f=i.maxHeight&&i.maxHeight<p,g=i.minWidth&&i.minWidth>h,v=i.minHeight&&i.minHeight>p;i.grid=a,g&&(h+=l),v&&(p+=c),m&&(h-=l),f&&(p-=c),/^(se|s|e)$/.test(r)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(r)?(t.size.width=h,t.size.height=p,t.position.top=s.top-u):/^(sw)$/.test(r)?(t.size.width=h,t.size.height=p,t.position.left=s.left-d):(p-c>0?(t.size.height=p,t.position.top=s.top-u):(t.size.height=c,t.position.top=s.top+o.height-c),h-l>0?(t.size.width=h,t.position.left=s.left-d):(t.size.width=l,t.position.left=s.left+o.width-l))}})}(t),function(e){e.widget("ui.selectable",e.ui.mouse,{version:"@VERSION",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,n=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(n.filter,this.element[0]),this._trigger("start",t),e(n.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=e.data(this,"selectable-item");n.startselected=!0,t.metaKey||t.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",t,{unselecting:n.element}))}),e(t.target).parents().addBack().each(function(){var n,o=e.data(this,"selectable-item");return o?(n=!t.metaKey&&!t.ctrlKey||!o.$element.hasClass("ui-selected"),o.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),o.unselecting=!n,o.selecting=n,o.selected=n,n?i._trigger("selecting",t,{selecting:o.element}):i._trigger("unselecting",t,{unselecting:o.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,n=this,o=this.options,s=this.opos[0],r=this.opos[1],a=t.pageX,l=t.pageY;return s>a&&(i=a,a=s,s=i),r>l&&(i=l,l=r,r=i),this.helper.css({left:s,top:r,width:a-s,height:l-r}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),c=!1;i&&i.element!==n.element[0]&&("touch"===o.tolerance?c=!(i.left>a||i.right<s||i.top>l||i.bottom<r):"fit"===o.tolerance&&(c=i.left>s&&i.right<a&&i.top>r&&i.bottom<l),c?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var n=e.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",t,{unselected:n.element})}),e(".ui-selecting",this.element[0]).each(function(){var n=e.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",t,{selected:n.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(t),function(e){function t(e,t,i){return e>t&&t+i>e}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,i){"disabled"===t?(this.options[t]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,i){var n=null,o=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,s.widgetName+"-item")===s?(n=e(this),!1):void 0}),e.data(t.target,s.widgetName+"-item")===s&&(n=e(t.target)),n&&(!this.options.handle||i||(e(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(o=!0)}),o))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,i,n){var o,s,r=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",r.cursor),this.storedStylesheet=e("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(s)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,n,o,s,r=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(t.pageY-e(document).scrollTop()<r.scrollSensitivity?a=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(a=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed)),t.pageX-e(document).scrollLeft()<r.scrollSensitivity?a=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(a=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed))),a!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],o=n.item[0],s=this._intersectsWithPointer(n),s&&n.instance===this.currentContainer&&o!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==o&&!e.contains(this.placeholder[0],o)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],o):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this,o=this.placeholder.offset(),s=this.options.axis,r={};s&&"x"!==s||(r.left=o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(r.top=o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,s=e.left,r=s+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,d=this.offset.click.left,u="x"===this.options.axis||n+c>a&&l>n+c,h="y"===this.options.axis||t+d>s&&r>t+d,p=u&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:s<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<r&&a<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),n="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),o=i&&n,s=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return o?this.floating?r&&"right"===r||"down"===s?2:1:s&&("down"===s?2:1):!1},_intersectsWithSides:function(e){var i=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),o=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&n||"left"===s&&!n:o&&("down"===o&&i||"up"===o&&!i)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){a.push(this)}var n,o,s,r,a=[],l=[],c=this._connectWith();if(c&&t)for(n=c.length-1;n>=0;n--)for(s=e(c[n]),o=s.length-1;o>=0;o--)r=e.data(s[o],this.widgetFullName),r&&r!==this&&!r.options.disabled&&l.push([e.isFunction(r.options.items)?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,n,o,s,r,a,l,c,d=this.items,u=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(i=h.length-1;i>=0;i--)for(o=e(h[i]),n=o.length-1;n>=0;n--)s=e.data(o[n],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(u.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s));for(i=u.length-1;i>=0;i--)for(r=u[i][1],a=u[i][0],n=0,c=a.length;c>n;n++)l=e(a[n]),l.data(this.widgetName+"-item",r),d.push({item:l,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,o,s;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item,t||(n.width=o.outerWidth(),n.height=o.outerHeight()),s=o.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,n=t.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=t.currentItem[0].nodeName.toLowerCase(),o=e("<"+n+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(o)}):"img"===n&&o.attr("src",t.currentItem.attr("src")),i||o.css("visibility","hidden"),o},update:function(e,o){(!i||n.forcePlaceholderSize)&&(o.height()||o.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(n){var o,s,r,a,l,c,d,u,h,p,m=null,f=null;for(o=this.containers.length-1;o>=0;o--)if(!e.contains(this.currentItem[0],this.containers[o].element[0]))if(this._intersectsWith(this.containers[o].containerCache)){if(m&&e.contains(this.containers[o].element[0],m.element[0]))continue;m=this.containers[o],f=o}else this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",n,this._uiHash(this)),this.containers[o].containerCache.over=0);if(m)if(1===this.containers.length)this.containers[f].containerCache.over||(this.containers[f]._trigger("over",n,this._uiHash(this)),this.containers[f].containerCache.over=1);else{for(r=1e4,a=null,p=m.floating||i(this.currentItem),l=p?"left":"top",c=p?"width":"height",d=this.positionAbs[l]+this.offset.click[l],s=this.items.length-1;s>=0;s--)e.contains(this.containers[f].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(!p||t(this.positionAbs.top+this.offset.click.top,this.items[s].top,this.items[s].height))&&(u=this.items[s].item.offset()[l],h=!1,Math.abs(u-d)>Math.abs(u+this.items[s][c]-d)&&(h=!0,u+=this.items[s][c]),Math.abs(u-d)<r&&(r=Math.abs(u-d),a=this.items[s],this.direction=h?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[f])return;a?this._rearrange(n,a,null,!0):this._rearrange(n,null,this.containers[f].element,!0),this._trigger("change",n,this._uiHash()),this.containers[f]._trigger("change",n,this._uiHash(this)),this.currentContainer=this.containers[f],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[f]._trigger("over",n,this._uiHash(this)),this.containers[f].containerCache.over=1}},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),("document"===o.containment||"window"===o.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(t=e(o.containment)[0],i=e(o.containment).offset(),n="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(o[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:o.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:o.scrollLeft())*n}},_generatePosition:function(t){var i,n,o=this.options,s=t.pageX,r=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),o.grid&&(i=this.originalPageY+Math.round((r-this.originalPageY)/o.grid[1])*o.grid[1],r=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-o.grid[1]:i+o.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/o.grid[0])*o.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-o.grid[0]:n+o.grid[0]:n)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}
},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(e,t,i){return function(n){i._trigger(e,n,t._uiHash(t))}}this.reverting=!1;var n,o=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&o.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||o.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(o.push(function(e){this._trigger("remove",e,this._uiHash())}),o.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),o.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||o.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(o.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),n=0;n<o.length;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(n=0;n<o.length;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}(t),function(e,i){var n="ui-effects-";e.effects={effect:{}},function(e,t){function i(e,t,i){var n=u[t.type]||{};return null==e?i||!t.def?null:t.def:(e=n.floor?~~e:parseFloat(e),isNaN(e)?t.def:n.mod?(e+n.mod)%n.mod:0>e?0:n.max<e?n.max:e)}function n(t){var i=c(),n=i._rgba=[];return t=t.toLowerCase(),m(l,function(e,o){var s,r=o.re.exec(t),a=r&&o.parse(r),l=o.space||"rgba";return a?(s=i[l](a),i[d[l].cache]=s[d[l].cache],n=i._rgba=s._rgba,!1):void 0}),n.length?("0,0,0,0"===n.join()&&e.extend(n,s.transparent),i):s[t]}function o(e,t,i){return i=(i+1)%1,1>6*i?e+(t-e)*i*6:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e}var s,r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],c=e.Color=function(t,i,n,o){return new e.Color.fn.parse(t,i,n,o)},d={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},h=c.support={},p=e("<p>")[0],m=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",h.rgba=p.style.backgroundColor.indexOf("rgba")>-1,m(d,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),c.fn=e.extend(c.prototype,{parse:function(o,r,a,l){if(o===t)return this._rgba=[null,null,null,null],this;(o.jquery||o.nodeType)&&(o=e(o).css(r),r=t);var u=this,h=e.type(o),p=this._rgba=[];return r!==t&&(o=[o,r,a,l],h="array"),"string"===h?this.parse(n(o)||s._default):"array"===h?(m(d.rgba.props,function(e,t){p[t.idx]=i(o[t.idx],t)}),this):"object"===h?(o instanceof c?m(d,function(e,t){o[t.cache]&&(u[t.cache]=o[t.cache].slice())}):m(d,function(t,n){var s=n.cache;m(n.props,function(e,t){if(!u[s]&&n.to){if("alpha"===e||null==o[e])return;u[s]=n.to(u._rgba)}u[s][t.idx]=i(o[e],t,!0)}),u[s]&&e.inArray(null,u[s].slice(0,3))<0&&(u[s][3]=1,n.from&&(u._rgba=n.from(u[s])))}),this):void 0},is:function(e){var t=c(e),i=!0,n=this;return m(d,function(e,o){var s,r=t[o.cache];return r&&(s=n[o.cache]||o.to&&o.to(n._rgba)||[],m(o.props,function(e,t){return null!=r[t.idx]?i=r[t.idx]===s[t.idx]:void 0})),i}),i},_space:function(){var e=[],t=this;return m(d,function(i,n){t[n.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var n=c(e),o=n._space(),s=d[o],r=0===this.alpha()?c("transparent"):this,a=r[s.cache]||s.to(r._rgba),l=a.slice();return n=n[s.cache],m(s.props,function(e,o){var s=o.idx,r=a[s],c=n[s],d=u[o.type]||{};null!==c&&(null===r?l[s]=c:(d.mod&&(c-r>d.mod/2?r+=d.mod:r-c>d.mod/2&&(r-=d.mod)),l[s]=i((c-r)*t+r,o)))}),this[o](l)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),o=c(t)._rgba;return c(e.map(i,function(e,t){return(1-n)*o[t]+n*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),n=i.pop();return t&&i.push(~~(255*n)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,d.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,n=e[0]/255,o=e[1]/255,s=e[2]/255,r=e[3],a=Math.max(n,o,s),l=Math.min(n,o,s),c=a-l,d=a+l,u=.5*d;return t=l===a?0:n===a?60*(o-s)/c+360:o===a?60*(s-n)/c+120:60*(n-o)/c+240,i=0===c?0:.5>=u?c/d:c/(2-d),[Math.round(t)%360,i,u,null==r?1:r]},d.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],n=e[2],s=e[3],r=.5>=n?n*(1+i):n+i-n*i,a=2*n-r;return[Math.round(255*o(a,r,t+1/3)),Math.round(255*o(a,r,t)),Math.round(255*o(a,r,t-1/3)),s]},m(d,function(n,o){var s=o.props,r=o.cache,l=o.to,d=o.from;c.fn[n]=function(n){if(l&&!this[r]&&(this[r]=l(this._rgba)),n===t)return this[r].slice();var o,a=e.type(n),u="array"===a||"object"===a?n:arguments,h=this[r].slice();return m(s,function(e,t){var n=u["object"===a?e:t.idx];null==n&&(n=h[t.idx]),h[t.idx]=i(n,t)}),d?(o=c(d(h)),o[r]=h,o):c(h)},m(s,function(t,i){c.fn[t]||(c.fn[t]=function(o){var s,r=e.type(o),l="alpha"===t?this._hsla?"hsla":"rgba":n,c=this[l](),d=c[i.idx];return"undefined"===r?d:("function"===r&&(o=o.call(this,d),r=e.type(o)),null==o&&i.empty?this:("string"===r&&(s=a.exec(o),s&&(o=d+parseFloat(s[2])*("+"===s[1]?1:-1))),c[i.idx]=o,this[l](c)))})})}),c.hook=function(t){var i=t.split(" ");m(i,function(t,i){e.cssHooks[i]={set:function(t,o){var s,r,a="";if("transparent"!==o&&("string"!==e.type(o)||(s=n(o)))){if(o=c(s||o),!h.rgba&&1!==o._rgba[3]){for(r="backgroundColor"===i?t.parentNode:t;(""===a||"transparent"===a)&&r&&r.style;)try{a=e.css(r,"backgroundColor"),r=r.parentNode}catch(l){}o=o.blend(a&&"transparent"!==a?a:"_default")}o=o.toRgbaString()}try{t.style[i]=o}catch(l){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=c(t.elem,i),t.end=c(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},c.hook(r),e.cssHooks.borderColor={expand:function(e){var t={};return m(["Top","Right","Bottom","Left"],function(i,n){t["border"+n+"Color"]=e}),t}},s=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(t),function(){function n(t){var i,n,o=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(o&&o.length&&o[0]&&o[o[0]])for(n=o.length;n--;)i=o[n],"string"==typeof o[i]&&(s[e.camelCase(i)]=o[i]);else for(i in o)"string"==typeof o[i]&&(s[i]=o[i]);return s}function o(t,i){var n,o,s={};for(n in i)o=i[n],t[n]!==o&&(r[n]||(e.fx.step[n]||!isNaN(parseFloat(o)))&&(s[n]=o));return s}var s=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(i,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(t.style(e.elem,n,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,i,r,a){var l=e.speed(i,r,a);return this.queue(function(){var i,r=e(this),a=r.attr("class")||"",c=l.children?r.find("*").addBack():r;c=c.map(function(){var t=e(this);return{el:t,start:n(this)}}),i=function(){e.each(s,function(e,i){t[i]&&r[i+"Class"](t[i])})},i(),c=c.map(function(){return this.end=n(this.el[0]),this.diff=o(this.start,this.end),this}),r.attr("class",a),c=c.map(function(){var t=this,i=e.Deferred(),n=e.extend({},l,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,n),i.promise()}),e.when.apply(e,c.get()).done(function(){i(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),l.complete.call(r[0])})})},e.fn.extend({addClass:function(t){return function(i,n,o,s){return n?e.effects.animateClass.call(this,{add:i},n,o,s):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,n,o,s){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},n,o,s):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(n,o,s,r,a){return"boolean"==typeof o||o===i?s?e.effects.animateClass.call(this,o?{add:n}:{remove:n},s,r,a):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:n},o,s,r)}}(e.fn.toggleClass),switchClass:function(t,i,n,o,s){return e.effects.animateClass.call(this,{add:i,remove:t},n,o,s)}})}(),function(){function t(t,i,n,o){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(o=i,n=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(o=n,n=i,i={}),e.isFunction(n)&&(o=n,n=null),i&&e.extend(t,i),n=n||i.duration,t.duration=e.fx.off?0:"number"==typeof n?n:n in e.fx.speeds?e.fx.speeds[n]:e.fx.speeds._default,t.complete=o||i.complete,t}function o(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"@VERSION",save:function(e,t){for(var i=0;i<t.length;i++)null!==t[i]&&e.data(n+t[i],e[0].style[t[i]])},restore:function(e,t){var o,s;for(s=0;s<t.length;s++)null!==t[s]&&(o=e.data(n+t[s]),o===i&&(o=""),e.css(t[s],o))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},n=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),o={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(r){s=document.body}return t.wrap(n),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),n=t.parent(),"static"===t.css("position")?(n.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,n){i[n]=t.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(o),n.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,n,o){return o=o||{},e.each(i,function(e,i){var s=t.cssUnit(i);s[0]>0&&(o[i]=s[0]*n+s[1])}),o}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(s)&&s.call(o[0]),e.isFunction(t)&&t()}var o=e(this),s=n.complete,a=n.mode;(o.is(":hidden")?"hide"===a:"show"===a)?(o[a](),i()):r.call(o[0],n,i)}var n=t.apply(this,arguments),o=n.mode,s=n.queue,r=e.effects.effect[n.effect];return e.fx.off||!r?o?this[o](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):s===!1?this.each(i):this.queue(s||"fx",i)},show:function(e){return function(i){if(o(i))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(i){if(o(i))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(i){if(o(i)||"boolean"==typeof i)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),n=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(n=[parseFloat(i),t])}),n}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}(t),function(e){var t=0,i={},n={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="show",e.widget("ui.accordion",{version:"@VERSION",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e(),content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,n=this.headers.length,o=this.headers.index(t.target),s=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:s=this.headers[(o+1)%n];break;case i.LEFT:case i.UP:s=this.headers[(o-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:s=this.headers[0];break;case i.END:s=this.headers[n-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,n=this.options,o=n.heightStyle,s=this.element.parent(),r=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t);this.active=this._findActive(n.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var i=e(this),n=i.attr("id"),o=i.next(),s=o.attr("id");n||(n=r+"-header-"+t,i.attr("id",n)),s||(s=r+"-panel-"+t,o.attr("id",s)),i.attr("aria-controls",s),o.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===o?(i=s.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(i-=t.outerHeight(!0))}),this.headers.each(function(){i-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===o&&(i=0,this.headers.next().each(function(){i=Math.max(i,e(this).css("height","").height())}).height(i))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,n=this.active,o=e(t.currentTarget),s=o[0]===n[0],r=s&&i.collapsible,a=r?e():o.next(),l=n.next(),c={oldHeader:n,oldPanel:l,newHeader:r?e():o,newPanel:a};t.preventDefault(),s&&!i.collapsible||this._trigger("beforeActivate",t,c)===!1||(i.active=r?!1:this.headers.index(o),this.active=s?e():o,this._toggle(c),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),s||(o.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&o.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),o.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,n=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,t):(n.hide(),i.show(),this._toggleComplete(t)),n.attr({"aria-hidden":"true"}),n.prev().attr("aria-selected","false"),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,o){var s,r,a,l=this,c=0,d=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},h=d&&u.down||u,p=function(){l._toggleComplete(o)};return"number"==typeof h&&(a=h),"string"==typeof h&&(r=h),r=r||h.easing||u.easing,a=a||h.duration||u.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(i,{duration:a,easing:r,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(n,{duration:a,easing:r,complete:p,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?c+=i.now:"content"!==l.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-c),c=0)}})):t.animate(i,a,r,p):e.animate(n,a,r,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(t),function(e){e.widget("ui.autocomplete",{version:"@VERSION",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,n,o=this.element[0].nodeName.toLowerCase(),s="textarea"===o,r="input"===o;this.isMultiLine=s?!0:r?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return t=!0,n=!0,void(i=!0);t=!1,n=!1,i=!1;var s=e.ui.keyCode;switch(o.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",o);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",o);break;case s.UP:t=!0,this._keyEvent("previous",o);break;case s.DOWN:t=!0,this._keyEvent("next",o);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,o.preventDefault(),this.menu.select(o));break;case s.TAB:this.menu.active&&this.menu.select(o);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(o),o.preventDefault());break;default:i=!0,this._searchTimeout(o)}},keypress:function(n){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:this._move("previousPage",n);break;case o.PAGE_DOWN:this._move("nextPage",n);break;case o.UP:this._keyEvent("previous",n);break;case o.DOWN:this._keyEvent("next",n)}}},input:function(e){return n?(n=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(n){n.target===t.element[0]||n.target===i||e.contains(i,n.target)||t.close()})})},menufocus:function(t,i){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var n=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:n})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value):this.liveRegion.text(n.value)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,n){n(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,o){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){o(e)},error:function(){o([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<a>").text(i.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(t),function(e){var t,i="ui-button ui-widget ui-state-default ui-corner-all",n="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",o=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},s=function(t){var i=t.name,n=t.form,o=e([]);return i&&(i=i.replace(/'/g,"\\'"),o=n?e(n).find("[name='"+i+"']"):e("[name='"+i+"']",t.ownerDocument).filter(function(){return!this.form})),o};e.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,o),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");
var n=this,r=this.options,a="checkbox"===this.type||"radio"===this.type,l=a?"":"ui-state-active";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(i).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===t&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||e(this).removeClass(l)}).bind("click"+this.eventNamespace,function(e){r.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),a&&this.element.bind("change"+this.eventNamespace,function(){n.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return r.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled)return!1;e(this).addClass("ui-state-active"),n.buttonElement.attr("aria-pressed","true");var t=n.element[0];s(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return r.disabled?!1:(e(this).addClass("ui-state-active"),t=this,void n.document.one("mouseup",function(){t=null}))}).bind("mouseup"+this.eventNamespace,function(){return r.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return r.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(i+" ui-state-active "+n).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.element.prop("disabled",!!t),void(t&&this.buttonElement.removeClass("ui-state-focus"))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?s(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(n),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),o=this.options.icons,s=o.primary&&o.secondary,r=[];o.primary||o.secondary?(this.options.text&&r.push("ui-button-text-icon"+(s?"s":o.primary?"-primary":"-secondary")),o.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+o.primary+"'></span>"),o.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+o.secondary+"'></span>"),this.options.text||(r.push(s?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))}}),e.widget("ui.buttonset",{version:"@VERSION",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(t),function(e,t){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div-1-10-4",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=n(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){e.datepicker._isDisabledDatepicker(s.inline?t.parent()[0]:s.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function o(t,i){e.extend(t,i);for(var n in i)null==i[n]&&(t[n]=i[n]);return t}e.extend(e.ui,{datepicker:{version:"@VERSION"}});var s,r="datepicker";e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var n,o,s;n=t.nodeName.toLowerCase(),o="div"===n||"span"===n,t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),o),s.settings=e.extend({},i||{}),"input"===n?this._connectDatepicker(t,s):o&&this._inlineDatepicker(t,s)},_newInst:function(t,i){var o=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:o,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var n=e(t);i.append=e([]),i.trigger=e([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,r,i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var n,o,s,r=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),r&&(i.append=e("<span class='"+this._appendClass+"'>"+r+"</span>"),t[a?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),("focus"===n||"both"===n)&&t.focus(this._showDatepicker),("button"===n||"both"===n)&&(o=this._get(i,"buttonText"),s=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:o,title:o}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:o,title:o}):o)),t[a?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,o,s=new Date(2009,11,20),r=this._get(e,"dateFormat");r.match(/[DM]/)&&(t=function(e){for(i=0,n=0,o=0;o<e.length;o++)e[o].length>i&&(i=e[o].length,n=o);return n},s.setMonth(t(this._get(e,r.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,i){var n=e(t);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),e.data(t,r,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,n,s,a){var l,c,d,u,h,p=this._dialogInst;return p||(this.uuid+=1,l="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],r,p)),o(p.settings,s||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(c=document.documentElement.clientWidth,d=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+u,d/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],r,p),this},_destroyDatepicker:function(t){var i,n=e(t),o=e.data(t,r);n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,r),"input"===i?(o.append.remove(),o.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,n,o=e(t),s=e.data(t,r);o.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(n=o.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,n,o=e(t),s=e.data(t,r);o.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(n=o.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,r)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,n,s){var r,a,l,c,d=this._getInst(i);return 2===arguments.length&&"string"==typeof n?"defaults"===n?e.extend({},e.datepicker._defaults):d?"all"===n?e.extend({},d.settings):this._get(d,n):null:(r=n||{},"string"==typeof n&&(r={},r[n]=s),void(d&&(this._curInst===d&&this._hideDatepicker(),a=this._getDateDatepicker(i,!0),l=this._getMinMaxDate(d,"min"),c=this._getMinMaxDate(d,"max"),o(d.settings,r),null!==l&&r.dateFormat!==t&&r.minDate===t&&(d.settings.minDate=this._formatDate(d,l)),null!==c&&r.dateFormat!==t&&r.maxDate===t&&(d.settings.maxDate=this._formatDate(d,c)),"disabled"in r&&(r.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(e(i),d),this._autoSize(d),this._setDate(d,a),this._updateAlternate(d),this._updateDatepicker(d))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,n,o,s=e.datepicker._getInst(t.target),r=!0,a=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),r=!1;break;case 13:return o=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),o[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,o[0]),i=e.datepicker._get(s,"onSelect"),i?(n=e.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[n,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),r=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),r=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?1:-1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),r=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?-1:1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),r=t.ctrlKey||t.metaKey;break;default:r=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):r=!1;r&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,n,o=e.datepicker._getInst(t.target);return e.datepicker._get(o,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(o,"dateFormat")),n=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(t){var i,n=e.datepicker._getInst(t.target);if(n.input.val()!==n.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,e.datepicker._getFormatConfig(n)),i&&(e.datepicker._setDateFromField(n),e.datepicker._updateAlternate(n),e.datepicker._updateDatepicker(n))}catch(o){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,s,r,a,l,c;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),s=n?n.apply(t,[t,i]):{},s!==!1&&(o(i.settings,s),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),r=!1,e(t).parents().each(function(){return r|="fixed"===e(this).css("position"),!r}),a={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),a=e.datepicker._checkOffset(i,a,r),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":r?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),c=e.datepicker._get(i,"duration"),i.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,s=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,n=this._getNumberOfMonths(t),o=n[1],r=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&t.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",r*o+"em"),t.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,n){var o=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),r=t.input?t.input.outerWidth():0,a=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?o-r:0,i.left-=n&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=n&&i.top===t.input.offset().top+a?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+o>l&&l>o?Math.abs(i.left+o-l):0),i.top-=Math.min(i.top,i.top+s>c&&c>s?Math.abs(s+a):0),i},_findPos:function(t){for(var i,n=this._getInst(t),o=this._get(n,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[o?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,n,o,s,a=this._curInst;!a||t&&a!==e.data(t,r)||this._datepickerShowing&&(i=this._get(a,"showAnim"),n=this._get(a,"duration"),o=function(){e.datepicker._tidyDialog(a)},e.effects&&(e.effects.effect[i]||e.effects[i])?a.dpDiv.hide(i,e.datepicker._get(a,"showOptions"),n,o):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,o),i||o(),this._datepickerShowing=!1,s=this._get(a,"onClose"),s&&s.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),n=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==n)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,n){var o=e(t),s=this._getInst(o[0]);this._isDisabledDatepicker(o[0])||(this._adjustInstDate(s,i+("M"===n?this._get(s,"showCurrentAtPos"):0),n),this._updateDatepicker(s))},_gotoToday:function(t){var i,n=e(t),o=this._getInst(n[0]);this._get(o,"gotoCurrent")&&o.currentDay?(o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear):(i=new Date,o.selectedDay=i.getDate(),o.drawMonth=o.selectedMonth=i.getMonth(),o.drawYear=o.selectedYear=i.getFullYear()),this._notifyChange(o),this._adjustDate(n)},_selectMonthYear:function(t,i,n){var o=e(t),s=this._getInst(o[0]);s["selected"+("M"===n?"Month":"Year")]=s["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(o)},_selectDay:function(t,i,n,o){var s,r=e(t);e(o).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||(s=this._getInst(r[0]),s.selectedDay=s.currentDay=e("a",o).html(),s.selectedMonth=s.currentMonth=i,s.selectedYear=s.currentYear=n,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var n,o=e(t),s=this._getInst(o[0]);i=null!=i?i:this._formatDate(s),s.input&&s.input.val(i),this._updateAlternate(s),n=this._get(s,"onSelect"),n?n.apply(s.input?s.input[0]:null,[i,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,n,o,s=this._get(t,"altField");s&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),n=this._getDate(t),o=this.formatDate(i,n,this._getFormatConfig(t)),e(s).each(function(){e(this).val(o)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,n){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var o,s,r,a,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,h=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,m=(n?n.monthNames:null)||this._defaults.monthNames,f=-1,g=-1,v=-1,_=-1,b=!1,y=function(e){var i=o+1<t.length&&t.charAt(o+1)===e;return i&&o++,i},T=function(e){var t=y(e),n="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,o=new RegExp("^\\d{1,"+n+"}"),s=i.substring(l).match(o);if(!s)throw"Missing number at position "+l;return l+=s[0].length,parseInt(s[0],10)},S=function(t,n,o){var s=-1,r=e.map(y(t)?o:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(r,function(e,t){var n=t[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(s=t[0],l+=n.length,!1):void 0}),-1!==s)return s+1;throw"Unknown name at position "+l},A=function(){if(i.charAt(l)!==t.charAt(o))throw"Unexpected literal at position "+l;l++};for(o=0;o<t.length;o++)if(b)"'"!==t.charAt(o)||y("'")?A():b=!1;else switch(t.charAt(o)){case"d":v=T("d");break;case"D":S("D",u,h);break;case"o":_=T("o");break;case"m":g=T("m");break;case"M":g=S("M",p,m);break;case"y":f=T("y");break;case"@":a=new Date(T("@")),f=a.getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((T("!")-this._ticksTo1970)/1e4),f=a.getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"'":y("'")?A():b=!0;break;default:A()}if(l<i.length&&(r=i.substr(l),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===f?f=(new Date).getFullYear():100>f&&(f+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=f?0:-100)),_>-1)for(g=1,v=_;;){if(s=this._getDaysInMonth(f,g-1),s>=v)break;g++,v-=s}if(a=this._daylightSavingAdjust(new Date(f,g-1,v)),a.getFullYear()!==f||a.getMonth()+1!==g||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var n,o=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,s=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=n+1<e.length&&e.charAt(n+1)===t;return i&&n++,i},c=function(e,t,i){var n=""+t;if(l(e))for(;n.length<i;)n="0"+n;return n},d=function(e,t,i,n){return l(e)?n[t]:i[t]},u="",h=!1;if(t)for(n=0;n<e.length;n++)if(h)"'"!==e.charAt(n)||l("'")?u+=e.charAt(n):h=!1;else switch(e.charAt(n)){case"d":u+=c("d",t.getDate(),2);break;case"D":u+=d("D",t.getDay(),o,s);break;case"o":u+=c("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=c("m",t.getMonth()+1,2);break;case"M":u+=d("M",t.getMonth(),r,a);break;case"y":u+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":h=!0;break;default:u+=e.charAt(n)}return u},_possibleChars:function(e){var t,i="",n=!1,o=function(i){var n=t+1<e.length&&e.charAt(t+1)===i;return n&&t++,n};for(t=0;t<e.length;t++)if(n)"'"!==e.charAt(t)||o("'")?i+=e.charAt(t):n=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":o("'")?i+="'":n=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,i){return e.settings[i]!==t?e.settings[i]:this._defaults[i]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,o=this._getDefaultDate(e),s=o,r=this._getFormatConfig(e);try{s=this.parseDate(i,n,r)||o}catch(a){n=t?"":n}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=n?s.getDate():0,e.currentMonth=n?s.getMonth():0,e.currentYear=n?s.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,n){var o=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(n){}for(var o=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=o.getFullYear(),r=o.getMonth(),a=o.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,c=l.exec(i);c;){switch(c[2]||"d"){case"d":case"D":a+=parseInt(c[1],10);break;case"w":case"W":a+=7*parseInt(c[1],10);break;case"m":case"M":r+=parseInt(c[1],10),a=Math.min(a,e.datepicker._getDaysInMonth(s,r));break;case"y":case"Y":s+=parseInt(c[1],10),a=Math.min(a,e.datepicker._getDaysInMonth(s,r))}c=l.exec(i)}return new Date(s,r,a)},r=null==i||""===i?n:"string"==typeof i?s(i):"number"==typeof i?isNaN(i)?n:o(i):new Date(i.getTime());return r=r&&"Invalid Date"===r.toString()?n:r,r&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var n=!t,o=e.selectedMonth,s=e.selectedYear,r=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=r.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=r.getMonth(),e.drawYear=e.selectedYear=e.currentYear=r.getFullYear(),o===e.selectedMonth&&s===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),n="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(n,-i,"M")},next:function(){e.datepicker._adjustDate(n,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(n)},selectDay:function(){return e.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(n,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,o,s,r,a,l,c,d,u,h,p,m,f,g,v,_,b,y,T,S,A,C,E,x,M,w,D,I,O,L,N,R,k,P,F,H,B,V=new Date,U=this._daylightSavingAdjust(new Date(V.getFullYear(),V.getMonth(),V.getDate())),j=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),G=this._get(e,"hideIfNoPrevNext"),W=this._get(e,"navigationAsDateFormat"),$=this._getNumberOfMonths(e),q=this._get(e,"showCurrentAtPos"),Y=this._get(e,"stepMonths"),X=1!==$[0]||1!==$[1],K=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(e,"min"),J=this._getMinMaxDate(e,"max"),Z=e.drawMonth-q,et=e.drawYear;
if(0>Z&&(Z+=12,et--),J)for(t=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-$[0]*$[1]+1,J.getDate())),t=Q&&Q>t?Q:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=W?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-Y,1)),this._getFormatConfig(e)):i,n=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"e":"w")+"'>"+i+"</span></a>":G?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"e":"w")+"'>"+i+"</span></a>",o=this._get(e,"nextText"),o=W?this.formatDate(o,this._daylightSavingAdjust(new Date(et,Z+Y,1)),this._getFormatConfig(e)):o,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"w":"e")+"'>"+o+"</span></a>":G?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"w":"e")+"'>"+o+"</span></a>",r=this._get(e,"currentText"),a=this._get(e,"gotoCurrent")&&e.currentDay?K:U,r=W?this.formatDate(r,a,this._getFormatConfig(e)):r,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",c=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(j?l:"")+(this._isInRange(e,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+r+"</button>":"")+(j?"":l)+"</div>":"",d=parseInt(this._get(e,"firstDay"),10),d=isNaN(d)?0:d,u=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),m=this._get(e,"monthNames"),f=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),_=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),y="",S=0;S<$[0];S++){for(A="",this.maxRows=4,C=0;C<$[1];C++){if(E=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),x=" ui-corner-all",M="",X){if(M+="<div class='ui-datepicker-group",$[1]>1)switch(C){case 0:M+=" ui-datepicker-group-first",x=" ui-corner-"+(j?"right":"left");break;case $[1]-1:M+=" ui-datepicker-group-last",x=" ui-corner-"+(j?"left":"right");break;default:M+=" ui-datepicker-group-middle",x=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+x+"'>"+(/all|left/.test(x)&&0===S?j?s:n:"")+(/all|right/.test(x)&&0===S?j?n:s:"")+this._generateMonthYearHeader(e,Z,et,Q,J,S>0||C>0,m,f)+"</div><table class='ui-datepicker-calendar'><thead><tr>",w=u?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",T=0;7>T;T++)D=(T+d)%7,w+="<th"+((T+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[D]+"'>"+p[D]+"</span></th>";for(M+=w+"</tr></thead><tbody>",I=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,I)),O=(this._getFirstDayOfMonth(et,Z)-d+7)%7,L=Math.ceil((O+I)/7),N=X&&this.maxRows>L?this.maxRows:L,this.maxRows=N,R=this._daylightSavingAdjust(new Date(et,Z,1-O)),k=0;N>k;k++){for(M+="<tr>",P=u?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(R)+"</td>":"",T=0;7>T;T++)F=g?g.apply(e.input?e.input[0]:null,[R]):[!0,""],H=R.getMonth()!==Z,B=H&&!_||!F[0]||Q&&Q>R||J&&R>J,P+="<td class='"+((T+d+6)%7>=5?" ui-datepicker-week-end":"")+(H?" ui-datepicker-other-month":"")+(R.getTime()===E.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===R.getTime()&&b.getTime()===E.getTime()?" "+this._dayOverClass:"")+(B?" "+this._unselectableClass+" ui-state-disabled":"")+(H&&!v?"":" "+F[1]+(R.getTime()===K.getTime()?" "+this._currentClass:"")+(R.getTime()===U.getTime()?" ui-datepicker-today":""))+"'"+(H&&!v||!F[2]?"":" title='"+F[2].replace(/'/g,"&#39;")+"'")+(B?"":" data-handler='selectDay' data-event='click' data-month='"+R.getMonth()+"' data-year='"+R.getFullYear()+"'")+">"+(H&&!v?"&#xa0;":B?"<span class='ui-state-default'>"+R.getDate()+"</span>":"<a class='ui-state-default"+(R.getTime()===U.getTime()?" ui-state-highlight":"")+(R.getTime()===K.getTime()?" ui-state-active":"")+(H?" ui-priority-secondary":"")+"' href='#'>"+R.getDate()+"</a>")+"</td>",R.setDate(R.getDate()+1),R=this._daylightSavingAdjust(R);M+=P+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(X?"</div>"+($[0]>0&&C===$[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),A+=M}y+=A}return y+=c,e._keyEvent=!1,y},_generateMonthYearHeader:function(e,t,i,n,o,s,r,a){var l,c,d,u,h,p,m,f,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),_=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(s||!g)y+="<span class='ui-datepicker-month'>"+r[t]+"</span>";else{for(l=n&&n.getFullYear()===i,c=o&&o.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;12>d;d++)(!l||d>=n.getMonth())&&(!c||d<=o.getMonth())&&(y+="<option value='"+d+"'"+(d===t?" selected='selected'":"")+">"+a[d]+"</option>");y+="</select>"}if(_||(b+=y+(!s&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},m=p(u[0]),f=Math.max(m,p(u[1]||"")),m=n?Math.max(m,n.getFullYear()):m,f=o?Math.min(f,o.getFullYear()):f,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f>=m;m++)e.yearshtml+="<option value='"+m+"'"+(m===i?" selected='selected'":"")+">"+m+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),_&&(b+=(!s&&g&&v?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(e,t,i){var n=e.drawYear+("Y"===i?t:0),o=e.drawMonth+("M"===i?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(n,o))+("D"===i?t:0),r=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,o,s)));e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),o=i&&i>t?i:t;return n&&o>n?n:o},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var o=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(i,n+(0>t?t:o[0]*o[1]),1));return 0>t&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var i,n,o=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),r=null,a=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),r=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(r+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!o||t.getTime()>=o.getTime())&&(!s||t.getTime()<=s.getTime())&&(!r||t.getFullYear()>=r)&&(!a||t.getFullYear()<=a)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var o=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),o,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e("<div class='visualizejs'></div>").append(e.datepicker.dpDiv));var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="@VERSION"}(t),function(e){var t={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"@VERSION",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,n=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(o){}this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!t&&this._trigger("focus",e),i},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),o=i.filter(":last");t.target!==o[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==n[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(o.focus(1),t.preventDefault()):(n.focus(1),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(i,function(i,n){var o,s;n=e.isFunction(n)?{click:n,text:i}:n,n=e.extend({type:"button"},n),o=n.click,n.click=function(){o.apply(t.element[0],arguments)},s={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,e("<button></button>",n).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,o){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,t(o))},drag:function(e,n){i._trigger("drag",e,t(n))},stop:function(o,s){n.position=[s.position.left-i.document.scrollLeft(),s.position.top-i.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",o,t(s))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,n=this.options,o=n.resizable,s=this.uiDialog.css("position"),r="string"==typeof o?o:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:r,start:function(n,o){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,t(o))},resize:function(e,n){i._trigger("resize",e,t(n))},stop:function(o,s){n.height=e(this).height(),n.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",o,t(s))}}).css("position",s)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(n){var o=this,s=!1,r={};e.each(n,function(e,n){o._setOption(e,n),e in t&&(s=!0),e in i&&(r[e]=n)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(e,t){var i,n,o=this.uiDialog;"dialogClass"===e&&o.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=o.is(":data(ui-draggable)"),i&&!t&&o.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=o.is(":data(ui-resizable)"),n&&!t&&o.resizable("destroy"),n&&"string"==typeof t&&o.resizable("option","handles",t),n||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,i=this.widgetFullName;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(n){t._allowInteraction(n)||(n.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t,i=this.options.position,n=[],o=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(n=i.split?i.split(" "):[i[0],i[1]],1===n.length&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(o[e]=n[e],n[e]=t)}),i={my:n[0]+(o[0]<0?o[0]:"+"+o[0])+" "+n[1]+(o[1]<0?o[1]:"+"+o[1]),at:n.join(" ")}),i=e.extend({},e.ui.dialog.prototype.options.position,i)):i=e.ui.dialog.prototype.options.position,t=this.uiDialog.is(":visible"),t||this.uiDialog.show(),this.uiDialog.position(i),t||this.uiDialog.hide()}})}(t),function(e){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;e.effects.effect.blind=function(n,o){var s,r,a,l=e(this),c=["position","top","bottom","left","right","height","width"],d=e.effects.setMode(l,n.mode||"hide"),u=n.direction||"up",h=t.test(u),p=h?"height":"width",m=h?"top":"left",f=i.test(u),g={},v="show"===d;l.parent().is(".ui-effects-wrapper")?e.effects.save(l.parent(),c):e.effects.save(l,c),l.show(),s=e.effects.createWrapper(l).css({overflow:"hidden"}),r=s[p](),a=parseFloat(s.css(m))||0,g[p]=v?r:0,f||(l.css(h?"bottom":"right",0).css(h?"top":"left","auto").css({position:"absolute"}),g[m]=v?a:r+a),v&&(s.css(p,0),f||s.css(m,a+r)),s.animate(g,{duration:n.duration,easing:n.easing,queue:!1,complete:function(){"hide"===d&&l.hide(),e.effects.restore(l,c),e.effects.removeWrapper(l),o()}})}}(t),function(e){e.effects.effect.bounce=function(t,i){var n,o,s,r=e(this),a=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(r,t.mode||"effect"),c="hide"===l,d="show"===l,u=t.direction||"up",h=t.distance,p=t.times||5,m=2*p+(d||c?1:0),f=t.duration/m,g=t.easing,v="up"===u||"down"===u?"top":"left",_="up"===u||"left"===u,b=r.queue(),y=b.length;for((d||c)&&a.push("opacity"),e.effects.save(r,a),r.show(),e.effects.createWrapper(r),h||(h=r["top"===v?"outerHeight":"outerWidth"]()/3),d&&(s={opacity:1},s[v]=0,r.css("opacity",0).css(v,_?2*-h:2*h).animate(s,f,g)),c&&(h/=Math.pow(2,p-1)),s={},s[v]=0,n=0;p>n;n++)o={},o[v]=(_?"-=":"+=")+h,r.animate(o,f,g).animate(s,f,g),h=c?2*h:h/2;c&&(o={opacity:0},o[v]=(_?"-=":"+=")+h,r.animate(o,f,g)),r.queue(function(){c&&r.hide(),e.effects.restore(r,a),e.effects.removeWrapper(r),i()}),y>1&&b.splice.apply(b,[1,0].concat(b.splice(y,m+1))),r.dequeue()}}(t),function(e){e.effects.effect.clip=function(t,i){var n,o,s,r=e(this),a=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(r,t.mode||"hide"),c="show"===l,d=t.direction||"vertical",u="vertical"===d,h=u?"height":"width",p=u?"top":"left",m={};e.effects.save(r,a),r.show(),n=e.effects.createWrapper(r).css({overflow:"hidden"}),o="IMG"===r[0].tagName?n:r,s=o[h](),c&&(o.css(h,0),o.css(p,s/2)),m[h]=c?s:0,m[p]=c?0:s/2,o.animate(m,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){c||r.hide(),e.effects.restore(r,a),e.effects.removeWrapper(r),i()}})}}(t),function(e){e.effects.effect.drop=function(t,i){var n,o=e(this),s=["position","top","bottom","left","right","opacity","height","width"],r=e.effects.setMode(o,t.mode||"hide"),a="show"===r,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",d="up"===l||"left"===l?"pos":"neg",u={opacity:a?1:0};e.effects.save(o,s),o.show(),e.effects.createWrapper(o),n=t.distance||o["top"===c?"outerHeight":"outerWidth"](!0)/2,a&&o.css("opacity",0).css(c,"pos"===d?-n:n),u[c]=(a?"pos"===d?"+=":"-=":"pos"===d?"-=":"+=")+n,o.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&o.hide(),e.effects.restore(o,s),e.effects.removeWrapper(o),i()}})}}(t),function(e){e.effects.effect.explode=function(t,i){function n(){b.push(this),b.length===u*h&&o()}function o(){p.css({visibility:"visible"}),e(b).remove(),f||p.hide(),i()}var s,r,a,l,c,d,u=t.pieces?Math.round(Math.sqrt(t.pieces)):3,h=u,p=e(this),m=e.effects.setMode(p,t.mode||"hide"),f="show"===m,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/h),_=Math.ceil(p.outerHeight()/u),b=[];for(s=0;u>s;s++)for(l=g.top+s*_,d=s-(u-1)/2,r=0;h>r;r++)a=g.left+r*v,c=r-(h-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-r*v,top:-s*_}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:_,left:a+(f?c*v:0),top:l+(f?d*_:0),opacity:f?0:1}).animate({left:a+(f?0:c*v),top:l+(f?0:d*_),opacity:f?1:0},t.duration||500,t.easing,n)}}(t),function(e){e.effects.effect.fade=function(t,i){var n=e(this),o=e.effects.setMode(n,t.mode||"toggle");n.animate({opacity:o},{queue:!1,duration:t.duration,easing:t.easing,complete:i})}}(t),function(e){e.effects.effect.fold=function(t,i){var n,o,s=e(this),r=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(s,t.mode||"hide"),l="show"===a,c="hide"===a,d=t.size||15,u=/([0-9]+)%/.exec(d),h=!!t.horizFirst,p=l!==h,m=p?["width","height"]:["height","width"],f=t.duration/2,g={},v={};e.effects.save(s,r),s.show(),n=e.effects.createWrapper(s).css({overflow:"hidden"}),o=p?[n.width(),n.height()]:[n.height(),n.width()],u&&(d=parseInt(u[1],10)/100*o[c?0:1]),l&&n.css(h?{height:0,width:d}:{height:d,width:0}),g[m[0]]=l?o[0]:d,v[m[1]]=l?o[1]:0,n.animate(g,f,t.easing).animate(v,f,t.easing,function(){c&&s.hide(),e.effects.restore(s,r),e.effects.removeWrapper(s),i()})}}(t),function(e){e.effects.effect.highlight=function(t,i){var n=e(this),o=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(n,t.mode||"show"),r={backgroundColor:n.css("backgroundColor")};"hide"===s&&(r.opacity=0),e.effects.save(n,o),n.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(r,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&n.hide(),e.effects.restore(n,o),i()}})}}(t),function(e){e.effects.effect.pulsate=function(t,i){var n,o=e(this),s=e.effects.setMode(o,t.mode||"show"),r="show"===s,a="hide"===s,l=r||"hide"===s,c=2*(t.times||5)+(l?1:0),d=t.duration/c,u=0,h=o.queue(),p=h.length;for((r||!o.is(":visible"))&&(o.css("opacity",0).show(),u=1),n=1;c>n;n++)o.animate({opacity:u},d,t.easing),u=1-u;o.animate({opacity:u},d,t.easing),o.queue(function(){a&&o.hide(),i()}),p>1&&h.splice.apply(h,[1,0].concat(h.splice(p,c+1))),o.dequeue()}}(t),function(e){e.effects.effect.puff=function(t,i){var n=e(this),o=e.effects.setMode(n,t.mode||"hide"),s="hide"===o,r=parseInt(t.percent,10)||150,a=r/100,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:o,complete:i,percent:s?r:100,from:s?l:{height:l.height*a,width:l.width*a,outerHeight:l.outerHeight*a,outerWidth:l.outerWidth*a}}),n.effect(t)},e.effects.effect.scale=function(t,i){var n=e(this),o=e.extend(!0,{},t),s=e.effects.setMode(n,t.mode||"effect"),r=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===s?0:100),a=t.direction||"both",l=t.origin,c={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},d={y:"horizontal"!==a?r/100:1,x:"vertical"!==a?r/100:1};o.effect="size",o.queue=!1,o.complete=i,"effect"!==s&&(o.origin=l||["middle","center"],o.restore=!0),o.from=t.from||("show"===s?{height:0,width:0,outerHeight:0,outerWidth:0}:c),o.to={height:c.height*d.y,width:c.width*d.x,outerHeight:c.outerHeight*d.y,outerWidth:c.outerWidth*d.x},o.fade&&("show"===s&&(o.from.opacity=0,o.to.opacity=1),"hide"===s&&(o.from.opacity=1,o.to.opacity=0)),n.effect(o)},e.effects.effect.size=function(t,i){var n,o,s,r=e(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],c=["width","height","overflow"],d=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(r,t.mode||"effect"),m=t.restore||"effect"!==p,f=t.scale||"both",g=t.origin||["middle","center"],v=r.css("position"),_=m?a:l,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&r.show(),n={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},"toggle"===t.mode&&"show"===p?(r.from=t.to||b,r.to=t.from||n):(r.from=t.from||("show"===p?b:n),r.to=t.to||("hide"===p?b:n)),s={from:{y:r.from.height/n.height,x:r.from.width/n.width},to:{y:r.to.height/n.height,x:r.to.width/n.width}},("box"===f||"both"===f)&&(s.from.y!==s.to.y&&(_=_.concat(u),r.from=e.effects.setTransition(r,u,s.from.y,r.from),r.to=e.effects.setTransition(r,u,s.to.y,r.to)),s.from.x!==s.to.x&&(_=_.concat(h),r.from=e.effects.setTransition(r,h,s.from.x,r.from),r.to=e.effects.setTransition(r,h,s.to.x,r.to))),("content"===f||"both"===f)&&s.from.y!==s.to.y&&(_=_.concat(d).concat(c),r.from=e.effects.setTransition(r,d,s.from.y,r.from),r.to=e.effects.setTransition(r,d,s.to.y,r.to)),e.effects.save(r,_),r.show(),e.effects.createWrapper(r),r.css("overflow","hidden").css(r.from),g&&(o=e.effects.getBaseline(g,n),r.from.top=(n.outerHeight-r.outerHeight())*o.y,r.from.left=(n.outerWidth-r.outerWidth())*o.x,r.to.top=(n.outerHeight-r.to.outerHeight)*o.y,r.to.left=(n.outerWidth-r.to.outerWidth)*o.x),r.css(r.from),("content"===f||"both"===f)&&(u=u.concat(["marginTop","marginBottom"]).concat(d),h=h.concat(["marginLeft","marginRight"]),c=a.concat(u).concat(h),r.find("*[width]").each(function(){var i=e(this),n={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};m&&e.effects.save(i,c),i.from={height:n.height*s.from.y,width:n.width*s.from.x,outerHeight:n.outerHeight*s.from.y,outerWidth:n.outerWidth*s.from.x},i.to={height:n.height*s.to.y,width:n.width*s.to.x,outerHeight:n.height*s.to.y,outerWidth:n.width*s.to.x},s.from.y!==s.to.y&&(i.from=e.effects.setTransition(i,u,s.from.y,i.from),i.to=e.effects.setTransition(i,u,s.to.y,i.to)),s.from.x!==s.to.x&&(i.from=e.effects.setTransition(i,h,s.from.x,i.from),i.to=e.effects.setTransition(i,h,s.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){m&&e.effects.restore(i,c)})})),r.animate(r.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===r.to.opacity&&r.css("opacity",r.from.opacity),"hide"===p&&r.hide(),e.effects.restore(r,_),m||("static"===v?r.css({position:"relative",top:r.to.top,left:r.to.left}):e.each(["top","left"],function(e,t){r.css(t,function(t,i){var n=parseInt(i,10),o=e?r.to.left:r.to.top;return"auto"===i?o+"px":n+o+"px"})})),e.effects.removeWrapper(r),i()}})}}(t),function(e){e.effects.effect.shake=function(t,i){var n,o=e(this),s=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(o,t.mode||"effect"),a=t.direction||"left",l=t.distance||20,c=t.times||3,d=2*c+1,u=Math.round(t.duration/d),h="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,m={},f={},g={},v=o.queue(),_=v.length;for(e.effects.save(o,s),o.show(),e.effects.createWrapper(o),m[h]=(p?"-=":"+=")+l,f[h]=(p?"+=":"-=")+2*l,g[h]=(p?"-=":"+=")+2*l,o.animate(m,u,t.easing),n=1;c>n;n++)o.animate(f,u,t.easing).animate(g,u,t.easing);o.animate(f,u,t.easing).animate(m,u/2,t.easing).queue(function(){"hide"===r&&o.hide(),e.effects.restore(o,s),e.effects.removeWrapper(o),i()}),_>1&&v.splice.apply(v,[1,0].concat(v.splice(_,d+1))),o.dequeue()}}(t),function(e){e.effects.effect.slide=function(t,i){var n,o=e(this),s=["position","top","bottom","left","right","width","height"],r=e.effects.setMode(o,t.mode||"show"),a="show"===r,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",d="up"===l||"left"===l,u={};e.effects.save(o,s),o.show(),n=t.distance||o["top"===c?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(o).css({overflow:"hidden"}),a&&o.css(c,d?isNaN(n)?"-"+n:-n:n),u[c]=(a?d?"+=":"-=":d?"-=":"+=")+n,o.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&o.hide(),e.effects.restore(o,s),e.effects.removeWrapper(o),i()}})}}(t),function(e){e.effects.effect.transfer=function(t,i){var n=e(this),o=e(t.to),s="fixed"===o.css("position"),r=e("body"),a=s?r.scrollTop():0,l=s?r.scrollLeft():0,c=o.offset(),d={top:c.top-a,left:c.left-l,height:o.innerHeight(),width:o.innerWidth()},u=n.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:u.top-a,left:u.left-l,height:n.innerHeight(),width:n.innerWidth(),position:s?"fixed":"absolute"}).animate(d,t.duration,t.easing,function(){h.remove(),i()
})}}(t),function(e){e.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,o,s,r,a,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,o=this.previousFilter||"",s=String.fromCharCode(t.keyCode),r=!1,clearTimeout(this.filterTimer),s===o?r=!0:s=o+s,a=new RegExp("^"+i(s),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(e(this).children("a").text())}),n=r&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(s=String.fromCharCode(t.keyCode),a=new RegExp("^"+i(s),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(e(this).children("a").text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,i=this.options.icons.submenu,n=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),n.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),n=t.prev("a"),o=e("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);n.attr("aria-haspopup","true").prepend(o),t.attr("aria-labelledby",n.attr("id"))}),t=n.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var i,n;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,n,o,s,r,a;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,o=t.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),r=this.activeMenu.height(),a=t.height(),0>o?this.activeMenu.scrollTop(s+o):o+a>r&&this.activeMenu.scrollTop(s+o-r+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(t),this.activeMenu=n},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(i,n)},nextPage:function(t){var i,n,o;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n-o<0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var i,n,o;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n+o>0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}(t),function(e,t){function i(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function n(t,i){return parseInt(e.css(t,i),10)||0}function o(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var s,r=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,d=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,m=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var i,n,o=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=o.children()[0];return e("body").append(o),i=r.offsetWidth,o.css("overflow","scroll"),n=r.offsetWidth,i===n&&(n=o[0].clientWidth),o.remove(),s=i-n},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),o="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,s="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]),o=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:o,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return m.apply(this,arguments);t=e.extend({},t);var s,p,f,g,v,_,b=e(t.of),y=e.position.getWithinInfo(t.within),T=e.position.getScrollInfo(y),S=(t.collision||"flip").split(" "),A={};return _=o(b),b[0].preventDefault&&(t.at="left top"),p=_.width,f=_.height,g=_.offset,v=e.extend({},g),e.each(["my","at"],function(){var e,i,n=(t[this]||"").split(" ");1===n.length&&(n=c.test(n[0])?n.concat(["center"]):d.test(n[0])?["center"].concat(n):["center","center"]),n[0]=c.test(n[0])?n[0]:"center",n[1]=d.test(n[1])?n[1]:"center",e=u.exec(n[0]),i=u.exec(n[1]),A[this]=[e?e[0]:0,i?i[0]:0],t[this]=[h.exec(n[0])[0],h.exec(n[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===t.at[0]?v.left+=p:"center"===t.at[0]&&(v.left+=p/2),"bottom"===t.at[1]?v.top+=f:"center"===t.at[1]&&(v.top+=f/2),s=i(A.at,p,f),v.left+=s[0],v.top+=s[1],this.each(function(){var o,c,d=e(this),u=d.outerWidth(),h=d.outerHeight(),m=n(this,"marginLeft"),_=n(this,"marginTop"),C=u+m+n(this,"marginRight")+T.width,E=h+_+n(this,"marginBottom")+T.height,x=e.extend({},v),M=i(A.my,d.outerWidth(),d.outerHeight());"right"===t.my[0]?x.left-=u:"center"===t.my[0]&&(x.left-=u/2),"bottom"===t.my[1]?x.top-=h:"center"===t.my[1]&&(x.top-=h/2),x.left+=M[0],x.top+=M[1],e.support.offsetFractions||(x.left=l(x.left),x.top=l(x.top)),o={marginLeft:m,marginTop:_},e.each(["left","top"],function(i,n){e.ui.position[S[i]]&&e.ui.position[S[i]][n](x,{targetWidth:p,targetHeight:f,elemWidth:u,elemHeight:h,collisionPosition:o,collisionWidth:C,collisionHeight:E,offset:[s[0]+M[0],s[1]+M[1]],my:t.my,at:t.at,within:y,elem:d})}),t.using&&(c=function(e){var i=g.left-x.left,n=i+p-u,o=g.top-x.top,s=o+f-h,l={target:{element:b,left:g.left,top:g.top,width:p,height:f},element:{element:d,left:x.left,top:x.top,width:u,height:h},horizontal:0>n?"left":i>0?"right":"center",vertical:0>s?"top":o>0?"bottom":"middle"};u>p&&a(i+n)<p&&(l.horizontal="center"),h>f&&a(o+s)<f&&(l.vertical="middle"),l.important=r(a(i),a(n))>r(a(o),a(s))?"horizontal":"vertical",t.using.call(this,e,l)}),d.offset(e.extend(x,{using:c}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,a=e.left-t.collisionPosition.marginLeft,l=o-a,c=a+t.collisionWidth-s-o;t.collisionWidth>s?l>0&&0>=c?(i=e.left+l+t.collisionWidth-s-o,e.left+=l-i):e.left=c>0&&0>=l?o:l>c?o+s-t.collisionWidth:o:l>0?e.left+=l:c>0?e.left-=c:e.left=r(e.left-a,e.left)},top:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,a=e.top-t.collisionPosition.marginTop,l=o-a,c=a+t.collisionHeight-s-o;t.collisionHeight>s?l>0&&0>=c?(i=e.top+l+t.collisionHeight-s-o,e.top+=l-i):e.top=c>0&&0>=l?o:l>c?o+s-t.collisionHeight:o:l>0?e.top+=l:c>0?e.top-=c:e.top=r(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,o=t.within,s=o.offset.left+o.scrollLeft,r=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=e.left-t.collisionPosition.marginLeft,d=c-l,u=c+t.collisionWidth-r-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,m=-2*t.offset[0];0>d?(i=e.left+h+p+m+t.collisionWidth-r-s,(0>i||i<a(d))&&(e.left+=h+p+m)):u>0&&(n=e.left-t.collisionPosition.marginLeft+h+p+m-l,(n>0||a(n)<u)&&(e.left+=h+p+m))},top:function(e,t){var i,n,o=t.within,s=o.offset.top+o.scrollTop,r=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=e.top-t.collisionPosition.marginTop,d=c-l,u=c+t.collisionHeight-r-l,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,m="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,f=-2*t.offset[1];0>d?(n=e.top+p+m+f+t.collisionHeight-r-s,e.top+p+m+f>d&&(0>n||n<a(d))&&(e.top+=p+m+f)):u>0&&(i=e.top-t.collisionPosition.marginTop+p+m+f-l,e.top+p+m+f>u&&(i>0||a(i)<u)&&(e.top+=p+m+f))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,o,s,r=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in n)t.style[s]=n[s];t.appendChild(a),i=r||document.documentElement,i.insertBefore(t,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",o=e(a).offset().left,e.support.offsetFractions=o>10&&11>o,t.innerHTML="",i.removeChild(t)}()}(t),function(e,t){e.widget("ui.progressbar",{version:"@VERSION",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(t),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,n=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",r=[];for(i=n.values&&n.values.length||1,o.length>i&&(o.slice(i).remove(),o=o.slice(0,i)),t=o.length;i>t;t++)r.push(s);this.handles=o.add(e(r.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,n,o,s,r,a,l,c,d=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(i),o=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(n-d.values(t));(o>i||o===i&&(t===d._lastChangedValue||d.values(t)===u.min))&&(o=i,s=e(this),r=t)}),a=this._start(t,r),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=r,s.addClass("ui-state-active").focus(),l=s.offset(),c=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-s.width()/2,top:t.pageY-l.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,r,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,o,s;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/t,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),o=this._valueMax()-this._valueMin(),s=this._valueMin()+n*o,this._trimAlignValue(s)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n,o,s;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>n||1===t&&n>i)&&(i=n),i!==this.values(t)&&(o=this.values(),o[t]=i,s=this._trigger("slide",e,{handle:this.handles[t],value:i,values:o}),n=this.values(t?0:1),s!==!1&&this.values(t,i))):i!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:i}),s!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,i){var n,o,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(n=this.options.values,o=arguments[0],s=0;s<n.length;s+=1)n[s]=this._trimAlignValue(o[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,i){var n,o=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(o=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;o>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=i>0?t:-t),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,n,o,s,r=this.options.range,a=this.options,l=this,c=this._animateOff?!1:a.animate,d={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,d["horizontal"===l.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[c?"animate":"css"](d,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:a.animate}))),t=i}):(n=this.value(),o=this._valueMin(),s=this._valueMax(),i=s!==o?(n-o)/(s-o)*100:0,d["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](d,a.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},a.animate),"max"===r&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},a.animate),"max"===r&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(i){var n,o,s,r,a=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(i.target).addClass("ui-state-active"),n=this._start(i,a),n===!1))return}switch(r=this.options.step,o=s=this.options.values&&this.options.values.length?this.values(a):this.value(),i.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(o===this._valueMax())return;s=this._trimAlignValue(o+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(o===this._valueMin())return;s=this._trimAlignValue(o-r)}this._slide(i,a,s)},click:function(e){e.preventDefault()},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}})}(t),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"@VERSION",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,n){var o=i.attr(n);void 0!==o&&o.length&&(t[n]=o)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,n=e.ui.keyCode;switch(t.keyCode){case n.UP:return this._repeat(null,1,t),!0;case n.DOWN:return this._repeat(null,-1,t),!0;case n.PAGE_UP:return this._repeat(null,i.page,t),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1
},_adjustValue:function(e){var t,i,n=this.options;return t=null!==n.min?n.min:0,i=e-t,i=Math.round(i/n.step)*n.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==n.max&&e>n.max?n.max:null!==n.min&&e<n.min?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(i))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(t),function(e,t){function i(){return++o}function n(e){return e=e.cloneNode(!1),e.hash.length>1&&decodeURIComponent(e.href.replace(s,""))===decodeURIComponent(location.href.replace(s,""))}var o=0,s=/#.*$/;e.widget("ui.tabs",{version:"@VERSION",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===t&&(n&&this.tabs.each(function(i,o){return e(o).attr("aria-controls")===n?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),o=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:n++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:o=!1,n--;break;case e.ui.keyCode.END:n=this.anchors.length-1;break;case e.ui.keyCode.HOME:n=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n===this.options.active?!1:n);default:return}t.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,o),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function n(){return t>o&&(t=0),0>t&&(t=o),t}for(var o=this.tabs.length-1;-1!==e.inArray(n(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,o){var s,r,a,l=e(o).uniqueId().attr("id"),c=e(o).closest("li"),d=c.attr("aria-controls");n(o)?(s=o.hash,r=t.element.find(t._sanitizeSelector(s))):(a=t._tabId(c),s="#"+a,r=t.element.find(s),r.length||(r=t._createPanel(a),r.insertAfter(t.panels[i-1]||t.tablist)),r.attr("aria-live","polite")),r.length&&(t.panels=t.panels.add(r)),d&&c.data("ui-tabs-aria-controls",d),c.attr({"aria-controls":s.substring(1),"aria-labelledby":l}),r.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,n=0;i=this.tabs[n];n++)t===!0||-1!==e.inArray(n,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,n=this.element.parent();"fill"===t?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,n=this.active,o=e(t.currentTarget),s=o.closest("li"),r=s[0]===n[0],a=r&&i.collapsible,l=a?e():this._getPanelForTab(s),c=n.length?this._getPanelForTab(n):e(),d={oldTab:n,oldPanel:c,newTab:a?e():s,newPanel:l};t.preventDefault(),s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||r&&!i.collapsible||this._trigger("beforeActivate",t,d)===!1||(i.active=a?!1:this.tabs.index(s),this.active=r?e():s,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(s),t),this._toggle(t,d))},_toggle:function(t,i){function n(){s.running=!1,s._trigger("activate",t,i)}function o(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&s.options.show?s._show(r,s.options.show,n):(r.show(),n())}var s=this,r=i.newPanel,a=i.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),o()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),r.length&&a.length?i.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),r.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var i,n=this._findActive(t);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var n=this.options.disabled;n!==!1&&(i===t?n=!1:(i=this._getIndex(i),n=e.isArray(n)?e.map(n,function(e){return e!==i?e:null}):e.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(n))},disable:function(i){var n=this.options.disabled;if(n!==!0){if(i===t)n=!0;else{if(i=this._getIndex(i),-1!==e.inArray(i,n))return;n=e.isArray(n)?e.merge([i],n).sort():[i]}this._setupDisabled(n)}},load:function(t,i){t=this._getIndex(t);var o=this,s=this.tabs.eq(t),r=s.find(".ui-tabs-anchor"),a=this._getPanelForTab(s),l={tab:s,panel:a};n(r[0])||(this.xhr=e.ajax(this._ajaxSettings(r,i,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(s.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){a.html(e),o._trigger("load",i,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&o.panels.stop(!1,!0),s.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===o.xhr&&delete o.xhr},1)})))},_ajaxSettings:function(t,i,n){var o=this;return{url:t.attr("href"),beforeSend:function(t,s){return o._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:s},n))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(t),function(e){function t(t,i){var n=(t.attr("aria-describedby")||"").split(/\s+/);n.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(n.join(" ")))}function i(t){var i=t.data("ui-tooltip-id"),n=(t.attr("aria-describedby")||"").split(/\s+/),o=e.inArray(i,n);-1!==o&&n.splice(o,1),t.removeData("ui-tooltip-id"),n=e.trim(n.join(" ")),n?t.attr("aria-describedby",n):t.removeAttr("aria-describedby")}var n=0;e.widget("ui.tooltip",{version:"@VERSION",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,i){var n=this;return"disabled"===t?(this[i?"_disable":"_enable"](),void(this.options[t]=i)):(this._super(t,i),void("content"===t&&e.each(this.tooltips,function(e,t){n._updateContent(t)})))},_disable:function(){var t=this;e.each(this.tooltips,function(i,n){var o=e.Event("blur");o.target=o.currentTarget=n[0],t.close(o,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,n=e(t?t.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&n.parents().each(function(){var t,n=e(this);n.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._updateContent(n,t))},_updateContent:function(e,t){var i,n=this.options.content,o=this,s=t?t.type:null;return"string"==typeof n?this._open(t,e,n):(i=n.call(e[0],function(i){e.data("ui-tooltip-open")&&o._delay(function(){t&&(t.type=s),this._open(t,e,i)})}),void(i&&this._open(t,e,i)))},_open:function(i,n,o){function s(e){c.of=e,r.is(":hidden")||r.position(c)}var r,a,l,c=e.extend({},this.options.position);if(o){if(r=this._find(n),r.length)return void r.find(".ui-tooltip-content").html(o);n.is("[title]")&&(i&&"mouseover"===i.type?n.attr("title",""):n.removeAttr("title")),r=this._tooltip(n),t(n,r.attr("id")),r.find(".ui-tooltip-content").html(o),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:s}),s(i)):r.position(e.extend({of:n},this.options.position)),r.hide(),this._show(r,this.options.show),this.options.show&&this.options.show.delay&&(l=this.delayedShow=setInterval(function(){r.is(":visible")&&(s(c.of),clearInterval(l))},e.fx.interval)),this._trigger("open",i,{tooltip:r}),a={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var i=e.Event(t);i.currentTarget=n[0],this.close(i,!0)}},remove:function(){this._removeTooltip(r)}},i&&"mouseover"!==i.type||(a.mouseleave="close"),i&&"focusin"!==i.type||(a.focusout="close"),this._on(!0,n,a)}},close:function(t){var n=this,o=e(t?t.currentTarget:this.element),s=this._find(o);this.closing||(clearInterval(this.delayedShow),o.data("ui-tooltip-title")&&o.attr("title",o.data("ui-tooltip-title")),i(o),s.stop(!0),this._hide(s,this.options.hide,function(){n._removeTooltip(e(this))}),o.removeData("ui-tooltip-open"),this._off(o,"mouseleave focusout keyup"),o[0]!==this.element[0]&&this._off(o,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete n.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:s}),this.closing=!1)},_tooltip:function(t){var i="ui-tooltip-"+n++,o=e("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(o),o.appendTo(this.document[0].body),this.tooltips[i]=t,o},_find:function(t){var i=t.data("ui-tooltip-id");return i?e("#"+i):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,n){var o=e.Event("blur");o.target=o.currentTarget=n[0],t.close(o,!0),e("#"+i).remove(),n.data("ui-tooltip-title")&&(n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))})}})}(t),t}),define("common/config/requestSettings",["require","jrs.configs"],function(e){var t=e("jrs.configs"),i=t.userLocale.replace(/_/g,"-");return{headers:{"X-Suppress-Basic":"true","Accept-Language":i,"Cache-Control":"no-cache, no-store",Pragma:"no-cache"}}}),function(e,t){"function"==typeof define&&define.amd?define("common/enum/loggingLevels",[],e):(t.logging||(t.logging={}),t.logging.loggingLevels=e())}(function(){return{DEBUG:100,INFO:200,WARN:300,ERROR:400}},this),function(e,t){"function"==typeof define&&define.amd?define("common/logging/Level",["common/enum/loggingLevels"],e):(t.logging||(t.logging={}),t.logging.Level=e(t.logging.loggingLevels))}(function(e){function t(e,t){this.level=e,this.name=t.toUpperCase()}t.prototype.isGreaterOrEqual=function(e){var i=(e instanceof t?e:t.getLevel(e)).level;return this.level>=i},t.prototype.toString=function(){return this.name},t.getLevel=function(e){return t[e.toUpperCase()]};for(var i in e)e.hasOwnProperty(i)&&(t[i]=new t(e[i],i));return t},this),function(e,t){"function"==typeof define&&define.amd?define("common/logging/LogItem",[],e):(t.logging||(t.logging={}),t.logging.LogItem=e())}(function(){function e(e){var t,i=e.getHours().toString(),n=e.getMinutes().toString(),o=e.getSeconds().toString(),s=e.getMilliseconds();return 1==i.length&&(i="0"+i),1==n.length&&(n="0"+n),1==o.length&&(o="0"+o),t=i+":"+n+":"+o+"."+s}function t(e){for(var t in e)if(e.hasOwnProperty(t)){if("args"===t)for(var i=0,n=e[t].length;n>i;i++)e[t][i]instanceof Error&&(e[t][i]=e[t][i].message);this[t]=e[t]}}return t.prototype.toArray=function(){var t=[];return t.push(e(this.time)),t.push("["+this.id+"]"),"unknown"!==this.file&&t.push("["+this.file+":"+this.line+"]"),t.push("["+this.level.toString()+"] -"),t=t.concat(this.args)},t},this),function(e,t){"function"==typeof define&&define.amd?define("common/logging/Log",["common/logging/Level","common/logging/LogItem"],e):(t.logging||(t.logging={}),t.logging.Log=e(t.logging.Level,t.logging.LogItem))}(function(e,t){function i(t){return function(){return this._prepareLogItem({level:e.getLevel(t),args:arguments})}}function n(e,t){this._id=e.id,this._callback=t}return n.prototype._prepareLogItem=function(e){e.id=this._id,e.args=Array.prototype.slice.call(e.args,0),e.time=new Date;var i=(new Error).stack;if(i){var n=i.split("\n")[2],o=n.match(/\/(\w+\.\w+):(\d+)/i);o&&(e.file=o[1],e.line=o[2])}return e.file||(e.file="unknown",e.line="0"),e=new t(e),this._callback(e),e},n.prototype.debug=i("debug"),n.prototype.info=i("info"),n.prototype.warn=i("warn"),n.prototype.error=i("error"),n},this),function(e,t){"function"==typeof define&&define.amd?define("common/logging/appender/ConsoleAppender",[],e):(t.logging||(t.logging={}),t.logging.appender||(t.logging.appender={}),t.logging.appender.ConsoleAppender=e())}(function(){function e(){}return e.prototype.console=function(){if("undefined"==typeof console){var e=function(){};return{assert:e,clear:e,count:e,debug:e,dir:e,dirxml:e,error:e,group:e,groupCollapsed:e,groupEnd:e,info:e,log:e,markTimeline:e,profile:e,profileEnd:e,table:e,time:e,timeEnd:e,timeStamp:e,trace:e,warn:e}}return console}(),e.prototype.write=function(e){var t=this.console.log;switch(e.level.toString()){case"DEBUG":t=this.console.debug||this.console.log;break;case"INFO":t=this.console.info||this.console.log;break;case"WARN":t=this.console.warn;break;case"ERROR":t=this.console.error}try{t.apply(this.console,e.toArray())}catch(i){try{Function.prototype.apply.call(t,this.console,e.toArray())}catch(n){}}},e},this),function(e,t,i){"function"==typeof define&&define.amd?define("common/logging/LoggerManager",["underscore","common/logging/Log","common/logging/Level","common/logging/appender/ConsoleAppender"],e):(t.logging||(t.logging={}),t.logging.LoggerManager=e(i,t.logging.Log,t.logging.Level,t.logging.appender.ConsoleAppender))}(function(e,t,i,n){var o={console:n},s=function(e){this.initialize(e||{})};return e.extend(s.prototype,{defaults:function(){return{enabled:!1,level:"error",appenders:{},appenderInstances:{},loggers:{}}},initialize:function(t){this.attributes=e.defaults(t,this.defaults());var i={};e.each(o,function(e,t){i[t]=new e}),this.set("appenderInstances",i)},get:function(e){return this.attributes[e]},set:function(e,t){this.attributes[e]=t},register:function(i){var n={id:"root"};if("string"==typeof i&&""!==i?n.id=i:i&&i.hasOwnProperty("id")&&(n.id=i.id),!this.get("loggers").hasOwnProperty(n.id)){var o=this.get("loggers");o[n.id]=new t(n,e.bind(this._processLogItem,this)),this.set("loggers",o)}return this.get("loggers")[n.id]},disable:function(){this.set("enabled",!1)},enable:function(e){e&&this.set("level",i.getLevel(e)),this.set("enabled",!0)},setLevel:function(e){this.set("level",e)},_processLogItem:function(e){this.get("enabled")&&e.level.isGreaterOrEqual(this.get("level"))&&this._appendLogItem(e)},_appendLogItem:function(e){var t=this.get("appenders"),i=this.get("appenderInstances");for(var n in t)i.hasOwnProperty(t[n])&&i[t[n]].write(e)}}),s},this,this._),define("logger",["require","exports","module","common/logging/LoggerManager"],function(e,t,i){var n=e("common/logging/LoggerManager"),o=i.config(),s=new n(o);return s}),function(e){define("xdm",["json3","logger"],e)}(function(e,t){function i(e,t){var i=typeof e[t];return"function"==i||!("object"!=i||!e[t])||"unknown"==i}function n(e,t){return!("object"!=typeof e[t]||!e[t])}function o(e){return"[object Array]"===Object.prototype.toString.call(e)}function s(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!f(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var i=navigator.plugins[e].description;i&&!f(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(C=i.match(/\d+/g))}if(!C){var n;try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),C=Array.prototype.slice.call(n.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),n=null}catch(o){}}if(!C)return!1;var s=parseInt(C[0],10),r=parseInt(C[1],10);return E=s>9&&r>0,!0}function r(){if(!z){z=!0,U("firing dom_onReady");for(var e=0;e<G.length;e++)G[e]();G.length=0}}function a(e,t){return z?void e.call(t):void G.push(function(){e.call(t)})}function l(){var e=parent;if(""!==P)for(var t=0,i=P.split(".");t<i.length;t++)e=e[i[t]];return e.easyXDM}function c(e){return U("Settings namespace to '"+e+"'"),window.easyXDM=H,P=e,P&&(B="easyXDM_"+P.replace(".","_")+"_"),F}function d(e){return e.match(N)[3]}function u(e){return e.match(N)[4]||""}function h(e){var t=e.toLowerCase().match(N),i=t[2],n=t[3],o=t[4]||"";return("http:"==i&&":80"==o||"https:"==i&&":443"==o)&&(o=""),i+"//"+n+o}function p(e){if(e=e.replace(k,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":location.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=location.protocol+"//"+location.host+t+e}for(;R.test(e);)e=e.replace(R,"");return U("resolved url '"+e+"'"),e}function m(e,t){var i="",n=e.indexOf("#");-1!==n&&(i=e.substring(n),e=e.substring(0,n));var o=[];for(var s in t)t.hasOwnProperty(s)&&o.push(s+"="+encodeURIComponent(t[s]));return e+(V?"#":-1==e.indexOf("?")?"?":"&")+o.join("&")+i}function f(e){return"undefined"==typeof e}function g(e,t,i){var n;for(var o in t)t.hasOwnProperty(o)&&(o in e?(n=t[o],"object"==typeof n?g(e[o],n,i):i||(e[o]=t[o])):e[o]=t[o]);return e}function v(){var e=document.body.appendChild(document.createElement("form")),t=e.appendChild(document.createElement("input"));t.name=B+"TEST"+O,A=t!==e.elements[t.name],document.body.removeChild(e),U("HAS_NAME_PROPERTY_BUG: "+A)}function _(e){U("creating frame: "+e.props.src),f(A)&&v();var t;A?t=document.createElement('<iframe name="'+e.props.name+'"/>'):(t=document.createElement("IFRAME"),t.name=e.props.name),t.id=t.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=document.getElementById(e.container)),e.container||(g(t.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=document.body);var i=e.props.src;if(e.props.src="javascript:false",g(t,e.props),t.border=t.frameBorder=0,t.allowTransparency=!0,e.container.appendChild(t),e.onLoad&&x(t,"load",e.onLoad),e.usePost){var n,o=e.container.appendChild(document.createElement("form"));if(o.target=t.name,o.action=i,o.method="POST","object"==typeof e.usePost)for(var s in e.usePost)e.usePost.hasOwnProperty(s)&&(A?n=document.createElement('<input name="'+s+'"/>'):(n=document.createElement("INPUT"),n.name=s),n.value=e.usePost[s],o.appendChild(n));o.submit(),o.parentNode.removeChild(o)}else t.src=i;return e.props.src=i,t}function b(e,t){"string"==typeof e&&(e=[e]);for(var i,n=e.length;n--;)if(i=e[n],i=new RegExp("^"==i.substr(0,1)?i:"^"+i.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),i.test(t))return!0;return!1}function y(e){var t,n=e.protocol;if(e.isHost=e.isHost||f($.xdm_p),V=e.hash||!1,U("preparing transport stack"),e.props||(e.props={}),e.isHost)e.remote=p(e.remote),e.channel=e.channel||"default"+O++,e.secret=Math.random().toString(16).substring(2),f(n)?(n=h(location.href)==h(e.remote)?"4":i(window,"postMessage")||i(document,"postMessage")?"1":e.swf&&i(window,"ActiveXObject")&&s()?"6":"Gecko"===navigator.product&&"frameElement"in window&&-1==navigator.userAgent.indexOf("WebKit")?"5":e.remoteHelper?"2":"0",U("selecting protocol: "+n)):U("using protocol: "+n);else if(U("using parameters from query"),e.channel=$.xdm_c.replace(/["'<>\\]/g,""),e.secret=$.xdm_s,e.remote=$.xdm_e.replace(/["'<>\\]/g,""),n=$.xdm_p,e.acl&&!b(e.acl,e.remote))throw new Error("Access denied for "+e.remote);switch(e.protocol=n,n){case"0":if(g(e,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),e.isHost){if(!e.local){U("looking for image to use as local");for(var o,r=location.protocol+"//"+location.host,a=document.body.getElementsByTagName("img"),l=a.length;l--;)if(o=a[l],o.src.substring(0,r.length)===r){e.local=o.src;break}e.local||(U("no image found, defaulting to using the window"),e.local=window)}var c={xdm_c:e.channel,xdm_p:0};e.local===window?(e.usePolling=!0,e.useParent=!0,e.local=location.protocol+"//"+location.host+location.pathname+location.search,c.xdm_e=e.local,c.xdm_pa=1):c.xdm_e=p(e.local),e.container&&(e.useResize=!1,c.xdm_po=1),e.remote=m(e.remote,c)}else g(e,{channel:$.xdm_c,remote:$.xdm_e,useParent:!f($.xdm_pa),usePolling:!f($.xdm_po),useResize:e.useParent?!1:e.useResize});t=[new F.stack.HashTransport(e),new F.stack.ReliableBehavior({}),new F.stack.QueueBehavior({encode:!0,maxLength:4e3-e.remote.length}),new F.stack.VerifyBehavior({initiate:e.isHost})];break;case"1":t=[new F.stack.PostMessageTransport(e)];break;case"2":e.isHost&&(e.remoteHelper=p(e.remoteHelper)),t=[new F.stack.NameTransport(e),new F.stack.QueueBehavior,new F.stack.VerifyBehavior({initiate:e.isHost})];break;case"3":t=[new F.stack.NixTransport(e)];break;case"4":t=[new F.stack.SameOriginTransport(e)];break;case"5":t=[new F.stack.FrameElementTransport(e)];break;case"6":C||s(),t=[new F.stack.FlashTransport(e)]}return t.push(new F.stack.QueueBehavior({lazy:e.lazy,remove:!0})),t}function T(e){for(var t,i={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},n=0,o=e.length;o>n;n++)t=e[n],g(t,i,!0),0!==n&&(t.down=e[n-1]),n!==o-1&&(t.up=e[n+1]);return t}function S(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}if("undefined"==typeof document)return{};var A,C,E,x,M,w=window.setTimeout,D=t.register("EasyXDM"),I=this,O=Math.floor(1e4*Math.random()),L=Function.prototype,N=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,R=/[\-\w]+\/\.\.\//,k=/([^:])\/\//g,P="",F={},H=window.easyXDM,B="easyXDM_",V=!1,U=L;if(i(window,"addEventListener"))x=function(e,t,i){U("adding listener "+t),e.addEventListener(t,i,!1)},M=function(e,t,i){U("removing listener "+t),e.removeEventListener(t,i,!1)};else{if(!i(window,"attachEvent"))throw new Error("Browser not supported");x=function(e,t,i){U("adding listener "+t),e.attachEvent("on"+t,i)},M=function(e,t,i){U("removing listener "+t),e.detachEvent("on"+t,i)}}var j,z=!1,G=[];if("readyState"in document?(j=document.readyState,z="complete"==j||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==j||"interactive"==j)):z=!!document.body,!z){if(i(window,"addEventListener"))x(document,"DOMContentLoaded",r);else if(x(document,"readystatechange",function(){"complete"==document.readyState&&r()}),document.documentElement.doScroll&&window===top){var W=function(){if(!z){try{document.documentElement.doScroll("left")}catch(e){return void w(W,1)}r()}};W()}x(window,"load",r)}var $=function(e){e=e.substring(1).split("&");for(var t,i={},n=e.length;n--;)t=e[n].split("="),i[t[0]]=decodeURIComponent(t[1]);return i}(/xdm_e=/.test(location.search)?location.search:location.hash),q=function(){var e={},t={a:[1,2,3]},i='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===i?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===i&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=i.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(q=function(){return e},e):null)};g(F,{version:"2.4.19.1",query:$,stack:{},apply:g,getJSONObject:q,whenReady:a,noConflict:c});var Y={_deferred:[],flush:function(){this.trace("... deferred messages ...");
for(var e=0,t=this._deferred.length;t>e;e++)this.trace(this._deferred[e]);this._deferred.length=0,this.trace("... end of deferred messages ...")},getTime:function(){var e=new Date,t=e.getHours()+"",i=e.getMinutes()+"",n=e.getSeconds()+"",o=e.getMilliseconds()+"",s="000";return 1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),1==n.length&&(n="0"+n),o=s.substring(o.length)+o,t+":"+i+":"+n+"."+o},log:function(e){D.debug(location.host+(P?":"+P:"")+": "+e)},getTracer:function(e){var i=t.register(e);return function(e){i.debug(e)}}};return Y.log("easyXDM present on '"+location.href),F.Debug=Y,U=Y.getTracer("EasyXDM.{Private}"),F.DomHelper={on:x,un:M,requiresJSON:function(e){n(window,"JSON")?Y.log("native JSON found"):(Y.log("loading external JSON"),document.write('<script type="text/javascript" src="'+e+'"></script>'))}},function(){var e={};F.Fn={set:function(t,i){this._trace("storing function "+t),e[t]=i},get:function(t,i){if(this._trace("retrieving function "+t),e.hasOwnProperty(t)){var n=e[t];return n||this._trace(t+" not found"),i&&delete e[t],n}}},F.Fn._trace=Y.getTracer("easyXDM.Fn")}(),F.Socket=function(e){var t=Y.getTracer("easyXDM.Socket");t("constructor");var i=T(y(e).concat([{incoming:function(t,i){e.onMessage(t,i)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=h(e.remote);this.origin=h(e.remote),this.destroy=function(){i.destroy()},this.postMessage=function(e){i.outgoing(e,n)},i.init()},F.Rpc=function(e,t){var i=Y.getTracer("easyXDM.Rpc");if(i("constructor"),t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var o=t.local[n];"function"==typeof o&&(t.local[n]={method:o})}var s=T(y(e).concat([new F.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=h(e.remote),this.destroy=function(){s.destroy()},s.init()},F.stack.SameOriginTransport=function(e){var t=Y.getTracer("easyXDM.stack.SameOriginTransport");t("constructor");var i,n,o,s;return i={outgoing:function(e,t,i){o(e),i&&i()},destroy:function(){t("destroy"),n&&(n.parentNode.removeChild(n),n=null)},onDOMReady:function(){t("init"),s=h(e.remote),e.isHost?(g(e.props,{src:m(e.remote,{xdm_e:location.protocol+"//"+location.host+location.pathname,xdm_c:e.channel,xdm_p:4}),name:B+e.channel+"_provider"}),n=_(e),F.Fn.set(e.channel,function(e){return o=e,w(function(){i.up.callback(!0)},0),function(e){i.up.incoming(e,s)}})):(o=l().Fn.get(e.channel,!0)(function(e){i.up.incoming(e,s)}),w(function(){i.up.callback(!0)},0))},init:function(){a(i.onDOMReady,i)}}},F.stack.FlashTransport=function(e){function t(e){w(function(){n("received message"),o.up.incoming(e,r)},0)}function i(t){n("creating factory with SWF from "+t);var i=e.swf+"?host="+e.isHost,o="easyXDM_swf_"+Math.floor(1e4*Math.random());F.Fn.set("flash_loaded"+t.replace(/[\-.]/g,"_"),function(){F.stack.FlashTransport[t].swf=l=c.firstChild;for(var e=F.stack.FlashTransport[t].queue,i=0;i<e.length;i++)e[i]();e.length=0}),e.swfContainer?c="string"==typeof e.swfContainer?document.getElementById(e.swfContainer):e.swfContainer:(c=document.createElement("div"),g(c.style,E&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),document.body.appendChild(c));var s="callback=flash_loaded"+encodeURIComponent(t.replace(/[\-.]/g,"_"))+"&proto="+I.location.protocol+"&domain="+encodeURIComponent(d(I.location.href))+"&port="+encodeURIComponent(u(I.location.href))+"&ns="+encodeURIComponent(P);s+="&log=true",c.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+o+"' data='"+i+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+i+"'></param><param name='flashvars' value='"+s+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+s+"' allowScriptAccess='always' wmode='transparent' src='"+i+"' height='1' width='1'></embed></object>"}var n=Y.getTracer("easyXDM.stack.FlashTransport");n("constructor");var o,s,r,l,c;return o={outgoing:function(t,i,n){l.postMessage(e.channel,t.toString()),n&&n()},destroy:function(){n("destroy");try{l.destroyChannel(e.channel)}catch(t){}l=null,s&&(s.parentNode.removeChild(s),s=null)},onDOMReady:function(){n("init"),r=e.remote,F.Fn.set("flash_"+e.channel+"_init",function(){w(function(){n("firing onReady"),o.up.callback(!0)})}),F.Fn.set("flash_"+e.channel+"_onMessage",t),e.swf=p(e.swf);var a=d(e.swf),c=function(){F.stack.FlashTransport[a].init=!0,l=F.stack.FlashTransport[a].swf,l.createChannel(e.channel,e.secret,h(e.remote),e.isHost),e.isHost&&(E&&e.swfNoThrottle&&g(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),g(e.props,{src:m(e.remote,{xdm_e:h(location.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:B+e.channel+"_provider"}),s=_(e))};F.stack.FlashTransport[a]&&F.stack.FlashTransport[a].init?c():F.stack.FlashTransport[a]?F.stack.FlashTransport[a].queue.push(c):(F.stack.FlashTransport[a]={queue:[c]},i(a))},init:function(){a(o.onDOMReady,o)}}},F.stack.PostMessageTransport=function(e){function t(e){if(e.origin)return h(e.origin);if(e.uri)return h(e.uri);if(e.domain)return location.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function i(i){var s=t(i);n("received message '"+i.data+"' from "+s),s==l&&i.data.substring(0,e.channel.length+1)==e.channel+" "&&o.up.incoming(i.data.substring(e.channel.length+1),s)}var n=Y.getTracer("easyXDM.stack.PostMessageTransport");n("constructor");var o,s,r,l;return o={outgoing:function(t,i,n){r.postMessage(e.channel+" "+t,i||l),n&&n()},destroy:function(){n("destroy"),M(window,"message",i),s&&(r=null,s.parentNode.removeChild(s),s=null)},onDOMReady:function(){if(n("init"),l=h(e.remote),e.isHost){var t=function(a){a.data==e.channel+"-ready"&&(n("firing onReady"),r="postMessage"in s.contentWindow?s.contentWindow:s.contentWindow.document,M(window,"message",t),x(window,"message",i),w(function(){o.up.callback(!0)},0))};x(window,"message",t),g(e.props,{src:m(e.remote,{xdm_e:h(location.href),xdm_c:e.channel,xdm_p:1}),name:B+e.channel+"_provider"}),s=_(e)}else x(window,"message",i),r="postMessage"in window.parent?window.parent:window.parent.document,r.postMessage(e.channel+"-ready",l),w(function(){o.up.callback(!0)},0)},init:function(){a(o.onDOMReady,o)}}},F.stack.FrameElementTransport=function(e){var t=Y.getTracer("easyXDM.stack.FrameElementTransport");t("constructor");var i,n,o,s;return i={outgoing:function(e,t,i){o.call(this,e),i&&i()},destroy:function(){t("destroy"),n&&(n.parentNode.removeChild(n),n=null)},onDOMReady:function(){t("init"),s=h(e.remote),e.isHost?(g(e.props,{src:m(e.remote,{xdm_e:h(location.href),xdm_c:e.channel,xdm_p:5}),name:B+e.channel+"_provider"}),n=_(e),n.fn=function(e){return delete n.fn,o=e,w(function(){i.up.callback(!0)},0),function(e){i.up.incoming(e,s)}}):(document.referrer&&h(document.referrer)!=$.xdm_e&&(window.top.location=$.xdm_e),o=window.frameElement.fn(function(e){i.up.incoming(e,s)}),i.up.callback(!0))},init:function(){a(i.onDOMReady,i)}}},F.stack.NameTransport=function(e){function t(t){var i=e.remoteHelper+(l?"#_3":"#_2")+e.channel;s("sending message "+t),s("navigating to  '"+i+"'"),c.contentWindow.sendMessage(t,i)}function i(){l?2!==++u&&l||r.up.callback(!0):(t("ready"),s("calling onReady"),r.up.callback(!0))}function n(e){s("received message "+e),r.up.incoming(e,b)}function o(){v&&w(function(){v(!0)},0)}var s=Y.getTracer("easyXDM.stack.NameTransport");s("constructor"),e.isHost&&f(e.remoteHelper)&&s("missing remoteHelper");var r,l,c,d,u,v,b,y;return r={outgoing:function(e,i,n){v=n,t(e)},destroy:function(){s("destroy"),c.parentNode.removeChild(c),c=null,l&&(d.parentNode.removeChild(d),d=null)},onDOMReady:function(){s("init"),l=e.isHost,u=0,b=h(e.remote),e.local=p(e.local),l?(F.Fn.set(e.channel,function(t){s("received initial message "+t),l&&"ready"===t&&(F.Fn.set(e.channel,n),i())}),y=m(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),g(e.props,{src:y+"#"+e.channel,name:B+e.channel+"_provider"}),d=_(e)):(e.remoteHelper=e.remote,F.Fn.set(e.channel,n));var t=function(){var n=c||this;M(n,"load",t),F.Fn.set(e.channel+"_load",o),function s(){"function"==typeof n.contentWindow.sendMessage?i():w(s,50)}()};c=_({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){a(r.onDOMReady,r)}}},F.stack.HashTransport=function(e){function t(t){if(s("sending message '"+(p+1)+" "+t+"' to "+b),!f)return void s("no caller window");var i=e.remote+"#"+p++ +"_"+t;(l||!v?f.contentWindow:f).location=i}function i(e){u=e,s("received message '"+u+"' from "+b),r.up.incoming(u.substring(u.indexOf("_")+1),b)}function n(){if(m){var e=m.location.href,t="",n=e.indexOf("#");-1!=n&&(t=e.substring(n)),t&&t!=u&&(s("poll: new message"),i(t))}}function o(){s("starting polling"),c=setInterval(n,d)}var s=Y.getTracer("easyXDM.stack.HashTransport");s("constructor");var r,l,c,d,u,p,m,f,v,b;return r={outgoing:function(e){t(e)},destroy:function(){window.clearInterval(c),(l||!v)&&f.parentNode.removeChild(f),f=null},onDOMReady:function(){if(l=e.isHost,d=e.interval,u="#"+e.channel,p=0,v=e.useParent,b=h(e.remote),l){if(g(e.props,{src:e.remote,name:B+e.channel+"_provider"}),v)e.onLoad=function(){m=window,o(),r.up.callback(!0)};else{var t=0,i=e.delay/50;!function n(){if(++t>i)throw s("unable to get reference to _listenerWindow, giving up"),new Error("Unable to reference listenerwindow");try{m=f.contentWindow.frames[B+e.channel+"_consumer"]}catch(a){}m?(o(),s("got a reference to _listenerWindow"),r.up.callback(!0)):w(n,50)}()}f=_(e)}else m=window,o(),v?(f=parent,r.up.callback(!0)):(g(e,{props:{src:e.remote+"#"+e.channel+new Date,name:B+e.channel+"_consumer"},onLoad:function(){r.up.callback(!0)}}),f=_(e))},init:function(){a(r.onDOMReady,r)}}},F.stack.ReliableBehavior=function(){var e=Y.getTracer("easyXDM.stack.ReliableBehavior");e("constructor");var t,i,n=0,o=0,s="";return t={incoming:function(r,a){e("incoming: "+r);var l=r.indexOf("_"),c=r.substring(0,l).split(",");r=r.substring(l+1),c[0]==n&&(e("message delivered"),s="",i&&i(!0)),r.length>0&&(e("sending ack, and passing on "+r),t.down.outgoing(c[1]+","+n+"_"+s,a),o!=c[1]&&(o=c[1],t.up.incoming(r,a)))},outgoing:function(e,r,a){s=e,i=a,t.down.outgoing(o+","+ ++n+"_"+e,r)}}},F.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===s.length)return i("removing myself from the stack"),void S(n);if(!r&&0!==s.length&&!o){i("dispatching from queue"),r=!0;var a=s.shift();n.down.outgoing(a.data,a.origin,function(e){r=!1,a.callback&&w(function(){a.callback(e)},0),t()})}}var i=Y.getTracer("easyXDM.stack.QueueBehavior");i("constructor");var n,o,s=[],r=!0,a="",l=0,c=!1,d=!1;return n={init:function(){f(e)&&(e={}),e.maxLength&&(l=e.maxLength,d=!0),e.lazy?c=!0:n.down.init()},callback:function(e){r=!1;var i=n.up;t(),i.callback(e)},incoming:function(t,o){if(d){var s=t.indexOf("_"),r=parseInt(t.substring(0,s),10);a+=t.substring(s+1),0===r?(i("received the last fragment"),e.encode&&(a=decodeURIComponent(a)),n.up.incoming(a,o),a=""):i("waiting for more fragments, seq="+t)}else n.up.incoming(t,o)},outgoing:function(o,r,a){e.encode&&(o=encodeURIComponent(o));var u,h=[];if(d){for(;0!==o.length;)u=o.substring(0,l),o=o.substring(u.length),h.push(u);for(;u=h.shift();)i("enqueuing"),s.push({data:h.length+"_"+u,origin:r,callback:0===h.length?a:null})}else s.push({data:o,origin:r,callback:a});c?n.down.init():t()},destroy:function(){i("destroy"),o=!0,n.down.destroy()}}},F.stack.VerifyBehavior=function(e){function t(){i("requesting verification"),o=Math.random().toString(16).substring(2),n.down.outgoing(o)}var i=Y.getTracer("easyXDM.stack.VerifyBehavior");i("constructor");var n,o,s;return n={incoming:function(r,a){var l=r.indexOf("_");-1===l?r===o?(i("verified, calling callback"),n.up.callback(!0)):s||(i("returning secret"),s=r,e.initiate||t(),n.down.outgoing(r)):r.substring(0,l)===s&&n.up.incoming(r.substring(l+1),a)},outgoing:function(e,t,i){n.down.outgoing(o+"_"+e,t,i)},callback:function(){e.initiate&&t()}}},F.stack.RpcBehavior=function(e,t){function i(e){e.jsonrpc="2.0",r.down.outgoing(l.stringify(e))}function n(e,t){var n=Array.prototype.slice;return a("creating method "+t),function(){a("executing method "+t);var o,s=arguments.length,r={method:t};return s>0&&"function"==typeof arguments[s-1]?(s>1&&"function"==typeof arguments[s-2]?(o={success:arguments[s-2],error:arguments[s-1]},r.params=n.call(arguments,0,s-2)):(o={success:arguments[s-1]},r.params=n.call(arguments,0,s-1)),d[""+ ++c]=o,r.id=c):r.params=n.call(arguments,0),e.namedParams&&1===r.params.length&&(r.params=r.params[0]),i(r),r.id}}function s(e,t,n,s){if(!n)return a("requested to execute non-existent procedure "+e),void(t&&i({id:t,error:{code:-32601,message:"Procedure not found."}}));a("requested to execute procedure "+e);var r,l;t?(r=function(e){r=L,i({id:t,result:e})},l=function(e,n){l=L;var o={id:t,error:{code:-32099,message:e}};n&&(o.error.data=n),i(o)}):r=l=L,o(s)||(s=[s]);try{var c=n.method.apply(n.scope,s.concat([r,l]));f(c)||r(c)}catch(d){l(d.message)}}var r,a=Y.getTracer("easyXDM.stack.RpcBehavior"),l=t.serializer||q(),c=0,d={};return r={incoming:function(e){var n=l.parse(e);if(n.method)a("received request to execute method "+n.method+(n.id?" using callback id "+n.id:"")),n&&n.params&&n.params[0]&&"object"==typeof n.params[0]&&(n.params[0].id=n.id),t.handle?t.handle(n,i):s(n.method,n.id,t.local[n.method],n.params);else{a("received return value destined to callback with id "+n.id);var o=d[n.id];n.error?o.error?o.error(n.error):a("unhandled error returned."):o.success&&o.success(n.result),delete d[n.id]}},init:function(){if(a("init"),t.remote){a("creating stubs");for(var i in t.remote)t.remote.hasOwnProperty(i)&&(e[i]=n(t.remote[i],i))}r.down.init()},destroy:function(){a("destroy");for(var i in t.remote)t.remote.hasOwnProperty(i)&&e.hasOwnProperty(i)&&delete e[i];r.down.destroy()}}},F}),define("common/transport/fakeXhrFactory",["require","underscore"],function(e){var t=e("underscore");return function(e){var i={},n={};return t.extend(e,{getResponseHeader:function(t){var i,n=/^(.*?):[ \t]*([^\r\n]*)$/gm;if(4===e.readyState){if(!this.responseHeaders)for(this.responseHeaders={};i=n.exec(this.responseHeadersString);)this.responseHeaders[i[1].toLowerCase()]=i[2];i=this.responseHeaders[t.toLowerCase()]}return null==i?null:i},getAllResponseHeaders:function(){return 2===e.readyState?this.responseHeadersString:null},setRequestHeader:function(t,o){var s=t.toLowerCase();return e.readyState||(t=i[s]=i[s]||t,n[t]=o),this}})}}),define("common/transport/xdmRequest",["require","jquery","underscore","xdm","./fakeXhrFactory","jrs.configs","logger"],function(e){function t(e,t){var i=n.Deferred(),o=n.Deferred(),s=e.request(t,function(e){i.resolve(e.data,e.status,r(e.xhr))},function(e){i.reject(e.message,e.data)});return t.success&&i.done(t.success),t.error&&i.fail(t.error),t.complete&&i.always(t.complete),i.done(o.resolve).fail(o.reject).progress(o.notify),o.fail(function(){"pending"==i.state()&&e.abort(s)}),o}function i(){var e=[];return e.push({name:"logEnabled",value:l.get("enabled")}),l.get("level")&&e.push({name:"logLevel",value:l.get("level")}),n.param(e)}var n=e("jquery"),o=e("underscore"),s=e("xdm"),r=e("./fakeXhrFactory"),a=e("jrs.configs"),l=e("logger"),c=function(e){if(0===arguments.length)throw new Error("Not enough arguments to perform the request.");var i=c.create(e.baseUrl?e.baseUrl:a.contextPath);return t(i,e)};return c.create=o.memoize(function(e){return new s.Rpc({remote:e+"/xdm.html?"+i(),container:document.body,props:{style:{display:"none"}}},{remote:{request:{},abort:{}}})}),c}),define("common/transport/xhrRequest",["require","jquery","underscore","logger"],function(e){function t(){r.trigger.apply(r,arguments)}function i(e){(401==e.status||e.getResponseHeader("LoginRequested"))&&(n(window).trigger("sessionExpired"),s.warn("Session timed-out. Redirecting to login page."),window.location.reload())}var n=e("jquery"),o=e("underscore"),s=e("logger").register("request");if("undefined"==typeof document)return{};var r=n(document);return function(e){return o.partial(t,"request:before").apply(null,arguments),n.ajax(e).fail(i).fail(function(e){e.getResponseHeader("adhocException")?s.error(e.getResponseHeader("adhocException")):(500==e.status||e.getResponseHeader("JasperServerError")&&!e.getResponseHeader("SuppressError"))&&s.error(e.responseText)}).fail(o.partial(t,"request:failure")).done(o.partial(t,"request:success"))}}),define("common/transport/request",["require","jquery","underscore","jrs.configs","common/config/requestSettings","common/transport/xdmRequest","common/transport/xhrRequest"],function(e){var t,i=e("jquery"),n=e("underscore"),o=e("jrs.configs"),s=e("common/config/requestSettings"),r=e("common/transport/xdmRequest"),a=e("common/transport/xhrRequest");return function(){t||(t=o.isXdm?r:a);var e=n.extend({},s,arguments[0]);return s.headers&&arguments[0].headers&&(e.headers=n.extend({},s.headers,arguments[0].headers)),arguments[0]=e,t.apply(i,arguments)}}),define("settings",["require","common/transport/request","common/config/requestSettings","underscore","jrs.configs"],function(e){var t=e("common/transport/request"),i=e("common/config/requestSettings"),n=e("underscore"),o=e("jrs.configs"),s=o.contextPath+"/rest_v2/settings/",r=function(e,o){var r=n.extend({},i,{type:"GET",dataType:"json",url:s+e});t(r).fail(function(){o(null)}).then(function(e){o(e)})};return r.load=function(e,t,i,n){return n.isBuild?void i():void r(e,i)},r}),define("common/jquery/extension/datepickerExt",["require","jrs.configs","jquery.ui","underscore","settings!dateTimeSettings"],function(e){function t(e,t){var i="en";return e&&(o.contains(t,e)?i=e:o.contains(t,e.substring(0,2))&&(i=e.substring(0,2))),i.replace("_","-")}var i=e("jrs.configs"),n=e("jquery.ui"),o=e("underscore"),s=e("settings!dateTimeSettings"),r=t(i.userLocale,i.avaliableLocales);return s&&n(function(e){e.datepicker.regional[r]=s.datepicker,e.datepicker.setDefaults(e.datepicker.regional[r])}),n.datepicker.movePickerRelativelyToTriggerIcon=function(e,t){var i=n(e).offset().left,o=parseFloat(t.dpDiv.css("width").replace("px","")),s=i+e.offsetWidth+o<n(window).width();t.dpDiv.css({marginLeft:s?e.offsetWidth+"px":0})},n}),define("jquery.timepicker.addon",["require","jquery.ui"],function(require){var jQuery=require("jquery.ui");return function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.3"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}overrides={beforeShow:function(e,t){return $.isFunction(tp_inst._defaults.evnts.beforeShow)?tp_inst._defaults.evnts.beforeShow.call($input[0],e,t,tp_inst):void 0},onChangeMonthYear:function(e,t,i){tp_inst._updateDateTime(i),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],e,t,i,tp_inst)},onClose:function(e,t){tp_inst.timeDefined===!0&&""!==$input.val()&&tp_inst._updateDateTime(t),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],e,t,tp_inst)}};for(i in overrides)overrides.hasOwnProperty(i)&&(fns[i]=o[i]||null);tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(e){return e.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(e){return e.toUpperCase()}),tp_inst.support=detectSupport(tp_inst._defaults.timeFormat+(tp_inst._defaults.pickerTimeFormat?tp_inst._defaults.pickerTimeFormat:"")+(tp_inst._defaults.altTimeFormat?tp_inst._defaults.altTimeFormat:"")),"string"==typeof tp_inst._defaults.controlType?("slider"==tp_inst._defaults.controlType&&"undefined"==typeof $.ui.slider&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType;var timezoneList=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];null!==tp_inst._defaults.timezoneList&&(timezoneList=tp_inst._defaults.timezoneList);var tzl=timezoneList.length,tzi=0,tzv=null;if(tzl>0&&"object"!=typeof timezoneList[0])for(;tzl>tzi;tzi++)tzv=timezoneList[tzi],timezoneList[tzi]={value:tzv,label:$.timepicker.timezoneOffsetString(tzv,tp_inst.support.iso8601)};return tp_inst._defaults.timezoneList=timezoneList,tp_inst.timezone=null!==tp_inst._defaults.timezone?$.timepicker.timezoneOffsetNumber(tp_inst._defaults.timezone):-1*(new Date).getTimezoneOffset(),tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.microsec=tp_inst._defaults.microsec<tp_inst._defaults.microsecMin?tp_inst._defaults.microsecMin:tp_inst._defaults.microsec>tp_inst._defaults.microsecMax?tp_inst._defaults.microsecMax:tp_inst._defaults.microsec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),(0===tp_inst._defaults.minDate||0===tp_inst._defaults.minDateTime)&&(tp_inst._defaults.minDate=new Date),(0===tp_inst._defaults.maxDate||0===tp_inst._defaults.maxDateTime)&&(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(e){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t),this._limitMinMaxDateTime(e,!1),this._injectTimePicker()},_parseTime:function(e,t){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),t||!this._defaults.timeOnly){var i=$.datepicker._get(this.inst,"dateFormat");try{var n=parseDateTimeInternal(i,this._defaults.timeFormat,e,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!n.timeObj)return!1;$.extend(this,n.timeObj)}catch(o){return $.timepicker.log("Error parsing the date/time string: "+o+"\ndate/time string = "+e+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+i),!1}return!0}var s=$.datepicker.parseTime(this._defaults.timeFormat,e,this._defaults);return s?($.extend(this,s),!0):!1},_injectTimePicker:function(){var e=this.inst.dpDiv,t=this.inst.settings,i=this,n="",o="",s=null,r={},a={},l=null,c=0,d=0;if(0===e.find("div.ui-timepicker-div").length&&t.showTimepicker){var u=' style="display:none;"',h='<div class="ui-timepicker-div'+(t.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(t.showTime?"":u)+">"+t.timeText+'</dt><dd class="ui_tpicker_time"'+(t.showTime?"":u)+"></dd>";for(c=0,d=this.units.length;d>c;c++){if(n=this.units[c],o=n.substr(0,1).toUpperCase()+n.substr(1),s=null!==t["show"+o]?t["show"+o]:this.support[n],r[n]=parseInt(t[n+"Max"]-(t[n+"Max"]-t[n+"Min"])%t["step"+o],10),a[n]=0,h+='<dt class="ui_tpicker_'+n+'_label"'+(s?"":u)+">"+t[n+"Text"]+'</dt><dd class="ui_tpicker_'+n+'"><div class="ui_tpicker_'+n+'_slider"'+(s?"":u)+"></div>",s&&t[n+"Grid"]>0){if(h+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"==n)for(var p=t[n+"Min"];p<=r[n];p+=parseInt(t[n+"Grid"],10)){a[n]++;var m=$.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:p},t);h+='<td data-for="'+n+'">'+m+"</td>"}else for(var f=t[n+"Min"];f<=r[n];f+=parseInt(t[n+"Grid"],10))a[n]++,h+='<td data-for="'+n+'">'+(10>f?"0":"")+f+"</td>";h+="</tr></table></div>"}h+="</dd>"}var g=null!==t.showTimezone?t.showTimezone:this.support.timezone;h+='<dt class="ui_tpicker_timezone_label"'+(g?"":u)+">"+t.timezoneText+"</dt>",h+='<dd class="ui_tpicker_timezone" '+(g?"":u)+"></dd>",h+="</dl></div>";var v=$(h);for(t.timeOnly===!0&&(v.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+t.timeOnlyTitle+"</div></div>"),e.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),c=0,d=i.units.length;d>c;c++)n=i.units[c],o=n.substr(0,1).toUpperCase()+n.substr(1),s=null!==t["show"+o]?t["show"+o]:this.support[n],i[n+"_slider"]=i.control.create(i,v.find(".ui_tpicker_"+n+"_slider"),n,i[n],t[n+"Min"],r[n],t["step"+o]),s&&t[n+"Grid"]>0&&(l=100*a[n]*t[n+"Grid"]/(r[n]-t[n+"Min"]),v.find(".ui_tpicker_"+n+" table").css({width:l+"%",marginLeft:t.isRTL?"0":l/(-2*a[n])+"%",marginRight:t.isRTL?l/(-2*a[n])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(){var e=$(this),t=e.html(),o=parseInt(t.replace(/[^0-9]/g),10),s=t.replace(/[^apm]/gi),r=e.data("for");"hour"==r&&(-1!==s.indexOf("p")&&12>o?o+=12:-1!==s.indexOf("a")&&12===o&&(o=0)),i.control.value(i,i[r+"_slider"],n,o),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/a[n]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=v.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(t.timezoneList,function(e){return $("<option />").val("object"==typeof e?e.value:e).text("object"==typeof e?e.label:e)})),"undefined"!=typeof this.timezone&&null!==this.timezone&&""!==this.timezone){var _=-1*new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset();_==this.timezone?selectLocalTimezone(i):this.timezone_select.val(this.timezone)}else"undefined"!=typeof this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(t.timezone):selectLocalTimezone(i);this.timezone_select.change(function(){i._onTimeChange(),i._onSelectHandler()});var b=e.find(".ui-datepicker-buttonpane");if(b.length?b.before(v):e.append(v),this.$timeObj=v.find(".ui_tpicker_time"),null!==this.inst){var y=this.timeDefined;this._onTimeChange(),this.timeDefined=y}if(this._defaults.addSliderAccess){var T=this._defaults.sliderAccessArgs,S=this._defaults.isRTL;T.isRTL=S,setTimeout(function(){if(0===v.find(".ui-slider-access").length){v.find(".ui-slider:visible").sliderAccess(T);var e=v.find(".ui-slider-access:eq(0)").outerWidth(!0);e&&v.find("table:visible").each(function(){var t=$(this),i=t.outerWidth(),n=t.css(S?"marginRight":"marginLeft").toString().replace("%",""),o=i-e,s=n*o/i+"%",r={width:o,marginRight:0,marginLeft:0};r[S?"marginRight":"marginLeft"]=s,t.css(r)})}},10)}}},_limitMinMaxDateTime:function(e,t){var i=this._defaults,n=new Date(e.selectedYear,e.selectedMonth,e.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(e,"minDateTime")&&void 0!==$.datepicker._get(e,"minDateTime")&&n){var o=$.datepicker._get(e,"minDateTime"),s=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0);(null===this.hourMinOriginal||null===this.minuteMinOriginal||null===this.secondMinOriginal||null===this.millisecMinOriginal||null===this.microsecMinOriginal)&&(this.hourMinOriginal=i.hourMin,this.minuteMinOriginal=i.minuteMin,this.secondMinOriginal=i.secondMin,this.millisecMinOriginal=i.millisecMin,this.microsecMinOriginal=i.microsecMin),e.settings.timeOnly||s.getTime()==n.getTime()?(this._defaults.hourMin=o.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=o.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=o.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=o.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=o.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)}if(null!==$.datepicker._get(e,"maxDateTime")&&void 0!==$.datepicker._get(e,"maxDateTime")&&n){var r=$.datepicker._get(e,"maxDateTime"),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0);
(null===this.hourMaxOriginal||null===this.minuteMaxOriginal||null===this.secondMaxOriginal||null===this.millisecMaxOriginal)&&(this.hourMaxOriginal=i.hourMax,this.minuteMaxOriginal=i.minuteMax,this.secondMaxOriginal=i.secondMax,this.millisecMaxOriginal=i.millisecMax,this.microsecMaxOriginal=i.microsecMax),e.settings.timeOnly||a.getTime()==n.getTime()?(this._defaults.hourMax=r.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=r.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=r.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=r.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=r.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)}if(void 0!==t&&t===!0){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),d=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),u=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);microsecMax=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10),this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:l}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:d}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:u}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec)),this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:microsecMax}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}}},_onTimeChange:function(){var e=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,t=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,i=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,n=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,o=this.microsec_slider?this.control.value(this,this.microsec_slider,"microsec"):!1,s=this.timezone_select?this.timezone_select.val():!1,r=this._defaults,a=r.pickerTimeFormat||r.timeFormat,l=r.pickerTimeSuffix||r.timeSuffix;"object"==typeof e&&(e=!1),"object"==typeof t&&(t=!1),"object"==typeof i&&(i=!1),"object"==typeof n&&(n=!1),"object"==typeof o&&(o=!1),"object"==typeof s&&(s=!1),e!==!1&&(e=parseInt(e,10)),t!==!1&&(t=parseInt(t,10)),i!==!1&&(i=parseInt(i,10)),n!==!1&&(n=parseInt(n,10)),o!==!1&&(o=parseInt(o,10));var c=r[12>e?"amNames":"pmNames"][0],d=e!=this.hour||t!=this.minute||i!=this.second||n!=this.millisec||o!=this.microsec||this.ampm.length>0&&12>e!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null!==this.timezone&&s!=this.timezone;d&&(e!==!1&&(this.hour=e),t!==!1&&(this.minute=t),i!==!1&&(this.second=i),n!==!1&&(this.millisec=n),o!==!1&&(this.microsec=o),s!==!1&&(this.timezone=s),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),this.support.ampm&&(this.ampm=c),this.formattedTime=$.datepicker.formatTime(r.timeFormat,this,r),this.$timeObj&&this.$timeObj.text(a===r.timeFormat?this.formattedTime+l:$.datepicker.formatTime(a,this,r)+l),this.timeDefined=!0,d&&this._updateDateTime()},_onSelectHandler:function(){var e=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;e&&t&&e.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(e){e=this.inst||e;var t=$.datepicker._daylightSavingAdjust(new Date(e.selectedYear,e.selectedMonth,e.selectedDay)),i=$.datepicker._get(e,"dateFormat"),n=$.datepicker._getFormatConfig(e),o=null!==t&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(i,null===t?new Date:t,n);var s=this.formattedDate;if(""===e.lastVal&&(e.currentYear=e.selectedYear,e.currentMonth=e.selectedMonth,e.currentDay=e.selectedDay),this._defaults.timeOnly===!0?s=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||o)&&(s+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=s,this._defaults.showTimepicker)if(this.$altInput&&this._defaults.timeOnly===!1&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(s);var r="",a=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,l=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(r=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===t?new Date:t,n):this.formattedDate,r&&(r+=a)),r+=this._defaults.altTimeFormat?$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+l:this.formattedTime+l,this.$altInput.val(r)}else this.$input.val(s);else this.$input.val(this.formattedDate);var c=$.datepicker._get(e,"onUpdateDateTime");c&&""!==this.formattedTime&&c.apply(window,[{time:this.formattedTime,date:this.formattedDate,datetime:s}]),this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var e=$.datepicker._getInst(this.$input.get(0)),t=$.datepicker._get(e,"timepicker");if(t&&t._defaults.timeOnly&&e.input.val()!=e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(i){$.timepicker.log(i)}}},_controls:{slider:{create:function(e,t,i,n,o,s,r){var a=e._defaults.isRTL;return t.prop("slide",null).slider({orientation:"horizontal",value:a?-1*n:n,min:a?-1*s:o,max:a?-1*o:s,step:r,slide:function(t,n){e.control.value(e,$(this),i,a?-1*n.value:n.value),e._onTimeChange()},stop:function(){e._onSelectHandler()}})},options:function(e,t,i,n,o){if(e._defaults.isRTL){if("string"==typeof n)return"min"==n||"max"==n?void 0!==o?t.slider(n,-1*o):Math.abs(t.slider(n)):t.slider(n);var s=n.min,r=n.max;return n.min=n.max=null,void 0!==s&&(n.max=-1*s),void 0!==r&&(n.min=-1*r),t.slider(n)}return"string"==typeof n&&void 0!==o?t.slider(n,o):t.slider(n)},value:function(e,t,i,n){return e._defaults.isRTL?void 0!==n?t.slider("value",-1*n):Math.abs(t.slider("value")):void 0!==n?t.slider("value",n):t.slider("value")}},select:{create:function(e,t,i,n,o,s,r){for(var a='<select class="ui-timepicker-select" data-unit="'+i+'" data-min="'+o+'" data-max="'+s+'" data-step="'+r+'">',l=e._defaults.pickerTimeFormat||e._defaults.timeFormat,c=o;s>=c;c+=r)a+='<option value="'+c+'"'+(c==n?" selected":"")+">",a+="hour"==i?$.datepicker.formatTime($.trim(l.replace(/[^ht ]/gi,"")),{hour:c},e._defaults):"millisec"==i||"microsec"==i||c>=10?c:"0"+c.toString(),a+="</option>";return a+="</select>",t.children("select").remove(),$(a).appendTo(t).change(function(){e._onTimeChange(),e._onSelectHandler()}),t},options:function(e,t,i,n,o){var s={},r=t.children("select");if("string"==typeof n){if(void 0===o)return r.data(n);s[n]=o}else s=n;return e.control.create(e,t,r.data("unit"),r.val(),s.min||r.data("min"),s.max||r.data("max"),s.step||r.data("step"))},value:function(e,t,i,n){var o=t.children("select");return void 0!==n?o.val(n):o.val()}}}}),$.fn.extend({timepicker:function(e){e=e||{};var t=Array.prototype.slice.call(arguments);return"object"==typeof e&&(t[0]=$.extend(e,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(e){e=e||{};var t=arguments;return"string"==typeof e?"getDate"==e?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var e=$(this);e.datepicker.apply(e,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,e)._defaults)})}}),$.datepicker.parseDateTime=function(e,t,i,n,o){var s=parseDateTimeInternal(e,t,i,n,o);if(s.timeObj){var r=s.timeObj;s.date.setHours(r.hour,r.minute,r.second,r.millisec),s.date.setMicroseconds(r.microsec)}return s.date},$.datepicker.parseTime=function(e,t,i){var n=extendRemove(extendRemove({},$.timepicker._defaults),i||{}),o=(-1!==e.replace(/\'.*?\'/g,"").indexOf("Z"),function(e,t,i){var n,o=function(e,t){var i=[];return e&&$.merge(i,e),t&&$.merge(i,t),i=$.map(i,function(e){return e.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+i.join("|")+")?"},s=function(e){var t=e.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),i={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};if(t)for(var n=0;n<t.length;n++)-1==i[t[n].toString().charAt(0)]&&(i[t[n].toString().charAt(0)]=n+1);return i},r="^"+e.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(e){var t=e.length;switch(e.charAt(0).toLowerCase()){case"h":return 1===t?"(\\d?\\d)":"(\\d{"+t+"})";case"m":return 1===t?"(\\d?\\d)":"(\\d{"+t+"})";case"s":return 1===t?"(\\d?\\d)":"(\\d{"+t+"})";case"l":return"(\\d?\\d?\\d)";case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return o(i.amNames,i.pmNames);default:return"("+e.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(e){return"\\"+e})+")?"}}).replace(/\s/g,"\\s?")+i.timeSuffix+"$",a=s(e),l="";n=t.match(new RegExp(r,"i"));var c={hour:0,minute:0,second:0,millisec:0,microsec:0};return n?(-1!==a.t&&(void 0===n[a.t]||0===n[a.t].length?(l="",c.ampm=""):(l=-1!==$.inArray(n[a.t].toUpperCase(),i.amNames)?"AM":"PM",c.ampm=i["AM"==l?"amNames":"pmNames"][0])),-1!==a.h&&(c.hour="AM"==l&&"12"==n[a.h]?0:"PM"==l&&"12"!=n[a.h]?parseInt(n[a.h],10)+12:Number(n[a.h])),-1!==a.m&&(c.minute=Number(n[a.m])),-1!==a.s&&(c.second=Number(n[a.s])),-1!==a.l&&(c.millisec=Number(n[a.l])),-1!==a.c&&(c.microsec=Number(n[a.c])),-1!==a.z&&void 0!==n[a.z]&&(c.timezone=$.timepicker.timezoneOffsetNumber(n[a.z])),c):!1}),s=function(e,t,i){try{var n=new Date("2012-01-01 "+t);if(isNaN(n.getTime())&&(n=new Date("2012-01-01T"+t),isNaN(n.getTime())&&(n=new Date("01/01/2012 "+t),isNaN(n.getTime()))))throw"Unable to parse time with native Date: "+t;return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds(),millisec:n.getMilliseconds(),microsec:n.getMicroseconds(),timezone:-1*n.getTimezoneOffset()}}catch(s){try{return o(e,t,i)}catch(r){$.timepicker.log("Unable to parse \ntimeString: "+t+"\ntimeFormat: "+e)}}return!1};return"function"==typeof n.parse?n.parse(e,t,n):"loose"===n.parse?s(e,t,n):o(e,t,n)},$.datepicker.formatTime=function(e,t,i){i=i||{},i=$.extend({},$.timepicker._defaults,i),t=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:0},t);var n=e,o=i.amNames[0],s=parseInt(t.hour,10);return s>11&&(o=i.pmNames[0]),n=n.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|('.*?'|".*?"))/g,function(e){switch(e){case"HH":return("0"+s).slice(-2);case"H":return s;case"hh":return("0"+convert24to12(s)).slice(-2);case"h":return convert24to12(s);case"mm":return("0"+t.minute).slice(-2);case"m":return t.minute;case"ss":return("0"+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"c":return("00"+t.microsec).slice(-3);case"z":return $.timepicker.timezoneOffsetString(null===t.timezone?i.timezone:t.timezone,!1);case"Z":return $.timepicker.timezoneOffsetString(null===t.timezone?i.timezone:t.timezone,!0);case"T":return o.charAt(0).toUpperCase();case"TT":return o.toUpperCase();case"t":return o.charAt(0).toLowerCase();case"tt":return o.toLowerCase();default:return e.replace(/\'/g,"")||"'"}}),n=$.trim(n)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(e,t){var i=this._getInst($(e)[0]),n=this._get(i,"timepicker");n?(n._limitMinMaxDateTime(i,!0),i.inline=i.stay_open=!0,this._base_selectDate(e,t),i.inline=i.stay_open=!1,this._notifyChange(i),this._updateDatepicker(i)):this._base_selectDate(e,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){var t=e.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!=e&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t||"boolean"==typeof e.stay_open&&e.stay_open!==!1)){this._base_updateDatepicker(e);var i=this._get(e,"timepicker");i&&i._addTimePicker(e)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&$.datepicker._get(t,"constrainInput")){var n=i.support.ampm,o=null!==i._defaults.showTimezone?i._defaults.showTimezone:i.support.timezone,s=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,n?"APM":"").replace(/Tt/g,n?"AaPpMm":"").replace(/tT/g,n?"AaPpMm":"").replace(/T/g,n?"AP":"").replace(/tt/g,n?"apm":"").replace(/t/g,n?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(o?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+s,a=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||" ">a||!s||r.indexOf(a)>-1}return $.datepicker._base_doKeyPress(e)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(e){var t=this._get(e,"timepicker");if(t){var i=t._defaults.altField;if(i){var n=(t._defaults.altFormat||t._defaults.dateFormat,this._getDate(e)),o=$.datepicker._getFormatConfig(e),s="",r=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,a=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix,l=null!==t._defaults.altTimeFormat?t._defaults.altTimeFormat:t._defaults.timeFormat;s+=$.datepicker.formatTime(l,t,t._defaults)+a,t._defaults.timeOnly||t._defaults.altFieldTimeOnly||null===n||(s=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,n,o)+r+s:t.formattedDate+r+s),$(i).val(s)}}else $.datepicker._base_updateAlternate(e)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(e){var t=$.datepicker._getInst(e.target),i=$.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(n){$.timepicker.log(n)}return $.datepicker._base_doKeyUp(e)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),i=t.dpDiv;this._base_gotoToday(e);var n=this._get(t,"timepicker");selectLocalTimezone(n);var o=new Date;this._setTime(t,o),$(".ui-datepicker-today",i).click()},$.datepicker._disableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(i._defaults.showTimepicker=!1,i._updateDateTime(t))}},$.datepicker._enableTimepickerDatepicker=function(e){var t=this._getInst(e);if(t){var i=this._get(t,"timepicker");$(e).datepicker("getDate"),i&&(i._defaults.showTimepicker=!0,i._addTimePicker(t),i._updateDateTime(t))}},$.datepicker._setTime=function(e,t){var i=this._get(e,"timepicker");if(i){var n=i._defaults;i.hour=t?t.getHours():n.hour,i.minute=t?t.getMinutes():n.minute,i.second=t?t.getSeconds():n.second,i.millisec=t?t.getMilliseconds():n.millisec,i.microsec=t?t.getMicroseconds():n.microsec,i._limitMinMaxDateTime(e,!0),i._onTimeChange(),i._updateDateTime(e)}},$.datepicker._setTimeDatepicker=function(e,t,i){var n=this._getInst(e);if(n){var o=this._get(n,"timepicker");if(o){this._setDateFromField(n);var s;t&&("string"==typeof t?(o._parseTime(t,i),s=new Date,s.setHours(o.hour,o.minute,o.second,o.millisec),s.setMicroseconds(o.microsec)):s=new Date(t.getTime()),"Invalid Date"==s.toString()&&(s=void 0),this._setTime(n,s))}}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(e,t){var i=this._getInst(e);if(i){var n=this._get(i,"timepicker"),o=t instanceof Date?new Date(t.getTime()):t;n&&null!=n.timezone&&(t=$.timepicker.timezoneAdjust(t,n.timezone),o=$.timepicker.timezoneAdjust(o,n.timezone)),this._updateDatepicker(i),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(e,o,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(e,t){var i=this._getInst(e);if(i){var n=this._get(i,"timepicker");if(n){void 0===i.lastVal&&this._setDateFromField(i,t);var o=this._getDate(i);return o&&n._parseTime($(e).val(),n.timeOnly)&&(o.setHours(n.hour,n.minute,n.second,n.millisec),o.setMicroseconds(n.microsec),null!=n.timezone&&(o=$.timepicker.timezoneAdjust(o,n.timezone))),o}return this._base_getDateDatepicker(e,t)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,i){var n;try{n=this._base_parseDate(e,t,i)}catch(o){if(!(o.indexOf(":")>=0))throw o;n=this._base_parseDate(e,t.substring(0,t.length-(o.length-o.indexOf(":")-2)),i)}return n},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(e){var t=this._get(e,"timepicker");return t?(t._updateDateTime(e),t.$input.val()):this._base_formatDate(e)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(e,t,i){var n,o=this._getInst(e);if(!o)return null;var s=this._get(o,"timepicker");if(s){var r,a=null,l=null,c=null,d=s._defaults.evnts,u={};if("string"==typeof t){if("minDate"===t||"minDateTime"===t)a=i;else if("maxDate"===t||"maxDateTime"===t)l=i;else if("onSelect"===t)c=i;else if(d.hasOwnProperty(t)){if("undefined"==typeof i)return d[t];u[t]=i,n={}}}else if("object"==typeof t){t.minDate?a=t.minDate:t.minDateTime?a=t.minDateTime:t.maxDate?l=t.maxDate:t.maxDateTime&&(l=t.maxDateTime);for(r in d)d.hasOwnProperty(r)&&t[r]&&(u[r]=t[r])}for(r in u)u.hasOwnProperty(r)&&(d[r]=u[r],n||(n=$.extend({},t)),delete n[r]);if(n&&isEmptyObject(n))return;a?(a=0===a?new Date:new Date(a),s._defaults.minDate=a,s._defaults.minDateTime=a):l?(l=0===l?new Date:new Date(l),s._defaults.maxDate=l,s._defaults.maxDateTime=l):c&&(s._defaults.onSelect=c)}return void 0===i?this._base_optionDatepicker.call($.datepicker,e,t):this._base_optionDatepicker.call($.datepicker,e,n||t,i)};var isEmptyObject=function(e){var t;for(t in e)if(e.hasOwnProperty(e))return!1;return!0},extendRemove=function(e,t){$.extend(e,t);for(var i in t)(null===t[i]||void 0===t[i])&&(e[i]=t[i]);return e},detectSupport=function(e){var t=e.replace(/\'.*?\'/g,"").toLowerCase(),i=function(e,t){return-1!==e.indexOf(t)?!0:!1};return{hour:i(t,"h"),minute:i(t,"m"),second:i(t,"s"),millisec:i(t,"l"),microsec:i(t,"c"),timezone:i(t,"z"),ampm:i("t")&&i(e,"h"),iso8601:i(e,"Z")}},convert24to12=function(e){return e>12&&(e-=12),0===e&&(e=12),String(e)},splitDateTime=function(e,t,i,n){try{var o=n&&n.separator?n.separator:$.timepicker._defaults.separator,s=n&&n.timeFormat?n.timeFormat:$.timepicker._defaults.timeFormat,r=s.split(o),a=r.length,l=t.split(o),c=l.length;if(c>1)return[l.splice(0,c-a).join(o),l.splice(0,a).join(o)]}catch(d){if($.timepicker.log("Could not split the date from the time. Please check the following datetimepicker options\nthrown error: "+d+"\ndateTimeString"+t+"\ndateFormat = "+e+"\nseparator = "+n.separator+"\ntimeFormat = "+n.timeFormat),d.indexOf(":")>=0){{var u=t.length-(d.length-d.indexOf(":")-2);t.substring(u)}return[$.trim(t.substring(0,u)),$.trim(t.substring(u))]}throw d}return[t,""]},parseDateTimeInternal=function(e,t,i,n,o){var s,r=splitDateTime(e,i,n,o);if(s=$.datepicker._base_parseDate(e,r[0],n),""!==r[1]){var a=r[1],l=$.datepicker.parseTime(t,a,o);if(null===l)throw"Wrong time format";return{date:s,timeObj:l}}return{date:s}},selectLocalTimezone=function(e,t){if(e&&e.timezone_select){var i="undefined"!=typeof t?t:new Date;e.timezone_select.val(-1*i.getTimezoneOffset())}};$.timepicker=new Timepicker,$.timepicker.timezoneOffsetString=function(e,t){if(isNaN(e)||e>840)return e;var i=e,n=i%60,o=(i-n)/60,s=t?":":"",r=(i>=0?"+":"-")+("0"+(101*o).toString()).slice(-2)+s+("0"+(101*n).toString()).slice(-2);return"+00:00"==r?"Z":r},$.timepicker.timezoneOffsetNumber=function(e){return e=e.toString().replace(":",""),"Z"===e.toUpperCase()?0:/^(\-|\+)\d{4}$/.test(e)?("-"==e.substr(0,1)?-1:1)*(60*parseInt(e.substr(1,2),10)+parseInt(e.substr(3,2),10)):e},$.timepicker.timezoneAdjust=function(e,t){var i=$.timepicker.timezoneOffsetNumber(t);if(!isNaN(i)){var n=-1*e.getTimezoneOffset(),o=n-i;e.setMinutes(e.getMinutes()+o)}return e},$.timepicker.timeRange=function(e,t,i){return $.timepicker.handleRange("timepicker",e,t,i)},$.timepicker.datetimeRange=function(e,t,i){$.timepicker.handleRange("datetimepicker",e,t,i)},$.timepicker.dateRange=function(e,t,i){$.timepicker.handleRange("datepicker",e,t,i)},$.timepicker.handleRange=function(e,t,i,n){function o(o,s){var r=t[e]("getDate"),a=i[e]("getDate"),l=o[e]("getDate");if(null!==r){var c=new Date(r.getTime()),d=new Date(r.getTime());c.setMilliseconds(c.getMilliseconds()+n.minInterval),d.setMilliseconds(d.getMilliseconds()+n.maxInterval),n.minInterval>0&&c>a?i[e]("setDate",c):n.maxInterval>0&&a>d?i[e]("setDate",d):r>a&&s[e]("setDate",l)}}function s(t,i,o){if(t.val()){var s=t[e].call(t,"getDate");null!==s&&n.minInterval>0&&("minDate"==o&&s.setMilliseconds(s.getMilliseconds()+n.minInterval),"maxDate"==o&&s.setMilliseconds(s.getMilliseconds()-n.minInterval)),s.getTime&&i[e].call(i,"option",o,s)}}return n=$.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},n),$.fn[e].call(t,$.extend({onClose:function(){o($(this),i)},onSelect:function(){s($(this),i,"minDate")}},n,n.start)),$.fn[e].call(i,$.extend({onClose:function(){o($(this),t)},onSelect:function(){s($(this),t,"maxDate")}},n,n.end)),o(t,i),s(t,i,"minDate"),s(i,t,"maxDate"),$([t.get(0),i.get(0)])},$.timepicker.log=function(e){window.console&&console.log(e)},Date.prototype.getMicroseconds||(Date.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(e){return this.microseconds=e,this}),$.timepicker.version="1.3"}}(jQuery),jQuery}),define("common/jquery/extension/timepickerExt",["require","jquery.timepicker.addon","settings!dateTimeSettings"],function(e){var t=e("jquery.timepicker.addon"),i=e("settings!dateTimeSettings");return i&&t.timepicker.setDefaults(i.timepicker),t}),jQuery.noConflict();var JRS={vars:{element_scrolled:!1,ajax_in_progress:!1,current_flow:null,contextPath:__jrsConfigs__.contextPath},i18n:{}},Calendar={};if("undefined"==typeof isEncryptionOn)var isEncryptionOn=!1;var jaspersoft={components:{},i18n:{}};"undefined"==typeof JRS&&(JRS={Mocks:{}}),"undefined"==typeof JRS.vars&&(JRS.vars={element_scrolled:!1,ajax_in_progress:!1,current_flow:null}),"undefined"==typeof JRS.Export&&(JRS.Export={i18n:{"file.name.empty":"export.file.name.empty","file.name.too.long":"export.file.name.too.long","file.name.not.valid":"export.file.name.not.valid","export.select.users":"export.select.users","export.select.roles":"export.select.roles","export.session.expired":"export.session.expired","error.timeout":"export.file.name.empty"},configs:{TIMEOUT:12e5,DELAY:3e3}}),"undefined"==typeof localContext&&(localContext={}),__jrsConfigs__.calendar&&(JRS.i18n.bundledCalendarFormat=__jrsConfigs__.calendar.i18n.bundledCalendarFormat,JRS.i18n.bundledCalendarTimeFormat=__jrsConfigs__.calendar.i18n.bundledCalendarTimeFormat),define("namespace",["common/jquery/extension/timepickerExt"],function(e){return function(){var t;return t||e.jaspersoft}}(this));var ajax={};ajax.cancelRequestsBefore,ajax.LOADING_ID="loading",ajax.csrfRequestHeaders=new Hash,ajax.setCsrfHeaders=function(e){ajax.csrfRequestHeaders.each(function(t){e.setRequestHeader(t.key,t.value)})},AjaxRequester.addVar("CUMULATIVE_UPDATE","c").addVar("ROW_COPY_UPDATE","r").addVar("TARGETTED_REPLACE_UPDATE","t").addVar("EVAL_JSON","j").addVar("DUMMY_POST_PARAM","dummyPostData").addVar("MAX_WAIT_TIME",2e3).addVar("errorHandler",function(){return!1}).addMethod("doGet",function(){return this.xmlhttp?(this.xmlhttp.open("GET",this.url,this.async),this.xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xmlhttp.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT"),this.xmlhttp.setRequestHeader("x-requested-with","AJAXRequest"),ajax.setCsrfHeaders(this.xmlhttp),this.xmlhttp.send(null),!0):!1}).addMethod("doPost",function(){return this.xmlhttp?(this.postData===AjaxRequester.prototype.DUMMY_POST_PARAM&&(this.postData=null),this.xmlhttp.open("POST",this.url,this.async),this.xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xmlhttp.setRequestHeader("x-requested-with","AJAXRequest"),ajax.setCsrfHeaders(this.xmlhttp),this.xmlhttp.send(this.postData),!0):!1}).addMethod("processResponse",function(e){return function(){if(4==e.xmlhttp.readyState){if(ajax.cancelRequestsBefore&&ajax.cancelRequestsBefore>e.requestTime)return void ajaxRequestEnded(e);handleResponse(e)}}}).addMethod("setErrorHandler",function(){this.errorHandler=errorHandler}).addMethod("verifyAjaxResponse",function(){return this.xmlhttp.getResponseHeader("Server")||this.confirmContinue()}).addMethod("startResponseTimer",function(){this.responseTimer=window.setTimeout(function(){dialogs.popup.show($(ajax.LOADING_ID),!0)},this.MAX_WAIT_TIME)}).addMethod("cancelResponseTimer",function(){window.clearTimeout(this.responseTimer)}).addMethod("confirmContinue",function(){return confirm(serverIsNotResponding)});var clobberingResponseHandler=function(e){var t=e.params[2];document.body.innerHTML=e.xmlhttp.responseText,document.fire("dom:loaded"),invokeCallbacks(t)},evalJSONResponseHandler=function(e){var t=null;try{t=e.xmlhttp.responseText.evalJSON()}catch(i){window.console&&console.log(i)}var n=e.params[2];invokeCallbacks(n,t)},ERROR_POPUP_DIV="jsErrorPopup",ERROR_POPUP_CONTENTS="errorPopupContents",ERROR_POPUP_BACK_BUTTON="errorBack",ERROR_POPUP_CLOSE_BUTTON="errorPopupCloseButton";ajax.ajaxRequestCount=0,define("core.ajax",["jquery","prototype","utils.common","builder","namespace"],function(e){return function(){var t;return t||e.ajax}}(this));var heartbeat={DOM_ID:"heartbeatOptin",PERMIT_CHECKBOX_ID:"heartbeatCheck",initialize:function(e){this._baseUrl=e.baseUrl,this._showDialog=e.showDialog,this._sendClientInfo=e.sendClientInfo,this._dom=$(this.DOM_ID),this._permit=$(this.PERMIT_CHECKBOX_ID),this._okButton=this._dom.select(layoutModule.BUTTON_PATTERN)[0],this._okButton.observe("click",this._okHandler.bind(this))},_okHandler:function(){dialogs.popup.hide(this._dom);var e=this._baseUrl+"/heartbeat.html?permit="+this._permit.checked;ajaxNonReturningUpdate(e,{errorHandler:baseErrorHandler})},start:function(){this._showDialog&&(dialogs.popup.show(this._dom),this._okButton.focus()),this._sendClientInfo&&this._doSendClientInfo()},_doSendClientInfo:function(){try{var e={};e.navAppName=navigator.appName,e.navAppVersion=navigator.appVersion,e.scrWidth=screen.width,e.scrHeight=screen.height,e.scrColorDepth=screen.colorDepth;var t=appendPostData("",e),i=this._baseUrl+"/heartbeatInfo.html";ajaxNonReturningUpdate(i,{postData:t})}catch(n){}}};define("components.heartbeat",["prototype","core.ajax"],function(e){return function(){var t;return t||e.heartbeat}}(this)),String.prototype.parseColor=function(){var e="#";if("rgb("==this.slice(0,4)){var t=this.slice(4,this.length-1).split(","),i=0;do e+=parseInt(t[i]).toColorPart();while(++i<3)}else if("#"==this.slice(0,1)){if(4==this.length)for(var i=1;4>i;i++)e+=(this.charAt(i)+this.charAt(i)).toLowerCase();7==this.length&&(e=this.toLowerCase())}return 7==e.length?e:arguments[0]||this},Element.collectTextNodes=function(e){return $A($(e).childNodes).collect(function(e){return 3==e.nodeType?e.nodeValue:e.hasChildNodes()?Element.collectTextNodes(e):""}).flatten().join("")},Element.collectTextNodesIgnoreClass=function(e,t){return $A($(e).childNodes).collect(function(e){return 3==e.nodeType?e.nodeValue:e.hasChildNodes()&&!Element.hasClassName(e,t)?Element.collectTextNodesIgnoreClass(e,t):""}).flatten().join("")},Element.setContentZoom=function(e,t){return e=$(e),e.setStyle({fontSize:t/100+"em"}),Prototype.Browser.WebKit&&window.scrollBy(0,0),e},Element.getInlineOpacity=function(e){return $(e).style.opacity||""},Element.forceRerendering=function(e){try{e=$(e);var t=document.createTextNode(" ");e.appendChild(t),e.removeChild(t)}catch(i){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(e){return-Math.cos(e*Math.PI)/2+.5},reverse:function(e){return 1-e},flicker:function(e){var e=-Math.cos(e*Math.PI)/4+.75+Math.random()/4;return e>1?1:e},wobble:function(e){return-Math.cos(e*Math.PI*9*e)/2+.5},pulse:function(e,t){return-Math.cos(e*((t||5)-.5)*2*Math.PI)/2+.5},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)},none:function(){return 0},full:function(){return 1}},DefaultOptions:{duration:1,fps:100,sync:!1,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(e){var t="position:relative";Prototype.Browser.IE&&(t+=";zoom:1"),e=$(e),$A(e.childNodes).each(function(i){3==i.nodeType&&(i.nodeValue.toArray().each(function(n){e.insertBefore(new Element("span",{style:t}).update(" "==n?String.fromCharCode(160):n),i)}),Element.remove(i))})},multiple:function(e,t){var i;i=("object"==typeof e||Object.isFunction(e))&&e.length?e:$(e).childNodes;var n=Object.extend({speed:.1,delay:0},arguments[2]||{}),o=n.delay;$A(i).each(function(e,i){new t(e,Object.extend(n,{delay:i*n.speed+o}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(e,t,i){return e=$(e),t=(t||"appear").toLowerCase(),Effect[Effect.PAIRS[t][e.visible()?1:0]](e,Object.extend({queue:{position:"end",scope:e.id||"global",limit:1}},i||{}))}};if(Effect.DefaultOptions.transition=Effect.Transitions.sinoidal,Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[],this.interval=null},_each:function(e){this.effects._each(e)},add:function(e){var t=(new Date).getTime(),i=Object.isString(e.options.queue)?e.options.queue:e.options.queue.position;switch(i){case"front":this.effects.findAll(function(e){return"idle"==e.state}).each(function(t){t.startOn+=e.finishOn,t.finishOn+=e.finishOn});break;case"with-last":t=this.effects.pluck("startOn").max()||t;break;case"end":t=this.effects.pluck("finishOn").max()||t}e.startOn+=t,e.finishOn+=t,(!e.options.queue.limit||this.effects.length<e.options.queue.limit)&&this.effects.push(e),this.interval||(this.interval=setInterval(this.loop.bind(this),15))
},remove:function(e){this.effects=this.effects.reject(function(t){return t==e}),0==this.effects.length&&(clearInterval(this.interval),this.interval=null)},loop:function(){for(var e=(new Date).getTime(),t=0,i=this.effects.length;i>t;t++)this.effects[t]&&this.effects[t].loop(e)}}),Effect.Queues={instances:$H(),get:function(e){return Object.isString(e)?this.instances.get(e)||this.instances.set(e,new Effect.ScopedQueue):e}},Effect.Queue=Effect.Queues.get("global"),Effect.Base=Class.create({position:null,start:function(e){e&&e.transition===!1&&(e.transition=Effect.Transitions.linear),this.options=Object.extend(Object.extend({},Effect.DefaultOptions),e||{}),this.currentFrame=0,this.state="idle",this.startOn=1e3*this.options.delay,this.finishOn=this.startOn+1e3*this.options.duration,this.fromToDelta=this.options.to-this.options.from,this.totalTime=this.finishOn-this.startOn,this.totalFrames=this.options.fps*this.options.duration,this.render=function(){function e(e,t){e.options[t+"Internal"]&&e.options[t+"Internal"](e),e.options[t]&&e.options[t](e)}return function(t){"idle"===this.state&&(this.state="running",e(this,"beforeSetup"),this.setup&&this.setup(),e(this,"afterSetup")),"running"===this.state&&(t=this.options.transition(t)*this.fromToDelta+this.options.from,this.position=t,e(this,"beforeUpdate"),this.update&&this.update(t),e(this,"afterUpdate"))}}(),this.event("beforeStart"),this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)},loop:function(e){if(e>=this.startOn){if(e>=this.finishOn)return this.render(1),this.cancel(),this.event("beforeFinish"),this.finish&&this.finish(),void this.event("afterFinish");var t=(e-this.startOn)/this.totalTime,i=(t*this.totalFrames).round();i>this.currentFrame&&(this.render(t),this.currentFrame=i)}},cancel:function(){this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this),this.state="finished"},event:function(e){this.options[e+"Internal"]&&this.options[e+"Internal"](this),this.options[e]&&this.options[e](this)},inspect:function(){var e=$H();for(property in this)Object.isFunction(this[property])||e.set(property,this[property]);return"#<Effect:"+e.inspect()+",options:"+$H(this.options).inspect()+">"}}),Effect.Parallel=Class.create(Effect.Base,{initialize:function(e){this.effects=e||[],this.start(arguments[1])},update:function(e){this.effects.invoke("render",e)},finish:function(e){this.effects.each(function(t){t.render(1),t.cancel(),t.event("beforeFinish"),t.finish&&t.finish(e),t.event("afterFinish")})}}),Effect.Tween=Class.create(Effect.Base,{initialize:function(e,t,i){e=Object.isString(e)?$(e):e;var n=$A(arguments),o=n.last(),s=5==n.length?n[3]:null;this.method=Object.isFunction(o)?o.bind(e):Object.isFunction(e[o])?e[o].bind(e):function(t){e[o]=t},this.start(Object.extend({from:t,to:i},s||{}))},update:function(e){this.method(e)}}),Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction}),Effect.Opacity=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});var t=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(t)},update:function(e){this.element.setOpacity(e)}}),Effect.Move=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(t)},setup:function(){this.element.makePositioned(),this.originalLeft=parseFloat(this.element.getStyle("left")||"0"),this.originalTop=parseFloat(this.element.getStyle("top")||"0"),"absolute"==this.options.mode&&(this.options.x=this.options.x-this.originalLeft,this.options.y=this.options.y-this.originalTop)},update:function(e){this.element.setStyle({left:(this.options.x*e+this.originalLeft).round()+"px",top:(this.options.y*e+this.originalTop).round()+"px"})}}),Effect.MoveBy=function(e,t,i){return new Effect.Move(e,Object.extend({x:i,y:t},arguments[3]||{}))},Effect.Scale=Class.create(Effect.Base,{initialize:function(e,t){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var i=Object.extend({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:t},arguments[2]||{});this.start(i)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1,this.elementPositioning=this.element.getStyle("position"),this.originalStyle={},["top","left","width","height","fontSize"].each(function(e){this.originalStyle[e]=this.element.style[e]}.bind(this)),this.originalTop=this.element.offsetTop,this.originalLeft=this.element.offsetLeft;var e=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(t){e.indexOf(t)>0&&(this.fontSize=parseFloat(e),this.fontSizeType=t)}.bind(this)),this.factor=(this.options.scaleTo-this.options.scaleFrom)/100,this.dims=null,"box"==this.options.scaleMode&&(this.dims=[this.element.offsetHeight,this.element.offsetWidth]),/^content/.test(this.options.scaleMode)&&(this.dims=[this.element.scrollHeight,this.element.scrollWidth]),this.dims||(this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth])},update:function(e){var t=this.options.scaleFrom/100+this.factor*e;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*t+this.fontSizeType}),this.setDimensions(this.dims[0]*t,this.dims[1]*t)},finish:function(){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(e,t){var i={};if(this.options.scaleX&&(i.width=t.round()+"px"),this.options.scaleY&&(i.height=e.round()+"px"),this.options.scaleFromCenter){var n=(e-this.dims[0])/2,o=(t-this.dims[1])/2;"absolute"==this.elementPositioning?(this.options.scaleY&&(i.top=this.originalTop-n+"px"),this.options.scaleX&&(i.left=this.originalLeft-o+"px")):(this.options.scaleY&&(i.top=-n+"px"),this.options.scaleX&&(i.left=-o+"px"))}this.element.setStyle(i)}}),Effect.Highlight=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(t)},setup:function(){return"none"==this.element.getStyle("display")?void this.cancel():(this.oldStyle={},this.options.keepBackgroundImage||(this.oldStyle.backgroundImage=this.element.getStyle("background-image"),this.element.setStyle({backgroundImage:"none"})),this.options.endcolor||(this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")),this.options.restorecolor||(this.options.restorecolor=this.element.getStyle("background-color")),this._base=$R(0,2).map(function(e){return parseInt(this.options.startcolor.slice(2*e+1,2*e+3),16)}.bind(this)),void(this._delta=$R(0,2).map(function(e){return parseInt(this.options.endcolor.slice(2*e+1,2*e+3),16)-this._base[e]}.bind(this))))},update:function(e){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(t,i,n){return t+(this._base[n]+this._delta[n]*e).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}}),Effect.ScrollTo=function(e){var t=arguments[1]||{},i=document.viewport.getScrollOffsets(),n=$(e).cumulativeOffset();return t.offset&&(n[1]+=t.offset),new Effect.Tween(null,i.top,n[1],t,function(e){scrollTo(i.left,e.round())})},Effect.Fade=function(e){e=$(e);var t=e.getInlineOpacity(),i=Object.extend({from:e.getOpacity()||1,to:0,afterFinishInternal:function(e){0==e.options.to&&e.element.hide().setStyle({opacity:t})}},arguments[1]||{});return new Effect.Opacity(e,i)},Effect.Appear=function(e){e=$(e);var t=Object.extend({from:"none"==e.getStyle("display")?0:e.getOpacity()||0,to:1,afterFinishInternal:function(e){e.element.forceRerendering()},beforeSetup:function(e){e.element.setOpacity(e.options.from).show()}},arguments[1]||{});return new Effect.Opacity(e,t)},Effect.Puff=function(e){e=$(e);var t={opacity:e.getInlineOpacity(),position:e.getStyle("position"),top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height};return new Effect.Parallel([new Effect.Scale(e,200,{sync:!0,scaleFromCenter:!0,scaleContent:!0,restoreAfterFinish:!0}),new Effect.Opacity(e,{sync:!0,to:0})],Object.extend({duration:1,beforeSetupInternal:function(e){Position.absolutize(e.effects[0].element)},afterFinishInternal:function(e){e.effects[0].element.hide().setStyle(t)}},arguments[1]||{}))},Effect.BlindUp=function(e){return e=$(e),e.makeClipping(),new Effect.Scale(e,0,Object.extend({scaleContent:!1,scaleX:!1,restoreAfterFinish:!0,afterFinishInternal:function(e){e.element.hide().undoClipping()}},arguments[1]||{}))},Effect.BlindDown=function(e){e=$(e);var t=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:t.height,originalWidth:t.width},restoreAfterFinish:!0,afterSetup:function(e){e.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(e){e.element.undoClipping()}},arguments[1]||{}))},Effect.SwitchOff=function(e){e=$(e);var t=e.getInlineOpacity();return new Effect.Appear(e,Object.extend({duration:.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(e){new Effect.Scale(e.element,1,{duration:.3,scaleFromCenter:!0,scaleX:!1,scaleContent:!1,restoreAfterFinish:!0,beforeSetup:function(e){e.element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned().setStyle({opacity:t})}})}},arguments[1]||{}))},Effect.DropOut=function(e){e=$(e);var t={top:e.getStyle("top"),left:e.getStyle("left"),opacity:e.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(e,{x:0,y:100,sync:!0}),new Effect.Opacity(e,{sync:!0,to:0})],Object.extend({duration:.5,beforeSetup:function(e){e.effects[0].element.makePositioned()},afterFinishInternal:function(e){e.effects[0].element.hide().undoPositioned().setStyle(t)}},arguments[1]||{}))},Effect.Shake=function(e){e=$(e);var t=Object.extend({distance:20,duration:.5},arguments[1]||{}),i=parseFloat(t.distance),n=parseFloat(t.duration)/10,o={top:e.getStyle("top"),left:e.getStyle("left")};return new Effect.Move(e,{x:i,y:0,duration:n,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*-i,y:0,duration:2*n,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*i,y:0,duration:2*n,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*-i,y:0,duration:2*n,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*i,y:0,duration:2*n,afterFinishInternal:function(e){new Effect.Move(e.element,{x:-i,y:0,duration:n,afterFinishInternal:function(e){e.element.undoPositioned().setStyle(o)}})}})}})}})}})}})},Effect.SlideDown=function(e){e=$(e).cleanWhitespace();var t=e.down().getStyle("bottom"),i=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:i.height,originalWidth:i.width},restoreAfterFinish:!0,afterSetup:function(e){e.element.makePositioned(),e.element.down().makePositioned(),window.opera&&e.element.setStyle({top:""}),e.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-e.element.clientHeight+"px"})},afterFinishInternal:function(e){e.element.undoClipping().undoPositioned(),e.element.down().undoPositioned().setStyle({bottom:t})}},arguments[1]||{}))},Effect.SlideUp=function(e){e=$(e).cleanWhitespace();var t=e.down().getStyle("bottom"),i=e.getDimensions();return new Effect.Scale(e,window.opera?0:1,Object.extend({scaleContent:!1,scaleX:!1,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:i.height,originalWidth:i.width},restoreAfterFinish:!0,afterSetup:function(e){e.element.makePositioned(),e.element.down().makePositioned(),window.opera&&e.element.setStyle({top:""}),e.element.makeClipping().show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-e.element.clientHeight+"px"})},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned(),e.element.down().undoPositioned().setStyle({bottom:t})}},arguments[1]||{}))},Effect.Squish=function(e){return new Effect.Scale(e,window.opera?1:0,{restoreAfterFinish:!0,beforeSetup:function(e){e.element.makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping()}})},Effect.Grow=function(e){e=$(e);var t,i,n,o,s=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{}),r={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()},a=e.getDimensions();switch(s.direction){case"top-left":t=i=n=o=0;break;case"top-right":t=a.width,i=o=0,n=-a.width;break;case"bottom-left":t=n=0,i=a.height,o=-a.height;break;case"bottom-right":t=a.width,i=a.height,n=-a.width,o=-a.height;break;case"center":t=a.width/2,i=a.height/2,n=-a.width/2,o=-a.height/2}return new Effect.Move(e,{x:t,y:i,duration:.01,beforeSetup:function(e){e.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(e){new Effect.Parallel([new Effect.Opacity(e.element,{sync:!0,to:1,from:0,transition:s.opacityTransition}),new Effect.Move(e.element,{x:n,y:o,sync:!0,transition:s.moveTransition}),new Effect.Scale(e.element,100,{scaleMode:{originalHeight:a.height,originalWidth:a.width},sync:!0,scaleFrom:window.opera?1:0,transition:s.scaleTransition,restoreAfterFinish:!0})],Object.extend({beforeSetup:function(e){e.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(e){e.effects[0].element.undoClipping().undoPositioned().setStyle(r)}},s))}})},Effect.Shrink=function(e){e=$(e);var t,i,n=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{}),o={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()},s=e.getDimensions();switch(n.direction){case"top-left":t=i=0;break;case"top-right":t=s.width,i=0;break;case"bottom-left":t=0,i=s.height;break;case"bottom-right":t=s.width,i=s.height;break;case"center":t=s.width/2,i=s.height/2}return new Effect.Parallel([new Effect.Opacity(e,{sync:!0,to:0,from:1,transition:n.opacityTransition}),new Effect.Scale(e,window.opera?1:0,{sync:!0,transition:n.scaleTransition,restoreAfterFinish:!0}),new Effect.Move(e,{x:t,y:i,sync:!0,transition:n.moveTransition})],Object.extend({beforeStartInternal:function(e){e.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.effects[0].element.hide().undoClipping().undoPositioned().setStyle(o)}},n))},Effect.Pulsate=function(e){e=$(e);var t=arguments[1]||{},i=e.getInlineOpacity(),n=t.transition||Effect.Transitions.linear,o=function(e){return 1-n(-Math.cos(e*(t.pulses||5)*2*Math.PI)/2+.5)};return new Effect.Opacity(e,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(e){e.element.setStyle({opacity:i})}},t),{transition:o}))},Effect.Fold=function(e){e=$(e);var t={top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height};return e.makeClipping(),new Effect.Scale(e,5,Object.extend({scaleContent:!1,scaleX:!1,afterFinishInternal:function(){new Effect.Scale(e,1,{scaleContent:!1,scaleY:!1,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(t)}})}},arguments[1]||{}))},Effect.Morph=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({style:{}},arguments[1]||{});if(Object.isString(t.style))if(t.style.include(":"))this.style=t.style.parseStyle();else{this.element.addClassName(t.style),this.style=$H(this.element.getStyles()),this.element.removeClassName(t.style);var i=this.element.getStyles();this.style=this.style.reject(function(e){return e.value==i[e.key]}),t.afterFinishInternal=function(e){e.element.addClassName(e.options.style),e.transforms.each(function(t){e.element.style[t.style]=""})}}else this.style=$H(t.style);this.start(t)},setup:function(){function e(e){return(!e||["rgba(0, 0, 0, 0)","transparent"].include(e))&&(e="#ffffff"),e=e.parseColor(),$R(0,2).map(function(t){return parseInt(e.slice(2*t+1,2*t+3),16)})}this.transforms=this.style.map(function(t){var i=t[0],n=t[1],o=null;if("#zzzzzz"!=n.parseColor("#zzzzzz"))n=n.parseColor(),o="color";else if("opacity"==i)n=parseFloat(n),Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});else if(Element.CSS_LENGTH.test(n)){var s=n.match(/^([\+\-]?[0-9\.]+)(.*)$/);n=parseFloat(s[1]),o=3==s.length?s[2]:null}var r=this.element.getStyle(i);return{style:i.camelize(),originalValue:"color"==o?e(r):parseFloat(r||0),targetValue:"color"==o?e(n):n,unit:o}}.bind(this)).reject(function(e){return e.originalValue==e.targetValue||"color"!=e.unit&&(isNaN(e.originalValue)||isNaN(e.targetValue))})},update:function(e){for(var t,i={},n=this.transforms.length;n--;)i[(t=this.transforms[n]).style]="color"==t.unit?"#"+Math.round(t.originalValue[0]+(t.targetValue[0]-t.originalValue[0])*e).toColorPart()+Math.round(t.originalValue[1]+(t.targetValue[1]-t.originalValue[1])*e).toColorPart()+Math.round(t.originalValue[2]+(t.targetValue[2]-t.originalValue[2])*e).toColorPart():(t.originalValue+(t.targetValue-t.originalValue)*e).toFixed(3)+(null===t.unit?"":t.unit);this.element.setStyle(i,!0)}}),Effect.Transform=Class.create({initialize:function(e){this.tracks=[],this.options=arguments[1]||{},this.addTracks(e)},addTracks:function(e){return e.each(function(e){e=$H(e);var t=e.values().first();this.tracks.push($H({ids:e.keys().first(),effect:Effect.Morph,options:{style:t}}))}.bind(this)),this},play:function(){return new Effect.Parallel(this.tracks.map(function(e){var t=e.get("ids"),i=e.get("effect"),n=e.get("options"),o=[$(t)||$$(t)].flatten();return o.map(function(e){return new i(e,Object.extend({sync:!0},n))})}).flatten(),this.options)}}),Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex"),Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,String.__parseStyleElement=document.createElement("div"),String.prototype.parseStyle=function(){var e,t=$H();return Prototype.Browser.WebKit?e=new Element("div",{style:this}).style:(String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>',e=String.__parseStyleElement.childNodes[0].style),Element.CSS_PROPERTIES.each(function(i){e[i]&&t.set(i,e[i])}),Prototype.Browser.IE&&this.include("opacity")&&t.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]),t},Element.getStyles=document.defaultView&&document.defaultView.getComputedStyle?function(e){var t=document.defaultView.getComputedStyle($(e),null);return Element.CSS_PROPERTIES.inject({},function(e,i){return e[i]=t[i],e})}:function(e){e=$(e);var t,i=e.currentStyle;return t=Element.CSS_PROPERTIES.inject({},function(e,t){return e[t]=i[t],e}),t.opacity||(t.opacity=e.getOpacity()),t},Effect.Methods={morph:function(e,t){return e=$(e),new Effect.Morph(e,Object.extend({style:t},arguments[2]||{})),e},visualEffect:function(e,t,i){e=$(e);var n=t.dasherize().camelize(),o=n.charAt(0).toUpperCase()+n.substring(1);return new Effect[o](e,i),e},highlight:function(e,t){return e=$(e),new Effect.Highlight(e,t),e}},$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(e){Effect.Methods[e]=function(t,i){return t=$(t),Effect[e.charAt(0).toUpperCase()+e.substring(1)](t,i),t}}),$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(e){Effect.Methods[e]=Element[e]}),Element.addMethods(Effect.Methods),define("effects",["prototype"],function(e){return function(){var t;return t||e.Effect}}(this)),define("utils.animation",["prototype","effects"],function(e){return function(){var t;return t||e.jQuery}}(this)),Object.isUndefined(Effect))throw"dragdrop.js requires including script.aculo.us' effects.js library";var Droppables={drops:[],remove:function(e){this.drops=this.drops.reject(function(t){return t.element==$(e)})},add:function(e){e=$(e);var t=Object.extend({greedy:!0,hoverclass:null,tree:!1},arguments[1]||{});if(t.containment){t._containers=[];var i=t.containment;Object.isArray(i)?i.each(function(e){t._containers.push($(e))}):t._containers.push($(i))}t.accept&&(t.accept=[t.accept].flatten()),Element.makePositioned(e),t.element=e,this.drops.push(t)},findDeepestChild:function(e){for(deepest=e[0],i=1;i<e.length;++i)Element.isParent(e[i].element,deepest.element)&&(deepest=e[i]);return deepest},isContained:function(e,t){var i;return i=t.tree?e.treeNode:e.parentNode,t._containers.detect(function(e){return i==e})},isAffected:function(e,t,i){return i.element!=t&&(!i._containers||this.isContained(t,i))&&(!i.accept||Element.classNames(t).detect(function(e){return i.accept.include(e)}))&&Position.within(i.element,e[0],e[1])},deactivate:function(e){e.hoverclass&&Element.removeClassName(e.element,e.hoverclass),this.last_active=null},activate:function(e){e.hoverclass&&Element.addClassName(e.element,e.hoverclass),this.last_active=e},show:function(e,t){if(this.drops.length){var i,n=[];this.drops.each(function(i){Droppables.isAffected(e,t,i)&&n.push(i)}),n.length>0&&(i=Droppables.findDeepestChild(n)),this.last_active&&this.last_active!=i&&this.deactivate(this.last_active),i&&(Position.within(i.element,e[0],e[1]),i.onHover&&i.onHover(t,i.element,Position.overlap(i.overlap,i.element)),i!=this.last_active&&Droppables.activate(i))}},fire:function(e,t){if(this.last_active){var i;return Position.prepare(),i=Draggables.supportsTouch?Draggables._lastPointer:[Event.pointerX(e),Event.pointerY(e)],this.isAffected(i,t,this.last_active)&&this.last_active.onDrop?(this.last_active.onDrop(t,this.last_active.element,e),!0):void 0}},reset:function(){this.last_active&&this.deactivate(this.last_active)}},Draggables={DEFAULT_TOLERANCE:window.Prototype.BrowserFeatures.SupportsTouch?2:1,drags:[],observers:[],supportsTouch:window.Prototype.BrowserFeatures.SupportsTouch,register:function(e){0==this.drags.length&&(this.eventMouseUp=this.endDrag.bindAsEventListener(this),this.eventMouseMove=this.updateDrag.bindAsEventListener(this),this.eventKeypress=this.keyPress.bindAsEventListener(this),Draggables.supportsTouch?(Event.observe(document,"touchend",this.eventMouseUp),Event.observe(document,"touchmove",this.eventMouseMove)):Event.observe(document,"mouseup",this.eventMouseUp),Event.observe(document,"keypress",this.eventKeypress)),this.drags.push(e)},unregister:function(e){this.drags=this.drags.reject(function(t){return t==e}),0==this.drags.length&&(Draggables.supportsTouch?(Event.stopObserving(document,"touchend",this.eventMouseUp),Event.stopObserving(document,"touchmove",this.eventMouseMove)):Event.stopObserving(document,"mouseup",this.eventMouseUp),Event.stopObserving(document,"keypress",this.eventKeypress))},activate:function(e){Draggables.supportsTouch||Event.observe(document,"mousemove",this.eventMouseMove),e.options.delay?this._timeout=setTimeout(function(){Draggables._timeout=null,window.focus(),Draggables.activeDraggable=e}.bind(this),e.options.delay):(window.focus(),this.activeDraggable=e)},deactivate:function(){Draggables.supportsTouch||Event.stopObserving(document,"mousemove",this.eventMouseMove),this.activeDraggable=null},updateDrag:function(e){if(this.activeDraggable){var t=[Event.pointerX(e),Event.pointerY(e)];this.pointerInRadius(t)||(this._lastPointer=t,this.activeDraggable.updateDrag(e,t))}},pointerInRadius:function(e,t){return t=t||2,this._lastPointer&&Math.abs(this._lastPointer[0]-e[0])<=t&&Math.abs(this._lastPointer[1]-e[1])<=t},endDrag:function(e){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.activeDraggable&&(Draggables.supportsTouch||(this._lastPointer=null),this.activeDraggable.endDrag(e),this.activeDraggable=null)},keyPress:function(e){this.activeDraggable&&this.activeDraggable.keyPress(e)},addObserver:function(e){this.observers.push(e),this._cacheObserverCallbacks()},removeObserver:function(e){this.observers=this.observers.reject(function(t){return t.element==e||t.element&&e&&t.element.id==e.id}),this._cacheObserverCallbacks()},notify:function(e,t,i){this[e+"Count"]>0&&this.observers.each(function(n){n[e]&&n[e](e,t,i)}),t.options[e]&&t.options[e](t,i)},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(e){Draggables[e+"Count"]=Draggables.observers.select(function(t){return t[e]}).length})}},Draggable=Class.create({initialize:function(e){var t={handle:!1,reverteffect:function(e,t,i){var n=.02*Math.sqrt(Math.abs(2^t)+Math.abs(2^i));new Effect.Move(e,{x:-i,y:-t,duration:n,queue:{scope:"_draggable",position:"end"}})},endeffect:function(e){Draggable._dragging[e]=!1},zindex:1e3,revert:!1,quiet:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,snap:!1,delay:0};(!arguments[1]||Object.isUndefined(arguments[1].endeffect))&&Object.extend(t,{starteffect:function(e){e._opacity=Element.getOpacity(e),Draggable._dragging[e]=!0}});var i=Object.extend(t,arguments[1]||{});this.element=$(e),i.handle&&Object.isString(i.handle)&&(this.handle=this.element.down("."+i.handle,0)),this.handle||(this.handle=$(i.handle)),this.handle||(this.handle=this.element),!i.scroll||i.scroll.scrollTo||i.scroll.outerHTML||(i.scroll=$(i.scroll),this._isScrollChild=Element.childOf(this.element,i.scroll)),Element.makePositioned(this.element),this.options=i,this.dragging=!1,this.eventMouseDown=this.initDrag.bindAsEventListener(this),Draggables.supportsTouch?Event.observe(this.handle,"touchstart",this.eventMouseDown):Event.observe(this.handle,"mousedown",this.eventMouseDown),Draggables.register(this)},destroy:function(){Draggables.supportsTouch?Event.stopObserving(this.handle,"touchstart",this.eventMouseDown):Event.stopObserving(this.handle,"mousedown",this.eventMouseDown),Draggables.unregister(this)},currentDelta:function(){var e=Element.getStyle(this.element,"left")||"",t=Element.getStyle(this.element,"top")||"";return e.include("%")&&(e=this.element.parentNode.getWidth()*parseInt(e)/100),t.include("%")&&(t=this.element.parentNode.getHeight()*parseInt(t)/100),[parseInt(e)||"0",parseInt(t)||"0"]},initDrag:function(e){if((Object.isUndefined(Draggable._dragging[this.element])||!Draggable._dragging[this.element])&&(Event.isLeftClick(e)||Draggables.supportsTouch&&e.touches&&1==e.touches.length)){var t=Event.element(e);if((tag_name=t.tagName.toUpperCase())&&("INPUT"==tag_name||"SELECT"==tag_name||"OPTION"==tag_name||"BUTTON"==tag_name||"TEXTAREA"==tag_name))return;var i=[Event.pointerX(e),Event.pointerY(e)],n=this.element.cumulativeOffset();this.offset=[0,1].map(function(e){return i[e]-n[e]}),Draggables.activate(this),this.countdown=Draggables.DEFAULT_TOLERANCE,Event.stop(e),Draggables.supportsTouch?this.handle.fire("drag:"+e.type,{targetEvent:e}):this.handle.fire("drag:mousedown",{targetEvent:e})}},startDrag:function(e){if(this.dragging=!0,this.delta||(this.delta=this.currentDelta()),this.options.zindex&&(this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0),this.element.style.zIndex=this.options.zindex),this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this._originallyAbsolute="absolute"==this.element.getStyle("position"),this._originallyAbsolute||Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element),"TR"===this.element.parentNode.tagName&&document.body.appendChild(this.element)),this.options.scroll)if(this.options.scroll==window){var t=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=t.left,this.originalScrollTop=t.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,this.originalScrollTop=this.options.scroll.scrollTop;Draggables.notify("onStart",this,e),this.options.starteffect&&this.options.starteffect(this.element)},updateDrag:function(event,pointer){if(!this.dragging)if(Draggables.supportsTouch){if(!isIE7()&&this.countdown&&this.countdown--)return;this.startDrag(event)}else{if(this.countdown&&this.countdown--)return;this.startDrag(event)}if(Draggables.supportsTouch&&event.touches.length>1&&this.endDrag(event),this.options.quiet||(Position.prepare(),Droppables.show(pointer,this.element)),Draggables.notify("onDrag",this,event),this.draw(pointer),this.options.change&&this.options.change(this),this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll))p=[left,top,left+width,top+height];else p=Position.page(this.options.scroll).toArray(),p[0]+=this.options.scroll.scrollLeft+Position.deltaX,p[1]+=this.options.scroll.scrollTop+Position.deltaY,p.push(p[0]+this.options.scroll.offsetWidth),p.push(p[1]+this.options.scroll.offsetHeight);var speed=[0,0];pointer[0]<p[0]+this.options.scrollSensitivity&&(speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity)),pointer[1]<p[1]+this.options.scrollSensitivity&&(speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity)),pointer[0]>p[2]-this.options.scrollSensitivity&&(speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity)),pointer[1]>p[3]-this.options.scrollSensitivity&&(speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity)),this.startScrolling(speed)}Prototype.Browser.WebKit&&window.scrollBy(0,0),Event.stop(event)},finishDrag:function(e,t){if(this.dragging=!1,this.options.quiet){Position.prepare();var i=[Event.pointerX(e),Event.pointerY(e)];Droppables.show(i,this.element)}this.options.ghosting&&(this._originallyAbsolute||(Position.relativize(this.element),"TR"===this._clone.parentNode.tagName&&this._clone.parentNode.insertBefore(this.element,this._clone)),delete this._originallyAbsolute,Element.remove(this._clone),this._clone=null);var n=!1;t&&(n=Droppables.fire(e,this.element),n?Draggables.supportsTouch&&(Draggables._lastPointer=null):n=!1),n&&this.options.onDropped&&this.options.onDropped(this.element),Draggables.notify("onEnd",this,e);var o=this.options.revert;o&&Object.isFunction(o)&&(o=o(this.element));var s=this.currentDelta();o&&this.options.reverteffect?(0==n||"failure"!=o)&&this.options.reverteffect(this.element,s[1]-this.delta[1],s[0]-this.delta[0]):this.delta=s,this.options.zindex&&(this.element.style.zIndex=this.originalZ),this.options.endeffect&&this.options.endeffect(this.element),Draggables.deactivate(this),Droppables.reset()},keyPress:function(e){e.keyCode==Event.KEY_ESC&&(this.finishDrag(e,!1),Event.stop(e))},endDrag:function(e){this.dragging&&(this.stopScrolling(),this.finishDrag(e,!0),Event.stop(e))},draw:function(e){var t=this.element.cumulativeOffset();if(this.options.ghosting){var i=Position.realOffset(this.element);t[0]+=i[0]-Position.deltaX,t[1]+=i[1]-Position.deltaY}var n=this.currentDelta();t[0]-=n[0],t[1]-=n[1],this.options.scroll&&this.options.scroll!=window&&this._isScrollChild&&(t[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft,t[1]-=this.options.scroll.scrollTop-this.originalScrollTop);var o=[0,1].map(function(i){return e[i]-t[i]-this.offset[i]}.bind(this));this.options.snap&&(o=Object.isFunction(this.options.snap)?this.options.snap(o[0],o[1],this):o.map(Object.isArray(this.options.snap)?function(e,t){return(e/this.options.snap[t]).round()*this.options.snap[t]
}.bind(this):function(e){return(e/this.options.snap).round()*this.options.snap}.bind(this)));var s=this.element.style;this.options.constraint&&"horizontal"!=this.options.constraint||(s.left=o[0]+"px"),this.options.constraint&&"vertical"!=this.options.constraint||(s.top=o[1]+"px"),"hidden"==s.visibility&&(s.visibility="")},stopScrolling:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null,Draggables._lastScrollPointer=null)},startScrolling:function(e){(e[0]||e[1])&&(this.scrollSpeed=[e[0]*this.options.scrollSpeed,e[1]*this.options.scrollSpeed],this.lastScrolled=new Date,this.scrollInterval=setInterval(this.scroll.bind(this),10))},scroll:function(){var current=new Date,delta=current-this.lastScrolled;if(this.lastScrolled=current,this.options.scroll==window){with(this._getWindowScroll(this.options.scroll))if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1e3;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}}else this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1e3,this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1e3;Position.prepare(),Droppables.show(Draggables._lastPointer,this.element),Draggables.notify("onDrag",this),this._isScrollChild&&(Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer),Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1e3,Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1e3,Draggables._lastScrollPointer[0]<0&&(Draggables._lastScrollPointer[0]=0),Draggables._lastScrollPointer[1]<0&&(Draggables._lastScrollPointer[1]=0),this.draw(Draggables._lastScrollPointer)),this.options.change&&this.options.change(this)},_getWindowScroll:function(w){var T,L,W,H;with(w.document)w.document.documentElement&&documentElement.scrollTop?(T=documentElement.scrollTop,L=documentElement.scrollLeft):w.document.body&&(T=body.scrollTop,L=body.scrollLeft),w.innerWidth?(W=w.innerWidth,H=w.innerHeight):w.document.documentElement&&documentElement.clientWidth?(W=documentElement.clientWidth,H=documentElement.clientHeight):(W=body.offsetWidth,H=body.offsetHeight);return{top:T,left:L,width:W,height:H}}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(e,t){this.element=$(e),this.observer=t,this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark(),this.lastValue!=Sortable.serialize(this.element)&&this.observer(this.element)}}),Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(e){for(;"BODY"!=e.tagName.toUpperCase();){if(e.id&&Sortable.sortables[e.id])return e;e=e.parentNode}},options:function(e){return(e=Sortable._findRootElement($(e)))?Sortable.sortables[e.id]:void 0},destroy:function(e){e=$(e);var t=Sortable.sortables[e.id];t&&(Draggables.removeObserver(t.element),t.droppables.each(function(e){Droppables.remove(e)}),t.draggables.invoke("destroy"),delete Sortable.sortables[t.element.id])},create:function(e){e=$(e);var t=Object.extend({element:e,tag:"li",dropOnEmpty:!1,accept:[],tree:!1,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:e,handle:!1,only:!1,delay:0,hoverclass:null,ghosting:!1,quiet:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:!1,handles:!1,onDrop:Prototype.emptyFunction,onHover:Sortable.onHover,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(e);var i={revert:!0,quiet:t.quiet,scroll:t.scroll,scrollSpeed:t.scrollSpeed,scrollSensitivity:t.scrollSensitivity,delay:t.delay,ghosting:t.ghosting,constraint:t.constraint,onStart:t.onStart,handle:t.handle};t.starteffect&&(i.starteffect=t.starteffect),t.reverteffect?i.reverteffect=t.reverteffect:t.ghosting&&(i.reverteffect=function(e){e.style.top=0,e.style.left=0}),t.endeffect&&(i.endeffect=t.endeffect),t.zindex&&(i.zindex=t.zindex);var n={overlap:t.overlap,containment:t.containment,tree:t.tree,hoverclass:t.hoverclass,onHover:t.onHover,onDrop:t.onDrop},o={onHover:t.onEmptyHover||Sortable.onEmptyHover,overlap:t.overlap,containment:t.containment,hoverclass:t.hoverclass,accept:t.accept,onDrop:t.onDrop};Element.cleanWhitespace(e),t.draggables=[],t.droppables=[],(t.dropOnEmpty||t.tree)&&(Droppables.add(e,o),t.droppables.push(e)),(t.elements||this.findElements(e,t)||[]).each(function(o,s){var r=t.handles?$(t.handles[s]):t.handle?$(o).select("."+t.handle)[0]:o;t.draggables.push(new Draggable(o,Object.extend(i,{handle:r}))),Droppables.add(o,n),t.tree&&(o.treeNode=e),t.droppables.push(o)}),t.tree&&(Sortable.findTreeElements(e,t)||[]).each(function(i){Droppables.add(i,o),i.treeNode=e,t.droppables.push(i)}),this.sortables[e.identify()]=t,Draggables.addObserver(new SortableObserver(e,t.onUpdate))},findElements:function(e,t){return Element.findChildren(e,t.only,t.tree?!0:!1,t.tag)},findTreeElements:function(e,t){return Element.findChildren(e,t.only,t.tree?!0:!1,t.treeTag)},onHover:function(e,t,i){var n=null,o=null;if(!(Element.isParent(t,e)||i>.33&&.66>i&&Sortable.options(t).tree))if(i>.5)Sortable.mark(t,"before"),t.previousSibling!=e&&(n=e.parentNode,e.style.visibility="hidden",t.parentNode.insertBefore(e,t),t.parentNode!=n&&(o=Sortable.options(n),o&&o.onChange(e)),Sortable.options(t.parentNode).onChange(e));else{Sortable.mark(t,"after");var s=t.nextSibling||null;s!=e&&(n=e.parentNode,e.style.visibility="hidden",t.parentNode.insertBefore(e,s),t.parentNode!=n&&(o=Sortable.options(n),o&&o.onChange(e)),Sortable.options(t.parentNode).onChange(e))}},onEmptyHover:function(e,t,i){var n=e.parentNode,o=Sortable.options(t);if(!Element.isParent(t,e)){var s,r=Sortable.findElements(t,{tag:o.tag,only:o.only}),a=null;if(r){var l,c=null,d=Element.offsetSize(t,o.overlap)*(1-i);for(s=0;s<r.length;s+=1)if(c=Element.offsetSize(r[s],o.overlap),l=r[s].cumulativeOffset().top,Position.ycomp>=l&&Position.ycomp<l+r[s].offsetHeight){if(!(d-c>=0)){if(d-c/2>=0){a=s+1<r.length?r[s+1]:null;break}a=r[s];break}d-=c}}t.insertBefore(e,a);var u=Sortable.options(n);u&&u.onChange(e),o.onChange(e)}},unmark:function(){Sortable._marker&&Sortable._marker.hide()},mark:function(e,t){var i=Sortable.options(e.parentNode);if(!i||i.ghosting){Sortable._marker||(Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"}),document.getElementsByTagName("body").item(0).appendChild(Sortable._marker));var n=e.cumulativeOffset();Sortable._marker.setStyle({left:n[0]+"px",top:n[1]+"px"}),"after"==t&&Sortable._marker.setStyle("horizontal"==i.overlap?{left:n[0]+e.clientWidth+"px"}:{top:n[1]+e.clientHeight+"px"}),Sortable._marker.show()}},_tree:function(e,t,i){for(var n=Sortable.findElements(e,t)||[],o=0;o<n.length;++o){var s=n[o].id.match(t.format);if(s){var r={id:encodeURIComponent(s?s[1]:null),element:e,parent:i,children:[],position:i.children.length,container:$(n[o]).down(t.treeTag)};r.container&&this._tree(r.container,t,r),i.children.push(r)}}return i},tree:function(e){e=$(e);var t=this.options(e),i=Object.extend({tag:t.tag,treeTag:t.treeTag,only:t.only,name:e.id,format:t.format},arguments[1]||{}),n={id:null,parent:null,children:[],container:e,position:0};return Sortable._tree(e,i,n)},_constructIndex:function(e){var t="";do e.id&&(t="["+e.position+"]"+t);while(null!=(e=e.parent));return t},sequence:function(e){e=$(e);var t=Object.extend(this.options(e),arguments[1]||{});return $(this.findElements(e,t)||[]).map(function(e){return e.id.match(t.format)?e.id.match(t.format)[1]:""})},setSequence:function(e,t){e=$(e);var i=Object.extend(this.options(e),arguments[2]||{}),n={};this.findElements(e,i).each(function(e){e.id.match(i.format)&&(n[e.id.match(i.format)[1]]=[e,e.parentNode]),e.parentNode.removeChild(e)}),t.each(function(e){var t=n[e];t&&(t[1].appendChild(t[0]),delete n[e])})},serialize:function(e){e=$(e);var t=Object.extend(Sortable.options(e),arguments[1]||{}),i=encodeURIComponent(arguments[1]&&arguments[1].name?arguments[1].name:e.id);return t.tree?Sortable.tree(e,arguments[1]).children.map(function(e){return[i+Sortable._constructIndex(e)+"[id]="+encodeURIComponent(e.id)].concat(e.children.map(arguments.callee))}).flatten().join("&"):Sortable.sequence(e,arguments[1]).map(function(e){return i+"[]="+encodeURIComponent(e)}).join("&")}};Element.isParent=function(e,t){return e.parentNode&&e!=t?e.parentNode==t?!0:Element.isParent(e.parentNode,t):!1},Element.findChildren=function(e,t,i,n){if(!e.hasChildNodes())return null;n=n.toUpperCase(),t&&(t=[t].flatten());var o=[];return $A(e.childNodes).each(function(e){if(!e.tagName||e.tagName.toUpperCase()!=n||t&&!Element.classNames(e).detect(function(e){return t.include(e)})||o.push(e),i){var s=Element.findChildren(e,t,i,n);s&&o.push(s)}}),o.length>0?o.flatten():[]},Element.offsetSize=function(e,t){return e["offset"+("vertical"==t||"height"==t?"Height":"Width")]},define("dragdrop",["prototype","effects"],function(e){return function(){var t;return t||e.Draggable}}(this)),Draggable.prototype.startDrag=function(e){this.dragging=!0,this.delta||(this.delta=this.currentDelta()),this.options.zindex&&(this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0),this.element.style.zIndex=this.options.zindex),this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this.element._originallyAbsolute="absolute"==this.element.getStyle("position"),this.element._originallyAbsolute||Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element));var t=jQuery("body"),i=jQuery(this.element),n=i.offset();if(this._sizes={window:{w:t.outerWidth(!0),h:t.outerHeight(!0)},element:{w:i.outerWidth(),h:i.outerHeight()},mouseOffset:{left:Event.pointerX(e)-n.left,top:Event.pointerY(e)-n.top}},this.options.superghosting){Position.prepare();var o=[Event.pointerX(e),Event.pointerY(e)];body=document.getElementsByTagName("body")[0],me=this.element,this._clone=me.cloneNode(!0),me.parentNode.insertBefore(this._clone,me),me.id="clone_"+me.id,me.hide(),Position.absolutize(me),me.parentNode.removeChild(me),body.appendChild(me),("0px"==me.style.width||"0px"==me.style.height)&&(me.style.width=Element.getWidth(this._clone)+"px",me.style.height=Element.getHeight(this._clone)+"px"),this.originalScrollTop=Element.getHeight(this._clone)/2,this.draw(o),me.show()}if(this.options.scroll)if(this.options.scroll==window){var s=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=s.left,this.originalScrollTop=s.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,this.originalScrollTop=this.options.scroll.scrollTop;Draggables.notify("onStart",this,e),this.options.starteffect&&this.options.starteffect(this.element)},Draggable.prototype.draw=function(e){"undefined"==typeof this.elemSizeCaptured&&(setTimeout(function(){if(this._sizes){var e=jQuery(this.element);this._sizes.element={w:e.outerWidth(),h:e.outerHeight()}}}.bind(this),100),this.elemSizeCaptured=!0);var t=jQuery(this.element),i=t.offset(),n={left:e[0]-this._sizes.mouseOffset.left,top:e[1]-this._sizes.mouseOffset.top},o=[n.left,n.top];this.options.snap&&(o=Object.isFunction(this.options.snap)?this.options.snap(o[0],o[1],this):o.map(Object.isArray(this.options.snap)?function(e,t){return(e/this.options.snap[t]).round()*this.options.snap[t]}.bind(this):function(e){return(e/this.options.snap).round()*this.options.snap}.bind(this))),n={left:o[0],top:o[1]},this.options.constraint&&"horizontal"==this.options.constraint&&(n.top=i.top),this.options.constraint&&"vertical"==this.options.constraint&&(n.left=i.left),this.options.mouseOffset&&(n={left:e[0],top:e[1]}),(0>n.top||0>n.left||n.top+this._sizes.element.h>this._sizes.window.h||n.left+this._sizes.element.w>this._sizes.window.w)&&(0>n.top&&(n.top=0),0>n.left&&(n.left=0),n.top+this._sizes.element.h>this._sizes.window.h&&(n.top=this._sizes.window.h-this._sizes.element.h),n.left+this._sizes.element.w>this._sizes.window.w&&(n.left=this._sizes.window.w-this._sizes.element.w)),t.offset(n),this._sequencer=this._sequencer||0,this._sequencer++,1==this._sequencer&&t.offset(n)},Droppables.isAffected=function(e,t,i){return Position.prepare(),positioned_within=Position.withinIncludingScrolloffsets(i.element,e[0],e[1]),i.element!=t&&(!i._containers||this.isContained(t,i))&&(!i.accept||Element.classNames(t).detect(function(e){return i.accept.include(e)}))&&positioned_within},Draggable.prototype.finishDrag=function(e,t){if(this.dragging=!1,delete this._sequencer,delete this._sizes,this.options.quiet){Position.prepare();var i=[Event.pointerX(e),Event.pointerY(e)];Droppables.show(i,this.element)}this.options.ghosting&&(this.element._originallyAbsolute||Position.relativize(this.element),this.element._originallyAbsolute=void 0,Element.remove(this._clone),this._clone=null),this.options.superghosting&&(body=document.getElementsByTagName("body")[0],Element.remove(this.element),new Draggable(this._clone,this.options));var n=!1;t&&(n=Droppables.fire(e,this.element),n||(n=!1)),n&&this.options.onDropped&&this.options.onDropped(this.element),Draggables.notify("onEnd",this,e);var o=this.options.revert;o&&"function"==typeof o&&(o=o(this.element));var s=this.currentDelta();o&&this.options.reverteffect?(0==n||"failure"!=o)&&this.options.reverteffect(this.element,s[1]-this.delta[1],s[0]-this.delta[0]):this.delta=s,this.options.zindex&&(this.element.style.zIndex=this.originalZ,this._clone&&(this._clone.style.zIndex=this.originalZ)),this.options.endeffect&&this.options.endeffect(this.element),Draggables.deactivate(this),Droppables.reset()},define("dragdrop.extra",["dragdrop","jquery"],function(e){return function(){var t;return t||e.Draggable}}(this));var Truncator=Class.create({initialize:function(e,t){if(e&&e[0]){var i=null;t&&(i=t),e.each(function(e){this.truncate(e,i)}.bind(this))}},truncate:function(e,t){if("ABBR"==e.nodeName){var i=e.title.replace("&quot;",'"');e=e.parentNode,e.update(i.strip().escapeHTML())}var n=Object.isUndefined(e.innerText)?e.textContent:e.innerText;e.insert(Truncator.template.evaluate({divId:Truncator.tmpDivId,spanId:Truncator.tmpSpanId}));var o=$(Truncator.tmpSpanId);o.insert(n.escapeHTML());var s=t?t:e.getWidth(),r=o.getWidth();if(s>=r)return void $(Truncator.tmpDivId).remove();for(var a=n,l=0,c=n.length,d=(c-l)/2;d>1;)d+=l,a=n.substr(0,d),isIE()?o.innerText=a:o.update(a.escapeHTML()),o.getWidth()+30>s?c=d:l=d,d=(c-l)/2;$(Truncator.tmpDivId).remove(),e.update(this.truncateString(this.ellipsifyString(a.escapeHTML()),n.escapeHTML().replace('"',"&quot;")))},untruncate:function(e){e.each(function(e){"ABBR"==e.nodeName&&e.update(e.title.strip().escapeHTML())})},ellipsifyString:function(e){return e+"&hellip;"},truncateString:function(e,t){return'<abbr title="'+t+'">'+e+"</abbr>"}});Truncator.tmpDivId="truncator-tmp-div",Truncator.tmpSpanId="truncator-tmp-span",Truncator.template=new Template('    <div id="#{divId}" style="width:9999px; left:-9999px; top:-9999px; display:block; position: absolute">        <span id="#{spanId}"></span>    </div>'),define("tools.truncator",["prototype"],function(e){return function(){var t;return t||e.jQuery}}(this)),function(){var e=Math,t=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",n="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,o="ontouchstart"in window,s=t+"Transform"in document.documentElement.style,r=/android/gi.test(navigator.appVersion),a=/iphone|ipad/gi.test(navigator.appVersion),c=/playbook/gi.test(navigator.appVersion),d=a||c,u=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),h=function(){return window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),p="onorientationchange"in window?"orientationchange":"resize",m=o?"touchstart":"mousedown",f=o?"touchmove":"mousemove",g=o?"touchend":"mouseup",v=o?"touchcancel":"mouseup",_="Moz"==t?"DOMMouseScroll":"mousewheel",b="translate"+(n?"3d(":"("),y=n?",0)":")",T=function(e,i){var l,c=this,u=document;c.wrapper="object"==typeof e?e:u.getElementById(e),c.wrapper.style.overflow="hidden",c.scroller=c.wrapper.children[0],c.options={hScroll:!0,vScroll:!0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:r,hideScrollbar:a,fadeScrollbar:a&&n,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in i)c.options[l]=i[l];c.options.useTransform=s?c.options.useTransform:!1,c.options.hScrollbar=c.options.hScroll&&c.options.hScrollbar,c.options.vScrollbar=c.options.vScroll&&c.options.vScrollbar,c.options.zoom=c.options.useTransform&&c.options.zoom,c.options.useTransition=d&&c.options.useTransition,c.scroller.style[t+"TransitionProperty"]=c.options.useTransform?"-"+t.toLowerCase()+"-transform":"top left",c.scroller.style[t+"TransitionDuration"]="0",c.scroller.style[t+"TransformOrigin"]="0 0",c.options.useTransition&&(c.scroller.style[t+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),c.options.useTransform?c.scroller.style[t+"Transform"]=b+"0,0"+y:c.scroller.style.cssText+=";position:absolute;top:0;left:0",c.options.useTransition&&(c.options.fixedScrollbar=!0),c.refresh(),c._bind(p,window),c._bind(m),o||(c._bind("mouseout",c.wrapper),c._bind(_)),c.options.checkDOMChanges&&(c.checkDOMTime=setInterval(function(){c._checkDOMChanges()},500))};T.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case m:if(!o&&0!==e.button)return;t._start(e);break;case f:t._move(e);break;case g:case v:t._end(e);break;case p:t._resize();break;case _:t._wheel(e);break;case"mouseout":t._mouseout(e);break;case"webkitTransitionEnd":t._transitionEnd(e)}},_checkDOMChanges:function(){this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale||this.refresh()},_scrollbar:function(i){var n,o=this,r=document;return o[i+"Scrollbar"]?(o[i+"ScrollbarWrapper"]||(n=r.createElement("div"),o.options.scrollbarClass?n.className=o.options.scrollbarClass+i.toUpperCase():n.style.cssText="position:absolute;z-index:100;"+("h"==i?"height:7px;bottom:1px;left:2px;right:"+(o.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(o.hScrollbar?"7":"2")+"px;top:2px;right:1px"),n.style.cssText+=";pointer-events:none;-"+t+"-transition-property:opacity;-"+t+"-transition-duration:"+(o.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(o.options.hideScrollbar?"0":"1"),o.wrapper.appendChild(n),o[i+"ScrollbarWrapper"]=n,n=r.createElement("div"),o.options.scrollbarClass||(n.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+t+"-background-clip:padding-box;-"+t+"-box-sizing:border-box;"+("h"==i?"height:100%":"width:100%")+";-"+t+"-border-radius:3px;border-radius:3px"),n.style.cssText+=";pointer-events:none;-"+t+"-transition-property:-"+t+"-transform;-"+t+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+t+"-transition-duration:0;-"+t+"-transform:"+b+"0,0"+y,o.options.useTransition&&(n.style.cssText+=";-"+t+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),o[i+"ScrollbarWrapper"].appendChild(n),o[i+"ScrollbarIndicator"]=n),"h"==i?(o.hScrollbarSize=o.hScrollbarWrapper.clientWidth,o.hScrollbarIndicatorSize=e.max(e.round(o.hScrollbarSize*o.hScrollbarSize/o.scrollerW),8),o.hScrollbarIndicator.style.width=o.hScrollbarIndicatorSize+"px",o.hScrollbarMaxScroll=o.hScrollbarSize-o.hScrollbarIndicatorSize,o.hScrollbarProp=o.hScrollbarMaxScroll/o.maxScrollX):(o.vScrollbarSize=o.vScrollbarWrapper.clientHeight,o.vScrollbarIndicatorSize=e.max(e.round(o.vScrollbarSize*o.vScrollbarSize/o.scrollerH),8),o.vScrollbarIndicator.style.height=o.vScrollbarIndicatorSize+"px",o.vScrollbarMaxScroll=o.vScrollbarSize-o.vScrollbarIndicatorSize,o.vScrollbarProp=o.vScrollbarMaxScroll/o.maxScrollY),void o._scrollbarPos(i,!0)):void(o[i+"ScrollbarWrapper"]&&(s&&(o[i+"ScrollbarIndicator"].style[t+"Transform"]=""),o[i+"ScrollbarWrapper"].parentNode.removeChild(o[i+"ScrollbarWrapper"]),o[i+"ScrollbarWrapper"]=null,o[i+"ScrollbarIndicator"]=null))},_resize:function(){var e=this;setTimeout(function(){e.refresh()},r?200:0)},_pos:function(i,n){i=this.hScroll?i:0,n=this.vScroll?n:0,this.options.useTransform?this.scroller.style[t+"Transform"]=b+i+"px,"+n+"px"+y+" scale("+this.scale+")":(i=e.round(i),n=e.round(n),this.scroller.style.left=i+"px",this.scroller.style.top=n+"px"),this.x=i,this.y=n,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(i,n){var o,s=this,r="h"==i?s.x:s.y;s[i+"Scrollbar"]&&(r=s[i+"ScrollbarProp"]*r,0>r?(s.options.fixedScrollbar||(o=s[i+"ScrollbarIndicatorSize"]+e.round(3*r),8>o&&(o=8),s[i+"ScrollbarIndicator"].style["h"==i?"width":"height"]=o+"px"),r=0):r>s[i+"ScrollbarMaxScroll"]&&(s.options.fixedScrollbar?r=s[i+"ScrollbarMaxScroll"]:(o=s[i+"ScrollbarIndicatorSize"]-e.round(3*(r-s[i+"ScrollbarMaxScroll"])),8>o&&(o=8),s[i+"ScrollbarIndicator"].style["h"==i?"width":"height"]=o+"px",r=s[i+"ScrollbarMaxScroll"]+(s[i+"ScrollbarIndicatorSize"]-o))),s[i+"ScrollbarWrapper"].style[t+"TransitionDelay"]="0",s[i+"ScrollbarWrapper"].style.opacity=n&&s.options.hideScrollbar?"0":"1",s[i+"ScrollbarIndicator"].style[t+"Transform"]=b+("h"==i?r+"px,0":"0,"+r+"px")+y)},_start:function(i){var n,s,r,a,l,c=this,d=o?i.touches[0]:i;T.scrolling=!1,clearTimeout(T.scrollTimer),!c.enabled||Draggables.dragging||i.touches.length<2||(c.options.onBeforeScrollStart&&c.options.onBeforeScrollStart.call(c,i),(c.options.useTransition||c.options.zoom)&&c._transitionTime(0),c.moved=!1,c.animating=!1,c.zoomed=!1,c.distX=0,c.distY=0,c.absDistX=0,c.absDistY=0,c.dirX=0,c.dirY=0,c.options.zoom&&o&&i.touches.length>1&&(a=e.abs(i.touches[0].pageX-i.touches[1].pageX),l=e.abs(i.touches[0].pageY-i.touches[1].pageY),c.touchesDistStart=e.sqrt(a*a+l*l),c.originX=e.abs(i.touches[0].pageX+i.touches[1].pageX-2*c.wrapperOffsetLeft)/2-c.x,c.originY=e.abs(i.touches[0].pageY+i.touches[1].pageY-2*c.wrapperOffsetTop)/2-c.y,c.options.onZoomStart&&c.options.onZoomStart.call(c,i)),c.options.momentum&&(c.options.useTransform?(n=getComputedStyle(c.scroller,null)[t+"Transform"].replace(/[^0-9-.,]/g,"").split(","),s=1*n[4],r=1*n[5]):(s=1*getComputedStyle(c.scroller,null).left.replace(/[^0-9-]/g,""),r=1*getComputedStyle(c.scroller,null).top.replace(/[^0-9-]/g,"")),(s!=c.x||r!=c.y)&&(c.options.useTransition?c._unbind("webkitTransitionEnd"):h(c.aniTime),c.steps=[],c._pos(s,r))),c.absStartX=c.x,c.absStartY=c.y,c.startX=c.x,c.startY=c.y,c.pointX=d.pageX,c.pointY=d.pageY,c.startTime=i.timeStamp||(new Date).getTime(),c.options.onScrollStart&&c.options.onScrollStart.call(c,i),c._bind(f),c._bind(g),c._bind(v),T.scrolling=!0)},_move:function(i){var n,s,r,a=this,l=o?i.touches[0]:i,c=l.pageX-a.pointX,d=l.pageY-a.pointY,u=a.x+c,h=a.y+d,p=i.timeStamp||(new Date).getTime();return a.options.onBeforeScrollMove&&a.options.onBeforeScrollMove.call(a,i),a.options.zoom&&o&&i.touches.length>1?(n=e.abs(i.touches[0].pageX-i.touches[1].pageX),s=e.abs(i.touches[0].pageY-i.touches[1].pageY),a.touchesDist=e.sqrt(n*n+s*s),a.zoomed=!0,r=1/a.touchesDistStart*a.touchesDist*this.scale,r<a.options.scaleMin?r=.5*a.options.scaleMin*Math.pow(2,r/a.options.scaleMin):r>a.options.scaleMax&&(r=2*a.options.scaleMax*Math.pow(.5,a.options.scaleMax/r)),a.lastScale=r/this.scale,u=this.originX-this.originX*a.lastScale+this.x,h=this.originY-this.originY*a.lastScale+this.y,this.scroller.style[t+"Transform"]=b+u+"px,"+h+"px"+y+" scale("+r+")",void(a.options.onZoom&&a.options.onZoom.call(a,i))):(a.pointX=l.pageX,a.pointY=l.pageY,(u>0||u<a.maxScrollX)&&(u=a.options.bounce?a.x+c/2:u>=0||a.maxScrollX>=0?0:a.maxScrollX),(h>0||h<a.maxScrollY)&&(h=a.options.bounce?a.y+d/2:h>=0||a.maxScrollY>=0?0:a.maxScrollY),a.absDistX<6&&a.absDistY<6?(a.distX+=c,a.distY+=d,a.absDistX=e.abs(a.distX),void(a.absDistY=e.abs(a.distY))):(a.options.lockDirection&&(a.absDistX>a.absDistY+5?(h=a.y,d=0):a.absDistY>a.absDistX+5&&(u=a.x,c=0)),a.moved=!0,a._pos(u,h),a.dirX=c>0?-1:0>c?1:0,a.dirY=d>0?-1:0>d?1:0,p-a.startTime>300&&(a.startTime=p,a.startX=a.x,a.startY=a.y),void(a.options.onScrollMove&&a.options.onScrollMove.call(a,i))))},_end:function(i){if(!o||0==i.touches.length){var n,s,r,a,l,c,d=this,u=o?i.changedTouches[0]:i,h={dist:0,time:0},p={dist:0,time:0},m=(i.timeStamp||(new Date).getTime())-d.startTime,_=d.x,S=d.y;if(d._unbind(f),d._unbind(g),d._unbind(v),T.scrollTimer=setTimeout(function(){T.scrolling=!1},1e3),d.options.onBeforeScrollEnd&&d.options.onBeforeScrollEnd.call(d,i),d.zoomed)return c=d.scale*d.lastScale,c=Math.max(d.options.zoomMin,c),c=Math.min(d.options.zoomMax,c),d.lastScale=c/d.scale,d.scale=c,d.x=d.originX-d.originX*d.lastScale+d.x,d.y=d.originY-d.originY*d.lastScale+d.y,d.scroller.style[t+"TransitionDuration"]="200ms",d.scroller.style[t+"Transform"]=b+d.x+"px,"+d.y+"px"+y+" scale("+d.scale+")",d.zoomed=!1,d.refresh(),void(d.options.onZoomEnd&&d.options.onZoomEnd.call(d,i));if(!d.moved)return o&&(d.doubleTapTimer&&d.options.zoom?(clearTimeout(d.doubleTapTimer),d.doubleTapTimer=null,d.options.onZoomStart&&d.options.onZoomStart.call(d,i),d.zoom(d.pointX,d.pointY,1==d.scale?d.options.doubleTapZoom:1)):d.doubleTapTimer=setTimeout(function(){for(d.doubleTapTimer=null,n=u.target;1!=n.nodeType;)n=n.parentNode;"SELECT"!=n.tagName&&"INPUT"!=n.tagName&&"TEXTAREA"!=n.tagName&&(s=document.createEvent("MouseEvents"),s.initMouseEvent("click",!0,!0,i.view,1,u.screenX,u.screenY,u.clientX,u.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null),s._fake=!0,n.dispatchEvent(s))},d.options.zoom?250:0)),d._resetPos(200),void(d.options.onTouchEnd&&d.options.onTouchEnd.call(d,i));if(i.scrollEvent=!0,300>m&&d.options.momentum&&(h=_?d._momentum(_-d.startX,m,-d.x,d.scrollerW-d.wrapperW+d.x,d.options.bounce?d.wrapperW:0):h,p=S?d._momentum(S-d.startY,m,-d.y,d.maxScrollY<0?d.scrollerH-d.wrapperH+d.y:0,d.options.bounce?d.wrapperH:0):p,_=d.x+h.dist,S=d.y+p.dist,(d.x>0&&_>0||d.x<d.maxScrollX&&_<d.maxScrollX)&&(h={dist:0,time:0}),(d.y>0&&S>0||d.y<d.maxScrollY&&S<d.maxScrollY)&&(p={dist:0,time:0})),h.dist||p.dist)return l=e.max(e.max(h.time,p.time),10),d.options.snap&&(r=_-d.absStartX,a=S-d.absStartY,e.abs(r)<d.options.snapThreshold&&e.abs(a)<d.options.snapThreshold?d.scrollTo(d.absStartX,d.absStartY,200):(snap=d._snap(_,S),_=snap.x,S=snap.y,l=e.max(snap.time,l))),d.scrollTo(_,S,l),void(d.options.onTouchEnd&&d.options.onTouchEnd.call(d,i));if(d.options.snap)return r=_-d.absStartX,a=S-d.absStartY,e.abs(r)<d.options.snapThreshold&&e.abs(a)<d.options.snapThreshold?d.scrollTo(d.absStartX,d.absStartY,200):(snap=d._snap(d.x,d.y),(snap.x!=d.x||snap.y!=d.y)&&d.scrollTo(snap.x,snap.y,snap.time)),void(d.options.onTouchEnd&&d.options.onTouchEnd.call(d,i));d._resetPos(200),d.options.onTouchEnd&&d.options.onTouchEnd.call(d,i)}},_resetPos:function(e){var i=this,n=i.x>=0?0:i.x<i.maxScrollX?i.maxScrollX:i.x,o=i.y>=0||i.maxScrollY>0?0:i.y<i.maxScrollY?i.maxScrollY:i.y;return n==i.x&&o==i.y?(i.moved&&(i.moved=!1,i.options.onScrollEnd&&i.options.onScrollEnd.call(i)),i.hScrollbar&&i.options.hideScrollbar&&("webkit"==t&&(i.hScrollbarWrapper.style[t+"TransitionDelay"]="300ms"),i.hScrollbarWrapper.style.opacity="0"),void(i.vScrollbar&&i.options.hideScrollbar&&("webkit"==t&&(i.vScrollbarWrapper.style[t+"TransitionDelay"]="300ms"),i.vScrollbarWrapper.style.opacity="0"))):void i.scrollTo(n,o,e||0)},_wheel:function(e){var t,i,n,o,s,r=this;return"wheelDeltaX"in e?(t=e.wheelDeltaX/12,i=e.wheelDeltaY/12):t=i="detail"in e?3*-e.detail:-e.wheelDelta,"zoom"==r.options.wheelAction?(s=r.scale*Math.pow(2,1/3*(i?i/Math.abs(i):0)),i<r.options.zoomMin&&(i=r.options.zoomMin),i>r.options.zoomMax&&(i=r.options.zoomMax),void(i!=r.scale&&(!r.wheelZoomCount&&r.options.onZoomStart&&r.options.onZoomStart.call(r,e),r.wheelZoomCount++,r.zoom(e.pageX,e.pageY,i,400),setTimeout(function(){r.wheelZoomCount--,!r.wheelZoomCount&&r.options.onZoomEnd&&r.options.onZoomEnd.call(r,e)},400)))):(n=r.x+t,o=r.y+i,n>0?n=0:n<r.maxScrollX&&(n=r.maxScrollX),o>0?o=0:o<r.maxScrollY&&(o=r.maxScrollY),void r.scrollTo(n,o,0))},_mouseout:function(e){var t=e.relatedTarget;if(!t)return void this._end(e);for(;t=t.parentNode;)if(t==this.wrapper)return;this._end(e)},_transitionEnd:function(e){var t=this;e.target==t.scroller&&(t._unbind("webkitTransitionEnd"),t._startAni())},_startAni:function(){var t,i,n=this,o=n.x,s=n.y,r=(new Date).getTime();if(!n.animating)return n.steps.length?(t=n.steps.shift(),t.x==o&&t.y==s&&(t.time=0),n.animating=!0,n.moved=!0,n.options.useTransition?(n._transitionTime(t.time),n._pos(t.x,t.y),n.animating=!1,void(t.time?n._bind("webkitTransitionEnd"):n._resetPos(0))):void function a(){var l,c,d=(new Date).getTime();return d>=r+t.time?(n._pos(t.x,t.y),n.animating=!1,n.options.onAnimationEnd&&n.options.onAnimationEnd.call(n),void n._startAni()):(d=(d-r)/t.time-1,i=e.sqrt(1-d*d),l=(t.x-o)*i+o,c=(t.y-s)*i+s,n._pos(l,c),void(n.animating&&(n.aniTime=u(a))))}()):void n._resetPos(400)},_transitionTime:function(e){e+="ms",this.scroller.style[t+"TransitionDuration"]=e,this.hScrollbar&&(this.hScrollbarIndicator.style[t+"TransitionDuration"]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[t+"TransitionDuration"]=e)},_momentum:function(t,i,n,o,s){var r=6e-4,a=e.abs(t)/i,l=a*a/(2*r),c=0,d=0;return t>0&&l>n?(d=s/(6/(l/a*r)),n+=d,a=a*n/l,l=n):0>t&&l>o&&(d=s/(6/(l/a*r)),o+=d,a=a*o/l,l=o),l*=0>t?-1:1,c=a/r,{dist:l,time:e.round(c)}},_offset:function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return e!=this.wrapper&&(t*=this.scale,i*=this.scale),{left:t,top:i}},_snap:function(t,i){var n,o,s,r,a,l,c=this;for(s=c.pagesX.length-1,n=0,o=c.pagesX.length;o>n;n++)if(t>=c.pagesX[n]){s=n;break}for(s==c.currPageX&&s>0&&c.dirX<0&&s--,t=c.pagesX[s],a=e.abs(t-c.pagesX[c.currPageX]),a=a?e.abs(c.x-t)/a*500:0,c.currPageX=s,s=c.pagesY.length-1,n=0;s>n;n++)if(i>=c.pagesY[n]){s=n;break}return s==c.currPageY&&s>0&&c.dirY<0&&s--,i=c.pagesY[s],l=e.abs(i-c.pagesY[c.currPageY]),l=l?e.abs(c.y-i)/l*500:0,c.currPageY=s,r=e.round(e.max(a,l))||200,{x:t,y:i,time:r}},_bind:function(e,t,i){(t||this.scroller).addEventListener(e,this,!!i)},_unbind:function(e,t,i){(t||this.scroller).removeEventListener(e,this,!!i)},destroy:function(){var e=this;e.scroller.style[t+"Transform"]="",e.hScrollbar=!1,e.vScrollbar=!1,e._scrollbar("h"),e._scrollbar("v"),e._unbind(p,window),e._unbind(m),e._unbind(f),e._unbind(g),e._unbind(v),e.options.hasTouch&&(e._unbind("mouseout",e.wrapper),e._unbind(_)),e.options.useTransition&&e._unbind("webkitTransitionEnd"),e.options.checkDOMChanges&&clearInterval(e.checkDOMTime),e.options.onDestroy&&e.options.onDestroy.call(e)},refresh:function(){var n,o=this,s=0,r=0;if(T.scrolling=!1,o.scale<o.options.zoomMin&&(o.scale=o.options.zoomMin),o.wrapperW=o.wrapper.clientWidth||1,o.wrapperH=o.wrapper.clientHeight||1,o.scrollerW=e.round(o.scroller.offsetWidth*o.scale),o.scrollerH=e.round(o.scroller.offsetHeight*o.scale),o.maxScrollX=o.wrapperW-o.scrollerW,o.maxScrollY=o.wrapperH-o.scrollerH,o.dirX=0,o.dirY=0,o.hScroll=o.options.hScroll&&o.maxScrollX<0,o.vScroll=o.options.vScroll&&(!o.options.bounceLock&&!o.hScroll||o.scrollerH>o.wrapperH),o.hScrollbar=o.hScroll&&o.options.hScrollbar,o.vScrollbar=o.vScroll&&o.options.vScrollbar&&o.scrollerH>o.wrapperH,n=o._offset(o.wrapper),o.wrapperOffsetLeft=-n.left,o.wrapperOffsetTop=-n.top,"string"==typeof o.options.snap)for(o.pagesX=[],o.pagesY=[],els=o.scroller.querySelectorAll(o.options.snap),i=0,l=els.length;l>i;i++)s=o._offset(els[i]),s.left+=o.wrapperOffsetLeft,s.top+=o.wrapperOffsetTop,o.pagesX[i]=s.left<o.maxScrollX?o.maxScrollX:s.left*o.scale,o.pagesY[i]=s.top<o.maxScrollY?o.maxScrollY:s.top*o.scale;
else if(o.options.snap){for(o.pagesX=[];s>=o.maxScrollX;)o.pagesX[r]=s,s-=o.wrapperW,r++;for(o.maxScrollX%o.wrapperW&&(o.pagesX[o.pagesX.length]=o.maxScrollX-o.pagesX[o.pagesX.length-1]+o.pagesX[o.pagesX.length-1]),s=0,r=0,o.pagesY=[];s>=o.maxScrollY;)o.pagesY[r]=s,s-=o.wrapperH,r++;o.maxScrollY%o.wrapperH&&(o.pagesY[o.pagesY.length]=o.maxScrollY-o.pagesY[o.pagesY.length-1]+o.pagesY[o.pagesY.length-1])}o._scrollbar("h"),o._scrollbar("v"),o.zoomed||(o.scroller.style[t+"TransitionDuration"]="0",o._resetPos(200))},scrollTo:function(e,t,i,n){var o,s,r=this,a=e;for(r.stop(),a.length||(a=[{x:e,y:t,time:i,relative:n}]),o=0,s=a.length;s>o;o++)a[o].relative&&(a[o].x=r.x-a[o].x,a[o].y=r.y-a[o].y),r.steps.push({x:a[o].x,y:a[o].y,time:a[o].time||0});r._startAni()},scrollToElement:function(t,i){var n,o=this;t=t.nodeType?t:o.scroller.querySelector(t),t&&(n=o._offset(t),n.left+=o.wrapperOffsetLeft,n.top+=o.wrapperOffsetTop,n.left=n.left>0?0:n.left<o.maxScrollX?o.maxScrollX:n.left,n.top=n.top>0?0:n.top<o.maxScrollY?o.maxScrollY:n.top,i=void 0===i?e.max(2*e.abs(n.left),2*e.abs(n.top)):i,o.scrollTo(n.left,n.top,i))},scrollToPage:function(e,t,i){var n,o,s=this;s.options.snap?(e="next"==e?s.currPageX+1:"prev"==e?s.currPageX-1:e,t="next"==t?s.currPageY+1:"prev"==t?s.currPageY-1:t,e=0>e?0:e>s.pagesX.length-1?s.pagesX.length-1:e,t=0>t?0:t>s.pagesY.length-1?s.pagesY.length-1:t,s.currPageX=e,s.currPageY=t,n=s.pagesX[e],o=s.pagesY[t]):(n=-s.wrapperW*e,o=-s.wrapperH*t,n<s.maxScrollX&&(n=s.maxScrollX),o<s.maxScrollY&&(o=s.maxScrollY)),s.scrollTo(n,o,i||400)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(f),this._unbind(g),this._unbind(v)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):h(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,i,n,o){var s=this,r=n/s.scale;s.options.useTransform&&(s.zoomed=!0,o=void 0===o?200:o,e=e-s.wrapperOffsetLeft-s.x,i=i-s.wrapperOffsetTop-s.y,s.x=e-e*r+s.x,s.y=i-i*r+s.y,s.scale=n,s.refresh(),s.x=s.x>0?0:s.x<s.maxScrollX?s.maxScrollX:s.x,s.y=s.y>0?0:s.y<s.maxScrollY?s.maxScrollY:s.y,s.scroller.style[t+"TransitionDuration"]=o+"ms",s.scroller.style[t+"Transform"]=b+s.x+"px,"+s.y+"px"+y+" scale("+n+")",s.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},"undefined"!=typeof exports?exports.iScroll=T:window.iScroll=T}(),define("iscroll",function(e){return function(){var t;return t||e.iScroll}}(this));var webHelpModule={currentContext:"default",displayWebHelp:function(){var e=__jrsConfigs__.webHelpModuleState;if(e){var t=e.hostURL+"/"+e.pagePrefix+webHelpModule.getPageForContext();window.name="";var i=window.open(t,"MCWebHelp");i.focus()}},getPageForContext:function(){return __jrsConfigs__.webHelpModuleState.contextMap[webHelpModule.currentContext]},setCurrentContext:function(e){webHelpModule.currentContext=e}};define("components.webHelp",["jrs.configs"],function(e){return function(){var t;return t||e.webHelpModule}}(this));var layoutModule={ELEMENT_CONTEXTMENU:"element:contextmenu",SIZEABLE_PATTERN:".sizeable",SIZER_PATTERN:".sizer",RESIZE_OVERLAY_PATTERN:".resizeOverlay",MOVEABLE_PATTERN:".moveable",MOVER_PATTERN:".mover",MINIMIZER_PATTERN:".maximized .minimize",MINIMIZED_PATTERN:".minimized .minimize",TRUNCATE_PATTERN:".trunc",TREE_LEAF_PATTERN:"a.>node",TREE_CONTAINER_PATTERN:".collapsible",TOOLBAR_CAPSULE_PATTERN:"#toolbar .capsule",NAVIGATION_MUTTON_PATTERN:"li.mutton",NAVIGATION_PATTERN:"#navigationOptions li",NAVIGATION_HOVER_PATTERN:"#navigationOptions li.over",META_LINKS_PATTERN:"#metaLinks #main_logOut_link",BUTTON_SET_BUTTON:".buttonSet > *",TABSET_TAB_PATTERN:".tab",BUTTON_PATTERN:".button",PRESSED_PATTERN:".pressed",SELECTED_PATTERN:".selected",LIST_ITEM_PATTERN:".list.responsive > li",LIST_ITEM_WRAP_PATTERN:".wrap",DISCLOSURE_BUTTON_PATTERN:".disclosure",MENU_LIST_PATTERN:"#menu li",SEPARATOR_PATTERN:".separator",MESSAGE_PATTERN:".message",MESSAGE_WARNING_PATTERN:".message.warning",MESSAGE_SUCCESS_PATTERN:".message.success",DETAILS_PATTERN:".details",COLUMN_NODE_WRAPPER_PATTERN:".node > .wrap > .column",COLUMN_LEAF_WRAPPER_PATTERN:".leaf > .wrap > .column",SEARCH_LOCKUP_PATTERN:".searchLockup",DIALOG_PATTERN:".dialog",DIALOG_LOADING_PATTERN:".dialog.loading",SWIPE_SCROLL_PATTERN:".swipeScroll",SCROLL_WRAPPER_PATTERN:".scrollWrapper",ADHOC_MODE_OPTION_CLASS:"tab mode horizontal",DRAGGING_CLASS:"dragging",COPY_CLASS:"copy",PRESSED_CLASS:"pressed",SELECTED_CLASS:"selected",DISABLED_CLASS:"disabled",HOVERED_CLASS:"over",ERROR_CLASS:"error",SUCCESS_CLASS:"error",MESSAGE_CLASS:"error",UP_CLASS:"up",LAST_CLASS:"last",FIRST_CLASS:"first",SCHEDULED_CLASS:"scheduled",NODE_CLASS:"node",LEAF_CLASS:"leaf",ICON_CLASS:"icon",OPEN_CLASS:"open",CLOSED_CLASS:"closed",LOADING_CLASS:"loading",NOTHING_TO_DISPLAY_CLASS:"nothingToDisplay",COLLAPSIBLE_CLASS:"collapsible",RESPONSIVE_CLASS:"responsive",HIDDEN_CLASS:"hidden",NO_GENERATORS_CLASS:"noGenerators",STACKTRACE_CLASS:"stacktrace",EMPHASIS_CLASS:"emphasis",ASCENDING_CLASS:"ascending",DESCENDING_CLASS:"descending",CANCELLABLE_CLASS:"cancellable",DROP_TARGET_CLASS:"dropTarget",BUTTON_CLASS:"button",ONE_COLUMN_CLASS:"oneColumn",CONTROL_PAGE_CLASS:"controlPage",DISABLED_ATTR_NAME:"disabled",SELECTED_ATTR_NAME:"selected",OPEN_ATTR_NAME:"open",CLOSED_ATTR_NAME:"closed",READONLY_ATTR_NAME:"readonly",DIMMER_ID:"pageDimmer",PAGE_BODY_ID:"display",MENU_ID:"menu",MAIN_NAVIGATION_ID:"mainNavigation",MAIN_NAVIGATION_HOME_ITEM_ID:"main_home",MAIN_NAVIGATION_LIBRARY_ITEM_ID:"main_library",META_LINK_LOGOUT_ID:"main_logOut_link",SCROLL_SENSITIVITY:50,DND_MOVABLE_ZINDEX:2e3,DIMMER_Z_INDEX:900,FOLDERS_RESIZABLE_PANEL_ID:"folders",FILTERS_RESIZABLE_PANEL_ID:"filters",PROPERTIES_RESIZABLE_PANEL_ID:"properties",FIELDS_RESIZABLE_PANEL_ID:"fields",FOLDERS_RESIZABLE_PANEL_COOKIE_NAME:"foldersPanelWidth",FOLDERS_MINIMIZED_PANEL_COOKIE_NAME:"foldersMinimized",FILTERS_RESIZABLE_PANEL_COOKIE_NAME:"filtersPanelWidth",FILTERS_MINIMIZED_PANEL_COOKIE_NAME:"filtersMinimized",PROPERTIES_RESIZABLE_PANEL_COOKIE_NAME:"propertiesPanelWidth",PROPERTIES_MINIMIZED_PANEL_COOKIE_NAME:"propertiesMinimized",FIELDS_RESIZABLE_PANEL_COOKIE_NAME:"fieldsPanelWidth",FIELDS_MINIMIZED_PANEL_COOKIE_NAME:"fieldsMinimized",PANEL_WIDTH:"PanelWidth",MINIMIZED:"Minimized",PANEL_STATE_CHANGED_MANUALLY:"PSCM",scrolls:$H(),initialize:function(e){e=$(e)||$(document.body),new Truncator(e.select(layoutModule.TRUNCATE_PATTERN)),isIE7()&&this.fixIE7Sizes(),e.select(this.SIZEABLE_PATTERN).each(this.createSizer.bind(this)),e.select(this.MOVEABLE_PATTERN).each(this.createMover.bind(this)),e.select(".centered_horz,.centered_vert").each(function(e){var t=parseFunc(e,"centered_fn_");t||(t=centerElement),t(e,{horz:e.match(".centered_horz"),vert:e.match(".centered_vert")})}),null!=$(layoutModule.DIMMER_ID)&&($(layoutModule.DIMMER_ID).style.zIndex=layoutModule.DIMMER_Z_INDEX),jQuery.datepicker&&jQuery.datepicker.initialized&&(jQuery.datepicker.initialized=!1),jQuery(function(){0==jQuery("#ajaxbuffer").length&&jQuery("body").append(jQuery('<div id="ajaxbuffer" style="display:none"></div>'))}),jQuery(window).resize(function(){this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){jQuery(this).trigger("resizeEnd")},500)})},updateOnOrientation:function(){},isVisible:function(e){return e&&!$(e).hasClassName(layoutModule.HIDDEN_CLASS)},createScroller:function(e,t){if(e){e=e.identify?e:$(e);var i=layoutModule.scrolls.get(e.identify());i&&i.destroy();var n=["mainTableContainer","resultsContainer","filtersPanel","foldersPodContent"];e.identify().startsWith("iframeScroll_")&&n.push(e.identify()),t=Object.extend({hideScrollbar:!1,useTransform:!n.include(e.identify()),bounce:["resultsContainer"].include(e.identify())},t||{});var o=new iScroll(e,t);return layoutModule.scrolls.set(e.identify(),o),o}return null},createSizer:function(e,t){e=$(e);var i=t&&t.sizer?$(t.sizer):e.down(this.SIZER_PATTERN);if(i&&!matchMeOrUp(e,"."+layoutModule.HIDDEN_CLASS)){var n=this.getSizerType(i),o=this.alignmentModule.getSizerAlignment(i,n),s=new Draggable(i);s.resizeablePanel=e,s.primaryPanel=$(e).siblings().find(function(e){return e.match(".primary")}),t&&t.fillerPattern&&(s.filler=$(jQuery(e).find(t.fillerPattern)[0]));var r=function(){return function(e){s.pointerX=e.pointerX(),s.pointerY=e.pointerY()}}();i.observe("mousedown",r),jQuery(i).bind({touchstart:function(e){r(e.originalEvent),this.style.background="#666",this.style.zIndex=9},touchend:function(){this.style.background="transparent"}}),s.sizerType=n,s.alignment=o,s.options={constraint:"diagonal"===n?"":n,onStart:layoutModule.beginSizerDragging.bind(layoutModule),onDrag:isIPad()?doNothing:layoutModule.respondToDrag.bind(layoutModule),onEnd:layoutModule.endSizerDragging.bind(layoutModule)}}},getSizerType:function(e){return e.match(".horizontal")&&"horizontal"||e.match(".vertical")&&"vertical"||e.match(".diagonal")&&"diagonal"},alignmentModule:{alignments:[["left","right"],["top","bottom"]],alignmentIndexes:{horizontal:0,vertical:1},dimensions:["width","height"],getSizerAlignment:function(e,t){var i=["",""];if("diagonal"===t)return["right","bottom"];var n=this.alignmentIndexes[t],o=this.alignments[n],s=[0,1].map(function(t){return parseInt(e.getStyle(o[t]))}),r=isNaN(s[0])||s[0]>s[1]?o[1]:o[0];return i[n]=r,i}},beginSizerDragging:function(e,t){var i=e.element;e.parentOffset=[i.getStyle(e.alignment[0]),i.getStyle(e.alignment[1])],e.offsetUnit="px",e.pointerX=e.pointerX||t.pointerX(),e.pointerY=e.pointerY||t.pointerY(),e.element.addClassName(layoutModule.DRAGGING_CLASS),$$(layoutModule.RESIZE_OVERLAY_PATTERN).each(function(e){e.removeClassName(layoutModule.HIDDEN_CLASS)})},endSizerDragging:function(e,t){layoutModule.respondToDrag(e,t),e.element.removeClassName(layoutModule.DRAGGING_CLASS),$$(layoutModule.RESIZE_OVERLAY_PATTERN).each(function(e){e.addClassName(layoutModule.HIDDEN_CLASS)}),document.fire("dragger:sizer",{targetEvent:t,element:e.element})},respondToDrag:function(e,t){"vertical"!==e.sizerType&&this.resizeOnDrag(e,t,"horizontal"),"horizontal"!==e.sizerType&&this.resizeOnDrag(e,t,"vertical")},resizeOnDrag:function(e,t,i){var n={};n.axis="horizontal"==i?0:1,n.myAlignments=this.alignmentModule.alignments[n.axis],n.dimension=this.alignmentModule.dimensions[n.axis],n.sizeProperty=n.axis?"offsetHeight":"offsetWidth";{var o=n.axis?"pointerY":"pointerX",s={pointerY:"clientY",pointerX:"clientX"};e.element}n.sizeableAnchorage=e.alignment[n.axis]===n.myAlignments[0]?n.myAlignments[1]:n.myAlignments[0];var r=t.changedTouches?t.changedTouches[0][s[o]]:t[o](),a=e[o]?r-e[o]:0;a=e.alignment[n.axis]===n.myAlignments[1]?a:0-a,n.dragDelta=a,e[o]=t[o](),this.resizePanelsOnDrag(e,n)},resizePanelsOnDrag:function(e,t){var i=this.getSizeTracker();i.checkpoint(e.resizeablePanel[t.sizeProperty]),e.filler&&!e["fillerDelta"+t.dimension]&&(e["fillerDelta"+t.dimension]=e.resizeablePanel[t.sizeProperty]-e.filler[t.sizeProperty]);var n=getDimensionInPx(e.resizeablePanel,t.dimension);if((this.isInBounds(e,t)||!this.isInBounds(e,t)&&t.dragDelta<0)&&(e.resizeablePanel.setStyle(t.dimension+":"+(n+t.dragDelta)+"px"),e.filler&&e.filler.setStyle(t.dimension+":"+(n+t.dragDelta-e["fillerDelta"+t.dimension])+"px")),new JSCookie(e.resizeablePanel.identify()+layoutModule.PANEL_WIDTH,e.resizeablePanel.getWidth()),!i.changed(e.resizeablePanel[t.sizeProperty])){var o=getActualDimension(e.resizeablePanel,t.dimension);return e.alignment[t.axis]!=t.myAlignments[0]&&(e.element.style[t.myAlignments[0]]=""),e.element.setStyle(e.alignment[t.axis]+":"+e.parentOffset[t.axis]),e.resizeablePanel.setStyle(t.dimension+":"+o+"px"),e.primaryPanel&&e.primaryPanel.style.zIndex==e.resizeablePanel.style.zIndex&&e.primaryPanel.setStyle(t.sizeableAnchorage+":"+o+"px"),void(e.filler&&e.filler.setStyle(t.dimension+":"+(o-e["fillerDelta"+t.dimension])+"px"))}var s;if(e.resizeablePanel.currentStyle?s=e.resizeablePanel.currentStyle.minWidth:(s=document.defaultView.getComputedStyle(e.resizeablePanel,null),s=s["min-width"]?s["min-width"]:s.minWidth),s=s.substring(0,s.indexOf("px")),e.primaryPanel&&e.primaryPanel.style.zIndex==e.resizeablePanel.style.zIndex){var r=getDimensionInPx(e.primaryPanel,t.sizeableAnchorage)+t.dragDelta,a=s>r?s:r;e.primaryPanel.setStyle(t.sizeableAnchorage+":"+a+"px")}e.alignment[t.axis]!=t.myAlignments[0]&&(e.element.style[t.myAlignments[0]]=""),e.element.setStyle(e.alignment[t.axis]+":"+e.parentOffset[t.axis]),jQuery("body").trigger("layout_update")},isInBounds:function(e,t){var i,n,o,s,r,a=jQuery(e.primaryPanel),l=a.parent(),c=t.dimension;if(e.primaryPanel){c=c.replace(c.charAt(0),c.charAt(0).toUpperCase()),r=jQuery.fn["outer"+c],s=r.call(a,!0)-r.call(a),i=parseInt(a.css("min-"+t.dimension)),isNaN(i)&&(i=0),n=parseInt(a.css(t.sizeableAnchorage)),o=parseInt(l.css(t.dimension));var d=l.children("div:visible:not(.minimized)");return jQuery.each(d,function(){var t=jQuery(this),i=0===t.width()||0===t.height();e.resizeablePanel==this||e.primaryPanel==this||i||(o-=r.call(t,!0))}),o-n-t.dragDelta>i+s}return!0},getSizeTracker:function(){return lastSize=-1,{checkpoint:function(e){lastSize=e},changed:function(e){return e!=lastSize}}},createMover:function(e){var t=e.down(this.MOVER_PATTERN);if(t&&!matchMeOrUp(e,"."+layoutModule.HIDDEN_CLASS)){var i=Math.max(this.DND_MOVABLE_ZINDEX,e.getStyle("zIndex"));new Draggable(e,{handle:t,zindex:i})}},maximize:function(e,t){function i(){o.removeClassName("minimized_if_vertical_orientation"),o.removeClassName("minimized"),o.addClassName("maximized"),new JSCookie(o.identify()+layoutModule.MINIMIZED,!1),jQuery("div.content",o).show()}t=!0;var n=e.hasClassName?e:$(e),o=n.hasClassName("column")?n:n.up(".column");0===window.orientation&&("filters"==o.id&&layoutModule.minimize(document.getElementById("fields")),"fields"==o.id&&layoutModule.minimize(document.getElementById("filters")));var s,r=layoutModule.alignmentModule.alignments[0],a=r.map(function(e){return parseInt(o.getStyle(e))}),l=r[0===a[0]?0:1],c=o.siblings().find(function(e){return e.match(".primary")});c&&(s=new JSCookie(o.identify()+layoutModule.PANEL_WIDTH).value),s&&!isNaN(s)&&(s+="px",o.setStyle({width:s}),t?(c.style[l]=s,o.removeClassName("minimized_if_vertical_orientation"),o.removeClassName("minimized"),o.addClassName("maximized"),new JSCookie(o.identify()+layoutModule.MINIMIZED,!1),jQuery("div.content",o).show(),jQuery("div.vtitle",o).hide()):(new Effect.Morph(c,{style:l+":"+s,duration:.6,afterFinish:function(){jQuery("body").trigger("layout_update")}}),new Effect.Opacity(o,{to:0,from:1,duration:.3,queue:{position:"front",scope:"sidePanel"},afterFinish:i}),new Effect.Opacity(o,{to:1,from:0,duration:.3,queue:{position:"end",scope:"sidePanel"}}))),jQuery(o).find(".sizer").show(),jQuery("body").trigger("layout_update",{elem:e.parentNode,type:"panel-maximize"}),jQuery(".column.secondary > div.content > .body").show().height()},minimize:function(e,t){function i(){r.addClassName("minimized"),r.removeClassName("maximized"),r.removeClassName("minimized_if_vertical_orientation"),new JSCookie(r.identify()+layoutModule.MINIMIZED,!0),jQuery("div.content",r).hide()}var n,o;t=!0;var s=e.hasClassName?e:$(e),r=s.hasClassName("column")?s:s.up(".column"),a="true"==new JSCookie(r.identify()+layoutModule.MINIMIZED).value;!a&&new JSCookie(r.identify()+layoutModule.PANEL_WIDTH,r.getWidth());var l=layoutModule.alignmentModule.alignments[0],c=l.map(function(e){return parseInt(r.getStyle(e))}),d=l[0===c[0]?0:1];if(n=r.siblings().find(function(e){return e.match(".primary")}))if(o=n.getStyle(d),t){var u=jQuery("div.title",r).eq(0),h=jQuery("div.vtitle",r),p=u.html(),m=u.width();m=7*jQuery.trim(u.text()).length,n.style[d]="12px",r.addClassName("minimized"),r.removeClassName("maximized"),r.removeClassName("minimized_if_vertical_orientation"),new JSCookie(r.identify()+layoutModule.MINIMIZED,!0),h.length||(h=jQuery('<div class="vtitle"></div>').appendTo(r),h.on("mouseup touchend",function(e){layoutModule.maximize(h[0]),e.preventDefault()}),h.html(jQuery.trim(p)).width(m+24)),isIE7()||isIE8()||isIE9()?h.css({top:0,left:0}):h.css("top",m+24+"px"),location.href.indexOf("nui=1")>0?h.hide():h.show(),jQuery("div.content",r).hide()}else new Effect.Morph(n,{style:d+":0px",duration:.6,afterFinish:function(){jQuery("body").trigger("layout_update")}}),new Effect.Opacity(r,{to:0,from:1,duration:.3,queue:{position:"front",scope:"sidePanel"},afterFinish:i}),new Effect.Opacity(r,{to:1,from:0,duration:.3,queue:{position:"end",scope:"sidePanel"}});jQuery(r).find(".sizer").hide(),jQuery("body").trigger("layout_update",{elem:e.parentNode,type:"panel-minimize"})},resizeOnClient:function(e,t,i){var n,o=[],s=jQuery("#"+t),r=jQuery("#display").width()-20-parseInt(s.width());jQuery.each([e,i],function(e,t){t&&(o.push({id:t,isLeft:0==e?!0:!1,jo:jQuery("#"+t),width:parseInt(new JSCookie(t+layoutModule.PANEL_WIDTH).value)}),o[e].minimized=new JSCookie(t+layoutModule.MINIMIZED).value,o[e].minimized=Object.isUndefined(o[e].minimized)?o[e].jo.hasClass("minimized"):"true"==o[e].minimized,n=o[e].jo[0].currentStyle?o[e].jo[0].currentStyle.minWidth:document.defaultView.getComputedStyle(o[e].jo[0],null).minWidth,o[e].minWidth=(n&&n.indexOf("px"))>0?n.substring(0,n.indexOf("px")):200,o[e].width=o[e].width?o[e].width:o[e].jo.width(),r-=o[e].width)});var a=0>r?Math.abs(r):0;r=0,jQuery.each(o,function(e,t){t.jo.length&&t.jo.is(":visible")&&(t.minimized?(t.jo.removeClass("maximized").addClass("minimized"),layoutModule.minimize(t.jo[0],!0)):(1==e&&!o[0].minimized&&o[0].jo.is(":visible")&&(t.width-=a,t.width<t.minWidth&&(r=t.width-t.minWidth,t.width=t.minWidth)),t.jo.removeClass("minimized").addClass("maximized"),s.css(t.isLeft?"left":"right",t.width+"px"),t.jo.css("width",t.width+"px")))}),0!=r&&(o[0].width+=r,o[0].width=o[0].width<o[0].minWidth?o[0].minWidth:o[0].width,s.css("left",o[0].width+"px"),o[0].jo.css("width",o[0].width+"px"))},autoMaximize:function(e){var t=new JSCookie(e.identify()+layoutModule.MINIMIZED).value;"true"==t?e.hasClassName("minimized")&&layoutModule.maximize(e,!0):!e.hasClassName("minimized")&&layoutModule.minimize(e,!0)},autoMinimize:function(e){var t=new JSCookie(e.identify()+layoutModule.MINIMIZED).value;"false"==t?layoutModule.minimize(e,!0):e.removeClassName("minimized")},fixIE7Sizes:function(){$$(".control.tabSet.buttons.vertical").each(function(e){e.immediateDescendants().each(function(t){t.style.width=e.clientWidth||e.offsetWidth})})},storePanelWidth:function(e,t){new JSCookie(e+layoutModule.PANEL_WIDTH,t)},getPanelWidth:function(e){return new JSCookie(e+layoutModule.PANEL_WIDTH).value},getPanelMinimizedState:function(e){return new JSCookie(e+layoutModule.MINIMIZED).value},storePanelMinimizedState:function(e,t){new JSCookie(e+layoutModule.MINIMIZED,t.toString())},manuallyChangePanelState:function(e,t,i){new JSCookie(e+layoutModule.PANEL_STATE_CHANGED_MANUALLY+t,i)},panelStateWasManuallyChanged:function(e,t){return"true"===new JSCookie(e+layoutModule.PANEL_STATE_CHANGED_MANUALLY+t).value}};define("core.layout",["jquery","prototype","utils.common","dragdrop.extra","tools.truncator","iscroll","components.webHelp"],function(e){return function(){var t;return t||e.layoutModule}}(this)),define("bundle",["require","common/transport/request","common/config/requestSettings","underscore","jrs.configs"],function(e){var t=e("common/transport/request"),i=e("common/config/requestSettings"),n=e("underscore"),o=e("jrs.configs"),s=o.contextPath+"/rest_v2/bundles",r="all",a=function(e,o){var a=r===e?"?expanded=true":"/"+e,l=n.extend({},i,{type:"GET",dataType:"json",url:s+a});t(l).then(function(t){o(r!==e?t:n(t).reduce(function(e,t){return n.extend(e,t)},{}))})};return a.load=function(e,t,i,n){return n.isBuild?void i():void a(e,i)},a});var dialogs={};dialogs.systemConfirm={container:null,message:null,show:function(e,t){window.isEmbeddedDesigner?jQuery(document).trigger("adhocDesigner:notification",[e,t]):(this.container=this.container||jQuery("#systemMessageConsole").on("mouseup touchend",function(){dialogs.systemConfirm.container.slideUp()}),this.message=this.message||document.getElementById("systemMessage"),this.closeText||(this.closeText=this.message.innerHTML.toLowerCase()),this.message.innerHTML=e+' <span>| <a href="#">'+this.closeText+"</a></span>",dialogs.systemConfirm.container.slideDown(),setTimeout("dialogs.systemConfirm.hide()",t?t:2e3))},showWarning:function(e,t){e='<span class="warning">'+e+"</span>",this.show(e,t)},hide:function(){dialogs.systemConfirm.container&&dialogs.systemConfirm.container.slideUp()}},dialogs.errorPopup={_dom:null,_content:null,_DOM_ID:"standardAlert",_CONTENT_ID:"errorPopupContents",_PAGE_CONTENT_PATTERN:"#errorPageContent",_DIALOG_WIDTH:"546px",_DIALOG_HEIGHT:"350px",clickHandler:null,show:function(e,t,i){i||(i={});var n=Builder.node("DIV",{style:"display:none"});n.innerHTML=e,document.body.insertBefore(n,document.body.firstChild);var o=$$(this._PAGE_CONTENT_PATTERN)[0],s=o?o.innerHTML:e,r=o&&o.innerHTML;if(n.remove(),s&&(this._dom||(this._dom=$(this._DOM_ID),this._content=$(this._CONTENT_ID),this.clickHandler=this._clickHandler.bindAsEventListener(this)),this._dom)){var a=s;r||(a=Builder.node("P",{"class":"message"}),a.update(s)),this._content.update(a),this._dom.observe("click",this.clickHandler),this._dom.setStyle({height:i.height||this._DIALOG_HEIGHT,width:i.width||this._DIALOG_WIDTH}),t&&this._dom.addClassName(layoutModule.STACKTRACE_CLASS),dialogs.popup.show(this._dom,t);var l=document.getElementById("completeStackTrace");l&&isIPad()&&new TouchController(l,l.parentNode,{noInit3d:!0})}},_hide:function(){this._dom&&(this._dom.stopObserving("click",this.clickHandler),dialogs.popup.hide(this._dom))},_clickHandler:function(e){var t=e.element();matchAny(t,["button"],!0)&&this._hide()}},dialogs.clusterErrorPopup=_.extend({},dialogs.errorPopup,{show:function(){var e=this;require(["bundle!jasperserver_messages","bundle!jsexceptions_messages"],function(t,i){var n=i["cluster.exception.session.attribute.missing.popup"];dialogs.errorPopup.show.call(e,n);var o=t["button.home"];jQuery("#"+e._DOM_ID).find("button span.wrap").html(o)})},_hide:function(){dialogs.errorPopup._hide.apply(this,arguments),window.location="home.html"}}),dialogs.popup={show:function(e,t,i){i=i||{},e=$(e),e&&((isIE7()||isIE8())&&(jo=jQuery(e),0==jo.children("div.msshadow").length&&jo.prepend('<div class="msshadow" style="position:absolute;top:-10px;right:10px;bottom:10px;left:-10px;border:0;background:#fff;">&nbsp;</div>')),t&&(pageDimmer.show(),e.match(layoutModule.DIALOG_LOADING_PATTERN)&&pageDimmer.setZindex(e.getStyle("zIndex")-1)),reParent(e,document.body),e.setOpacity(0),e.removeClassName(layoutModule.HIDDEN_CLASS),isIE7()&&!e.match(".sizeable")&&setWidthStyleByReflection(e,".content"),layoutModule.createMover.call(layoutModule,e),layoutModule.createSizer.call(layoutModule,e),i.cascade?cascadeElement(e,{position:i.position,number:i.number,horzOffset:40,vertOffset:40}):centerElement(e,{horz:!0,vert:!0}),dialogs.popup._setMaxZIndex(e),layoutModule.createMover.call(layoutModule,e),isIPad()?e.setOpacity(1)&&e.show():appear(e,.4),e.tabIndex=-1,(!i||"undefined"==typeof i.focus||i.focus)&&(isIE8()?setTimeout(function(){try{e.focus()}catch(t){}},450):e.focus()),!t&&e.observe("click",dialogs.popup.zIndexHandler))},hide:function(e){e&&(e=$(e),e.hasClassName(layoutModule.HIDDEN_CLASS)||(e.addClassName(layoutModule.HIDDEN_CLASS),pageDimmer.hide(),e.match(layoutModule.DIALOG_LOADING_PATTERN)&&pageDimmer.setZindex(layoutModule.DIMMER_Z_INDEX)),e.stopObserving("click",dialogs.popup.zIndexHandler))},zIndexHandler:function(e){var t=Event.element(e),i=matchMeOrUp(t,layoutModule.DIALOG_PATTERN);dialogs.popup._setMaxZIndex(i)},_setMaxZIndex:function(e,t){if(e){var i=t?t.getStyle("zIndex"):0,n=document.body.select(layoutModule.DIALOG_PATTERN),o=function(e){e.visible()&&!e.match(layoutModule.DIALOG_LOADING_PATTERN)&&(i=Math.max(i,e.getStyle("zIndex"),layoutModule.DIMMER_Z_INDEX+1))};1==n.length?o(n[0]):n.each(o),e.setStyle({zIndex:Math.max(i+1,e.getStyle("zIndex"))})}}},dialogs.popupConfirm=_.extend({},dialogs.popup,{show:function(e,t,i){dialogs.popup.show.apply(this,arguments),i=_.extend({okButtonSelector:"button.ok",cancelButtonSelector:"button.cancel"},i);var n=jQuery(e),o=n.find(i.okButtonSelector),s=n.find(i.cancelButtonSelector),r=jQuery.Deferred();return o.on("click",function(){i.validateFunc&&i.validateFunc()===!1||(o.off("click"),s.off("click"),dialogs.popupConfirm.hide(e),r.resolve())}),s.on("click",function(){o.off("click"),s.off("click"),dialogs.popupConfirm.hide(e),r.reject()}),r}}),dialogs.childPopup=_.extend({},dialogs.popup,{cascadePopups:{},show:function(e,t,i,n){i?(n=_.extend({parent:i},n),this.cascadePopups[i.id]||(this.cascadePopups[i.id]=[]),this.cascadePopups[i.id].push(e.id),$(e).setAttribute("data-parentDialog",i.id),dialogs.popup.show.apply(this,[e,t,n]),dialogs.popup._setMaxZIndex(e,i),t&&pageDimmer.setZindex(e.getStyle("zIndex")-1),i.stopObserving("click",dialogs.popup.zIndexHandler)):dialogs.popup.show.apply(this,[e,t,n])},hide:function(e){var t=$(e).getAttribute("data-parentDialog");if(t){this.cascadePopups[t]&&(this.cascadePopups[t]=_.without(this.cascadePopups[t],e.id)),dialogs.popup.hide.apply(this,[e]);var i=$(t);pageDimmer.show(i),dialogs.popup._setMaxZIndex(i)}else dialogs.popup.hide.apply(this,[e])}}),define("components.dialogs",["jquery","prototype","underscore","utils.common","utils.animation","core.layout"],function(e){return function(){var t;return t||e.dialogs}}(this));var about={initialize:function(){about.aboutBox.registerListeners()}};about.aboutBox={show:function(){var e=jQuery("#aboutBox");e.hasClass("hidden")&&dialogs.popup.show(e[0],!0)},_hide:function(){var e=jQuery("#aboutBox");e.hasClass("hidden")||dialogs.popup.hide(e[0])},registerListeners:function(){jQuery(document).delegate("#about","click",function(e){e.preventDefault(),about.aboutBox.show()}),jQuery(document).delegate("#aboutBox button","click",function(e){about.aboutBox._hide(),e.stopPropagation()})}},jQuery(function(){"undefined"==typeof require&&about.initialize()}),define("components.about",["components.dialogs"],function(e){return function(){var t;return t||e.about}}(this)),define("commons.minimal.main",["require","commons.bare.main","!domReady","components.heartbeat","jrs.configs","components.about","components.webHelp","jquery"],function(e){e("commons.bare.main");var t=e("!domReady"),i=e("components.heartbeat"),n=e("jrs.configs"),o=e("components.about"),s=e("components.webHelp"),r=e("jquery");t(function(){i.initialize(n.heartbeatInitOptions),i.start(),n.initAdditionalUIComponents&&o.initialize();var e=r("#helpLink");e&&e.on("click",function(e){e.preventDefault(),s.displayWebHelp()})})});var Mustache=function(){function e(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return r[e]||e})}var t=Object.prototype.toString;Array.isArray=Array.isArray||function(e){return"[object Array]"==t.call(e)};var i,n=String.prototype.trim;if(n)i=function(e){return null==e?"":n.call(e)};else{var o,s;/\S/.test(" ")?(o=/^[\s\xA0]+/,s=/[\s\xA0]+$/):(o=/^\s+/,s=/\s+$/),i=function(e){return null==e?"":e.toString().replace(o,"").replace(s,"")}}var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a={},l=function(){};return l.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(e,t,i,n){if(n||(this.context=t,this.buffer=[]),!this.includes("",e))return n?e:void this.send(e);e=this.render_pragmas(e);var o=this.render_section(e,t,i);return o===!1&&(o=this.render_tags(e,t,i,n)),n?o:void this.sendLines(o)},send:function(e){""!==e&&this.buffer.push(e)},sendLines:function(e){if(e)for(var t=e.split("\n"),i=0;i<t.length;i++)this.send(t[i])},render_pragmas:function(e){if(!this.includes("%",e))return e;var t=this,i=this.getCachedRegex("render_pragmas",function(e,t){return new RegExp(e+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+t,"g")});return e.replace(i,function(e,i,n){if(!t.pragmas_implemented[i])throw{message:"This implementation of mustache doesn't understand the '"+i+"' pragma"};if(t.pragmas[i]={},n){var o=n.split("=");t.pragmas[i][o[0]]=o[1]}return""})},render_partial:function(e,t,n){if(e=i(e),!n||void 0===n[e])throw{message:"unknown_partial '"+e+"'"};return t&&"object"==typeof t[e]?this.render(n[e],t[e],n,!0):this.render(n[e],t,n,!0)},render_section:function(e,t,i){if(!this.includes("#",e)&&!this.includes("^",e))return!1;var n=this,o=this.getCachedRegex("render_section",function(e,t){return new RegExp("^([\\s\\S]*?)"+e+"(\\^|\\#)\\s*(.+)\\s*"+t+"\n*([\\s\\S]*?)"+e+"\\/\\s*\\3\\s*"+t+"\\s*([\\s\\S]*)$","g")});return e.replace(o,function(e,o,s,r,a,l){var c,d=o?n.render_tags(o,t,i,!0):"",u=l?n.render(l,t,i,!0):"",h=n.find(r,t);return"^"===s?c=!h||Array.isArray(h)&&0===h.length?n.render(a,t,i,!0):"":"#"===s&&(c=Array.isArray(h)?n.map(h,function(e){return n.render(a,n.create_context(e),i,!0)}).join(""):n.is_object(h)?n.render(a,n.create_context(h),i,!0):"function"==typeof h?h.call(t,a,function(e){return n.render(e,t,i,!0)}):h?n.render(a,t,i,!0):""),d+c+u})},render_tags:function(t,i,n,o){for(var s=this,r=function(){return s.getCachedRegex("render_tags",function(e,t){return new RegExp(e+"(=|!|>|&|\\{|%)?([^#\\^]+?)\\1?"+t+"+","g")})},a=r(),l=function(t,o,l){switch(o){case"!":return"";case"=":return s.set_delimiters(l),a=r(),"";case">":return s.render_partial(l,i,n);case"{":case"&":return s.find(l,i);default:return e(s.find(l,i))}},c=t.split("\n"),d=0;d<c.length;d++)c[d]=c[d].replace(a,l,this),o||this.send(c[d]);return o?c.join("\n"):void 0},set_delimiters:function(e){var t=e.split(" ");this.otag=this.escape_regex(t[0]),this.ctag=this.escape_regex(t[1])},escape_regex:function(e){if(!arguments.callee.sRE){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+t.join("|\\")+")","g")}return e.replace(arguments.callee.sRE,"\\$1")},find:function(e,t){function n(e){return e===!1||0===e||e}e=i(e);var o;if(e.match(/([a-z_]+)\./gi)){var s=this.walk_context(e,t);n(s)&&(o=s)}else n(t[e])?o=t[e]:n(this.context[e])&&(o=this.context[e]);return"function"==typeof o?o.apply(t):void 0!==o?o:""},walk_context:function(e,t){for(var i=e.split("."),n=void 0!=t[i[0]]?t:this.context,o=n[i.shift()];void 0!=o&&i.length>0;)n=o,o=o[i.shift()];return"function"==typeof o?o.apply(n):o},includes:function(e,t){return-1!=t.indexOf(this.otag+e)},create_context:function(e){if(this.is_object(e))return e;var t=".";this.pragmas["IMPLICIT-ITERATOR"]&&(t=this.pragmas["IMPLICIT-ITERATOR"].iterator);var i={};return i[t]=e,i},is_object:function(e){return e&&"object"==typeof e},map:function(e,t){if("function"==typeof e.map)return e.map(t);for(var i=[],n=e.length,o=0;n>o;o++)i.push(t(e[o]));return i},getCachedRegex:function(e,t){var i=a[this.otag];i||(i=a[this.otag]={});var n=i[this.ctag];n||(n=i[this.ctag]={});var o=n[e];return o||(o=n[e]=t(this.otag,this.ctag)),o}},{name:"mustache.js",version:"0.4.0",to_html:function(e,t,i,n){var o=new l;return n&&(o.send=n),o.render(e,t||{},i),n?void 0:o.buffer.join("\n")}}}();define("mustache",function(e){return function(){var t,i;return i=function(){return Mustache},t=i.apply(e,arguments)}}(this)),jaspersoft.components.templateEngine=function(e,t,i){return{render:function(e,n,o){if(!o)return i.to_html(e,n);if(o==this.STD_PLACEHOLDERS){var s=String(e);return t.each(n,function(e,t){var i=new RegExp("\\{"+t+"\\}");s=s.replace(i,e)}),s}},renderUrl:function(e,t,n){var o=i.to_html(e,t);return n&&(o=encodeURI(o)),o},getTemplateText:function(t){var i=e("#"+t);return i.html()},createTemplate:function(t){var n=e("#"+t),o=n.html();return o&&o.length>0?function(e){return i.to_html(o,e)}:void 0},createTemplateFromText:function(e){return e&&e.length>0?function(t){return i.to_html(e,t)}:void 0},createTemplateSection:function(e,t){var n="\\{\\{#val\\}\\}(\\s|\\S)*\\{\\{/val\\}\\}",o=n.replace(/val/g,e),s=new RegExp(o,"g"),r=this.getTemplateText(t),a=r.match(s)[0];
return function(e){return i.to_html(a,e)}},STD_PLACEHOLDERS:"std_placeholder"}}(jQuery,_,Mustache),define("components.templateengine",["namespace","jquery","underscore","mustache"],function(e){return function(){var t;return t||e.jaspersoft.components.templateEngine}}(this)),function(){{var e,t=this,i=t.Backbone,n=[],o=(n.push,n.slice);n.splice}e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.1.0";var s=t._;s||"undefined"==typeof require||(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var r=e.Events={on:function(e,t,i){if(!l(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,i){if(!l(this,"once",e,[t,i])||!t)return this;var n=this,o=s.once(function(){n.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,i)},off:function(e,t,i){var n,o,r,a,c,d,u,h;if(!this._events||!l(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(a=e?[e]:s.keys(this._events),c=0,d=a.length;d>c;c++)if(e=a[c],r=this._events[e]){if(this._events[e]=n=[],t||i)for(u=0,h=r.length;h>u;u++)o=r[u],(t&&t!==o.callback&&t!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!l(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&c(i,t),n&&c(n,arguments),this},stopListening:function(e,t,i){var n=this._listeningTo;if(!n)return this;var o=!t&&!i;i||"object"!=typeof t||(i=this),e&&((n={})[e._listenId]=e);for(var r in n)e=n[r],e.off(t,i,this),(o||s.isEmpty(e._events))&&delete this._listeningTo[r];return this}},a=/\s+/,l=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var o in i)e[t].apply(e,[o,i[o]].concat(n));return!1}if(a.test(i)){for(var s=i.split(a),r=0,l=s.length;l>r;r++)e[t].apply(e,[s[r]].concat(n));return!1}return!0},c=function(e,t){var i,n=-1,o=e.length,s=t[0],r=t[1],a=t[2];switch(t.length){case 0:for(;++n<o;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;++n<o;)(i=e[n]).callback.call(i.ctx,s,r);return;case 3:for(;++n<o;)(i=e[n]).callback.call(i.ctx,s,r,a);return;default:for(;++n<o;)(i=e[n]).callback.apply(i.ctx,t)}},d={listenTo:"on",listenToOnce:"once"};s.each(d,function(e,t){r[t]=function(t,i,n){var o=this._listeningTo||(this._listeningTo={}),r=t._listenId||(t._listenId=s.uniqueId("l"));return o[r]=t,n||"object"!=typeof i||(n=this),t[e](i,n,this),this}}),r.bind=r.on,r.unbind=r.off,s.extend(e,r);var u=e.Model=function(e,t){var i=e||{};t||(t={}),this.cid=s.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(u.prototype,r,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,o,r,a,l,c,d,u;if(null==e)return this;if("object"==typeof e?(o=e,i=t):(o={})[e]=t,i||(i={}),!this._validate(o,i))return!1;r=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),u=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)t=o[n],s.isEqual(u[n],t)||a.push(n),s.isEqual(d[n],t)?delete this.changed[n]:this.changed[n]=t,r?delete u[n]:u[n]=t;if(!l){a.length&&(this._pending=!0);for(var h=0,p=a.length;p>h;h++)this.trigger("change:"+a[h],this,u[a[h]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in e)s.isEqual(n[o],t=e[o])||((i||(i={}))[o]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},P(this,e),this.sync("read",this,e)},save:function(e,t,i){var n,o,r,a=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=s.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},a,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=s.extend(n||{},t)),s.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},P(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=n),r=this.sync(o,this,i),n&&i.wait&&(this.attributes=a),r},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(o){(e.wait||t.isNew())&&n(),i&&i(t,o,e),t.isNew()||t.trigger("sync",t,o,e)},this.isNew())return e.success(),!1;P(this,e);var o=this.sync("delete",this,e);return e.wait||n(),o},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||k();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},s.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,s.extend(t,{validationError:i})),!1):!0}});var h=["keys","values","pairs","invert","pick","omit"];s.each(h,function(e){u.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),s[e].apply(s,t)}});var p=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},f={add:!0,remove:!1};s.extend(p.prototype,r,{model:u,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.extend({merge:!1},t,f))},remove:function(e,t){var i=!s.isArray(e);e=i?[e]:s.clone(e),t||(t={});var n,o,r,a;for(n=0,o=e.length;o>n;n++)a=e[n]=this.get(e[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,t.silent||(t.index=r,a.trigger("remove",a,this,t)),this._removeReference(a));return i?e[0]:e},set:function(e,t){t=s.defaults({},t,m),t.parse&&(e=this.parse(e,t));var i=!s.isArray(e);e=i?e?[e]:[]:s.clone(e);var n,o,r,a,l,c,d,h=t.at,p=this.model,f=this.comparator&&null==h&&t.sort!==!1,g=s.isString(this.comparator)?this.comparator:null,v=[],_=[],b={},y=t.add,T=t.merge,S=t.remove,A=!f&&y&&S?[]:!1;for(n=0,o=e.length;o>n;n++){if(l=e[n],r=l instanceof u?a=l:l[p.prototype.idAttribute],c=this.get(r))S&&(b[c.cid]=!0),T&&(l=l===a?a.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),f&&!d&&c.hasChanged(g)&&(d=!0)),e[n]=c;else if(y){if(a=e[n]=this._prepareModel(l,t),!a)continue;v.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}A&&A.push(c||a)}if(S){for(n=0,o=this.length;o>n;++n)b[(a=this.models[n]).cid]||_.push(a);_.length&&this.remove(_,t)}if(v.length||A&&A.length)if(f&&(d=!0),this.length+=v.length,null!=h)for(n=0,o=v.length;o>n;n++)this.models.splice(h+n,0,v[n]);else{A&&(this.models.length=0);var C=A||v;for(n=0,o=C.length;o>n;n++)this.models.push(C[n])}if(d&&this.sort({silent:!0}),!t.silent){for(n=0,o=v.length;o>n;n++)(a=v[n]).trigger("add",a,this,t);(d||A&&A.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),e=this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,s.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,s.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e.id]||this._byId[e.cid]||this._byId[e]},at:function(e){return this.models[e]},where:function(e,t){return s.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var o=e.reset?"reset":"set";i[o](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},P(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(e,t,o){o.wait&&i.add(e,o),n&&n(e,t,o)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof u)return e.collection||(e.collection=this),e;t=t?s.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(g,function(e){p.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}});var v=["groupBy","countBy","sortBy"];s.each(v,function(e){p.prototype[e]=function(t,i){var n=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,n,i)}});var _=e.View=function(e){this.cid=s.uniqueId("view"),e||(e={}),s.extend(this,s.pick(e,y)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},b=/^(\S+)\s*(.*)$/,y=["model","collection","el","id","attributes","className","tagName","events"];s.extend(_.prototype,r,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=s.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(s.isFunction(i)||(i=this[e[t]]),i){var n=t.match(b),o=n[1],r=n[2];i=s.bind(i,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,i):this.$el.on(o,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className"));var i=e.$("<"+s.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,n){var o=S[t];s.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var r={type:o,dataType:"json"};if(n.url||(r.url=s.result(i,"url")||k()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",n.emulateJSON&&(r.data._method=o);var a=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"===r.type&&T&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(s.extend(r,n));return i.trigger("request",i,l,n),l};var T=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),S={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var A=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,x=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(A.prototype,r,{initialize:function(){},route:function(t,i,n){s.isRegExp(t)||(t=this._routeToRegExp(t)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var o=this;return e.history.route(t,function(s){var r=o._extractParameters(t,s);n&&n.apply(o,r),o.trigger.apply(o,["route:"+i].concat(r)),o.trigger("route",i,r),e.history.trigger("route",o,i,r)}),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(M,"\\$&").replace(C,"(?:$1)?").replace(E,function(e,t){return t?e:"([^/]+)"}).replace(x,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return s.map(i,function(e){return e?decodeURIComponent(e):null})}});var w=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,O=/msie [\w.]+/,L=/\/$/,N=/[?#].*$/;w.started=!1,s.extend(w.prototype,r,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(L,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(D,"")},start:function(t){if(w.started)throw new Error("Backbone.history has already been started");w.started=!0,this.options=s.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,o=O.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(I,"/"),o&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location,a=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!a)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&a&&r.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),w.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),s.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!w.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(N,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),e.history=new w;var R=function(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,e&&s.extend(i.prototype,e),i.__super__=n.prototype,i};u.extend=p.extend=A.extend=_.extend=w.extend=R;var k=function(){throw new Error('A "url" property or function must be specified')},P=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}}}.call(this),define("backbone.original",["underscore","json3"],function(e){return function(){var t;return t||e.Backbone}}(this)),define("backbone",["require","backbone.original","common/transport/request"],function(e){var t=e("backbone.original"),i=e("common/transport/request");return t.ajax=i,t}),jaspersoft||(jaspersoft={components:{}}),jaspersoft.components||(jaspersoft.components={}),function(e,t,i,n,o,s){var r=n.View.extend({rendered:!1,contentSelector:".body",events:{"click .cancel":"hide"},initialize:function(e){if(this.templateId=e&&e.templateId||this.templateId,this.contentSelector=e&&e.contentSelector||this.contentSelector,!this.templateId)throw"Dialog template is not provided";i.bindAll(this),this.options=i.extend({},e)},render:function(e){return this.undelegateEvents(),this.$el=t(o.getTemplateText(this.templateId)).closest("div"),this.el=this.$el[0],t(e?e:document.body).append(this.$el),this.delegateEvents(),this.rendered=!0,this},hide:function(e){s.popup.hide(this.el),e&&e.stopPropagation()},show:function(e){this.rendered||this.render(e),s.popup.show(this.el,this.options.modal)},setContent:function(e){this.$el.find(this.contentSelector).html(t(e))},_updateMessage:function(e){e=i.isString(e)?[e]:e;var n=document.createDocumentFragment();i.each(e||[],function(e){n.appendChild(t("<p/>",{text:e,"class":"message"})[0])},this),this.$el.find(".body").html(n)}}),a=r.extend({templateId:"standardConfirmTemplate",events:{"click button.cancel":"hide","click button.ok":"onOk"},initialize:function(e){r.prototype.initialize.call(this,e),i.extend(this,i.defaults(e||{},{messages:"",ok:function(){}}))},show:function(e){r.prototype.show.call(this),this._updateMessage(e.messages||this.messages),e.ok&&(this.ok=e.ok)},onOk:function(){this.hide(),this.ok()}});e.Dialog=r,e.ConfirmDialog=a}(jaspersoft.components,jQuery,_,Backbone,jaspersoft.components.templateEngine,dialogs),define("components.dialog",["jquery","underscore","components.templateengine","components.dialogs","backbone"],function(e){return function(){var t;return t||e.jaspersoft.components.Dialog}}(this)),jaspersoft.components.NotificationViewTrait=function(e,t,i){return i.View.extend({initialize:function(){t.bindAll(this),this.collection&&this.collection.each(this.addListeners)},addListeners:function(e){e.on("error:server",this.handleServerError),e.on("notification:show",this.handleNotificationShow)},showErrorNotification:function(e,t){this.showNotification(e,"error",t)},showSuccessNotification:function(e,t){this.showNotification(e,"success",t)},showNotification:function(){},hideNotification:function(){},handleServerError:function(e){this.showErrorNotification(e.message)},handleNotificationShow:function(e){this.showSuccessNotification(e.message)}})}(jQuery,_,Backbone),define("components.notificationviewtrait",["namespace","jquery","underscore","backbone"],function(e){return function(){var t;return t||e.jaspersoft.components.NotificationViewTrait}}(this)),jaspersoft.components.SystemNotificationView=function(e,t){return e.NotificationViewTrait.extend({PSEUDO_INFINITY_DELAY:9999999999,showNotification:function(e){t.systemConfirm.show(e,this.PSEUDO_INFINITY_DELAY)}})}(jaspersoft.components,dialogs),define("components.systemnotificationview",["namespace","jquery","underscore","components.dialogs","components.notificationviewtrait"],function(e){return function(){var t;return t||e.jaspersoft.components.SystemNotificationView}}(this)),jaspersoft.components.Layout=function(e,t,i,n){return i.View.extend({initialize:function(e){t.bindAll(this),this.createUIComponents(e)},render:function(t){return this.notificationView.render(),t&&t.container?(e(t.container).find(".body").prepend(this.notificationView.el),this.defaultRender(this.formView,{container:e(t.container)})):(this.dialogRender(this.formView,this.dialog),this.dialog.$el.find(".body").prepend(this.notificationView.el)),this},createUIComponents:function(e){if(e&&(e.type&&e.namespace[e.type]&&(this.formView=new e.namespace[e.type]({model:this.model})),e.container||(this.dialog=new n.Dialog({modal:e.modal,templateId:"exportsDialogTemplate"}))),this.model){this.stateView=new n.StateView({model:this.model.get("state")});var t=new i.Collection([this.model,this.model.get("state")]);this.notificationView=new n.SystemNotificationView({collection:t})}},defaultRender:function(e,t){t&&t.container&&e.render(t)},dialogRender:function(t,i){i&&t&&(i.render(e("body")),t.render({container:i.$el}),e("#exportDialog #cancelExportButton").removeClass("hidden"))},showDialog:function(){this.dialog&&(this.formView.prepareToShow&&this.formView.prepareToShow(),this.notificationView.hideNotification(),this.dialog.show())}})}(jQuery,_,Backbone,jaspersoft.components),define("components.layout",["jquery","underscore","components.dialog","components.systemnotificationview"],function(e){return function(){var t;return t||e.jaspersoft.components.Layout}}(this)),TouchController=function(e,t,i){if(this.element=e,this.parent=t,this.children=[],this.hbar=null,this.vbar=null,i=i||{},this.element.style.position=i.absolute?"absolute":"relative",this.useParent=this.observer=i.useParent?t:e,this.translate3d=i.translate3d!==!1?!0:!1,this.forceLayout=i.forceLayout!==!0?!1:!0,this.use2Fingers=i.use2Fingers!==!0?!1:!0,this.fit=i.fit,i.debug&&(t.style.border="solid 1px #f00",e.style.border="solid 1px #00f"),this.translate3d&&!i.noInit3d){var n=jQuery(e).position();e.style.webkitTransform="translate3d("+n.left+"px,"+n.top+"px,0)",e.style.top="",e.style.left=""}if(i.scrollbars===!0){var o=jQuery('<div style="position:absolute;bottom:4px;left:0;right:0;"><div style="position:relative;background:#3fb8fa;min-height:4px;width:24px;opacity:0.4;"></div></div>').appendTo(t),s=jQuery('<div style="position:absolute;top:0;bottom:0;right:4px;"><div style="position:relative;background:#3fb8fa;min-width:4px;height:24px;opacity:0.4;"></div></div>').appendTo(t);this.hbar=o.children().eq(0),this.vbar=s.children().eq(0)}this.computeBoundaries(),this.dragging=!1,this.drag_sensitivity=20,this.scale=1,this.element.style.top=0,this.element.style.left=0,this.maxX=0,this.maxY=0,this.startTouchY=0,this.startTouchX=0,this.contentOffsetX=0,this.contentOffsetY=0,this.observer.addEventListener("touchstart",this,!1),this.observer.addEventListener("touchmove",this,!1),this.observer.addEventListener("touchend",this,!1)},TouchController.prototype.handleEvent=function(e){switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchEnd(e)}},TouchController.prototype.computeBoundaries=function(){this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.maxX=this.maxX<0?this.maxX:0,this.maxY=this.maxY<0?this.maxY:0,this.hbar&&0!==this.maxX?(this.hratio=this.parent.clientWidth/this.element.clientWidth,this.hbar.width(this.hratio*this.parent.clientWidth),this.hbar.show()):this.hbar&&this.hbar.hide(),this.vbar&&0!==this.maxY?(this.vratio=this.parent.clientHeight/this.element.clientHeight,this.vbar.height(this.vratio*this.parent.clientHeight),this.vbar.show()):this.vbar&&this.vbar.hide(),0===this.maxX&&0===this.maxY&&(this.element.style.minWidth=this.parent.clientWidth+"px",this.element.style.minHeight=this.parent.clientHeight+"px","reportContainer"===this.element.id&&(this.element.style.maxWidth=this.parent.clientWidth+"px",this.element.style.maxHeight=this.parent.clientHeight+"px"))},TouchController.prototype.onTouchStart=function(e){this.scale_pre=!1,this.computeBoundaries(),this.startTouchX=e.touches[0].clientX,this.startTouchY=e.touches[0].clientY,this.contentStartOffsetX=this.contentOffsetX,this.contentStartOffsetY=this.contentOffsetY},TouchController.prototype.onTouchMove=function(e){var t=e.touches[0].clientY,i=e.touches[0].clientX;(!this.use2Fingers||this.use2Fingers&&2==e.touches.length)&&(this.dragging?this.animateTo(i,t):this.isDragging(e)&&(TouchController.element_scrolled=!0,this.forceLayout&&(this.element.style.top=0,this.element.style.webkitTransform="translate3d(0,"+this.contentOffsetY+"px,0)"),this.animateTo(i,t)))},TouchController.prototype.onTouchEnd=function(e){this.dragging&&(this.forceLayout&&(this.element.style.webkitTransform="translate3d(0,0,0)",this.element.style.top=this.contentOffsetY+"px"),this.hbar&&this.hbar.hide(),this.vbar&&this.vbar.hide(),e.preventDefault(),this.shouldStartMomentum()),this.dragging=!1},TouchController.prototype.animateTo=function(e,t){var i=e-this.startTouchX,n=t-this.startTouchY,o=i+this.contentStartOffsetX,s=n+this.contentStartOffsetY,r=jQuery(this.element).position();this.translate3d?(o>0&&(o=0),s>0&&(s=0),o<this.maxX&&(o=this.maxX),s<this.maxY&&(s=this.maxY)):(o+r.left>0&&(o=-1*r.left),s+r.top>0&&(s=-1*r.top),r.left+o<this.maxX&&(o=this.maxX-r.left),r.top+s<this.maxY&&(s=this.maxY-r.top)),this.contentOffsetX=o,this.contentOffsetY=s,this.translate3d||this.use2Fingers?this.element.style.webkitTransform="scale("+this.scale+") translate3d("+o+"px,"+s+"px, 0)":(this.element.style.top=r.top+s+"px",this.element.style.left=r.left+o+"px"),this.hbar&&this.hbar.css("left",-1*o*this.hratio+"px"),this.vbar&&this.vbar.css("top",-1*s*this.vratio+"px")},TouchController.prototype.isDragging=function(e){var t=e.touches[0].clientX-this.startTouchX,i=e.touches[0].clientY-this.startTouchY,n=Math.abs(t),o=Math.abs(i);return this.dragging=n>this.drag_sensitivity||o>this.drag_sensitivity?!0:!1,this.dragging},TouchController.prototype.shouldStartMomentum=function(){return!1},TouchController.prototype.reset=function(){offsetX=this.contentOffsetX,offsetY=this.contentOffsetY,this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.translate3d?(this.element.style.webkitTransform="scale("+this.scale+") translate3d("+offsetX+"px,"+offsetY+"px, 0)",this.element.style.webkitTransform="scale("+this.scale+") translate3d(0,0,0)",this.contentOffsetX=0,this.contentOffsetY=0):(this.element.style.top=0,this.element.style.left=0)},TouchController.prototype.forceRefresh=function(){},TouchController.prototype.isBottom=function(){return this.maxY>=0?!1:this.contentOffsetY-this.maxY<10},TouchController.prototype.addPadding=function(e,t){var i=jQuery("#"+e).width()+t.right,n=jQuery("#"+e).height()+t.bottom;this.element.style.width=i+"px",this.element.style.height=n+"px"},define("touchcontroller",["jquery"],function(e){return function(){var t;return t||e.TouchController}}(this)),JSTooltip.addVar("SEPARATOR","@@"),JSTooltip.addVar("TOOLTIP_LABEL","tooltiplabel"),JSTooltip.addVar("TOOLTIP_TEXT","tooltiptext"),JSTooltip.addVar("TOOLTIP_TEMPLATE","tooltiptemplate"),JSTooltip.addVar("TOOLTIP_TEMPLATE_ID","jsTooltip"),JSTooltip.addVar("LABEL_PATTERN",".message.label"),JSTooltip.addVar("TEXT_PATTERN",".message:not(.label)"),JSTooltip.addMethod("_toAttribute",function(e,t){this.srcElement&&this.srcElement.writeAttribute(e,isArray(t)?t.join(this.SEPARATOR):t)}),JSTooltip.addMethod("_fromAttribute",function(e){if(this.srcElement&&this.srcElement.hasAttribute(e)){var t=this.srcElement.readAttribute(e);return t.include(this.SEPARATOR)?t.split(this.SEPARATOR):t}return null}),JSTooltip.addMethod("_setValues",function(e,t){e.each(function(e,i){t[i]&&e.update(t[i])})}),JSTooltip.addMethod("_calculateZIndex",function(e){function t(e){return parseInt(jQuery(e).css("z-index"))}var i=t(e);(!_.isNumber(i)||_.isNaN(i))&&(i=1e3);var n=_.flatten([this.srcElement,jQuery(this.srcElement).parents().toArray()]),o=_.reduce(n,function(e,i){var n=t(i);return _.isNumber(n)&&!_.isNaN(n)&&(e=Math.max(e,n)),e},i);return o+1}),JSTooltip.addMethod("show",function(e){e&&(this.offsets=e),this._element=$(this.templateId);var e;this.showBelow?(e=getBoxOffsets(this.srcElement),e[1]+=this.srcElement.clientHeight+5):e=[getScrollLeft()+5,getScrollTop()+5],this.offsets&&(e[0]+=this.offsets[0],e[1]+=this.offsets[1]),this._element.setStyle({position:"absolute",left:e[0]+"px",top:e[1]+"px",zIndex:this._calculateZIndex(this._element)});var t=this._element.select(this.LABEL_PATTERN),i=this._element.select(this.TEXT_PATTERN);if(this.label&&this._setValues(t,isArray(this.label)?this.label:[this.label]),this.text&&this._setValues(i,isArray(this.text)?this.text:[this.text]),this._element.removeClassName(layoutModule.HIDDEN_CLASS),e[0]+this._element.clientWidth>jQuery(window).width()){var n=e[0]-this._element.clientWidth>0?e[0]-this._element.clientWidth:15;this._element.setStyle({left:n+"px"})}if(e[1]+this._element.clientHeight>jQuery(window).height()){var o=e[1]-this._element.clientHeight-10;this._element.setStyle({top:o+"px"})}return this.loadTextCallback&&!this.loadTextExecuted&&(this.loadTextExecuted=!0,this.loadTextCallback(this)),this}),JSTooltip.addMethod("updateText",function(e){this.text=e,this.show()}),JSTooltip.addMethod("hide",function(){this._element&&this._element.addClassName(layoutModule.HIDDEN_CLASS)});var tooltipModule={TOOLTIP_PATTERN:"*[tooltiptext] > *",ELEMENT_WITH_TOOLTIP_PATTERN:"*[tooltiptext]",actualX:0,actualY:0,tooltips:[],showJSTooltip:function(e,t){e.jsTooltip||(e.jsTooltip=new JSTooltip(e,{})),this.actualX=t[0],this.actualY=t[1],this.cleanUp();
var i=jQuery(e).attr("tooltipappeardelay");i=i?parseInt(i):1e3,e.jsTooltip.timer&&clearTimeout(e.jsTooltip.timer),e.jsTooltip.timer=setTimeout(function(){e.jsTooltip.show([tooltipModule.actualX,tooltipModule.actualY])},i),jQuery(e).on("mousemove",function(e){tooltipModule.actualX=e.clientX,tooltipModule.actualY=e.clientY})},hideJSTooltip:function(e){e&&e.jsTooltip&&(e.jsTooltip.timer&&clearTimeout(e.jsTooltip.timer),e.jsTooltip.hide(),jQuery(e).off("mousemove"))},cleanUp:function(){if(this.tooltips&&this.tooltips.length>0){var e=[],t="fuigasuifdughaiadbvguaidbapvuwbev";this.tooltips.each(function(i){i.srcElement.id&&document.getElementById(i.srcElement.id)||(i.srcElement.setAttribute("id",t),document.getElementById(t)||(i.hide(),e.push(i)),i.srcElement.setAttribute("id",null))}),e.length>0&&(this.tooltips=this.tooltips.reject(function(t){return e.include(t)}))}}};define("components.tooltip",["jquery","prototype","utils.common","core.layout"],function(e){return function(){var t;return t||e.JSTooltip}}(this)),document.observe(isSupportsTouch()?"drag:touchstart":"drag:mousedown",function(e){var t=e.memo.targetEvent.element();if(!isSupportsTouch()||!event.treeEvent&&!event.listEvent){var i=matchMeOrUp(t,layoutModule.LIST_ITEM_PATTERN);i&&!t.match(layoutModule.DISCLOSURE_BUTTON_PATTERN)&&buttonManager.down(i,function(e){return $(e).down(layoutModule.LIST_ITEM_WRAP_PATTERN)}),t.match(layoutModule.DISCLOSURE_BUTTON_PATTERN)&&buttonManager.down(t)}});var buttonManager={over:function(e,t){if(e&&!this.isSelected(e)){var i=t?t(e):e;$(i).addClassName(layoutModule.HOVERED_CLASS)}},out:function(e,t){if(e){var i=t?t(e):e;$(i).removeClassName(layoutModule.HOVERED_CLASS).removeClassName(layoutModule.PRESSED_CLASS)}},down:function(e,t){if(e&&!this.isSelected(e)){var i=t?t(e):e;$(i).removeClassName(layoutModule.HOVERED_CLASS).addClassName(layoutModule.PRESSED_CLASS)}},up:function(e,t){if(e&&!this.isSelected(e)){var i=t?t(e):e;i=$(i),i.removeClassName(layoutModule.PRESSED_CLASS),!isIPad()&&i.addClassName(layoutModule.HOVERED_CLASS)}},disable:function(e){e&&(buttonManager.out(e),$(e).writeAttribute(layoutModule.DISABLED_ATTR_NAME,layoutModule.DISABLED_ATTR_NAME))},enable:function(e){e&&(buttonManager.out(e),$(e).writeAttribute(layoutModule.DISABLED_ATTR_NAME,null))},isDisabled:function(e){return e?$(e).readAttribute(layoutModule.DISABLED_ATTR_NAME)===layoutModule.DISABLED_ATTR_NAME||$(e).hasClassName(layoutModule.DISABLED_CLASS):void 0},unSelect:function(e){e&&$(e).removeClassName(layoutModule.SELECTED_CLASS)},select:function(e){e&&$(e).addClassName(layoutModule.SELECTED_CLASS)},isSelected:function(e,t){if(e){var i=t?t(e):$(e),n=i.up("li");return n&&n.hasClassName(layoutModule.SELECTED_CLASS)}return!1}};document.observe("mouseup",function(e){if(isRightClick(e)){var t=e.element();document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:e,node:t})}}),document.observe("contextmenu",function(e){return Event.stop(e),!1}),document.observe("dom:loaded",function(){isIE()&&document.body.setAttribute("oncontextmenu","return false"),jQuery("body").on("mouseover mouseout",layoutModule.BUTTON_PATTERN,function(e){hasDisabledAttributeSet(this)||("mouseover"==e.type?buttonManager.over(this):buttonManager.out(this))}),jQuery("body").on("mousedown mouseup touchstart touchend",[layoutModule.BUTTON_PATTERN,layoutModule.MENU_LIST_PATTERN,layoutModule.DISCLOSURE_BUTTON_PATTERN,layoutModule.META_LINKS_PATTERN].join(","),function(e){"mousedown"==e.type||"touchstart"==e.type?!hasDisabledAttributeSet(this)&&buttonManager.down(this):!hasDisabledAttributeSet(this)&&buttonManager.up(this),("mouseup"==e.type||"touchend"==e.type)&&(this.parentNode.id==layoutModule.MAIN_NAVIGATION_HOME_ITEM_ID&&primaryNavModule.navigationOption("home"),this.parentNode.id==layoutModule.MAIN_NAVIGATION_LIBRARY_ITEM_ID&&primaryNavModule.navigationOption("library"))}),jQuery("#frame").on("touchend mouseup",".minimize",function(e){this.parentNode.className.indexOf("maximized")>=0?layoutModule.minimize(this):layoutModule.maximize(this),e.preventDefault()}),jQuery("#frame").on("touchend mouseup",layoutModule.TABSET_TAB_PATTERN,function(){hasDisabledAttributeSet(this)||(jQuery(this).siblings().removeClass(layoutModule.SELECTED_CLASS).each(function(){jQuery(jQuery(this).attr("tabId")).addClass("hidden")}),jQuery(this).addClass(layoutModule.SELECTED_CLASS),jQuery(jQuery(this).attr("tabId")).removeClass("hidden"))}),jQuery("#"+layoutModule.META_LINK_LOGOUT_ID).on("mousedown touchstart",function(e){e.preventDefault(),primaryNavModule.navigationOption("logOut")}),jQuery("body").on("mouseover mouseout click","[tooltiptext]",function(e){("mouseout"==e.type||"click"==e.type)&&tooltipModule.hideJSTooltip(this),"mouseover"==e.type&&tooltipModule.showJSTooltip(this,[e.clientX,e.clientY])}),jQuery("#mainNavigation").on("mouseover",layoutModule.NAVIGATION_MUTTON_PATTERN,function(e){primaryNavModule.showNavButtonMenu(e,this)}),isSupportsTouch()&&(document.body.addEventListener("touchstart",function(){window.calendar&&window.calendar.hide&&!window.calendar.hidden&&window.calendar.hide(),"undefined"!=typeof TouchController&&(TouchController.element_scrolled=!1)},!1),document.body.addEventListener("touchmove",function(){},!1)),jQuery("#filePath").on("mouseenter mouseout",function(){jQuery("#fake_upload_button").toggleClass("over")})}),define("core.events.bis",["jquery","prototype","utils.common","core.layout","components.tooltip"],function(e){return function(){var t;return t||e.buttonManager}}(this));var baseList={isResponsive:function(e){return $(e.up(0)).hasClassName(layoutModule.RESPONSIVE_CLASS)},isCollapsible:function(e){return $(e.up(0)).hasClassName(layoutModule.COLLAPSIBLE_CLASS)},selectItem:function(e){this.isItemDisabled(e)||$(e).addClassName(layoutModule.SELECTED_CLASS)},deselectItem:function(e){$(e).removeClassName(layoutModule.SELECTED_CLASS)},isItemSelected:function(e){return $(e).hasClassName(layoutModule.SELECTED_CLASS)},disableItem:function(e){buttonManager.disable(e)},enableItem:function(e){buttonManager.enable(e)},isItemDisabled:function(e){buttonManager.isDisabled(e)},openItem:function(e){$(e).removeClassName(layoutModule.CLOSED_CLASS).addClassName(layoutModule.OPEN_CLASS).isOpen=!0},isItemOpen:function(e){return $(e).hasClassName(layoutModule.OPEN_CLASS)||$(e).isOpen&&!$(e).hasClassName(layoutModule.CLOSED_CLASS)},closeItem:function(e){$(e).removeClassName(layoutModule.OPEN_CLASS).addClassName(layoutModule.CLOSED_CLASS).isOpen=!1}},dynamicList={lists:{},activeListId:null,_templateHash:{},messages:{listNItemsSelected:"#{count} items selected"}};dynamicList.ListItem=function(e){this._itemId=void 0,this._list=void 0,this.first=!1,this.last=!1,e&&(this._value=e.value?e.value:{},this._label=e.label?e.label:"",this._subList=e.subList,this._cssClassName=e.cssClassName?e.cssClassName:void 0,this._templateDomId=e.templateDomId?e.templateDomId:void 0,this._respondOnItemEvents=Object.isUndefined(e.respondOnItemEvents)?!0:e.respondOnItemEvents,this._excludeFromEventHandling=e.excludeFromEventHandling?e.excludeFromEventHandling:void 0,this._excludeFromSelectionTriggers=e.excludeFromSelectionTriggers?e.excludeFromSelectionTriggers:void 0)},dynamicList.ListItem.addVar("DEFAULT_TEMPLATE_DOM_ID","dynamicListItemTemplate"),dynamicList.ListItem.addVar("DEFAULT_ITEM_ID_PREFIX","item"),dynamicList.ListItem.addVar("DEFAULT_SUB_LIST_ID_SUFFIX","SubList"),dynamicList.ListItem.addMethod("getId",function(){return this._itemId}),dynamicList.ListItem.addMethod("setList",function(e){this._list=e,this.getList()&&(this._itemId=this.getList().getNextItemId())}),dynamicList.ListItem.addMethod("getList",function(){return this._list}),dynamicList.ListItem.addMethod("setValue",function(e){return this._value=e}),dynamicList.ListItem.addMethod("getValue",function(){return this._value}),dynamicList.ListItem.addMethod("setLabel",function(e){return this._label=e}),dynamicList.ListItem.addMethod("getLabel",function(){return this._label}),dynamicList.ListItem.addMethod("setCssClassName",function(e){this._cssClassName=e}).addMethod("getCssClassName",function(){return this._cssClassName}),dynamicList.ListItem.addMethod("setTemplateDomId",function(e){this._templateDomId=e}),dynamicList.ListItem.addMethod("getTemplateDomId",function(){return this._templateDomId}),dynamicList.ListItem.addMethod("show",function(e){if(e){this._element=this.processTemplate(this._getTemplate()),this._getElement().setAttribute("id",this._generateId()),this._getElement().setAttribute("tabindex",-1),this.first&&this.getList().tabindex&&this._getElement().writeAttribute("tabindex",this.getList().tabindex),this._getElement().listItem=this,this.refreshStyle();var t=e.childElements(),i=this.index(),n=i-1;n>-1&&n<t.length?this._getElement().insert({after:t[n]}):$(e).insert(this._getElement())}}),dynamicList.ListItem.addMethod("refresh",function(){isNotNullORUndefined(this._getElement())&&(this.getList()?(this._element=this.processTemplate(this._getElement()),this.refreshStyle()):(this._getElement().remove(),this._element=null))}),dynamicList.ListItem.addMethod("refreshStyle",function(){var e=this._getElement();e.templateClassName&&(e.className=e.templateClassName),this.first&&e.addClassName(layoutModule.FIRST_CLASS),this.last&&e.addClassName(layoutModule.LAST_CLASS),this.isSelected()&&e.addClassName(layoutModule.SELECTED_CLASS),this.isDisabled()&&e.addClassName(layoutModule.DISABLED_CLASS),this.getCssClassName()&&e.addClassName(this.getCssClassName())}),dynamicList.ListItem.addMethod("isRendered",function(){return isNotNullORUndefined(this._getElement())}),dynamicList.ListItem.addMethod("disable",function(){baseList.disableItem(this._getElement())}).addMethod("enable",function(){baseList.enableItem(this._getElement())}).addMethod("isDisabled",function(){return baseList.isItemDisabled(this._getElement())}),dynamicList.ListItem.addMethod("processTemplate",function(e){var t=e.childElements()[0];t.cleanWhitespace();var i=t.childElements().length;return i==t.childNodes.length?t.insert(this.getLabel().escapeHTML()):t.childNodes[i].data=this.getLabel(),e}),dynamicList.ListItem.addMethod("focus",function(){this._getElement().focus()}),dynamicList.ListItem.addMethod("remove",function(){this.getList().removeItems([this])}),dynamicList.ListItem.addMethod("isSelected",function(){return this.getList().isItemSelected(this)}),dynamicList.ListItem.addMethod("select",function(){this.getList().selectItem(this,!0)}),dynamicList.ListItem.addMethod("deselect",function(){this.getList().deselectItem(this)}),dynamicList.ListItem.addMethod("index",function(){this.getList().getItems().indexOf(this)}),dynamicList.ListItem.addMethod("_getElement",function(){if(!this._element){var e=$(this._generateId());this._element=Object.isElement(e)?e:void 0}return this._element}),dynamicList.ListItem.addMethod("_getTemplate",function(){var e=this._templateDomId;dynamicList._templateHash[e]||(dynamicList._templateHash[e]=e);var t=$(dynamicList._templateHash[e]).cloneNode(!0);return t.templateId=e,t.templateClassName=t.className,t}),dynamicList.ListItem.addMethod("_generateId",function(){return this.getList().getId()+"_"+this.DEFAULT_ITEM_ID_PREFIX+this.getId()}),dynamicList.ListItem.addMethod("_isElementInExcluded",function(e){var t=e.element();return this._excludeFromEventHandling&&null!=matchAny(t,this._excludeFromEventHandling)}),dynamicList.ListItem.addMethod("_isExcludedFromSelectionTriggers",function(e){var t=e.element();return this._excludeFromSelectionTriggers&&null!=matchAny(t,this._excludeFromSelectionTriggers)}),dynamicList.CompositeItem=function(e){dynamicList.ListItem.call(this,e),this.isComposite=!0,this._items=e.items,this._openUp=e.openUp,this._subList=null,this._subListOptions=e.listOptions?e.listOptions:{},this._listTagName="ul",this.OPEN_HANDLER_PATTERN=e.openHandlerPattern?e.openHandlerPattern:this.OPEN_HANDLER_PATTERN,this.CLOSE_HANDLER_PATTERN=e.closeHandlerPattern?e.closeHandlerPattern:this.CLOSE_HANDLER_PATTERN},dynamicList.CompositeItem.prototype=deepClone(dynamicList.ListItem.prototype),dynamicList.CompositeItem.addVar("OPEN_HANDLER_PATTERN","[openHandler=openHandler]"),dynamicList.CompositeItem.addVar("CLOSE_HANDLER_PATTERN","[closeHandler=closeHandler]"),dynamicList.CompositeItem.addMethod("getItems",function(){return this._items}),dynamicList.CompositeItem.addMethod("setItems",function(e){this._items=e}),dynamicList.CompositeItem.addMethod("addItem",function(e){this._items.push(e)}),dynamicList.CompositeItem.addMethod("removeItems",function(e){this._items=this._items.reject(function(t){return e.include(t)}),this._subList.removeItems(e)}),dynamicList.CompositeItem.addMethod("show",function(e){this._listTagName=e.tagName,dynamicList.ListItem.prototype.show.call(this,e),baseList.closeItem(this._getElement()),this._items&&this._showSubList()}),dynamicList.CompositeItem.addMethod("_showSubList",function(){var e=this._getSubListId(),t=new Element(this._listTagName,{id:e});this._getElement().insert(this._openUp?{top:t}:{bottom:t});var i=this._subListOptions;this._subList=new dynamicList.List(e,{responsive:i.responsive?i.responsive:this.getList()._responsive,collapsible:i.collapsible?i.collapsible:this.getList()._collapsible,multiSelect:i.multiSelect?i.multiSelect:this.getList()._multiSelect,cssClassName:i.cssClassName?i.cssClassName:this.getList()._cssClassName,listTemplateDomId:i.listTemplateDomId?i.listTemplateDomId:this.getList()._listTemplateDomId,itemTemplateDomId:i.itemTemplateDomId?i.itemTemplateDomId:this.getList()._itemTemplateDomId,itemCssClassName:i.itemCssClassName?i.itemCssClassName:this.getList()._itemCssClassName,comparator:i.comparator?i.comparator:this.getList()._comparator,items:this._items}),this._subList._initEvents=function(){},this._subList.show(),this._subList._parentList=this.getList(),this._subList.getItems().each(function(e){e.parentItem=this}.bind(this))}),dynamicList.CompositeItem.addMethod("refresh",function(){dynamicList.ListItem.prototype.refresh.call(this),this._items&&(this._subList?this._subList.refresh():this._showSubList())}),dynamicList.CompositeItem.addMethod("getFirstChild",function(){return this._subList.getItems()[0]}),dynamicList.CompositeItem.addMethod("refreshStyle",function(){dynamicList.ListItem.prototype.refreshStyle.call(this),baseList.isItemOpen(this._getElement())?baseList.openItem(this._getElement()):baseList.closeItem(this._getElement()),this._subList&&this._subList.refreshStyle()}),dynamicList.CompositeItem.addMethod("_isOpenHandler",function(e){return e.match(this.OPEN_HANDLER_PATTERN)}).addMethod("_isCloseHandler",function(e){return e.match(this.CLOSE_HANDLER_PATTERN)}),dynamicList.CompositeItem.addMethod("_getSubListId",function(){return this._generateId()+"_"+this.DEFAULT_SUB_LIST_ID_SUFFIX}),dynamicList.TemplatedListItem=function(e){this.tooltipText=e?e.tooltipText:null,dynamicList.ListItem.call(this,e)};var tempFunc=function(){};tempFunc.prototype=dynamicList.ListItem.prototype,dynamicList.TemplatedListItem.prototype=new tempFunc,dynamicList.TemplatedListItem.prototype.constructor=dynamicList.TemplatedListItem,dynamicList.TemplatedListItem.prototype.processTemplate=function(e){var t=Mustache.to_html(e.innerHTML,this.getValue());return e.innerHTML=t,null!=this.tooltipText&&new JSTooltip(e,{text:this.tooltipText}),e},dynamicList.UnderscoreTemplatedListItem=function(e){dynamicList.TemplatedListItem.call(this,e),this._template=e?e.template:""};var tempFunc=function(){};tempFunc.prototype=dynamicList.TemplatedListItem.prototype,dynamicList.UnderscoreTemplatedListItem.prototype=new tempFunc,dynamicList.UnderscoreTemplatedListItem.prototype.constructor=dynamicList.UnderscoreTemplatedListItem,dynamicList.UnderscoreTemplatedListItem.prototype._getTemplate=function(){return this._template},dynamicList.UnderscoreTemplatedListItem.prototype.processTemplate=function(){var e=jQuery(_.template(this._template,this.getValue()))[0];return e.templateClassName=e.className,null!=this.tooltipText&&new JSTooltip(e,{text:this.tooltipText}),e},dynamicList.List=function(e,t){this._id=e,this._items=[],this._selectedItems=[],this._lastSelectedItem=null,this._nextId=1,this.draggables=[],this._parentList=null,t&&(this._multiSelect=t.multiSelect?t.multiSelect:!1,this._cssClassName=t.cssClassName?t.cssClassName:"",this._listTemplateDomId=t.listTemplateDomId,this._itemTemplateDomId=t.itemTemplateDomId,this._itemCssClassName=t.itemCssClassName,this._comparator=t.comparator,this._excludeFromEventHandling=t.excludeFromEventHandling,this._excludeFromSelectionTriggers=t.excludeFromSelectionTriggers,this.dragPattern=t.dragPattern,this.selectOnMousedown=t.selectOnMousedown,this.scroll=t.scroll,this.setItems(t.items)),this._createFromTemplate(),this._registerCustomScroll(),dynamicList.activeListId=this.getId(),this._msgNItemsSelected=new Template(dynamicList.messages.listNItemsSelected),dynamicList.lists[this._id]=this},dynamicList.List.addVar("Event",{ITEM_SELECTED:"item:selected",ITEM_UNSELECTED:"item:unselected",ITEM_MOUSEUP:"item:mouseup",ITEM_MOUSEDOWN:"item:mousedown",ITEM_CLICK:"item:click",ITEM_DBLCLICK:"item:dblclick",ITEM_OPEN:"item:open",ITEM_CLOSED:"item:closed",ITEM_CONTEXTMENU:"item:contextmenu",ITEM_BEFORE_SELECT_OR_UNSELECT:"item:beforeSelectOrUnselect"}),dynamicList.List.addVar("DND_WRAPPER_TEMPLATE","column_two"),dynamicList.List.addVar("DND_ITEM_TEMPLATE","column_two:resourceName"),dynamicList.List.addMethod("getNextItemId",function(){return this._nextId++}),dynamicList.List.addMethod("getId",function(){return this._id}),dynamicList.List.addMethod("getItems",function(){return this._items}),dynamicList.List.addMethod("setItems",function(e){e&&(this._items=[],this.resetSelected(),this.addItems(e))}),dynamicList.List.addMethod("addItems",function(e){e&&(e.compact().each(function(e){this._prepareListItem(e),this._items.push(e)}.bind(this)),this._comparator&&(this._items=this._items.sort(this._comparator)))}),dynamicList.List.addMethod("insertItems",function(e,t){t&&(t=t.compact(),t.each(function(e){this._prepareListItem(e)}.bind(this)),this._items.splice.apply(this._items,[e,0].concat(t)),this._comparator&&(this._items=this._items.sort(this._comparator)))}),dynamicList.List.addMethod("_prepareListItem",function(e){e&&(e.setList(this),this._itemTemplateDomId&&!e.getTemplateDomId()&&e.setTemplateDomId(this._itemTemplateDomId),this._itemCssClassName&&!e.getCssClassName()&&e.setCssClassName(this._itemCssClassName),this._excludeFromEventHandling&&!e._excludeFromEventHandling&&(e._excludeFromEventHandling=this._excludeFromEventHandling),this._excludeFromSelectionTriggers&&!e._excludeFromSelectionTriggers&&(e._excludeFromSelectionTriggers=this._excludeFromSelectionTriggers))}),dynamicList.List.addMethod("removeItems",function(e){e&&isArray(e)&&(this._items=this._items.reject(function(t){return e.include(t)}),e.each(function(e){this.deselectItem(e)}.bind(this)),e.each(function(e){e.setList(null),e.refresh()}))}),dynamicList.List.addMethod("sort",function(e){e&&(this._comparator=e),this._comparator&&this.getItems().sort(this._comparator)}),dynamicList.List.addMethod("getSelectedItems",function(){return this._selectedItems}),dynamicList.List.addMethod("isItemSelected",function(e){return this.getSelectedItems().include(e)}),dynamicList.List.addMethod("selectItem",function(e,t,i,n){var o=this.fire(this.Event.ITEM_BEFORE_SELECT_OR_UNSELECT,{item:e});if(!o.stopSelectOrUnselect&&(!(this._multiSelect&&this._selectedItems.length>1&&this.isItemSelected(e))||t||i||n)){var s=this.isItemSelected(e)&&n,r=!(this._multiSelect&&t||s),a=this.isItemSelected(e)&&t&&!s,l=!a&&isNotNullORUndefined(this._lastSelectedItem)&&i,c=!a&&!l;if(r&&this.resetSelected(),a&&!r&&this._removeItemFromSelected(e),l){var d=this._items.indexOf(this._lastSelectedItem),u=this._items.indexOf(e),h=Math.min(d,u),p=Math.max(d,u);if(h>-1)for(var m=h;p>=m;m++)this._addItemToSelected(this._items[m],!1);else this._addItemToSelected(this._items[p],!1)}c&&(this._addItemToSelected(e,!i),this.cursor=e)}}),dynamicList.List.addMethod("deselectItem",function(e){this._removeItemFromSelected(e)}),dynamicList.List.addMethod("deselectOthers",function(e,t,i,n){var o=this.fire(this.Event.ITEM_BEFORE_SELECT_OR_UNSELECT,{item:e});if(!o.stopSelectOrUnselect&&this._multiSelect&&this._selectedItems.length>1&&this.isItemSelected(e)&&!(t||i||n)){var s=this._selectedItems.findAll(function(t){return t!=e});s.each(function(e){this._removeItemFromSelected(e)}.bind(this))}}),dynamicList.List.addMethod("resetSelected",function(e){var t=this._selectedItems;this._selectedItems=[],t.each(function(e){e.getList()!==this&&e.getList().resetSelected(!0),e.refreshStyle(),this.fire(this.Event.ITEM_UNSELECTED,{item:e})}.bind(this)),this._parentList&&!e&&this._parentList.resetSelected()}),dynamicList.List.addMethod("getNextItem",function(e){var t=this.getItems(),i=t.indexOf(e);return~i?this.getItems()[i+1]:null}),dynamicList.List.addMethod("getPreviousItem",function(e){var t=this.getItems(),i=t.indexOf(e);return~i?this.getItems()[i-1]:null}),dynamicList.List.addMethod("selectNext",function(e){var t=e.memo.targetEvent,i=this.cursor?this.cursor:this.getSelectedItems()[this.getSelectedItems().length-1],n=i.getList().getNextItem(i);n&&(isShiftHeld(t)?this.isItemSelected(n)?i.getList().deselectItem(i):this._addItemToSelected(n,!1):(this.resetSelected(),i.getList().selectItem(n)),n._getElement().focus(),this.cursor=n)}),dynamicList.List.addMethod("selectPrevious",function(e){var t=e.memo.targetEvent,i=this.cursor?this.cursor:this.getSelectedItems()[0],n=i.getList().getPreviousItem(i);n&&(isShiftHeld(t)?this.isItemSelected(n)?i.getList().deselectItem(i):this._addItemToSelected(n,!1):(this.resetSelected(),i.getList().selectItem(n)),n._getElement().focus(),this.cursor=n)}),dynamicList.List.addMethod("selectOutwards",function(e){var t=this.getSelectedItems()[0],i=t._getElement(),n=!baseList.isItemOpen(i)&&t.parentItem;n?(t.deselect(),n.select(),n._getElement().focus()):(baseList.closeItem(i),this.fire(this.Event.ITEM_CLOSED,{targetEvent:e,item:t}))}),dynamicList.List.addMethod("selectInwards",function(e){var t=this.getSelectedItems()[0];if(t.isComposite){var i=t._getElement(),n=baseList.isItemOpen(i)&&t.getFirstChild();n?(t.deselect(),n.select(),i.focus()):(baseList.openItem(i),this.fire(this.Event.ITEM_OPEN,{targetEvent:e,item:t}))}}),dynamicList.List.addMethod("show",function(){dynamicList.activeListId=this.getId(),this._getElement().update(),this.getItems().each(function(e,t){e.first=0===t,e.last=t===this.getItems().length-1,e.show(this._getElement())}.bind(this)),this.draggables=[],this.scroll&&this.scroll.refresh(),this._initEvents()}),dynamicList.List.addMethod("refresh",function(){this.refreshStyle();var e=this._getElement().childElements(),t=[];this.getItems().each(function(i,n){if(i.first=0===n,i.last=n===this.getItems().length-1,i.isRendered())if(i.index()!=e.indexOf(i._getElement())){var o=baseList.isItemOpen(i._getElement());i._getElement().remove(),i.show(this._getElement()),o&&baseList.openItem(i._getElement())}else i.refresh();else i.show(this._getElement());t.push(i._getElement())}.bind(this)),e.each(function(e){!t.include(e)&&e.parentNode&&e.remove()})}),dynamicList.List.addMethod("refreshStyle",function(){var e=this._getElement();e.templateClassName&&(e.className=e.templateClassName),this._cssClassName&&e.addClassName(this._cssClassName)}),dynamicList.List.addMethod("fire",function(e,t){return this._getElement().fire(e,t)}),dynamicList.List.addMethod("observe",function(e,t){this._getElement().observe(e,t)}),dynamicList.List.addMethod("stopObserving",function(e){this._getElement().stopObserving(e,handler)}),dynamicList.List.addMethod("_getElement",function(){return this._element||(this._element=$(this.getId())),this._element}),dynamicList.List.addMethod("getItemByEvent",function(e){if(e)for(var t=Event.element(e);t&&t.readAttribute&&t.readAttribute("id")!==this.getId();){var i=t.listItem;if(i&&null!=i.getList())return i;t=$(t.parentNode)}return null}),dynamicList.List.addMethod("_createFromTemplate",function(){var e=this._getElement().readAttribute("tabindex");this.tabindex=parseInt(e&&e.length>0?e:-1),this._getElement().insert({after:this._getTemplateElement(this._getElement())}),this._getElement().remove(),this._element=null,this._getElement().update(),this.tabindex&&this.tabindex.length>0&&this._getElement().writeAttribute("tabindex",this.tabindex),disableSelectionWithoutCursorStyle(this._getElement())}),dynamicList.List.addMethod("_getTemplateElement",function(e){var t=this._listTemplateDomId;dynamicList._templateHash[t]||(dynamicList._templateHash[t]=t);var i=$(dynamicList._templateHash[t]).cloneNode(!0);return i.writeAttribute("id",this.getId()),i.templateId=t,i.templateClassName=i.className,cloneCustomAttributes(e,i),i}),dynamicList.List.addMethod("_addItemToSelected",function(e,t){e&&!this.isItemSelected(e)&&(this._selectedItems.push(e),t&&(this._lastSelectedItem=e),e.refreshStyle(),this._parentList?this._parentList._addItemToSelected(e,t):this.fire(this.Event.ITEM_SELECTED,{item:e}))}),dynamicList.List.addMethod("_removeItemFromSelected",function(e){e&&this.isItemSelected(e)&&(this._selectedItems=this._selectedItems.without(e),e.refreshStyle(),this._parentList?this._parentList._removeItemFromSelected(e):this.fire(this.Event.ITEM_UNSELECTED,{item:e}))}),dynamicList.List.addMethod("_buildDnDOverlay",function(e){e.setStyle({width:null,height:null}),e.items.length>1?e.update(this._msgNItemsSelected.evaluate({count:e.items.length})):1==e.items.length&&e.update(e.items[0].getLabel())}),dynamicList.List.addMethod("_registerCustomScroll",function(){if(!this.scroll&&this._getElement()){var e=this._getElement().up(layoutModule.SWIPE_SCROLL_PATTERN);if(e){var t=layoutModule.scrolls.get(e.identify());t&&(this.scroll=t)}}}),dynamicList.List.addMethod("createDraggableIfNeeded",function(e){var t=e.element();if(this.dragPattern&&!this.draggables[t.identify()]){var i=matchAny(t,[this.dragPattern],!0);if(i){if(!i||this.draggables[i.identify()])return;var n=this.getItemByEvent(e);this.draggables[i.identify()]=new Draggable(i,{superghosting:!0,mouseOffset:!0,onStart:this.setDragStartState.bind(this,n),onEnd:this.setDragEndState.bind(this,n)})}}}),dynamicList.List.addMethod("setDragStartState",function(e,t){var i=e._getElement().templateClassName;i&&t.element.addClassName(i),t.element.addClassName(layoutModule.DRAGGING_CLASS).addClassName(this.getId()),t.element.items=this.getSelectedItems().slice(0),this._buildDnDOverlay(t.element),t.options.scroll=this._getElement(),t.options.scrollSensitivity=layoutModule.SCROLL_SENSITIVITY,Draggables.dragging=this.regionID||!0}),dynamicList.List.addMethod("setDragEndState",function(){delete Draggables.dragging}),dynamicList.List.addMethod("_mouseupHandler",function(e){var t=e.element(),i=matchMeOrUp(t,layoutModule.BUTTON_PATTERN)&&this.getItemByEvent(e);if(i&&!i._isElementInExcluded(e)){if(e.listEvent=!0,i._respondOnItemEvents&&!e.isInvoked){if(this.fire(this.Event.ITEM_MOUSEUP,{targetEvent:e,item:i}),!i._isExcludedFromSelectionTriggers(e)){var n=isMetaHeld(e),o=isShiftHeld(e),s=isRightClick(e),r=!this.selectOnMousedown&&!TouchController.element_scrolled&&(!isSupportsTouch()||e.changedTouches.length>=1);if(r&&i.getList().selectItem(i,n,o,s),!r&&this._multiSelect&&this._selectedItems.length>1&&this.isItemSelected(i)&&!(n||o||s)&&(this._lastSelectedItem=i),i.getList().deselectOthers(i,isMetaHeld(e),isShiftHeld(e),isRightClick(e)),this.twofingers){this.twofingers=!1;var a=jQuery(t).parents("li:first");a.hasClass("selected")&&document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:e,node:t})}}this.createDraggableIfNeeded(e)}e.isInvoked=!0}}),dynamicList.List.addMethod("_mousedownHandler",function(e){e="dataavailable"==e.type?e.memo.targetEvent:e;var t=e.element(),i=matchMeOrUp(t,layoutModule.BUTTON_PATTERN)&&this.getItemByEvent(e);if(i&&!i._isElementInExcluded(e)){if(e.listEvent=!0,this.twofingers=e.touches&&2==e.touches.length?!0:!1,i._respondOnItemEvents&&!e.isInvoked&&(this.fire(this.Event.ITEM_MOUSEDOWN,{targetEvent:e,item:i}),!i._isExcludedFromSelectionTriggers(e))){var n=this.selectOnMousedown;n&&i.getList().selectItem(i,isMetaHeld(e),isShiftHeld(e),isRightClick(e))}e.isInvoked=!0}}),dynamicList.List.addMethod("_mouseoverHandler",function(e){matchMeOrUp(e.element(),layoutModule.BUTTON_PATTERN)&&this.createDraggableIfNeeded(e)}),dynamicList.List.addMethod("_clickHandler",function(e){var t=matchMeOrUp(e.element(),layoutModule.BUTTON_PATTERN)&&this.getItemByEvent(e);if(t&&!t._isElementInExcluded(e)){if(!e.isInvoked){if(t._respondOnItemEvents&&this.fire(this.Event.ITEM_CLICK,{targetEvent:e,item:t}),!t.isComposite)return;var i=t._getElement(),n=e.element();t._isCloseHandler(n)&&baseList.isItemOpen(i)?(baseList.closeItem(i),this.fire(this.Event.ITEM_CLOSED,{targetEvent:e,item:t})):t._isOpenHandler(n)&&!baseList.isItemOpen(i)&&(baseList.openItem(i),this.fire(this.Event.ITEM_OPEN,{targetEvent:e,item:t}))}e.isInvoked=!0}}),dynamicList.List.addMethod("_dblclickHandler",function(e){var t=matchMeOrUp(e.element(),layoutModule.BUTTON_PATTERN)&&this.getItemByEvent(e);t&&!t._isElementInExcluded(e)&&(t._respondOnItemEvents&&!e.isInvoked&&this.fire(this.Event.ITEM_DBLCLICK,{targetEvent:e,item:t}),e.isInvoked=!0)}),dynamicList.List.addMethod("_initEvents",function(){var e=this._getElement();this.draggables=[],isSupportsTouch()?(e.stopObserving("touchstart").observe("touchstart",this._mousedownHandler.bindAsEventListener(this)),e.stopObserving("drag:touchstart").observe("drag:touchstart",this._mousedownHandler.bindAsEventListener(this)),e.stopObserving("touchend").observe("touchend",this._mouseupHandler.bindAsEventListener(this))):(e.stopObserving("mouseup").observe("mouseup",this._mouseupHandler.bindAsEventListener(this)),e.stopObserving("mousedown").observe("mousedown",this._mousedownHandler.bindAsEventListener(this)),e.stopObserving("drag:mousedown").observe("drag:mousedown",this._mousedownHandler.bindAsEventListener(this))),isIPad||e.stopObserving("mouseover").observe("mouseover",this._mouseoverHandler.bindAsEventListener(this)),e.stopObserving("click").observe("click",this._clickHandler.bindAsEventListener(this)),e.stopObserving("dblclick").observe("dblclick",this._dblclickHandler.bindAsEventListener(this)),e.stopObserving("key:down").observe("key:down",this.selectNext.bindAsEventListener(this)),e.stopObserving("key:up").observe("key:up",this.selectPrevious.bindAsEventListener(this)),e.stopObserving("key:right").observe("key:right",this.selectInwards.bindAsEventListener(this)),e.stopObserving("key:left").observe("key:left",this.selectOutwards.bindAsEventListener(this))}),dynamicList.UnderscoreTemplatedList=function(e,t){this._template=t?t.template:"",dynamicList.List.apply(this,arguments)};var tempFunc=function(){};tempFunc.prototype=dynamicList.List.prototype,dynamicList.UnderscoreTemplatedList.prototype=new tempFunc,dynamicList.UnderscoreTemplatedList.prototype.constructor=dynamicList.UnderscoreTemplatedList,dynamicList.UnderscoreTemplatedList.prototype._getTemplateElement=function(e){var t=jQuery(_.template(this._template,{}))[0];return t.writeAttribute("id",this.getId()),t.templateClassName=t.className,cloneCustomAttributes(e,t),t},define("components.list",["jquery","prototype","components.layout","touchcontroller","utils.common","dragdrop.extra","core.events.bis"],function(e){return function(){var t;return t||e.dynamicList}}(this)),"undefined"==typeof localContext&&(localContext=window);var actionModel={};actionModel.SIMPLE_ACTION="simpleAction",actionModel.SELECT_ACTION="selectAction",actionModel.INPUT_ACTION="inputAction",actionModel.OPTION_ACTION="optionAction",actionModel.SEPARATOR="separator",actionModel.SINGLE_SELECT_CONSTRAINT="singleSelect",actionModel.HIGH_Z_INDEX=99999,actionModel.RES_LABEL="$label",actionModel.RES_ID="$id",actionModel.RES_SELECTED="$selected",actionModel.EVENT="$event",actionModel.selObjects=[],actionModel.lastItemWasSeparator=!1,actionModel.noItemsYet=!0,actionModel.data=null,actionModel.openedSubMenus=[],actionModel.parentMenu="",actionModel.menuDom=null,actionModel.menuListDom=null,actionModel.PARENT_MENU_CONTAINER="menuList",actionModel.PARENT_MENU_STYLE="menu vertical context hidden",actionModel.SIMPLE_ACTION_DOM_ID="menuList_simpleAction",actionModel.SEPARATOR_DOM_ID="menuList_separator",actionModel.FLYOUT_PARENT_DOM_ID="menuList_flyout",actionModel.EXTRA_INPUT_DOM_ID="menuList_extraInput",actionModel.LIST_ITEM_DOM_ID="menuList_listItem",actionModel.DISPLAY_STYLE="inline",actionModel.DROP_DOWN_MENU=".dropDown",actionModel.showDynamicMenu=function(e,t,i,n,o,s){if(null==e){if(!isProVersion())return;
var r=designerBase.getSelectedObject();if(!r||!r.menuLevel)return;e=r.menuLevel}actionModel.resetMenu(),actionModel.updateCSSClass(i),actionModel.initActionModelData(o),actionModel.assembleMenuFromActionModel(e,t,actionModel.menuListDom,s),actionModel.setMenuPosition(actionModel.menuDom,t,n),actionModel.setMenuEventHandlers(actionModel.menuDom),isIE()&&jQuery("#"+actionModel.menuDom.id).prepend('<div class="msshadow"></div>'),actionModel.makeMenuVisible(actionModel.menuDom),isIE7()&&setWidthStyleByReflection(actionModel.menuDom,".content"),actionModel.adjustMenuPosition(actionModel.menuDom),actionModel.focusMenu(),jQuery("body").on("mouseout",actionModel.closeHandler)},actionModel.closeHandler=function(e){var t=jQuery(e.relatedTarget);(t.hasClass("mutton")||t.parents(".mutton").length)&&e.relatedTarget||"menu"===t.attr("id")||t.parents("#menu").length?e.stopPropagation():(jQuery("body").trigger("actionmodel-mouseout"),actionModel.hideMenu())},actionModel.resetMenu=function(){var e=$("menu");e.parentId=void 0,e.setAttribute("tabIndex",-1),e.childElements().each(function(e){Element.remove(e)}),e.innerHTML=$("commonMenu").cloneNode(!0).innerHTML;var t=e.down("ul"),i=t.readAttribute("id");t.writeAttribute("id",actionModel.updateTemplateId(i)),e.className=actionModel.PARENT_MENU_STYLE,e.writeAttribute("style",""),actionModel.menuDom=e,actionModel.menuListDom=t},actionModel.updateTemplateId=function(e){var t=new RegExp("_template");return e.replace(t,"")},actionModel.updateCSSClass=function(e){isNotNullORUndefined(e)&&($(actionModel.menuDom).className=e+" hidden")},actionModel.setMenuPosition=function(e,t,i){var n=t?t:window.event,o=Event.pointer(n);isSupportsTouch()&&n.changedTouches&&(o={x:n.changedTouches[0].pageX+20,y:n.changedTouches[0].pageY});var s,r;isNotNullORUndefined(i)?(s=isNotNullORUndefined(i.menuLeft)?i.menuLeft:o.x,r=isNotNullORUndefined(i.menuTop)?i.menuTop:o.y):(s=o.x,r=o.y),e.setStyle({left:s+"px",top:r+"px"})},actionModel.adjustMenuPosition=function(e,t,i,n,o){(!$(e).hasClassName("dropDown")||$(e).hasClassName("fitable"))&&fitObjectIntoScreen(e,null,i,null,o)},actionModel.assembleMenuFromActionModel=function(e,t,i,n){actionModel.noItemsYet=!0;var o=actionModel.data[e];n&&(o=n(e,o)),o.each(function(e){actionModel.appendToMenu(e,t,i)}),actionModel.removeTrailingSeparator()},actionModel.initActionModelData=function(e){actionModel.data="navigationActionModel"===e?primaryNavModule.JSON:_.isString(e)?jQuery("#"+e).html().evalJSON():e},actionModel.appendToMenu=function(e,t,i){if(actionModel.passesClientTest(e)){var n=getMenuMouseupFunction(getAsFunction(e.action),e.actionArgs,e.text,e.id,t);actionModel.appendDesiredRowType(e,t,n,i)}},actionModel.appendDesiredRowType=function(e,t,i,n){var o=function(){actionModel.isMenuShowing()&&actionModel.hideMenu(),i&&i()};e.type==actionModel.SIMPLE_ACTION&&actionModel.addSimpleActionRow(e,o,n),e.type!=actionModel.SEPARATOR||actionModel.lastItemWasSeparator||actionModel.addSeparatorRows(e,n),e.type==actionModel.SELECT_ACTION&&actionModel.addSelector(e,n,t),e.type==actionModel.OPTION_ACTION&&actionModel.addOption(e,o,n)},actionModel.addSimpleActionRow=function(e,t,i){var n=null;n=e.className&&"requiresInput"==e.className?$(actionModel.EXTRA_INPUT_DOM_ID).cloneNode(!0):$(actionModel.SIMPLE_ACTION_DOM_ID).cloneNode(!0),isSupportsTouch()?n.ontouchend=t:n.onmouseup=t,n.onmouseup_saved=t;var o=$(n).down(".button"),s=document.createTextNode(e.text);s.nodeValue=replaceNbsps(s.nodeValue),o.appendChild(s);var r=n.readAttribute("id")+getRandomId();n.writeAttribute("id",r),actionModel.insertMenuRow(i,n,!1,e.isDisabled,e.id,null)},actionModel.addSeparatorRows=function(e,t){var i=null;if(!actionModel.noItemsYet){var n=$(actionModel.SEPARATOR_DOM_ID).cloneNode(!0),o=n.readAttribute("id")+getRandomId();n.writeAttribute("id",o),e.className&&(i=e.className),actionModel.insertMenuRow(t,n,!0,e.isDisabled,null,i)}},actionModel.addOption=function(e,t,i){if(actionModel.passesClientTest(e)){var n=null,o=$(actionModel.LIST_ITEM_DOM_ID).cloneNode(!0);e.button=e.button&&"true"==String(e.button).toLowerCase()?!0:!1,isSupportsTouch()?o.ontouchend=t:o.onmouseup=t,o.onmouseup_saved=t;var s=$(o).down(".button"),r=document.createTextNode(e.text);r.nodeValue=replaceNbsps(r.nodeValue),s.appendChild(r);var a=o.readAttribute("id")+getRandomId();o.writeAttribute("id",a),e.className&&(n=e.className),!e.button&&evaluateTest(e.isSelectedTest,e.isSelectedTestArgs,e.text,e.id,!1,!1)&&s.addClassName("down"),actionModel.insertMenuRow(i,o,!1,e.isDisabled,e.id,n)}},actionModel.addSelector=function(e,t,i){var n,o=e.className;if("flyout"==o){if(e&&e.children.length>0){n=$(actionModel.FLYOUT_PARENT_DOM_ID).cloneNode(!0);var s=$(n).down(".button"),r=document.createTextNode(e.text);r.nodeValue=replaceNbsps(r.nodeValue),s.appendChild(r);var a=n.readAttribute("id")+getRandomId();n.writeAttribute("id",a),actionModel.insertMenuRow(t,n,!1,e.isDisabled,e.id,null);var l=actionModel.menuDom.cloneNode(!1);l.writeAttribute("id",n.readAttribute("id")+"_subMenu"),l.innerHTML=$("commonMenu").cloneNode(!0).innerHTML;var c=l.down("ul"),d=c.readAttribute("id");c.writeAttribute("id",actionModel.updateTemplateId(d)),n.appendChild(l);var u=l.select("ul")[0],h=u.writeAttribute("id",u.readAttribute("id")+"_subMenu");actionModel.buildSubMenu(e,h,i)}}else e.children.each(function(e){var n=getMenuMouseupFunction(getAsFunction(e.action),e.actionArgs,e.text,e.id,i);actionModel.appendDesiredRowType(e,i,n,t)})},actionModel.getSubMenuLeft=function(e){var t=$(e).up(2).clientWidth,i=Math.abs(parseInt($(e).up(1).offsetLeft));return t+i},actionModel.getSubMenuTop=function(e){return Math.abs(parseInt($(e).offsetTop))},actionModel.showChildSubmenu=function(e){var t,i,n=e.parentNode.parentNode.parentNode.id,o=!1;for(t=0;t<actionModel.openedSubMenus.length;t++)actionModel.openedSubMenus[t]==n&&(i=t,o=!0,jQuery("#"+n+">div.content>ul").children("li.node").each(function(){actionModel.hideChildSubmenu(jQuery(this).get(0))})),o&&jQuery("#"+actionModel.openedSubMenus[t]+">div.content>ul").children("li.node").each(function(){actionModel.hideChildSubmenu(jQuery(this).get(0))});actionModel.openedSubMenus.splice(i,actionModel.openedSubMenus.length-i);var s=null,r=null,a=null,l=20,c=e.childElements()[1];c.setStyle({display:actionModel.DISPLAY_STYLE}),c.setStyle({position:"absolute"});var d=actionModel.getSubMenuLeft(e),u=0;c.setStyle({left:d+"px",top:u+"px"}),isIE()&&jQuery(c).prepend('<div class="msshadow"></div>'),actionModel.makeMenuVisible(c),isIE7()&&setWidthStyleByReflection(c,".content"),s=$(c).cumulativeOffset()[1],r=$(c).getHeight();var h=getWindowHeight(),p=s+r;p>h&&(u=h-p-l,c.setStyle({top:u+"px"}));var m=c.cumulativeOffset()[0];a=c.getWidth(),getWindowWidth()<m+a&&c.setStyle({left:"-"+a+"px"}),actionModel.openedSubMenus.push(n)},actionModel.hideChildSubmenu=function(e){var t=e.childElements()[1];t.setStyle({display:"none"}),t.setStyle({position:"absolute"}),t.setStyle({left:0}),actionModel.makeMenuInVisible($(t))},actionModel.makeMenuVisible=function(e){var t=e.down("ul");t.childElements().length>0&&(e.setStyle({zIndex:actionModel.HIGH_Z_INDEX}),$(e).removeClassName("hidden"))},actionModel.makeMenuInVisible=function(e){e.addClassName("hidden")},actionModel.buildSubMenu=function(e,t,i){e.children.each(function(e){actionModel.appendToMenu(e,i,$(t))})},actionModel.isMenuShowing=function(){return!("none"==$("menu").getStyle("display")||$("menu").hasClassName("hidden"))},actionModel.updateRowDom=function(e,t){if(e){e.innerHTML=t;var i=e.readAttribute("id")+getRandomId();e.writeAttribute("id",i)}return e},actionModel.launchNewMenu=function(){actionModel.hideMenu(),alert("action not implemented...")},actionModel.insertMenuRow=function(e,t,i,n,o,s){null==t.readAttribute("id")&&(o?t.setAttribute("id",o):t.identify()),n&&actionModel.disableMenuOption(t),s&&t.addClassName(s),e.appendChild(t),actionModel.lastItemWasSeparator=i,actionModel.noItemsYet=!1},actionModel.disableMenuOption=function(e){buttonManager.disable(e),_.isEmpty(e.childNodes)&&buttonManager.disable(e.childNodes[0])},actionModel.passesClientTest=function(e){var t,i=!0;if(e.clientTest){t=e.clientTest;var n=!1;t.startsWith("!")&&(t=e.clientTest.sub("!",""),n=!0),i=evaluateTest(t,e.clientTestArgs,e.text,e.id,n,null)}var o=actionModel.selObjects;return _.isEmpty(o)||i&&e.selectionConstraint&&(i=e.selectionConstraint==actionModel.SINGLE_SELECT_CONSTRAINT?1==o.length:o.length>1),i},actionModel.removeTrailingSeparator=function(){var e=actionModel.menuListDom.lastChild;if($(e)&&!actionModel.noItemsYet){var t=e.identify(),i=new RegExp("w*separatorw*");i.test(t)&&e.remove()}},actionModel.getMenuParent=function(){return $(actionModel.menuDom.parentId)},actionModel.getFirstMenuButton=function(){return actionModel.menuDom.down(layoutModule.BUTTON_PATTERN,0)},actionModel.focusMenu=function(){var e=actionModel.menuDom;if(actionModel.lastFocused=document.activeElement,!e.hasClassName(layoutModule.HIDDEN_CLASS)&&e.focus(),!e.match(actionModel.DROP_DOWN_MENU)&&!isSupportsTouch()){var t=e.select("li");if(t[0]){var i=t[0].down(layoutModule.BUTTON_PATTERN);i&&buttonManager.over(i)}}},actionModel.showDropDownMenu=function(e,t,i,n,o){t=jQuery(t);var s=t.offset(),r={menuLeft:s.left,menuTop:s.top+t.height()-1};actionModel.showDynamicMenu(i,e,n,r,o)},actionModel.setMenuEventHandlers=function(e){e.select("li").each(function(e){e.hasClassName("disabled")||e.hasClassName("node")&&(isSupportsTouch()?Event.observe(e,"touchstart",function(t){t.firstCall||actionModel.showChildSubmenu(e),t.firstCall=!0}):(Event.observe(e,"mouseenter",function(){actionModel.showChildSubmenu(e)}),Event.observe(e,"mouseleave",function(){actionModel.hideChildSubmenu(e)})))})},actionModel.initializeOneTimeMenuHandlers=function(){$("menu").observe("mouseenter",function(){var e=this.select("."+layoutModule.HOVERED_CLASS)[0];e&&buttonManager.out(e)}.bind($("menu")))},actionModel.hideMenu=function(){if(actionModel.isMenuShowing()){var e=function(){var e=actionModel.lastFocused;try{e&&e.focus()}catch(t){}};!isSupportsTouch()&&setTimeout(e,0),actionModel.makeMenuInVisible($("menu")),jQuery("body").off("mouseout",actionModel.closeHandler)}},actionModel.createMenuElement=function(e,t){if(!e)throw new Error("Can not construct actionModel object: type can not be empty");return Object.extend({type:e},t)},actionModel.setSelected=function(e){actionModel.selObjects=e},define("actionModel.modelGenerator",["prototype","utils.common","core.events.bis"],function(e){return function(){var t;return t||e.actionModel}}(this));var accessibilityModule={ATTR_TAB_INDEX:"data-tab-index",ATTR_COMPONENT_TYPE:"data-component-type",delayTime:500,components:[],currentTabIndex:-1,disabled:!1,initialize:function(){var e=$$("*["+this.ATTR_TAB_INDEX+"]");e.each(function(e){var t=this.getTabIndex(e);t>0&&(this.components[t]=e)}.bind(this))},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},_focusByType:{tree:function(e){var t=e.readAttribute("id"),i=dynamicTree.trees[t];if(i){var n=i.selectedNodes.last();n=n||(i.bShowRoot?i.getRootNode():i.getRootNode().getFirstChild()),n&&(n.isSelected()||n.select(),accessibilityModule._doFocus(n))}},list:function(e){var t=e.readAttribute("id"),i=dynamicList.lists[t];if(i){var n=i.getSelectedItems().last();n=n||i.getItems().first(),n&&(n.isSelected()||n.select(),accessibilityModule._doFocus(n))}},search:function(e){var t=e.down("input");t&&t.select(),accessibilityModule._doFocus(t)},navigation:function(e){var t=e.down("#main_home");buttonManager.over(t.down(layoutModule.BUTTON_PATTERN)),accessibilityModule._doFocus(t)},linkList:function(e){buttonManager.over(e.down("a")),accessibilityModule._doFocus(e)}},_blurByType:{navigation:function(e){actionModel.hideMenu(),e.select(".over").each(function(e){buttonManager.out(e)})},linkList:function(e){e.select("a.over").each(function(e){buttonManager.out(e)})}},_doFocus:function(e){setTimeout(function(){e.focus()},this.delayTime)},_focusComponent:function(e){var t=e&&this.getType(e)&&this._focusByType[this.getType(e)];return t&&t(e)},_blurComponent:function(e){var t=e&&this.getType(e)&&this._blurByType[this.getType(e)];return t&&t(e)},findTabComponent:function(e){for(var t;e&&!t;)t=e.hasAttribute&&e.hasAttribute(this.ATTR_TAB_INDEX)&&e,e=$(e.parentNode);return t},getTabIndex:function(e){var t=-1;if(e&&e.hasAttribute){e.hasAttribute(this.ATTR_TAB_INDEX)||(e=accessibilityModule.findTabComponent(e));var i=e?e.readAttribute(this.ATTR_TAB_INDEX):this.currentTabIndex;try{i&&i.length>0&&(t=parseInt(i))}catch(n){}}return t},getType:function(e){return e&&e.hasAttribute(this.ATTR_COMPONENT_TYPE)?e.readAttribute(this.ATTR_COMPONENT_TYPE):void 0},getNext:function(e){var t=-1;if(this.components.length>0)for(e||(e=this.currentTabIndex),0>e&&(e=0),t=e+1;Object.isUndefined(this.components[t])&&t!=e;)t++,t<this.components.length||(t=0);return t},getPrevious:function(e){var t=-1;if(this.components.length>0)for(e||(e=this.currentTabIndex),0>e&&(e=0),t=e-1;Object.isUndefined(this.components[t])&&t!=e;)t--,t>-1||(t=this.components.length-1);return t},focusNext:function(e){this.focusByIndex(this.getNext(e))},focusPrevious:function(e){this.focusByIndex(this.getPrevious(e))},focusByIndex:function(e){e>-1&&(this.currentTabIndex=e)&&this._focusComponent(this.components[e])},blurCurrent:function(){var e=this.components[this.currentTabIndex];e&&this._blurComponent(e)},blurByIndex:function(e){var t=this.components[e];t&&this._blurComponent(t)}};document.observe("key:tab",function(e){if(!accessibilityModule.disabled){if(!t)var t=window.event;var i=accessibilityModule.getTabIndex(e.element());return accessibilityModule.blurCurrent(),isShiftHeld(e)?accessibilityModule.focusPrevious(i):accessibilityModule.focusNext(i),e.stop(),!1}}),define("core.accessibility",["prototype","components.list","actionModel.modelGenerator","core.events.bis"],function(e){return function(){var t;return t||e.accessibilityModule}}(this));var keyManager={ignoreKeyDown:[Keys.DOM_VK_SHIFT,Keys.DOM_VK_CONTROL,Keys.DOM_VK_ALT],noBubbleOnKeyUp:[Keys.DOM_VK_F10]};document.observe("keyup",function(e){keyManager.noBubbleOnKeyUp.include(e.keyCode)&&Event.stop(e)}),document.observe("keydown",function(e){if(!keyManager.ignoreKeyDown.include(e.keyCode)){var t=e.element();return e.keyCode==Event.KEY_RETURN?void t.fire("key:enter",{targetEvent:e,node:t}):e.shiftKey&&e.keyCode==Keys.DOM_VK_F10?(Event.stop(e),void t.fire("key:contextMenu",{targetEvent:e,node:t})):e.keyCode==Event.KEY_LEFT?void t.fire("key:left",{targetEvent:e,node:t}):e.keyCode==Event.KEY_RIGHT?void t.fire("key:right",{targetEvent:e,node:t}):e.keyCode==Event.KEY_UP?void t.fire("key:up",{targetEvent:e,node:t}):e.keyCode==Event.KEY_DOWN?void t.fire("key:down",{targetEvent:e,node:t}):isMetaHeld(e)&&89==e.keyCode?void t.fire("key:redo",{targetEvent:e,node:t}):isMetaHeld(e)&&90==e.keyCode?void t.fire("key:undo",{targetEvent:e,node:t}):e.keyCode==Event.KEY_ESC?void t.fire("key:escape",{targetEvent:e,node:t}):e.keyCode==Event.KEY_TAB?void t.fire("key:tab",{targetEvent:e,node:t}):e.keyCode==Event.KEY_DELETE?void t.fire("key:delete",{targetEvent:e,node:t}):65==e.keyCode&&isMetaHeld(e)?void t.fire("key:selectAll",{targetEvent:e,node:t}):83==e.keyCode&&isMetaHeld(e)&&!isShiftHeld(e)?void t.fire("key:save",{targetEvent:e,node:t}):76==e.keyCode&&isMetaHeld(e)&&isShiftHeld(e)?void t.fire("key:chartZoomIn",{targetEvent:e,node:t}):79==e.keyCode&&isMetaHeld(e)&&isShiftHeld(e)?void t.fire("key:chartZoomOut",{targetEvent:e,node:t}):void 0}}),document.observe("key:esc",function(){actionModel.isMenuShowing()&&actionModel.hideActionModelMenu()}),document.observe("key:enter",function(e){var t,i=e.element(),n=$(layoutModule.MENU_ID);if(layoutModule.isVisible(n)){Event.stop(e);var o=n.select("."+layoutModule.HOVERED_CLASS)[0];if(o){var s=o.up(layoutModule.MENU_LIST_PATTERN);setTimeout(s.onmouseup.curry(e.memo.targetEvent),0)}}t=matchMeOrUp(i,layoutModule.NAVIGATION_PATTERN),t&&(t.identify()==layoutModule.MAIN_NAVIGATION_HOME_ITEM_ID?(Event.stop(e),primaryNavModule.navigationOption("home")):t.identify()==layoutModule.MAIN_NAVIGATION_LIBRARY_ITEM_ID&&(Event.stop(e),primaryNavModule.navigationOption("library")))}),document.observe("key:down",function(e){{var t;e.element()}if(layoutModule.isVisible(layoutModule.MENU_ID)){Event.stop(e);var i=$(layoutModule.MENU_ID).select("."+layoutModule.HOVERED_CLASS)[0];if(i){var n=i.up(layoutModule.MENU_LIST_PATTERN),o=getNextNonMatchingSibling(n,layoutModule.SEPARATOR_PATTERN);return void(o&&(buttonManager.out(i),buttonManager.over(o.down(layoutModule.BUTTON_PATTERN)),o.focus()))}}(t=matchAny(e.element(),[layoutModule.NAVIGATION_MUTTON_PATTERN],!0))&&(buttonManager.out(t.down(layoutModule.BUTTON_PATTERN)),buttonManager.over(actionModel.getFirstMenuButton()),actionModel.focusMenu())}),document.observe("key:up",function(e){e.element();if(layoutModule.isVisible(layoutModule.MENU_ID)){Event.stop(e);var t=$(layoutModule.MENU_ID).select("."+layoutModule.HOVERED_CLASS)[0];if(t){var i=t.up(layoutModule.MENU_LIST_PATTERN),n=getPreviousNonMatchingSibling(i,layoutModule.SEPARATOR_PATTERN)||actionModel.getMenuParent();n&&(buttonManager.out(t),buttonManager.over(n.down(layoutModule.BUTTON_PATTERN)),n.focus())}}}),document.observe("key:left",function(e){var t,i=(e.element(),$(layoutModule.MAIN_NAVIGATION_ID)),n=i&&i.select("."+layoutModule.HOVERED_CLASS)[0];if(n){Event.stop(e);var o=n.up(layoutModule.NAVIGATION_PATTERN),s=getPreviousMatchingSibling(o,layoutModule.NAVIGATION_PATTERN);s&&(actionModel.hideMenu(),buttonManager.out(n),buttonManager.over(s.down(layoutModule.BUTTON_PATTERN)),s.focus(),t=matchMeOrUp(s,layoutModule.NAVIGATION_MUTTON_PATTERN),t&&primaryNavModule.showNavButtonMenu(e,t))}}),document.observe("key:right",function(e){var t,i=(e.element(),$(layoutModule.MAIN_NAVIGATION_ID)),n=i&&i.select("."+layoutModule.HOVERED_CLASS)[0];if(n){Event.stop(e);var o=n.up(layoutModule.NAVIGATION_PATTERN),s=getNextMatchingSibling(o,layoutModule.NAVIGATION_PATTERN);s&&(actionModel.hideMenu(),buttonManager.out(n),buttonManager.over(s.down(layoutModule.BUTTON_PATTERN)),s.focus(),t=matchMeOrUp(s,layoutModule.NAVIGATION_MUTTON_PATTERN),t&&primaryNavModule.showNavButtonMenu(e,t))}}),define("core.key.events",["jquery","prototype","utils.common","core.layout"],function(e){return function(){var t;return t||e.keyManager}}(this));var dynamicTree={trees:{},nodes:{},treeNodeEdited:null,editaborted:!1,activeTreeId:null,Tree:function(e,t){this.id=e,t?(this.setRootNode(t.root),this.bShowRoot=!!t.bShowRoot,this.handleNodeOnDblclick=void 0!==t.handleNodeOnDblclick?t.handleNodeOnDblclick:!0,this.multiSelectEnabled=!!t.multiSelectEnabled,this.showAllNodesOnStartup=!!t.showAllNodesOnStartup,this.treeClassName=t.treeClassName?t.treeClassName:"",this.dragPattern=t.dragPattern,this.dragClasses=t.dragClasses,this.dropClasses=t.dropClasses,this.selectOnMousedown=t.selectOnMousedown,this.regionID=t.regionID,this.scroll=t.scroll,this.templateDomId=t.templateDomId?t.templateDomId:this.DEFAULT_TREE_TEMPLATE_ID):(this.templateDomId=this.DEFAULT_TREE_TEMPLATE_ID,this.handleNodeOnDblclick=!0),this.stateObject={},this.sortNodes=!0,this.sorters=[this.sortByOrder,this.sortByName],this.selectedNodes=[],this.TREE_NN_ITEMS_SELECTED="#{count} items selected",dynamicTree.trees[this.id]=this,this._createFromTemplate(),this.refreshStyle(),this._registerEvents(),this._registerCustomScroll()},getNextId:function(){var e=1;return function(){return e++}}(),getActiveTree:function(){return dynamicTree.trees[dynamicTree.activeTreeId]},getTreeNode:function(e){return dynamicTree.nodes[e]},getStorageVal:function(e){var t=JSON.parse(window.localStorage.getItem("dynamicTree"))||{};return t[e]||null},setStorageVal:function(e,t){var i=window.localStorage,n=JSON.parse(i.getItem("dynamicTree"))||{};n[e]=t;try{i.setItem("dynamicTree",JSON.stringify(n))}catch(o){window.console&&console.log(o)}},_templateHash:{}};dynamicTree.Tree.addVar("DEFAULT_TREE_TEMPLATE_ID","list_responsive_collapsible"),dynamicTree.Tree.addVar("HIDE_ROOT_CLASS_NAME","hideRoot"),dynamicTree.Tree.addMethod("getId",function(){return this.id}),dynamicTree.Tree.addMethod("_getElement",function(){return this._element||(this._element=$(this.id)),this._element}),dynamicTree.Tree.addMethod("_createFromTemplate",function(){this._getElement()&&(this._getElement().insert({after:this._getTemplateElement(this._getElement())}),this._getElement().remove(),this._element=null,this._getElement().update())}),dynamicTree.Tree.addMethod("_registerCustomScroll",function(){if(!this.scroll&&this._getElement()){var e=this._getElement().up(layoutModule.SWIPE_SCROLL_PATTERN);if(e){var t=layoutModule.scrolls.get(e.identify());t&&(this.scroll=t)}}}),dynamicTree.Tree.addMethod("setRootNode",function(e){this.rootNode=e,this.rootNode&&(this.rootNode.treeId=this.id)}),dynamicTree.Tree.addMethod("getRootNode",function(){return this.rootNode}),dynamicTree.Tree.addMethod("refreshStyle",function(){var e=this._getElement();e.templateClassName&&(e.className=e.templateClassName),this.treeClassName&&e.addClassName(this.treeClassName),this.bShowRoot?e.removeClassName(this.HIDE_ROOT_CLASS_NAME):e.addClassName(this.HIDE_ROOT_CLASS_NAME)}),dynamicTree.Tree.addMethod("resetSelected",function(){this._prevSelectedNodes=this.selectedNodes.clone(),this.selectedNodes=[]}),dynamicTree.Tree.addMethod("revertSelection",function(){var e=this._prevSelectedNodes.clone();e=e.concat(this.selectedNodes),this.selectedNodes=this._prevSelectedNodes.clone();for(var t=0;t<e.length;t++)e[t].refreshStyle()}),dynamicTree.Tree.addMethod("getSelectedNode",function(){return 0==this.selectedNodes.length?null:this.selectedNodes[0]}),dynamicTree.Tree.addMethod("addNodeToSelected",function(e){this.selectedNodes.push(e),this._prevSelectedNodes=this.selectedNodes.clone()}),dynamicTree.Tree.addMethod("removeNodeFromSelected",function(e){for(var t=0;t<this.selectedNodes.length;t++)if(this.selectedNodes[t]==e)return this._prevSelectedNodes=this.selectedNodes.clone(),void this.selectedNodes.splice(t,1)}),dynamicTree.Tree.addMethod("isNodeSelected",function(e){var t=this.selectedNodes&&this.selectedNodes.length;if(t)for(var i=0;t>i;i++)if(this.selectedNodes[i]==e)return!0;return!1}),dynamicTree.Tree.addMethod("resortSubtree",function(e){if(e){e.resortChilds();for(var t=0;t<e.childs.length;t++)this.resortSubtree(e.childs[t])}}),dynamicTree.Tree.addMethod("resortTree",function(){this.sortNodes&&this.resortSubtree(this.rootNode)}),dynamicTree.Tree.addMethod("readStates",function(){var e=dynamicTree.getStorageVal("tree"+this.id);if(e)for(var t in e)this.stateObject[t]=e[t]}),dynamicTree.Tree.addMethod("getState",function(e){var t,i=this.stateObject;return i[e]?(t=i[e],(null==t||""==t)&&(t=dynamicTree.TreeNode.State.CLOSED),t):dynamicTree.TreeNode.State.CLOSED}),dynamicTree.Tree.addMethod("writeStates",function(e,t){var i={},n=this.stateObject;for(var o in n)i[o]=n[o];n[e]=t,null!=t&&(i[e]=t),dynamicTree.setStorageVal("tree"+this.id,i)}),dynamicTree.Tree.addMethod("resetStates",function(){this.stateObject={},dynamicTree.setStorageVal("tree"+this.id,"")}),dynamicTree.Tree.addMethod("comparer",function(e,t){var i,n;if(this.sorters&&this.sorters.length)for(i=0;i<this.sorters.length;i++)if(n=this.sorters[i](e,t),0!=n)return n;return 0}),dynamicTree.Tree.addMethod("renderTree",function(){this.readStates(),this.stopWaiting(),this.refreshStyle();var e=this._getElement();this.rootNode&&(this.writeStates(this.rootNode.id,dynamicTree.TreeNode.State.OPEN),this.rootNode.showNode(),this.rootNode.render(e),this.refreshScroll())}),dynamicTree.Tree.addMethod("refreshScroll",function(e){e?setTimeout(function(){this.scroll&&this.scroll.refresh()}.bind(this),e):this.scroll&&this.scroll.refresh()}),dynamicTree.Tree.addMethod("binarySearchOfNode",function(e,t){for(var i=0,n=e.length-1;n>=i;){var o=Math.round((i+n)/2),s=e[o];if(this.comparer(s,t)<0)i=o+1;else{if(!(this.comparer(s,t)>0))return o;n=o-1}}return-(i+1)}),dynamicTree.Tree.addMethod("_deselectAllNodes",function(e){if(this.selectedNodes.length>0){var t=this.selectedNodes.clone();this.resetSelected();for(var i=0;i<t.length;i++)t[i].refreshStyle();if(e){var n=dynamicTree.trees[this.id];n.fireUnSelectAllEvent(e)}}}),dynamicTree.Tree.addMethod("_selectOrEditNode",function(e,t,i,n,o){var s=t.isSelected()&&o,r=this.multiSelectEnabled&&t.isSelected()&&i&&!s,a=t.isSelected()&&dynamicTree.treeNodeEdited!==t&&!this.multiSelectEnabled&&!i&&!s,l=null!=dynamicTree.treeNodeEdited&&(u||r),c=this.multiSelectEnabled&&!t.isSelected()&&n&&isNotNullORUndefined(this._lastSelectedNode)&&this._lastSelectedNode.parent===t.parent,d=this.multiSelectEnabled&&t.isSelected()&&n&&isNotNullORUndefined(this._lastSelectedNode)&&this._lastSelectedNode.parent===t.parent,u=!this.multiSelectEnabled&&!t.isSelected()||this.multiSelectEnabled&&!i&&!t.isSelected(),h=!t.isSelected()||u&&this.selectedNodes.length>1;if(n&&this._lastSelectedNode||(this._lastSelectedNode=t),r&&t.deselect(e),u&&this._deselectAllNodes(e),a)return void t.edit(e);if(l&&dynamicTree.treeNodeEdited.doEndEdit(e),c||d)var p=t.parent,m=p.childs.indexOf(this._lastSelectedNode),f=p.childs.indexOf(t),g=Math.min(m,f),v=Math.max(m,f);if(c)if(g>-1)for(var _=g;v>=_;_++)p.childs[_].select(e);else p.childs[v].select(e);else if(d){for(var _=0;g>_;_++)p.childs[_].deselect(e);for(var _=v+1;_<p.childs.length;_++)p.childs[_].deselect(e)}else h&&t.select(e,t.nofocus)}),dynamicTree.Tree.addMethod("_deselectOthers",function(e,t,i,n,o){var s=this.multiSelectEnabled&&this.selectedNodes.length>1&&t.isSelected()&&!(i||n||o);s&&this.selectedNodes.findAll(function(e){return e!=t}.bind(this)).invoke("deselect",e)}),dynamicTree.Tree.addMethod("_selectNextNode",function(e,t){function i(e){return e=e.parent,!e&&null||e.nextSibling||i(e)}var n=e.isOpen()&&e.getFirstChild()||e.nextSibling||i(e);n&&e.deselect()&&n.select(t)}),dynamicTree.Tree.addMethod("_selectPreviousNode",function(e,t){function i(e){return!(e.isOpen()&&e.hasChilds())&&e||i(e.getLastChild())}var n=e.prevSibling&&i(e.prevSibling)||e.parent;n&&e.deselect()&&n.select(t)}),dynamicTree.Tree.addMethod("_selectInwards",function(e,t){var i=e.isOpen()&&e.getFirstChild();i?e.deselect()&&i.select(t):e.handleNode(t)}),dynamicTree.Tree.addMethod("_selectOutwards",function(e,t){if(!e.isHiddenRootNode()){var i=e.isOpen()?null:e.parent;i?e.deselect()&&i.select(t):e.handleNode(t)}}),dynamicTree.Tree.addMethod("sortByOrder",function(e,t){var i=e.orderNumber,n=t.orderNumber;return null==i&&null==n?0:null==i?1:null==n?-1:i-n}),dynamicTree.Tree.addMethod("sortByName",function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i>n?1:n>i?-1:0}),dynamicTree.Tree.addVar("TREE_WAIT_TEMPLATE_DOM_ID","list_responsive_collapsible:loading"),dynamicTree.Tree.addMethod("wait",function(){$(this.id).update($(this.TREE_WAIT_TEMPLATE_DOM_ID).cloneNode(!0))}),dynamicTree.Tree.addMethod("stopWaiting",function(){$(this.id).update("")}),dynamicTree.Tree.addMethod("_getTemplateElement",function(e){var t=this.templateDomId,i=$(t).cloneNode(!0);return i.writeAttribute("id",this.getId()),i.templateId=t,i.templateClassName=i.className,cloneCustomAttributes(e,i),i}),define("dynamicTree.tree",["prototype","dragdrop.extra","touchcontroller","utils.common","core.layout","json3"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.TreeNode=function(e){this.id=dynamicTree.getNextId(),this.treeId=null,this.name=null!=e.name?e.name:this.DEFAULT_NAME,this.param=null!=e.param?e.param:{},this.orderNumber=null!=e.orderNumber?e.orderNumber:null,this.childs=[],this.parent=null,this.Types={Folder:new dynamicTree.TreeNode.Type(this.FOLDER_TYPE_NAME)},this.isloaded=!1,this.delayedRendering=!0,this.haschilds=!1,this.editable=!1,this.isWaiting=!1,this.hidden=!1,this.isDropTarget=!1,dynamicTree.nodes[this.id]=this},dynamicTree.TreeNode.Type=function(e,t){this.name=e,t&&(this.cssClassName=t.cssClassName,this.templateDomId=t.templateDomId)},dynamicTree.TreeNode.State={OPEN:"open",CLOSED:"closed"},dynamicTree.TreeNode.addVar("FOLDER_TYPE_NAME","com.jaspersoft.jasperserver.api.metadata.common.domain.Folder"),dynamicTree.TreeNode.addVar("DEFAULT_NAME","unset name"),dynamicTree.TreeNode.addVar("NODE_ID_PREFIX","node"),dynamicTree.TreeNode.addVar("SUB_NODE_ID_SUFFIX","sub"),dynamicTree.TreeNode.addVar("HANDLER_ID_PREFIX","handler"),dynamicTree.TreeNode.addVar("NODE_CLASS_NAME","node").addVar("LEAF_CLASS_NAME","leaf").addVar("OPEN_CLASS_NAME","open").addVar("CLOSED_CLASS_NAME","closed").addVar("SELECTED_CLASS_NAME","selected").addVar("LOADING_CLASS_NAME","loading").addVar("ROOTS_CLASS_NAME","roots"),dynamicTree.TreeNode.addVar("nodeHeaderTemplateDomId","list_responsive_collapsible:leaf"),dynamicTree.TreeNode.addVar("nodeFooterTemplateDomId","list_responsive_collapsible"),dynamicTree.TreeNode.addVar("nodeInputTemplateDomId","list_responsive_collapsible:input"),dynamicTree.TreeNode.addVar("isSelectable",!1),dynamicTree.TreeNode.addMethod("getTreeId",function(){return this.treeId||this.parent&&this.parent.getTreeId()}),dynamicTree.TreeNode.addMethod("getState",function(){return dynamicTree.trees[this.getTreeId()].getState(this.id)}),dynamicTree.TreeNode.addMethod("isParent",function(){return this.param.type==this.Types.Folder.name}),dynamicTree.TreeNode.addMethod("addChild",function(e){if(this.isParent()){var t=this.childs[this.childs.length-1];t&&(t.nextSibling=e,e.prevSibling=t),this.childs.push(e),e.parent=this,this.resortChilds(),this.delayedRendering||(e.showNode(),e.render(this._getChildrenElement(),e.nextSibling))}}),dynamicTree.TreeNode.addMethod("removeChild",function(e){for(var t=0;t<this.childs.length;t++)if(this.childs[t]==e){this.childs.splice(t,1);break}if(e.deselect(),!this.delayedRendering){var i=e._getElement();i&&i.remove()}}),dynamicTree.TreeNode.addMethod("resortChilds",function(){var e=this.getTreeId(),t=dynamicTree.trees[e];if(t&&t.sortNodes&&isArray(this.childs)){this.childs.sort(function(e,i){return t.comparer(e,i)});for(var i=this.childs.length;i--;){var n=this.childs[i];n.prevSibling=this.childs[i-1],n.nextSibling=this.childs[i+1]}}}),dynamicTree.TreeNode.addMethod("resetChilds",function(){this.childs=[]}),dynamicTree.TreeNode.addMethod("setHasChilds",function(e){this.haschilds=e}),dynamicTree.TreeNode.addMethod("hasChilds",function(){return this.haschilds?!0:this.getChildCount()>0}),dynamicTree.TreeNode.addMethod("getChildCount",function(){return this.childs.length}),dynamicTree.TreeNode.addMethod("getFirstChild",function(){return this.hasChilds()?this.childs[0]:null}),dynamicTree.TreeNode.addMethod("getLastChild",function(){return this.hasChilds()?this.childs[this.childs.length-1]:null}),dynamicTree.TreeNode.addMethod("_getElement",function(){return this._element||(this._element=$(this.NODE_ID_PREFIX+this.id)),this._element}),dynamicTree.TreeNode.addMethod("_getTitle",function(){var e=this._getElement().childElements()[0];e.cleanWhitespace();var t=e.childNodes[e.childNodes.length-1];return"#text"!==t.nodeName&&(t=document.createTextNode(""),e.appendChild(t)),t}),dynamicTree.TreeNode.addMethod("_getTitleInputElement",function(){return $(this._getElement().getElementsByTagName("input")[0])}),dynamicTree.TreeNode.addMethod("_getChildrenElement",function(){return this._childrenElement||(this._childrenElement=$(this.NODE_ID_PREFIX+this.id+this.SUB_NODE_ID_SUFFIX)),this._childrenElement}),dynamicTree.TreeNode.addMethod("isOpen",function(){return this.getState()===dynamicTree.TreeNode.State.OPEN}),dynamicTree.TreeNode.addMethod("changeName",function(e){this.name=e,this._getTitle().data=this.name}),dynamicTree.TreeNode.addMethod("getType",function(){for(var e in this.Types)if(this.param.type===this.Types[e].name)return this.Types[e];return void 0}),dynamicTree.TreeNode.addMethod("refreshStyle",function(e){if(e=$(e)||this._getElement()){e.templateClassName&&(e.className=e.templateClassName),this.isParent()?(e.addClassName(this.NODE_CLASS_NAME).removeClassName(this.LEAF_CLASS_NAME),this.isWaiting||(this.isOpen()?e.addClassName(this.OPEN_CLASS_NAME).removeClassName(this.CLOSED_CLASS_NAME):e.addClassName(this.CLOSED_CLASS_NAME).removeClassName(this.OPEN_CLASS_NAME))):e.addClassName(this.LEAF_CLASS_NAME).removeClassName(this.NODE_CLASS_NAME),this.isWaiting?e.addClassName(this.LOADING_CLASS_NAME):e.removeClassName(this.LOADING_CLASS_NAME),this.isSelected()?e.addClassName(this.SELECTED_CLASS_NAME):e.removeClassName(this.SELECTED_CLASS_NAME),this.hidden?e.addClassName(layoutModule.HIDDEN_CLASS):e.removeClassName(layoutModule.HIDDEN_CLASS),this.param.cssClass&&e.addClassName(this.param.cssClass);
var t=this.getType();t&&t.cssClassName&&e.addClassName(t.cssClassName);var i=e.down();this.isDropTarget&&i&&i.addClassName(layoutModule.DROP_TARGET_CLASS),!this.isDropTarget&&i&&i.removeClassName(layoutModule.DROP_TARGET_CLASS)}}),dynamicTree.TreeNode.addMethod("_createNode",function(){var e=this.id,t=dynamicTree.trees[this.getTreeId()],i=this._getHeaderTemplateElement();i.id=this.NODE_ID_PREFIX+e,i.tabIndex=-1,this.refreshStyle(i),this.treeId=t.id,i.treeNode=this;var n=i.childElements()[0];n.insert(this.name),null!=this.tooltip&&this.tooltip.length>0&&(n.title=this.tooltip),n.childElements().each(function(t,i){0===i&&(t.id=this.HANDLER_ID_PREFIX+e);var n=this.iconTooltip;n&&(t.title=isArray(n)?n[i]:n)}.bind(this)),this._element=i}),dynamicTree.TreeNode.addMethod("_createNodeChildren",function(){var e=this._getFooterTemplateElement();e.id=this.NODE_ID_PREFIX+this.id+this.SUB_NODE_ID_SUFFIX,this._childrenElement=e}),dynamicTree.TreeNode.addMethod("showNode",function(e){var t=dynamicTree.trees[this.getTreeId()];if(this._createNode(),this.isParent()){var i=this.isOpen()||t.showAllNodesOnStartup;if(i){this._createNodeChildren();for(var n=0;n<this.getChildCount();n++)this.childs[n].showNode(this._getChildrenElement());this.delayedRendering=!1,t.fireOpenEvent(this)}}this.render(e)}),dynamicTree.TreeNode.addMethod("render",function(e,t){if(!Object.isUndefined(e)){var i=$(e);i&&(this._getChildrenElement()&&this._getElement().insert(this._getChildrenElement()),t?i.insert(this._getElement(),{before:t._getElement()}):i.insert(this._getElement()))}}),dynamicTree.TreeNode.addMethod("_renderChildren",function(){var e=this._getElement();e&&this._getChildrenElement()&&e.insert(this._getChildrenElement())}),dynamicTree.TreeNode.addMethod("refreshNode",function(){if(this.refreshStyle(),this.isParent()&&this.isOpen()&&this.isloaded){this.delayedRendering?(this._createNodeChildren(),this._renderChildren()):this._getChildrenElement().update("");for(var e=0;e<this.getChildCount();e++)this.childs[e].showNode(this._getChildrenElement());this.delayedRendering=!1}var t=dynamicTree.trees[this.getTreeId()];t.refreshScroll()}),dynamicTree.TreeNode.addMethod("wait",function(){this.isWaiting=!0,this.refreshStyle()}),dynamicTree.TreeNode.addMethod("stopWaiting",function(){this.isWaiting=!1,this.refreshStyle()}),dynamicTree.TreeNode.addMethod("isHiddenRootNode",function(){var e=dynamicTree.trees[this.getTreeId()];return e.rootNode==this&&!e.bShowRoot}),dynamicTree.TreeNode.addMethod("deselect",function(e){var t=dynamicTree.trees[this.getTreeId()];return t&&this.isSelected()?(t.removeNodeFromSelected(this),this.refreshStyle(),e&&t.fireUnSelectEvent(this,e),!0):!1}),dynamicTree.TreeNode.addMethod("select",function(e,t){if(!t&&this.focus(),this.isSelected())return!1;var i=dynamicTree.trees[this.getTreeId()];return i.addNodeToSelected(this),this.refreshStyle(),i.fireSelectEvent(this,e),!0}),dynamicTree.TreeNode.addMethod("focus",function(){!isIPad()&&this._getElement()&&this._getElement().focus()}),dynamicTree.TreeNode.addMethod("isSelected",function(){var e=dynamicTree.trees[this.getTreeId()];return e&&e.isNodeSelected(this)}),dynamicTree.TreeNode.addMethod("_removeTitle",function(){var e=this._getTitle();e.data="",$(e.parentNode).cleanWhitespace()}),dynamicTree.TreeNode.addMethod("edit",function(e){if(this.editable){if(dynamicTree.treeNodeEdited==this)return;dynamicTree.treeNodeEdited=this;var t=this.name,i=$(this._getTitle().parentNode),n=this._getInputTemplateElement();this._getTitle().data="",i.cleanWhitespace(),i.insert(n),n.value=this.name,n.focus(),n.select(e),n.onclick=function(e){cancelEventBubbling(e)},n.ondblclick=function(e){cancelEventBubbling(e)},n.onmousedown=function(e){cancelEventBubbling(e)},n.onmouseup=function(e){cancelEventBubbling(e)},n.onkeydown=function(e){var i=window.event?window.event:e;13==i.keyCode?(n.onblur=null,this.doEndEdit(i)):27==i.keyCode&&(n.onblur=null,n.value=t,this.doEndEdit(i))}.bindAsEventListener(this),n.onblur=function(e){this.doEndEdit(e)}.bindAsEventListener(this),dynamicTree.trees[this.getTreeId()].fireStartEditEvent(this,n)}}),dynamicTree.TreeNode.addMethod("doEndEdit",function(){this.editEnded(),dynamicTree.trees[this.getTreeId()].fireEndEditEvent(this)}),dynamicTree.TreeNode.addMethod("editEnded",function(){var e=dynamicTree.trees[this.getTreeId()];if(null!=dynamicTree.treeNodeEdited){var t=this._getTitleInputElement(),i=($(t.parentNode),t.value);if(i==dynamicTree.treeNodeEdited.name)return t.remove(),this._getTitle().data=dynamicTree.treeNodeEdited.name,void(dynamicTree.treeNodeEdited=null);e.fireEditEvent(dynamicTree.treeNodeEdited,i),dynamicTree.editaborted||(dynamicTree.treeNodeEdited.name=i,t.remove(),this._getTitle().data=i),dynamicTree.treeNodeEdited=null}}),dynamicTree.TreeNode.addMethod("scroll",function(e){var t=dynamicTree.trees[this.getTreeId()].rootNode._getElement(),i=$(e?e:t.parentNode),n=this._getElement();if(i){var o=i.clientHeight,s=i.clientWidth,r=i.scrollTop,a=i.scrollLeft,l=n.cumulativeOffset().top-i.cumulativeOffset().top,c=n.offsetLeft,d=n.clientHeight,u=n.clientWidth;l>r+o?i.scrollTop=l-(o/2-d/2):r>l+d&&(i.scrollTop=l-(o/2-d/2)),c>a+s?i.scrollLeft=c-(s/2-u/2):a>c+u&&(i.scrollTop=c-(s/2-u/2))}}),dynamicTree.TreeNode.addMethod("handleNode",function(e){if(this.isParent()){var t=dynamicTree.trees[this.getTreeId()];this.isOpen()?t.writeStates(this.id,dynamicTree.TreeNode.State.CLOSED):(t.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),t.fireOpenEvent(this,e)),this.refreshNode()}}),dynamicTree.TreeNode.addMethod("openNode",function(e){if(this.isParent()){var t=dynamicTree.trees[this.getTreeId()];this.isOpen()||(t.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),t.fireOpenEvent(this,e)),this.refreshNode()}}),dynamicTree.TreeNode.addMethod("_getHeaderTemplateElement",function(){var e=this.getType(),t=e&&e.templateDomId?e.templateDomId:this.nodeHeaderTemplateDomId,i=$(t).cloneNode(!0);return i.templateId=t,i.templateClassName=i.className,i}),dynamicTree.TreeNode.addMethod("_getFooterTemplateElement",function(){var e=this.nodeFooterTemplateDomId,t=$(e).cloneNode(!0);return t.templateId=e,t.update(""),t}),dynamicTree.TreeNode.addMethod("_getInputTemplateElement",function(){var e=this.nodeInputTemplateDomId,t=$(e).cloneNode(!0);return t.templateId=e,t}),define("dynamicTree.treenode",["prototype","dynamicTree.tree"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.Tree.addVar("NODE_PATTERN",".node").addVar("NODE_WRAPPER_PATTERN",".node > .wrap").addVar("NODE_ICON_PATTERN",".node > .wrap .icon").addVar("NODE_CUSTOM_PATTERNS",[]),dynamicTree.Tree.addVar("LEAF_PATTERN",".leaf").addVar("LEAF_WRAPPER_PATTERN",".leaf > .wrap").addVar("LEAF_ICON_PATTERN",".leaf > .wrap .icon").addVar("LEAF_CUSTOM_PATTERNS",[]),dynamicTree.Tree.addVar("EXPANDING_TIME",1e3),dynamicTree.Tree.addVar("draggables",[]),dynamicTree.Tree.addMethod("getTreeNodeByEvent",function(e){var t=Event.element(e);return this.getTreeNodeByElement(t)}),dynamicTree.Tree.addMethod("getTreeNodeByElement",function(e){for(;e&&e.readAttribute&&e.readAttribute("id")!==this.id;){var t=e.treeNode;if(t&&t.getTreeId()===this.getId())return t;e=$(e.parentNode)}return null}),dynamicTree.Tree.addMethod("isNodeEvent",function(e){var t=matchMeOrUp(e.element().parentNode,"LI");return t&&t.hasClassName(layoutModule.NODE_CLASS)}),dynamicTree.Tree.addMethod("isLeafEvent",function(e){var t=matchMeOrUp(e.element().parentNode,"LI");return t&&t.hasClassName(layoutModule.LEAF_CLASS)}),dynamicTree.Tree.addMethod("isIconEvent",function(e){return e.element().hasClassName(layoutModule.ICON_CLASS)}),dynamicTree.Tree.addMethod("_registerEvents",function(){this._cleanUpListeners(),this._registerClickEvents(),this._registerCustomEvents(),this._registerKeyEvents(),this._registerMouseEvents()}),dynamicTree.Tree.addMethod("_cleanUpListeners",function(){var e=this._getElement();e.stopObserving("click"),e.stopObserving("dblclick"),isSupportsTouch()?(e.stopObserving("touchstart"),e.stopObserving("drag:touchstart"),e.stopObserving("touchend")):(e.stopObserving("mousedown"),e.stopObserving("drag:mousedown"),e.stopObserving("mouseup")),e.stopObserving("mouseover"),e.stopObserving("mouseout")}),dynamicTree.Tree.addMethod("_registerClickEvents",function(){var e=this._getElement();e.observe("click",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(i){var n=this.isIconEvent(t),o=this.isNodeEvent(t),s=this.isLeafEvent(t);o?(n&&e.fire("nodeIcon:click",{targetEvent:t,node:i}),e.fire("node:click",{targetEvent:t,node:i})):s&&(n&&e.fire("nodeIcon:click",{targetEvent:t,node:i}),e.fire("leaf:click",{targetEvent:t,node:i})),!isIPad()&&o&&n&&i.handleNode(t)}}.bindAsEventListener(this)),e.observe("dblclick",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(i){var n=this.isIconEvent(t),o=this.isNodeEvent(t),s=this.isLeafEvent(t);o?(n&&e.fire("nodeIcon:dblclick",{targetEvent:t,node:i}),e.fire("node:dblclick",{targetEvent:t,node:i})):s&&(n&&e.fire("leafIcon:dblclick",{targetEvent:t,node:i}),e.fire("leaf:dblclick",{targetEvent:t,node:i})),this.handleNodeOnDblclick&&(o||s)&&!n&&i.handleNode(t)}}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("_registerMouseEvents",function(){var e=this._getElement();e.observe(isSupportsTouch()?"touchstart":"mousedown",function(t){var i=t.element(),n=matchMeOrUp(i,layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(n){t.treeEvent=!0;var o=this.isIconEvent(t),s=this.isNodeEvent(t),r=this.isLeafEvent(t);if(isSupportsTouch())if(JRS.vars.ajax_in_progress)alert("please wait");else if(this.twofingers=!1,2==t.touches.length&&(this.twofingers=!0,this._selectOrEditNode(t,n,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),n.isSelected()||designerBase&&designerBase.isInSelection(n))){var a=jQuery(i).parents("li:first");return void(a.hasClass("selected")&&document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:t,node:i}))}isSupportsTouch()&&JRS.vars.ajax_in_progress||(!this.selectOnMousedown||isSupportsTouch()&&1!=t.touches.length||this._selectOrEditNode(t,n,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),s?(o&&e.fire("nodeIcon:mousedown",{targetEvent:t,node:n}),e.fire("node:mousedown",{targetEvent:t,node:n})):r&&(o&&e.fire("leafIcon:mousedown",{targetEvent:t,node:n}),e.fire("leaf:mousedown",{targetEvent:t,node:n})))}}.bindAsEventListener(this)),e.observe(isSupportsTouch()?"drag:touchstart":"drag:mousedown",function(t){var i=t.memo.targetEvent,n=matchMeOrUp(i.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(i);if(n){i.treeEvent=!0;var o=this.isIconEvent(i),s=this.isNodeEvent(i),r=this.isLeafEvent(i);this.selectOnMousedown&&!isRightClick(i)&&this._selectOrEditNode(i,n,isMetaHeld(i),isShiftHeld(i),isRightClick(i)),s?(o&&e.fire("nodeIcon.drag:mousedown",{targetEvent:i,node:n}),e.fire("node.drag:mousedown",{targetEvent:i,node:n})):r&&(o&&e.fire("leafIcon.drag:mousedown",{targetEvent:i,node:n}),e.fire("leaf.drag:mousedown",{targetEvent:i,node:n}))}}.bindAsEventListener(this)),e.observe(isSupportsTouch()?"touchend":"mouseup",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(i){t.treeEvent=!0;var n=this.isIconEvent(t),o=this.isNodeEvent(t),s=this.isLeafEvent(t);if(this.twofingers&&(t.isEmulatedRightClick=!0),isSupportsTouch()&&!this.twofingers&&(this.clickid==i.id&&!JRS.vars.ajax_in_progress&&t.timeStamp-this.clicktime<700&&(o?(n&&e.fire("nodeIcon:dblclick",{targetEvent:t,node:i}),e.fire("node:dblclick",{targetEvent:t,node:i})):s&&(n&&e.fire("leafIcon:dblclick",{targetEvent:t,node:i}),e.fire("leaf:dblclick",{targetEvent:t,node:i})),this.handleNodeOnDblclick&&(o||s)&&!n&&i.handleNode(t)),this.clicktime=t.timeStamp,this.clickid=i.id),!isSupportsTouch()||!JRS.vars.ajax_in_progress){this.selectOnMousedown||TouchController.element_scrolled||isSupportsTouch()&&1!=t.changedTouches.length||this._selectOrEditNode(t,i,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),this._deselectOthers(t,i,isMetaHeld(t),isShiftHeld(t),isRightClick(t));o?(n&&e.fire("nodeIcon:mouseup",{targetEvent:t,node:i}),e.fire("node:mouseup",{targetEvent:t,node:i})):s&&(n&&e.fire("leafIcon:mouseup",{targetEvent:t,node:i}),e.fire("leaf:mouseup",{targetEvent:t,node:i})),isSupportsTouch()&&o&&n&&!TouchController.element_scrolled&&i.handleNode(t)}}}.bindAsEventListener(this)),"createTouch"in document||(e.observe("mouseover",function(t){var i=t.element(),n=matchMeOrUp(i,layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);n&&(Draggables.dragging&&(clearTimeout(this.timeout_id),this.timeout_id=setTimeout(function(e){n.openNode(e)},this.EXPANDING_TIME)),this.createDraggableIfNeeded(t,n),!isIE7()&&e.fire("tree:mouseover",{targetEvent:t,node:n}))}.bindAsEventListener(this)),isIE7()||e.observe("mouseout",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);i&&e.fire("tree:mouseout",{targetEvent:t,node:i})}.bindAsEventListener(this))),Droppables.add(e,{accept:this.dropClasses,onDrop:function(e){this.elementDropped=e}.bind(this)})}),dynamicTree.Tree.addMethod("_registerKeyEvents",function(){var e=this._getElement();e.observe("key:down",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectNextNode(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:up",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectPreviousNode(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:right",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectInwards(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:left",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectOutwards(t,e.memo.targetEvent)}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("_registerCustomEvents",function(){var e=this._getElement();e.observe("mousedown",function(t){dynamicTree.activeTreeId&&dynamicTree.activeTreeId===this.getId()||(e.fire("tree:blur",{targetEvent:t,tree:dynamicTree.getActiveTree()}),dynamicTree.activeTreeId=this.getId(),e.fire("tree:focus",{targetEvent:t,tree:dynamicTree.getActiveTree()}))}.bindAsEventListener(this)),e.observe("mouseover",function(t){var i=this.getTreeNodeByEvent(t);i||e.fire("tree:mouseover",{targetEvent:t,tree:this})}.bindAsEventListener(this)),e.observe("mouseout",function(t){var i=this.getTreeNodeByEvent(t);i||e.fire("tree:mouseout",{targetEvent:t,tree:this})}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("fireOpenEvent",function(e,t){var i=this._getElement();i.fire("node:open",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireSelectEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:selected":"leaf:selected",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireUnSelectEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:unselected":"leaf:unselected",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireUnSelectAllEvent",function(e){var t=this._getElement();t.fire("items:unselected",{targetEvent:e})}),dynamicTree.Tree.addMethod("fireEditEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:edit":"leaf:edit",{node:e,newValue:t})}),dynamicTree.Tree.addMethod("fireStartEditEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:startEdit":"leaf:startEdit",{node:e,input:t})}),dynamicTree.Tree.addMethod("fireEndEditEvent",function(e){var t=this._getElement();t.fire(e.isParent()?"node:endEdit":"leaf:endEdit",{node:e})}),dynamicTree.Tree.addMethod("observe",function(e,t){this._getElement().observe(e,t)}),dynamicTree.Tree.addMethod("stopObserving",function(e,t){this._getElement().stopObserving(e,t)}),dynamicTree.Tree.addMethod("createDraggableIfNeeded",function(e,t){var i=e?e.element():t._getElement().down(this.dragPattern),n=this.draggables[i.identify()];if(this.dragPattern&&!n){var o=matchAny(i,[this.dragPattern],!0);if(o&&i.className.toLowerCase().indexOf("icon")<0&&!this.draggables[o.identify()])return this.draggables[o.identify()]=new Draggable(i,{superghosting:!0,mouseOffset:!0,delay:isIE()||isSupportsTouch()?200:0,onStart:this.setDragStartState.bind(this,t),onEnd:this.setDragEndState.bind(this,t)}),this.draggables[o.identify()]}return null}),dynamicTree.Tree.addMethod("setDragStartState",function(e,t){var i=e._getElement().templateClassName;i&&t.element.addClassName(i),t.element.setStyle({width:null,height:null}),t.element.addClassName(layoutModule.DRAGGING_CLASS).addClassName(this.getId()),this.dragClasses&&t.element.addClassName(this.dragClasses),this.selectedNodes.length>1&&t.element.update(new Template(this.TREE_NN_ITEMS_SELECTED).evaluate({count:this.selectedNodes.length})),t.element.node=e,t.element.nodes=this.selectedNodes,t.options.scroll=this._getElement(),t.options.scrollSensitivity=layoutModule.SCROLL_SENSITIVITY,Draggables.dragging=this.regionID||!0}),dynamicTree.Tree.addMethod("setDragEndState",function(){delete Draggables.dragging}),define("dynamicTree.events",["prototype","dynamicTree.tree"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.TreeSupport=function(e,t){if(dynamicTree.Tree.call(this,e,t),this.providerId=t.providerId,this.hideLoader=t.hideLoader,this.rootUri=Object.isUndefined(t.rootUri)?"/":t.rootUri,this.nodeClass=t.nodeClass&&Object.isFunction(t.nodeClass)?t.nodeClass:dynamicTree.TreeNode,t.rootObjectModifier&&(this.modifyRootObject=t.rootObjectModifier),this.resetStatesOnShow=Object.isUndefined(t.resetStatesOnShow)||t.resetStatesOnShow,this.inInit=!0,this.ajaxBufferId="ajaxbuffer",this.nodeTextId="treeNodeText",this.urlGetNode=t.urlGetNode?t.urlGetNode:this._getFlowUrl("getNode"),this.urlGetChildren=t.urlGetChildren?t.urlGetChildren:this._getFlowUrl("getChildren"),this.urlGetMultipleChildren=t.urlGetMultipleChildren?t.urlGetMultipleChildren:this._getFlowUrl("getMultipleChildren"),this.urlGetMessage=t.urlGetMessage?t.urlGetMessage:this._getFlowUrl("getMessage"),this.additionalParams=t.additionalParams?t.additionalParams:{},null==this.TREE_NN_ITEMS_SELECTED){var i=function(e){this.TREE_NN_ITEMS_SELECTED=e}.bind(this);this.getMessage("TREE_NN_ITEMS_SELECTED",i,null)}this._initOpenListener()},dynamicTree.TreeSupport.prototype=deepClone(dynamicTree.Tree.prototype),dynamicTree.TreeSupport.addMethod("_initOpenListener",function(){this.observe("node:open",function(e){var t=e.memo.node;t&&!t.isloaded&&this.getTreeNodeChildren(t)}.bindAsEventListener(this))}),dynamicTree.TreeSupport.addMethod("stopObserving",function(e,t){this._getElement().stopObserving(e,t),"node:open"!==e||t||this._initOpenListener()}),dynamicTree.TreeSupport.addMethod("_getFlowUrl",function(e){return __jrsConfigs__.contextPath+"/flow.html?_flowId=treeFlow&method="+e}),dynamicTree.TreeSupport.addMethod("showTree",function(e,t,i,n){var o=this.urlGetNode+"&provider="+this.providerId+"&uri="+this.rootUri+"&depth="+e;n&&(o+="&forceHtmlEscape=true"),o+="&"+this._evaluateAdditionalParams(),this._showTree(o,t,i)}),dynamicTree.TreeSupport.addMethod("_evaluateAdditionalParams",function(){var e=this.additionalParams;return _.isFunction(e)&&(e=e.call(null)),_.isObject(e)?Object.toQueryString(e):null}),dynamicTree.TreeSupport.addMethod("showTreePrefetchNodes",function(e,t,i){var n=this.urlGetNode+"&provider="+this.providerId+"&uri="+this.rootUri;e&&(n+="&prefetch="+encodeURIComponent(e)),n+="&"+this._evaluateAdditionalParams(),this._showTree(n,t,i)}),dynamicTree.TreeSupport.addMethod("_showTree",function(e,t,i){this.inInit=!0,this.wait();var n=function(e,t,i){return function(){return e.showTreeCallback(t,i)}}(this,t,i);ajaxTargettedUpdate(e,{fillLocation:this.ajaxBufferId,callback:n,errorHandler:baseErrorHandler,hideLoader:this.hideLoader})}),dynamicTree.TreeSupport.addMethod("showTreeCallback",function(e,t){var i=document.getElementById(this.nodeTextId);if(null==i)return void(t?t():this.fireServerErrorEvent());var n=i.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").evalJSON();this.modifyRootObject&&(n=this.modifyRootObject(n,!1)),i=document.getElementById(this.ajaxBufferId),i.innerHTML="",this.setRootNode(this.processNode(n)),this.resortTree(),this.resetStatesOnShow&&this.resetStates(),this.renderTree(),this.inInit=!1,e?e():this.fireTreeLoadedEvent({tree:this})}),dynamicTree.TreeSupport.addMethod("processNode",function(e){var t={};t.id=e.id,t.type=e.type,t.uri=e.uri,t.extra=deepClone(e.extra),e.cssClass&&(t.cssClass=e.cssClass);var i=this.nodeClass,n=new i({name:unescapeBackslash(e.label),param:t,orderNumber:e.order});e.tooltip&&(n.tooltip=e.tooltip);var o=e.children;if(null!=o){var s=o.length;if(0==s)n.setHasChilds(!1);else for(var r=0;s>r;r++){var a=o[r];if(a){var l=this.processNode(a);n.addChild(l)}}n.isloaded=!0}return n}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildren",function(e,t,i){var n=e.param.uri,o=function(e,t,i,n){return function(){return e.getTreeNodeChildrenCallback(t,i,n)}}(this,e.id,t,i),s=function(t){(500==t.status||t.getResponseHeader("JasperServerError"))&&e.stopWaiting(),baseErrorHandler(t)};ajaxTargettedUpdate(this.urlGetChildren+"&provider="+this.providerId+"&uri="+encodeURIComponent(encodeURIComponent(n))+"&"+this._evaluateAdditionalParams(),{fillLocation:this.ajaxBufferId,callback:o,errorHandler:s,hideLoader:this.hideLoader}),this.inInit||e.wait()}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenCallback",function(e,t,i){var n=document.getElementById(this.nodeTextId);if(null==n)return void(i?i():this.fireServerErrorEvent());var o=window.eval("("+n.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")+")"),s=dynamicTree.nodes[e];this.modifyRootObject&&(o=this.modifyRootObject(o,!0,s)),n=document.getElementById(this.ajaxBufferId),n.innerHTML="",s.resetChilds(),s.stopWaiting();var r=o.length;if(0==r)s.setHasChilds(!1);else{var a=s.getTreeId(),l=a?dynamicTree.trees[a]:null,c=l?l.sortNodes:null;l&&(l.sortNodes=!1);for(var d=0;r>d;d++){var u=this.processNode(o[d]);s.addChild(u)}l&&(l.sortNodes=c,s.resortChilds())}s.isloaded=!0,s.refreshNode(),t?t(s.childs):this.fireChildrenLoadedEvent(s.childs)}),dynamicTree.TreeSupport.addMethod("getTreeMultipleNodesChildren",function(e,t,i){var n,o="",s=[];if(e&&e.length)for(n=0;n<e.length;n++)n>0&&(o+=","),o+=encodeURIComponent(encodeURIComponent(e[n].param.uri)),s[n]=e[n].id;if(o.length){var r=function(e,t,i,n){return function(){return e.getTreeMultipleNodesChildrenCallback(t,i,n)}}(this,s,t,i);if(ajaxTargettedUpdate(this.urlGetMultipleChildren+"&provider="+this.providerId,{fillLocation:this.ajaxBufferId,callback:r,postData:"uris="+o,errorHandler:baseErrorHandler,hideLoader:this.hideLoader}),!this.inInit)for(n=0;n<e.length;n++)e[n].wait()}}),dynamicTree.TreeSupport.addMethod("getTreeMultipleNodesChildrenCallback",function(e,t,i){var n=document.getElementById(this.nodeTextId);if(null==n)return void(i?i():this.fireServerErrorEvent());var o=window.eval("("+n.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")+")");n=document.getElementById(this.ajaxBufferId),n.innerHTML="",t?t(e,o):(this.setMultipleNodesChilden(e,o),this.fireMultipleChildrenLoadedEvent(e,o))}),dynamicTree.TreeSupport.addMethod("setMultipleNodesChilden",function(e,t,i){if(e&&t)for(var n=0;n<t.length;n++){for(var o=t[n],s=o.children,r=null,a=0;a<e.length;a++){var l=dynamicTree.nodes[e[a]];if(l.param.uri==o.parentUri){r=l;break}}if(r){r.resetChilds(),r.stopWaiting();var c=s.length;if(0==c)r.setHasChilds(!1);else{var d=r.getTreeId(),u=d?dynamicTree.trees[d]:null,h=u?u.sortNodes:null;u&&(u.sortNodes=!1);for(var p=0;c>p;p++){var m=this.processNode(s[p]);r.addChild(m)}u&&(u.sortNodes=h,r.resortChilds())}r.isloaded=!0,i||r.refreshNode()}}}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenPrefetched",function(e,t,i,n,o,s,r){var a=e.param.uri,l=this.urlGetNode+"&provider="+this.providerId+"&uri="+a,c="";t&&(c="&prefetch="+t),o&&(l+="&depth="+o);var d=function(e,t,i,n,o,s){return function(){return e.getTreeNodeChildrenPrefetchedCallback(t,i,n,o,s)}}(this,e.id,i,n,s,r);ajaxTargettedUpdate(l,{fillLocation:this.ajaxBufferId,callback:d,postData:c,errorHandler:baseErrorHandler,hideLoader:this.hideLoader}),this.inInit||e.wait()}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenPrefetchedCallback",function(e,t,i,n,o){var s=document.getElementById(this.nodeTextId);if(null==s)return void(i?i():this.fireServerErrorEvent());var r=window.eval("("+s.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")+")");s=document.getElementById(this.ajaxBufferId),s.innerHTML="";var a=dynamicTree.nodes[e];if(a.resetChilds(),a.stopWaiting(),r.children){var l=a.getTreeId(),c=l?dynamicTree.trees[l]:null,d=c?c.sortNodes:null;c&&(c.sortNodes=!1);for(var u=0;u<r.children.length;u++){var h=this.processNode(r.children[u]);a.addChild(h)}c&&(c.sortNodes=d,n||a.resortChilds())}a.isloaded=!0,o||a.refreshNode(),t?t():this.fireChildredPrefetchedLoadedEvent(a.childs)}),dynamicTree.TreeSupport.addMethod("openAndSelectNode",function(e,t,i){var n=function(e){if(e.parent){var t=dynamicTree.trees[e.getTreeId()];t&&t.rootNode!=e.parent&&t.getState(e.parent.id)==dynamicTree.TreeNode.State.CLOSED&&e.parent.handleNode()}e&&jQuery("#dataChooserSource").length&&(e.nofocus=!0),t._selectOrEditNode(void 0,e,!1)};this.processNodePath(e,n,i);var o=this.getSelectedNode();o&&o.scroll(),t&&t()}),dynamicTree.TreeSupport.addMethod("processNodePath",function(e,t,i){var n,o=e.split("/"),s=this.getRootNode();for(n=0;n<o.length;n++)if(o[n]){var r=s;if(s=this.findNodeChildByMetaName(s,o[n]),!s){if(!i)return;if(s=this.findNodeFirstNodeChildByAlphabeticalOrder(r),!s)return}t(s)}}),dynamicTree.TreeSupport.addMethod("findLastLoadedNode",function(e){var t={node:null},i=function(e){return function(t){e.node=t}}(t);return this.processNodePath(e,i),t.node}),dynamicTree.TreeSupport.addMethod("findNodeChildByMetaName",function(e,t){if(e.hasChilds())for(var i=0;i<e.childs.length;i++)if(e.childs[i].param.id==t)return e.childs[i];return null}),dynamicTree.TreeSupport.addMethod("findNodeFirstNodeChildByAlphabeticalOrder",function(e){var t=null,i=null;if(e.childs.length>0){t=e.childs[0].param.id,i=0;for(var n=null,o=null,s=1;s<e.childs.length;s++){n=e.childs[s].param.id,o=s;for(var r=n.length<t.length?n.length:t.length,a=0;r>a;a++){if(n.charCodeAt(a)<t.charCodeAt(a)){t=n,i=o;break}if(n.charCodeAt(a)>t.charCodeAt(a))break}}return e.childs[i]}return null}),dynamicTree.TreeSupport.addMethod("findNodeById",function(e,t){return function i(e,t){if(!t||!e)return null;if(t.param.id===e)return t;if(t.hasChilds())for(var n=0;n<t.childs.length;++n){var o=i(e,t.childs[n]);if(o)return o}return null}(e,t?t:this.getRootNode())}),dynamicTree.TreeSupport.addMethod("hasVisibleFolders",function(e){if(this.bShowRoot)return!0;var t=e.children;if(t)for(var i=0;i<t.length;i++){var n=e.children[i].children;if(n&&n.length>0)return!0}return!1}),dynamicTree.TreeSupport.addMethod("getMessage",function(e,t,i){var n=this.urlGetMessage+"&messageId="+e,o=function(e,t,i){return function(){return e.getMessageCallback(t,i)}}(this,t,i);ajaxTargettedUpdate(n,{fillLocation:this.ajaxBufferId,callback:o,errorHandler:baseErrorHandler,hideLoader:this.hideLoader})}),dynamicTree.TreeSupport.addMethod("getMessageCallback",function(e,t){var i=document.getElementById(this.ajaxBufferId);if(null==i)return void(t&&t());var n=trim(i.innerHTML);i.innerHTML="",e&&e(n)}),dynamicTree.TreeSupport.addMethod("fireServerErrorEvent",function(){this._getElement().fire("server:error",{})}),dynamicTree.TreeSupport.addMethod("fireTreeLoadedEvent",function(e){this._getElement().fire("tree:loaded",{tree:e})}),dynamicTree.TreeSupport.addMethod("fireChildrenLoadedEvent",function(e){this._getElement().fire("children:loaded",{nodes:e})}),dynamicTree.TreeSupport.addMethod("fireMultipleChildrenLoadedEvent",function(e,t){this._getElement().fire("multipleChildren:loaded",{parentNodeIds:e,metaNodes:t})}),dynamicTree.TreeSupport.addMethod("fireChildredPrefetchedLoadedEvent",function(e){this._getElement().fire("childredPrefetched:loaded",{nodes:e})}),define("components.dynamicTree",["prototype","dynamicTree.tree","dynamicTree.treenode","dynamicTree.events","core.ajax"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.RepositoryFolder=function(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("com.jaspersoft.jasperserver.api.metadata.common.domain.Folder"),SuperRoot:new dynamicTree.TreeNode.Type("superroot"),Root:new dynamicTree.TreeNode.Type("root")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_folders:folders",this.param.extra&&this.param.extra.isActiveThemeFolder&&(this.param.cssClass=this.ACTIVE_THEME_CLASS)},dynamicTree.TreeNode&&(dynamicTree.RepositoryFolder.prototype=deepClone(dynamicTree.TreeNode.prototype)),dynamicTree.RepositoryFolder.addVar("ACTIVE_THEME_CLASS","activeTheme"),dynamicTree.RepositoryFolder.addMethod("isParent",function(){return this.param.type==this.Types.Folder.name||this.param.type==this.Types.SuperRoot.name||this.param.type==this.Types.Root.name}),dynamicTree.RepositoryFolder.addMethod("isSuperRoot",function(){return this.param.type==this.Types.SuperRoot.name}),dynamicTree.RepositoryFolder.addMethod("isPublic",function(){return"public"===this.param.id}),dynamicTree.createRepositoryTree=function(e,t){var i=null!=t.organizationId&&""!==t.organizationId;null==t.bShowRoot&&(t.bShowRoot=!i),t.nodeClass||(t.nodeClass=dynamicTree.RepositoryFolder),t.templateDomId="list_responsive_collapsible_folders";var n=new dynamicTree.TreeSupport(e,t);if(n.organizationId=t.organizationId,n.publicFolderUri=t.publicFolderUri,n.orgMode=i,n.modifyRootObject=function(e,t,i){var n;if(t){n=[];for(var o=0;o<e.length;o++)e[o].uri==this.publicFolderUri&&i&&"/"!=i.param.uri||n.push(e[o])}else if(this.orgMode&&null!=e.children){for(var s,r=e.children,a=[],o=0;o<r.length;o++)r[o].uri==this.publicFolderUri?s=r[o]:a.push(r[o]);e.children=a,n={type:"superroot",label:"",extra:{}},n.children=[e,s]}else n=e;return n},n.getRootNode=function(){var e=this.rootNode;return e.isSuperRoot()?e.childs[0].isPublic()?e.childs[1]:e.childs[0]:e},n.findNodeChildByMetaName=function(e,t){if(e.isSuperRoot()){var i,o;if(e.childs[0].isPublic()?(i=e.childs[0],o=e.childs[1]):(i=e.childs[1],o=e.childs[0]),"public"===t)return i;e=o}if(e.hasChilds())for(var s=0;s<e.childs.length;s++)if(e.childs[s].param.id==t)return e.childs[s];return"public"==t&&e.parent&&e.parent.isSuperRoot()?n.findNodeChildByMetaName(e.parent,t):null},isIPad()){var o=$(e);n.touchController=new TouchController(o,o.up(1),{absolute:!0})}return n},define("dynamicTree.utils",["components.dynamicTree","touchcontroller","dynamicTree.treenode"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),JRS.ViewQueryDialog=function(e){var t=function(t){this.template=e(t.id),this.selectionContainer=t.selectionContainer,this.updateContent(t.content),this.registerEvents()};return t.fn=t.prototype,t.fn.close=function(){disableSelectionWithoutCursorStyle(this.selectionContainer),dialogs.popup.hide(this.template.get(0))},t.fn.show=function(){enableSelection(this.selectionContainer),dialogs.popup.show(this.template.get(0))},t.fn.updateContent=function(t){e(".content .body textarea",this.template).html(t)},t.fn.registerEvents=function(){e(".button",this.template).on("click",e.proxy(this.close,this))},t}(jQuery),JRS.SaveAsDialog=function(e,t){return function(i){function n(t){var i=e(t.templateMatcher);return d.cloneTemplate&&(i=i.clone()),d.cloneTemplate&&d.elementId&&i.attr("id",t.elementId),e(d.insertAfterMatcher).append(i),i.on("keydown",function(e){d.grabKeydownEvents&&e.stopPropagation(),e.keyCode==Event.KEY_ESC&&u.close()}),i}function o(e,t){var i={};for(inputName in t.inputMatchers)t.inputMatchers.hasOwnProperty(inputName)&&(i[inputName]=e.find(t.inputMatchers[inputName]));
return i}function s(e){for(inputName in p)p.hasOwnProperty(inputName)&&(e[inputName]=p[inputName].val());if(f){var t=f.getSelectedNode();t?(e.folder=t.param.uri,e.isFolderWritable=t.param.extra?t.param.extra.isWritable:!0):e.folder=null}g&&(t=g.getSelectedNode(),t?(e.reportFolder=t.param.uri,e.isReportFolderWritable=t.param.extra?t.param.extra.isWritable:!0):e.reportFolder=null)}function r(e){e.stopPropagation(),s(m),d.prepareState&&d.prepareState(m),d.validator(m)&&d.saveHandler(m).then(function(){u.close()})}function a(e){e.stopPropagation(),u.close()}function l(e){var i=e.attr("id"),n=t.createRepositoryTree(i,{providerId:"adhocRepositoryTreeFoldersProvider",rootUri:"/",organizationId:d.organizationId,publicFolderUri:d.publicFolderUri,urlGetNode:"flow.html?_flowId=adhocTreeFlow&method=getNode",urlGetChildren:"flow.html?_flowId=adhocTreeFlow&method=getChildren",treeErrorHandlerFn:function(){}}),o=n.modifyRootObject;return n.modifyRootObject=function(e,t,i,s){for(var r=t?e:e.children,a=0,l=r.length;l>a;a++)r[a].extra.isWritable||(r[a].cssClass="readonly"),r[a].children&&n.modifyRootObject(r[a],!1,r[a],!0);return t?e=r:e.children=r,s?void 0:o.call(this,e,t,i)},n}var c={templateMatcher:"#saveAs",insertAfterMatcher:"#frame",cloneTemplate:!1,elementId:null,okButtonMatcher:".saveButton",cancelButtonMatcher:".cancelButton",inputMatchers:{name:".resourceName",description:".resourceDescription"},foldersTreeMatcher:"#saveDataViewFoldersTree",reportFoldersTreeMatcher:"#saveReportFoldersTree",organizationId:"",publicFolderUri:"/public",grabKeydownEvents:!0,validator:function(){return!0},saveHandler:function(){var t=e.Deferred();return t.resolve(),t}},d=e.extend({},c,i),u=this,h=n(d);this.dialogElement=h;var p=o(h,d);this.inputElements=p;var m={folder:null,isFolderWritable:!1,reportFolder:null,isReportFolderWritable:!1},f=null,g=null,v=h.find(d.foldersTreeMatcher),b=h.find(d.reportFoldersTreeMatcher);this.foldersTree=v,this.reportFoldersTree=b,this.open=function(t){m=t,dialogs.popup.show(h.get(0));for(inputName in p)if(p.hasOwnProperty(inputName)){var i=p[inputName],n=m[inputName];if(i[0]&&"SELECT"==i[0].tagName.toUpperCase()&&_.isArray(n)){i.empty();var o;_.each(n,function(e){o=new Option(e.label,e.id),o.id=e.id,i.append(o)})}else i.val(m[inputName])}h.find(d.okButtonMatcher).click(r),h.find(d.cancelButtonMatcher).click(a);var s=e.Deferred(),c=m.folder&&m.reportFolder?0:1;return m.folder&&(f=l(v),f.showTreePrefetchNodes(m.folder,function(){c++,m.folder&&f.openAndSelectNode(m.folder),2==c&&s.resolve()})),m.reportFolder&&b.length>0&&(g=l(b),g.showTreePrefetchNodes(m.reportFolder,function(){c++,g.openAndSelectNode(m.reportFolder),2==c&&s.resolve()})),s},this.close=function(){h.find(d.okButtonMatcher).unbind("click",r),h.find(d.cancelButtonMatcher).unbind("click",a),dialogs.popup.hide(h.get(0))}}}(jQuery,dynamicTree),JRS.RepositorySelectionDialog=function(e,t){var i={idsPrefix:"repSelDialog_",templateMatcher:"#repositorySelectionDialog",insertAfterMatcher:"#frame",okButtonMatcher:".okButton",cancelButtonMatcher:".cancelButton",repositoryTreeMatcher:"ul.repositoryTree",organizationId:"",publicFolderUri:"/public",treeFlowId:"treeFlow",treeProviderId:"repositoryExplorerTreeFoldersProvider",uriOnCancel:null,selectionValidationMessage:"Item not selected",acceptOnlyLeaf:!0,okHandler:function(){var t=e.Deferred();return t.resolve(),t}};return function(n){function o(t){var i=e(t.templateMatcher).clone();return a.elementId&&i.attr("id",t.elementId),e(a.insertAfterMatcher).append(i),i}function s(e){e.stopPropagation();var t=l._repositoryTree.getSelectedNode();if(!t||a.acceptOnlyLeaf&&t.isParent())return void alert(a.selectionValidationMessage);var i=a.okHandler(t.param.uri);i?i.then(function(){l.close()}):l.close()}function r(e){e.stopPropagation(),l.close(),a.uriOnCancel&&(document.location=a.uriOnCancel)}var a=e.extend({},i,n),l=this;this._createRepositoryTree=function(){var e=a.idsPrefix+"repTree";this.$repositoryTree.attr("id",e);var i=t.createRepositoryTree(e,{providerId:a.treeProviderId,rootUri:"/",organizationId:a.organizationId,publicFolderUri:a.publicFolderUri,urlGetNode:"flow.html?_flowId="+a.treeFlowId+"&method=getNode",urlGetChildren:"flow.html?_flowId="+a.treeFlowId+"&method=getChildren",treeErrorHandlerFn:function(){}});return i},this.init=function(){this.$dialogElement=o(a),this.$repositoryTree=this.$dialogElement.find(a.repositoryTreeMatcher),this.$dialogElement.find(a.okButtonMatcher).click(s),this.$dialogElement.find(a.cancelButtonMatcher).click(r)},this.open=function(){function t(e){if(e.isParent())for(var i=0;i<e.childs.length;i++)t(e.childs[i]);else"com.jaspersoft.ji.adhoc.AdhocDataView"==e.param.type&&(e.param.cssClass="adhocDataView",e.refreshStyle())}dialogs.popup.show(this.$dialogElement.get(0),!0),this._repositoryTree=this._createRepositoryTree();var i=e.Deferred();return this._repositoryTree.observe("children:loaded",function(e){var i=e.memo.nodes;i.each(function(e){t(e)})}),this._repositoryTree.showTreePrefetchNodes("/",function(){l._repositoryTree.openAndSelectNode("/"),i.resolve()}),this._repositoryTree.observe("leaf:dblclick",s),i},this.close=function(){dialogs.popup.hide(this.$dialogElement.get(0))},this.init()}}(jQuery,dynamicTree),JRS.GeneratorPropertiesDialog=function(e,t){function i(e){var t=dynamicTree.createRepositoryTree(e.treeId,{providerId:e.treeProviderId,rootUri:"/",organizationId:e.organizationId,publicFolderUri:e.publicFolderUri,urlGetNode:"flow.html?_flowId="+e.treeFlowId+"&method=getNode",urlGetChildren:"flow.html?_flowId="+e.treeFlowId+"&method=getChildren",treeErrorHandlerFn:function(){}});return t}var n={id:"reportGeneratorProperties",treeId:"advLocationTree",treeFlowId:"adhocTreeFlow",treeProviderId:"adhocDataViewsTreeDataProvider",organizationId:t.organizationId,publicFolderUri:t.publicFolderUri,advUri:void 0,reportGenerators:null,messages:{}},o=function(s){this.opts=jQuery.extend({},n,s),this.template=e("#"+this.opts.id),this.customGenerators=t.commonReportGeneratorsMetadata||[],this.registerEvents(),_.isUndefined(this.opts.advUri)?(e("#advTreePanel").removeClass(layoutModule.HIDDEN_CLASS),e("#reportGeneratorProperties").addClass(o.WITH_TREE_CLASS),this._tree=i(this.opts)):e("#reportGeneratorProperties").removeClass(o.WITH_TREE_CLASS),this._generatorSelect=new JRS.generatorSelect({id:"commonGeneratorSelect",parent:this.template.get(0),reportGenerators:this.customGenerators})};o.WITH_TREE_CLASS="withTree",o.NO_GENERATORS_CLASS=layoutModule.NO_GENERATORS_CLASS,o.fn=o.prototype,o.fn.show=function(){enableSelection(this.selectionContainer),0==this.customGenerators.length&&this.template.addClass(o.NO_GENERATORS_CLASS),dialogs.popup.show(this.template.get(0),!0);var e=s();e&&(e.template?this._generatorSelect.val(e.template,"TEMPLATE"):e.generator&&this._generatorSelect.val(e.generator,"GENERATOR"));var t=e&&e.sourceURI?e.sourceURI:"/",i=this._tree;i&&i.showTreePrefetchNodes(t,function(){e&&i.openAndSelectNode(t)})};var s=o.fn.store=function(e){var t=window.localStorage;if(!t)return null;if(!e){var i=t.getItem("reportGenerator");return i?JSON.parse(i):null}t.setItem("reportGenerator",JSON.stringify(e))},r=o.fn.ok=function(){var e=this.getValue();_.isUndefined(e.sourceURI)?alert(this.getMessage("advNotSelected")):_.isEmpty(e.template)&&"TEMPLATE"===this._generatorSelect.state?alert(this.getMessage("templateNotSelected")):(s(e),this.opts.okHandler&&this.opts.okHandler(e),this.close())},a=o.fn.close=function(){return disableSelectionWithoutCursorStyle(this.selectionContainer),dialogs.popup.hide(this.template.get(0)),this};return o.fn.getMessage=function(e){return this.opts.messages[e]},o.fn.getValue=function(){var e=this.opts.advUri;if(_.isUndefined(e)){var t=this._tree.getSelectedNode(),i=t&&"com.jaspersoft.ji.adhoc.AdhocDataView"==t.param.type;i&&(e=t.param.uri)}var n={sourceURI:e};return"TEMPLATE"===this._generatorSelect.state&&(n.template=this._generatorSelect.val()),"GENERATOR"===this._generatorSelect.state&&(n.generator=this._generatorSelect.val()),n},o.fn.registerEvents=function(){e("#reportGeneratorPropertiesBtnOk",this.template).on("click",e.proxy(r,this)),e("#reportGeneratorPropertiesBtnCancel",this.template).on("click",e.proxy(a,this))},o}(jQuery,__jrsConfigs__),JRS.generatorSelect=function(e,t,i){function n(t){return e("#"+t.options.id)}function o(t){t._radios=e("#"+t.options.id+" input[type="+_+"]").get();var i=t._radios.length;t._inputs=new Array(i);for(var n=0;i>n;n++){var o=t._radios[n].id,s=o.replace(g(_),""),r=e("#"+s);r.length>0&&(t._inputs[n]=r[0])}}function s(e){e.StateContract={},e._states=new Array(e._radios.length);var i=0;for(var n in b.StateContractPrototype){var o=t.clone(b.StateContractPrototype[n],!0);o.index=i,e.StateContract[n]=o,e._states[i]=n,i++}}function r(i,n){var o=i.StateContract.GENERATOR,s=e(i._inputs[o.index]);n&&n.length>0?(s.parents("li").removeClass("hidden"),t.each(n,function(t){s.append(e("<option />").val(t.id).text(t.label))})):s.parents("li").addClass("hidden")}function a(e){e.template.on("click",function(t){l(t.target)?e.refresh():c(t.target)&&f(e)})}function l(e){return e.type?"radio"==e.type:e.control&&"radio"==e.control.type}function c(e){return e.type&&"button"==e.type||"SPAN"==e.tagName&&"button"==e.parentNode.type}function d(t){e(t).attr("checked","checked")}function u(t){t=e(t);var i=t.parent();t.attr("disabled","disabled"),i.find("button").attr("disabled","disabled")}function h(t){t=e(t);var i=t.parent();t.attr("disabled",null),i.find("button").attr("disabled",null)}function p(t,i){e(t).val(i)}function m(t){return e(t).val()}function f(e){var t=e.StateContract[e.state],i=e._inputs[t.index];e._dialog||(e._dialog=new JRS.TemplateDialog({id:e.options.id+"TemplateDialog",parent:e.options.parent,okHandler:function(e){p(i,e)}})),e._dialog&&e._dialog.show(m(i))}function g(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}var v={id:"generatorSelect",defaultRadioIdPrefix:"DefaultTemplateRadio",customTemplateRadioIdPrefix:"CustomTemplateRadio",customGeneratorRadioIdPrefix:"CustomGeneratorRadio",reportGenerators:[{id:"custom",label:"Custom"}],treeId:"templateLocationTree",treeFlowId:"adhocTreeFlow",treeProviderId:"templateTreeDataProvider",organizationId:i.organizationId,publicFolderUri:i.publicFolderUri},_="radio",b=function(e){this.StateContract={},this.options=jQuery.extend({},v,e),this.template=n(this),this.state="DEFAULT",o(this),s(this),r(this,this.options.reportGenerators),a(this),this.refresh()};return b.fn=b.prototype,b.StateContractPrototype={DEFAULT:{index:0},TEMPLATE:{index:1},GENERATOR:{index:2}},b.fn.val=function(e,i){var n=this.StateContract[this.state];return t.isString(e)?(t.isString(i)&&t.has(this.StateContract,i)&&(n=this.StateContract[i]),d(this._radios[n.index]),p(this._inputs[n.index],e),this.refresh(),void 0):m(this._inputs[n.index])},b.fn.refresh=function(){for(var e=0;e<this._radios.length;e++)this._radios[e].checked?(h(this._inputs[e]),this.state=this._states[e]):u(this._inputs[e])},b.fn.hide=function(){this.template.addClass("hidden")},b.fn.show=function(){this.template.removeClass("hidden")},b}(jQuery,window._,__jrsConfigs__),JRS.TemplateDialog=function(e,t){function i(e){var t=dynamicTree.createRepositoryTree(e.treeId,{providerId:e.treeProviderId,rootUri:"/",organizationId:e.organizationId,publicFolderUri:e.publicFolderUri,urlGetNode:"flow.html?_flowId="+e.treeFlowId+"&method=getNode",urlGetChildren:"flow.html?_flowId="+e.treeFlowId+"&method=getChildren",treeErrorHandlerFn:function(){}});return t}var n=function(){return{treeId:"TemplateTree",treeFlowId:"adhocTreeFlow",treeProviderId:"templateTreeDataProvider",organizationId:t.organizationId,publicFolderUri:t.publicFolderUri,defaultTemplateUri:t.defaultTemplateUri}},o=function(t){this.opts=jQuery.extend({},n(),t),this.opts.treeId=this.opts.id+"Tree",this.template=e("#"+this.opts.id),this.registerEvents(),this._tree=i(this.opts)};o.fn=o.prototype,o.fn.show=function(e){dialogs.childPopup.show(this.template.get(0),!0,this.opts.parent);var t=this.opts.defaultTemplateUri||"/",i=this._tree;i.showTreePrefetchNodes(e||t,function(){i.openAndSelectNode(e||t)})};var s=o.fn.ok=function(){var e=this._tree.getSelectedNode(),t=e&&"com.jaspersoft.jasperserver.api.metadata.common.domain.FileResource"==e.param.type;t&&(this.opts.okHandler&&this.opts.okHandler(e.param.uri),this.close())},r=o.fn.close=function(){return disableSelectionWithoutCursorStyle(this.selectionContainer),dialogs.childPopup.hide(this.template.get(0)),this};return o.fn.registerEvents=function(){e("#"+this.opts.id+"OkTemplate",this.template).on("click",e.proxy(s,this)),e("#"+this.opts.id+"CloseTemplate",this.template).on("click",e.proxy(r,this))},o}(jQuery,__jrsConfigs__),define("dialog.definitions",["namespace","jquery","dynamicTree.utils"],function(e){return function(){var t;return t||e.JRS.RepositorySelectionDialog}}(this)),JRS.CreateReport=function(e,t){var i=null;return getDialog=function(e){return i||(i=new JRS.GeneratorPropertiesDialog({advUri:e,okHandler:JRS.CreateReport.showGeneratedReport,messages:t})),i},{showGeneratedReport:function(t){var i=e("#reportGeneratorForm");i.find("input[name=advUri]").val(t.sourceURI),i.find("input[name=template]").val(t.template||""),i.find("input[name=generator]").val(t.generator||""),i.submit()},selectADV:function(){getDialog().show()},selectGenerator:function(e){getDialog(e).show()}}}(jQuery,__jrsConfigs__),jQuery(function(){0==jQuery("#ajaxbuffer").length&&jQuery("body").append(jQuery('<div id="ajaxbuffer" style="display:none"></div>'))}),define("create.report",["namespace","jrs.configs","jquery","dialog.definitions"],function(e){return function(){var t;return t||e.JRS.CreateReport}}(this));var primaryNavModule={NAVIGATION_MENU_CLASS:"menu vertical dropDown",ACTION_MODEL_TAG:"navigationActionModel",CONTEXT_POSTFIX:"_mutton",NAVIGATION_MUTTON_DOM_ID:"navigation_mutton",NAVIGATION_MENU_PARENT_DOM_ID:"navigationOptions",JSON:null,navigationPaths:{browse:{url:"flow.html",params:"_flowId=searchFlow"},home:{url:"home.html"},library:{url:"flow.html",params:"_flowId=searchFlow&mode=library"},logOut:{url:"exituser.html"},search:{url:"flow.html",params:"_flowId=searchFlow&mode=search"},report:{url:"flow.html",params:"_flowId=searchFlow&mode=search&filterId=resourceTypeFilter&filterOption=resourceTypeFilter-reports&searchText="},olap:{url:"flow.html",params:"_flowId=searchFlow&mode=search&filterId=resourceTypeFilter&filterOption=resourceTypeFilter-view&searchText="},event:{url:"flow.html",params:"_flowId=logEventFlow"},samples:{url:"flow.html",params:"_flowId=sampleFlow&page=dialogs"},adminHome:{url:"flow.html",params:"_flowId=adminHomeFlow"},organization:{url:"flow.html",params:"_flowId=tenantFlow"},etl:{url:"etl"},mondrianProperties:{url:"olap/properties.html"},flush:{url:"olap/flush.html"},user:{url:"flow.html",params:"_flowId=userListFlow"},role:{url:"flow.html",params:"_flowId=roleListFlow"},analysisOptions:{url:"flow.html",params:"_flowId=mondrianPropertiesFlow"},designerOptions:{url:"flow.html",params:"_flowId=designerOptionsFlow"},designerCache:{url:"flow.html",params:"_flowId=designerCacheFlow"},awsSettings:{url:"flow.html",params:"_flowId=awsSettingsFlow"},designer:{url:"flow.html",params:"_flowId=adhocFlow"},dashboard:{url:"dashboard/designer.html"},legacyDashboard:{url:"flow.html",params:"_flowId=dashboardDesignerFlow&createNew=true"},domain:{url:"flow.html",params:"_flowId=createSLDatasourceFlow&ParentFolderUri="},dataSource:{url:"flow.html",params:"_flowId=addDataSourceFlow&ParentFolderUri="+encodeURIComponent("/datasources")},logSettings:{url:"log_settings.html"},createReport:{url:"view/view/modules/adhoc/createReport"}},bodyIds:{designer:"designerBase.confirmAndLeave",dashboardDesigner:"designerBase.confirmAndLeave",repoBrowse:"repositorySearch.confirmAndLeave",repoSearch:"repositorySearch.confirmAndLeave",manage_users:"orgModule.confirmAndLeave",manage_roles:"orgModule.confirmAndLeave",manage_orgs:"orgModule.confirmAndLeave",domainDesigner_tables:"domain.designer.confirmAndLeave",domainDesigner_derivedTables:"domain.designer.confirmAndLeave",domainDesigner_joins:"domain.designer.confirmAndLeave",domainDesigner_calculatedFields:"domain.designer.confirmAndLeave",domainDesigner_filters:"domain.designer.confirmAndLeave",domainDesigner_display:"domain.designer.confirmAndLeave",dataChooserDisplay:"domain.chooser.confirmAndLeave",dataChooserFields:"domain.chooser.confirmAndLeave",dataChooserPreFilters:"domain.chooser.confirmAndLeave",dataChooserSaveAsTopic:"domain.chooser.confirmAndLeave",reportViewer:"Report.confirmAndLeave"},globalActions:{logOut:function(e){return primaryNavModule.bodyIds[e]}},initializeNavigation:function(){var e,t,i;this.JSON=$("navigationActionModel").text?$("navigationActionModel").text.evalJSON():{};var n=/[A-Za-z]+[_]{1}[A-Za-z]+/;for(e in this.JSON)t=n.exec(e)[0],i=this.JSON[e][0],isNotNullORUndefined(i)&&this.createMutton(t,i.text)},createMutton:function(e,t){var i=$(this.NAVIGATION_MUTTON_DOM_ID).cloneNode("true"),n=$(i).down(".button");$(i).setAttribute("id",e);var o=document.createTextNode(t);n.appendChild(o);var s=$(this.NAVIGATION_MENU_PARENT_DOM_ID);s&&s.appendChild(i)},showNavButtonMenu:function(e,t){var i=jQuery(t).attr("id");actionModel.showDropDownMenu(e,t,i+this.CONTEXT_POSTFIX,this.NAVIGATION_MENU_CLASS,this.ACTION_MODEL_TAG),$("menu").parentId=i},isNavButton:function(e){return $(e).hasClassName("mutton")||$(e).hasClassName("icon")},setNewLocation:function(e,t){var i=this.navigationPaths[e],n=t||i.params;i&&(n=n?"?"+n:"",window.location.href=__jrsConfigs__.urlContext+"/"+i.url+n)},navigationOption:function(e){var t=$(document.body).readAttribute("id"),i=null;if(primaryNavModule.globalActions[e]?i=primaryNavModule.globalActions[e](t):primaryNavModule.bodyIds[t]&&(i=primaryNavModule.bodyIds[t]),i){var n=getAsFunction(i),o=n();if("function"==typeof o)return void o(function(){primaryNavModule.setNewLocation(e)});if(!o)return}primaryNavModule.setNewLocation(e)}};define("actionModel.primaryNavigation",["actionModel.modelGenerator"],function(e){return function(){var t;return t||e.primaryNavModule}}(this));var SearchBox=function(e){this._id=e.id,this._dom=$(this._id),this._enabled=!0,this._process(),this._assignHandlers()};SearchBox.addMethod("_process",function(){this._input=this._dom.select("input")[0],this._clearButton=this._dom.select(".button.searchClear")[0],this._searchButton=this._dom.select(".button.search")[0]}),SearchBox.addMethod("_assignHandlers",function(){this._dom.observe("submit",function(e){Event.stop(e)}),this._input.observe("keypress",this._keyPressHandler.bindAsEventListener(this)),this._clearButton.observe("click",this._clearHandler.bindAsEventListener(this)),this._searchButton.observe("click",this._searchHandler.bindAsEventListener(this))}),SearchBox.addMethod("_keyPressHandler",function(e){this._enabled&&Event.KEY_RETURN==e.keyCode&&(this._doSearch(),Event.stop(e))}),SearchBox.addMethod("_updateClearButtonVisibility",function(){this.getText().blank()?this._clearButton.removeClassName(layoutModule.UP_CLASS):this._clearButton.addClassName(layoutModule.UP_CLASS)}),SearchBox.addMethod("_clearHandler",function(){this._enabled&&(this.setText(""),this._doSearch())}),SearchBox.addMethod("_searchHandler",function(){this._enabled&&this._doSearch()}),SearchBox.addMethod("getText",function(){return this._input.getValue()}),SearchBox.addMethod("setText",function(e){this._input.setValue(e),this._updateClearButtonVisibility()}),SearchBox.addMethod("enable",function(){buttonManager.enable(this._clearButton),buttonManager.enable(this._searchButton),this._input.writeAttribute(layoutModule.READONLY_ATTR_NAME,null),this._dom.writeAttribute(layoutModule.DISABLED_ATTR_NAME,null),this._enabled=!0}),SearchBox.addMethod("disable",function(){buttonManager.disable(this._clearButton),buttonManager.disable(this._searchButton),this._input.writeAttribute(layoutModule.READONLY_ATTR_NAME,layoutModule.READONLY_ATTR_NAME),this._dom.writeAttribute(layoutModule.DISABLED_ATTR_NAME,layoutModule.DISABLED_ATTR_NAME),this._enabled=!1}),SearchBox.addMethod("_doSearch",function(){this._updateClearButtonVisibility(),this.onSearch(this.getText())}),SearchBox.addMethod("onSearch",function(){}),define("components.searchBox",["prototype","utils.common","core.events.bis"],function(e){return function(){var t;return t||e.SearchBox}}(this));var globalSearchBox={_searchBox:null,_containerId:"globalSearch",_searchInputId:"searchInput",initialize:function(){this._searchBox=new SearchBox({id:this._containerId}),this._searchBox.onSearch=function(e){$(this._searchInputId).setValue(e),primaryNavModule.navigationPaths.search.params+="&searchText="+encodeUriParameter(e),primaryNavModule.navigationOption("search")}.bind(this)},setText:function(e){this._searchBox.setText(e)}};define("repository.search.globalSearchBoxInit",["prototype","actionModel.primaryNavigation","components.searchBox"],function(e){return function(){var t;return t||e.globalSearchBox}}(this)),define("commons.main",["require","!domReady","json3","commons.minimal.main","namespace","core.accessibility","core.events.bis","core.key.events","create.report","actionModel.modelGenerator","actionModel.primaryNavigation","repository.search.globalSearchBoxInit","core.layout","jrs.configs"],function(e){var t=e("!domReady");e("json3"),e("commons.minimal.main"),e("namespace"),e("core.accessibility"),e("core.events.bis"),e("core.key.events"),e("create.report");var i=e("actionModel.modelGenerator"),n=e("actionModel.primaryNavigation"),o=e("repository.search.globalSearchBoxInit"),s=e("core.layout"),r=e("jrs.configs");t(function(){s.initialize(),n.initializeNavigation(),i.initializeOneTimeMenuHandlers(),r.initAdditionalUIComponents&&o.initialize(),document.fire("dom:loaded")})}),JRS.Log=function(){window.console||(window.console={log:function(){},debug:function(){},error:function(){}})}(),define("controls.logging",["namespace"],function(e){return function(){var t;return t||e.JRS}}(this)),JRS.Controls=function(e,t,i,n){var o=navigator.userAgent.toLowerCase().indexOf("msie")>-1;return{Base:t.extend(function(){},{extend:function(e,i){var n,o=this;n=e&&t.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},t.extend(n,o,i);var s=function(){this.constructor=n};return s.prototype=o.prototype,n.prototype=new s,e&&t.extend(n.prototype,e),n.__super__=o.prototype,n}}),TemplateEngine:{render:function(e,n,o){if(!o)return i.to_html(e,n);if(o==this.STD_PLACEHOLDERS){var s=String(e);return t.each(n,function(e,t){var i=new RegExp("\\{"+t+"\\}");s=s.replace(i,e)}),s}},renderUrl:function(e,t,n){var s=i.to_html(e,t);return o&&!n&&(s=encodeURI(s)),s},getTemplateText:function(t){var i=e("#"+t);return i.html()},createTemplate:function(t){var n=e("#"+t),o=n.html();return o&&o.length>0?function(e){return i.to_html(o,e)}:void 0},createTemplateSection:function(e,t){var n="\\{\\{#val\\}\\}(\\s|\\S)*\\{\\{/val\\}\\}",o=n.replace(/val/g,e),s=new RegExp(o,"g"),r=this.getTemplateText(t),a=r.match(s)[0];return function(e){return i.to_html(a,e)}},STD_PLACEHOLDERS:"std_placeholder"},Utils:{LOADING_DIALOG_DELAY:800,isElementInDom:function(e){var t=e.nextSibling,i=e.parentNode&&!(11===e.parentNode.nodeType);return t||i},setInnerHtml:function(e,i,n){var s,r;if(this.isElementInDom(e)){s=e.nextSibling,r=e.parentNode;var a=e.style.display;e.style.display="none",r.removeChild(e)}if(e.innerHTML="",o&&"SELECT"==e.tagName){var l=document.createDocumentFragment();t.each(n.data,function(e){var i=document.createElement("OPTION");i.value=t.isUndefined(e.value)?e.id:e.value,i.innerHTML=e.label,e.selected&&i.setAttribute("selected","selected"),l.appendChild(i)}),e.appendChild(l)}else e.innerHTML=i(n);if(s?r.insertBefore(e,s):r.appendChild(e),e.style.display=a,o&&"SELECT"==e.tagName){var c=e.getAttribute("style");e.removeAttribute("style"),e.setAttribute("style",c)}},wait:function(t){return e.Deferred(function(e){setTimeout(e.resolve,t)})},showLoadingDialogOn:function(i,o,s){this.wait(o?o:this.LOADING_DIALOG_DELAY).then(t.bind(function(){"pending"==i.state()&&(n.popup.show($(ajax.LOADING_ID),s,{focus:!1}),e.when(i).always(t.bind(function(){this.wait(500).then(function(){window.viewer&&window.viewer.loading?window.viewer.loaded&&n.popup.hide($(ajax.LOADING_ID)):n.popup.hide($(ajax.LOADING_ID))})},this)))},this))},createTimer:function(t){var i=new e.Deferred;return i.done(function(e){var i=(new Date).getTime(),n=i-e;console.log(t+" took time: "+n+" msec.")}),{start:function(){return this.startTime=(new Date).getTime(),this},stop:function(){return i.resolve(this.startTime),this}}}},listen:function(i,n){t.each(i,function(i,n){e(document).bind(n,t.bind(i,this))},n?n:this)},ignore:function(t,i){e(document).unbind(t,i)}}}(jQuery,_,Mustache,dialogs),define("controls.core",["jquery","underscore","mustache","components.dialogs","namespace","controls.logging"],function(e){return function(){var t;return t||e.JRS.Controls}}(this)),JRS.Controls=function(e,t,i){function n(e){if(t.isArray(e)){var i=t.filter(e,function(e){return e.selected});return t.map(i,function(e){return e.id||""===e.id?e:e.value})}return e}return t.extend(i,{BaseControl:i.Base.extend({id:null,elem:null,error:null,templateChunks:{},constructor:function(){this.initialize.apply(this,arguments)},getElem:function(){return this.elem},setElem:function(e){this.elem=e},bindCustomEventListeners:function(){},isSingleSelect:function(){return!t.isArray(this.get("selection"))},isSingleValue:function(){return!t.isArray(this.get("values"))},getTemplateSection:function(e){return this.templateChunks[this.type+"_"+e]||(this.templateChunks[this.type+"_"+e]=i.TemplateEngine.createTemplateSection(e,this.type)),this.templateChunks[this.type+"_"+e]},initialize:function(e){this.baseRender(e),this.isVisible(e)&&this.bindCustomEventListeners()},fireControlSelectionChangeEvent:function(t){e(document).trigger(i.CHANGE_CONTROL,this,t)},baseRender:function(n){n&&t.extend(this,n);var o=i.TemplateEngine.createTemplate(this.type);if(o){var s=e(o(this));this.setElem(s)}},update:function(){},get:function(e){return this[e]},isValid:function(){return null===this.error||this.error&&this.error instanceof String&&0===this.error.length},isVisible:function(e){return!e||void 0==e.visible||e.visible===!0},updateWarningMessage:function(){var e=null!=this.error?this.error:"";this.getElem()&&this.getElem().find(".warning").text(e)},refresh:function(){var e=this.get("values"),t=this.get("selection");e=this.isSingleValue()?t:i.BaseControl.merge(e,t),this.values=e,this.initialize(this),this.isVisible(this)&&this.update(e)},set:function(e,i){if(t.extend(this,e),void 0!==e.values&&(this.isVisible(this)&&this.update(e.values),this.selection=this.isSingleValue()?e.values:this.isSingleSelect()?n(e.values)[0]:n(e.values)),void 0!==e.selection&&(this.isSingleValue()&&(this.values=e.selection),!i&&this.fireControlSelectionChangeEvent()),void 0!==e.disabled&&!this.get("readOnly")){var o=e.disabled;i||(o?this.disable():this.enable())}void 0!==e.error&&this.updateWarningMessage()},find:function(e){if(void 0!==e&&e&&"object"==typeof e){var i=t.keys(e)[0],n=t.values(e)[0];return t.find(this.get("values"),function(e){return e[i]===n})}},enable:function(){this.getElem().find("input").prop("disabled",!1),this.getElem().find("select").prop("disabled",!1)},disable:function(){this.getElem().find("input").prop("disabled",!0),this.getElem().find("select").prop("disabled",!0)}},{merge:function(e,i){return t.isNull(e)||t.isUndefined(e)?i:t.isNull(i)||t.isUndefined(i)?e:t.isArray(i)?t.map(e,function(e){var n=t.find(i,function(t){return t===e.value});return void 0!=n?e.selected=!0:delete e.selected,e}):this.merge(e,[i])}}),CHANGE_CONTROL:"changed:control"})}(jQuery,_,JRS.Controls),define("controls.basecontrol",["jquery","underscore","controls.core"],function(e){return function(){var t;return t||e.JRS.Controls}}(this));var ControlsBase={INPUT_CONTROLS_FORM:"inputControlsForm",INPUT_CONTROLS_CONTAINER:"inputControlsContainer",INPUT_CONTROLS_DIALOG:"inputControls",SAVE_REPORT_OPTIONS_DIALOG:"saveValues",REPORT_OPTIONS_SELECTOR:"savedValues",TOOLBAR_CONTROLS_BUTTON:"ICDialog",DEFAULT_OPTION_TEXT:"Options",NULL_SUBSTITUTION_VALUE:null,NULL_SUBSTITUTION_LABEL:null,NOTHING_SUBSTITUTION_VALUE:null,_BUTTON_OK:"ok",_BUTTON_SAVE:"save",_BUTTON_REMOVE:"remove",_BUTTON_APPLY:"apply",_BUTTON_CANCEL:"cancel",TEMP_REPORT_CONTAINER:"tempReportContainer",WRAPPER_ERROR_FLAG_PREFIX_SELECTOR:"div[id^=error_]",WRAPPERS_ERRORS_DIV:"wrappersErrors",EVAL_SCRIPT_ELEMENT_NAME:"_evalScript",CALENDAR_ICON_SPAN:'<span class="button picker calTriggerWrapper" />',_messages:{},getMessage:function(e,t){var i=this._messages[e];return i?new Template(i).evaluate(t?t:{}):""},setControlError:function(e,t){e&&(e=$(e),t?(e.up().addClassName(layoutModule.ERROR_CLASS),e.nextSiblings()[0].update(t)):(e.up().removeClassName(layoutModule.ERROR_CLASS),e.nextSiblings()[0].update("")))},setControlsErrors:function(e){var t=$$(ControlsBase.WRAPPER_ERROR_FLAG_PREFIX_SELECTOR),i=0,n=-1;t.each(function(t){var o=!1;e&&e.each(function(e){if(t.id.indexOf(e[0])>-1)throw ControlsBase.setControlError(t,e[1]),0>n&&(jQuery("#inputControlsForm .leaf").each(function(e,t){i>e&&(n+=t.clientHeight)}),jQuery(".groupBox .content .body")[0].scrollTop=n),o=!0,$break;i++}),o||ControlsBase.setControlError(t,"")})},buildParams:function(e){var t="";if(_.isObject(e)&&!_.isEmpty(e)){var i=function(e){return e.length>0&&"&"!=e[e.length-1]&&(e+="&"),e};_.each(e,function(e,n){t=i(t),_.isArray(e)?_.each(e,function(e){t=i(t),t+=n+"="+encodeURIComponent(e)}):t+=n+"="+encodeURIComponent(e)})}return t},buildSelectedDataUri:function(e,t){var i=ControlsBase.buildParams(e);if(_.isObject(t)&&!_.isEmpty(t)){var n=ControlsBase.buildParams(t);return i+"&"+n}return i}},ControlDialog=function(e){var t=this;this._dom=$(ControlsBase.INPUT_CONTROLS_DIALOG),this.buttonActions=e,jQuery("#"+ControlsBase.INPUT_CONTROLS_DIALOG).on("mouseup touchend","button",function(){if(this.id&&!this.id.empty()){var e=t.buttonActions["button#"+this.id];e&&e()}})};ControlDialog.addMethod("_dialogClickHandler",function(e){var t=e.element();for(var i in this.buttonActions)if(matchAny(t,[i],!0))return this.buttonActions[i](),void e.stop()}),ControlDialog.addMethod("show",function(){dialogs.popup.show(this._dom)}),ControlDialog.addMethod("hide",function(){dialogs.popup.hide(this._dom)});var OptionsDialog=function(e){this._dom=$(ControlsBase.SAVE_REPORT_OPTIONS_DIALOG),this.input=this._dom.select("input#savedValuesName")[0],this.overwrite=!1,this.buttonActions=e,this._dom.observe("click",this._dialogClickHandler.bindAsEventListener(this))};OptionsDialog.addMethod("_dialogClickHandler",function(e){var t=e.element();for(var i in this.buttonActions)if(matchAny(t,[i],!0))return this.buttonActions[i](),void e.stop()}),OptionsDialog.addMethod("show",function(){this.input.setValue(ControlsBase.DEFAULT_OPTION_TEXT),dialogs.popup.show(this._dom)}),OptionsDialog.addMethod("hide",function(){dialogs.popup.hide(this._dom),this.hideWarning()}),OptionsDialog.addMethod("showWarning",function(e){var t=jQuery("#"+ControlsBase.SAVE_REPORT_OPTIONS_DIALOG).find(".warning");e&&t.text(e),t.show()}),OptionsDialog.addMethod("hideWarning",function(){var e=jQuery("#"+ControlsBase.SAVE_REPORT_OPTIONS_DIALOG).find(".warning");e.text(""),e.hide()}),define("controls.base",["jquery","underscore","utils.common"],function(e){return function(){var t;return t||e.ControlsBase}}(this)),function(e){e.Report={_messages:{},_scroll:null,pageActions:{},viewReportForm:null,pageIndex:0,lastPageIndex:0,pageTimestamp:null,checkPageUpdatedTimeoutId:null,emptyReport:!0,reportForceControls:!1,hasInputControls:!1,reportControlsLayout:null,refreshReportCanceled:!1,reportParameterValues:null,allRequestParameters:null,requestedInputParameters:{},parametersWithoutDefaultValues:null,isLoaded:!1,EXPORT_ACTION_FORM:"exportActionForm",TOOLBAR_SUBMENU:"toolbarText",PAGINATION_CONTAINER:"pagination",PAGINATION_PAGE_FIRST:"page_first",PAGINATION_PAGE_PREV:"page_prev",PAGINATION_PAGE_CURRENT:"page_current",PAGINATION_PAGE_NEXT:"page_next",PAGINATION_PAGE_LAST:"page_last",PAGINATION_PAGE_TOTAL:"page_total",DATA_TIMESTAMP_SPAN:"dataTimestampMessage",DATA_REFRESH_BUTTON:"dataRefreshButton",ASYNC_CANCEL_BUTTON:"asyncCancel",getMessage:function(e,t){var i=this._messages[e];
return i?new Template(i).evaluate(t?t:{}):""},commonInit:function(){var e=jQuery("#"+ajax.LOADING_ID);e.length>0&&(e.addClass(layoutModule.CANCELLABLE_CLASS),e.find("#cancel").click(function(){Report.cancelReportExecution()})),document.location.href.indexOf("frame=0")>0&&(jQuery("#reportViewFrame > .content > .header").hide(),jQuery("#reportViewFrame").css("margin",0),jQuery("#innerPagination").css("margin","none"),jQuery("#reportViewFrame > .content > .body").css({top:0,"margin-top":0}))},navigateToReportPage:function(e){viewer.jive&&viewer.jive.hide(),viewer.reportInstance.gotoPage(e)},goToPage:function(e){parseInt(e,10)&&parseInt(e,10)>0&&(null==Report.lastPageIndex||parseInt(e,10)<=Report.lastPageIndex+1)?Report.navigateToReportPage(parseInt(e,10)-1):doNothing()},reportExecutionKey:function(){return Report.flowExecutionKeyOutput?Report.flowExecutionKeyOutput:window.dashboardViewFrame?dashboardViewFrame.flowExecutionKey:Report.flowExecutionKey},refreshReport:function(e,t,i){var n=/(\?|&)output=([^&]*)/.exec(location.href),o=n&&3===n.length?n[2]:"";dialogs.popup.show($(ajax.LOADING_ID),!0),e=e||{},e._flowExecutionKey=e._flowExecutionKey?e._flowExecutionKey:Report.reportExecutionKey(),e._eventId=e._eventId?e._eventId:"refreshReport",e.decorate="no",e.confirm="true",e.decorator="empty",e.ajax||(e.ajax="true");var s="flow.html?"+Object.toQueryString(e);Report.requestedInputParameters=i?i:this.getParametersFromRequest(),e.freshData&&(Report.requestedInputParameters+="&freshData=true"),""===o||"html"===o?Report.isLoaded?(viewer.reportInstance.eventManager.triggerEvent("beforeAction",{name:"beforeAction",type:"reportRefresh"}),viewer.reportInstance.refreshPage(0)):(Report.isLoaded=!0,viewer.loadReport()):"pdf"===o||"swf"===o?Report.exportReport(o,s):(new jaspersoft.components.AjaxDownloader).start(s+"&"+Report.requestedInputParameters)},cancelReportExecution:function(){document.body.style.cursor="default",dialogs.popup.hide($(ajax.LOADING_ID)),viewer.reportInstance.cancelExecution().then(function(){},function(){Report.goBack()})},getParametersFromRequest:function(){return ControlsBase.buildParams(Report.getAllRequestParameters())},getAllRequestParameters:function(){return _.isObject(Report.allRequestParameters)?Report.allRequestParameters:{}},canSaveReport:function(){return!Report.isReportReadOnly},confirmExit:function(){return!0},confirmAndLeave:function(){return Report.confirmExit()?Report.closeViewerOnExit:!1},closeViewerOnExit:function(e){viewer.exit().then(function(){e()})},showAjaxDialog:function(){dialogs.popup.show($(ajax.LOADING_ID),!0)},hideAjaxDialog:function(){dialogs.popup.hide($(ajax.LOADING_ID))}}}(window),define("report.view.base",["jquery","underscore","controls.basecontrol","controls.base","core.ajax"],function(e){return function(){var t;return t||e.Report}}(this));var domain={PROPAGATE_EVENT:"propagateEvent",_messages:{},disabledFolderTooltip:"disabledFolderTooltip",getMessage:function(e,t){var i=this._messages[e];return i?new Template(i).evaluate(t?t:{}):""},setMessage:function(e,t){this._messages[e]=t},treeErrorHandler:function(){throw"exception while loading tree"},submitForm:function(e,t,i){if(t){var n=buildActionUrl(t);i&&i(),$(e).writeAttribute("method","post").writeAttribute("action",n),$(e).submit()}},sendAjaxRequest:function(e,t,i,n){var o=buildActionUrl(e),s={postData:Object.toQueryString(t),callback:i,errorHandler:this._serverErrorHandler,mode:AjaxRequester.prototype.EVAL_JSON};n&&Object.extend(s,n),ajaxTargettedUpdate(o,s)},_serverErrorHandler:function(e){return baseErrorHandler(e)},elementClicked:function(e,t){return e&&t?matchAny(e,[t],!0):!1},basicClickHandler:function(e,t,i){var n=null;return t.any(function(t){return n=domain.elementClicked(e,t.key),n?(Object.isFunction(t.value)?t.value(n):Object.isFunction(i)&&i(t.value),!0):void 0})},registerClickHandlers:function(e,t,i){if(domain._bodyClickEventHandlers)return void(i?Array.prototype.unshift:Array.prototype.push).apply(domain._bodyClickEventHandlers,e);domain._bodyClickEventHandlers=e;var n=t?t:"body";$$(n)[0].observe(isSupportsTouch()?"touchstart":"click",function(e){var t=e.element();domain._bodyClickEventHandlers&&domain._bodyClickEventHandlers.each(function(i){var n=i(t);if(n)throw n!==domain.PROPAGATE_EVENT&&Event.stop(e),$break})})},enableButton:function(e,t){"string"==typeof e&&(e=$(e)),e.disabled=t,t?buttonManager.enable(e):buttonManager.disable(e)},setOptionsToSelect:function(e,t){return e&&(e.update(""),t)?(t.each(function(t){var i={value:t.value,title:t.label};t.selected&&(i.selected="selected");var n=new Element("option",i);n.appendChild(document.createTextNode(t.label)),e.appendChild(n)}),e):void 0},getDataIslandId:function(e,t){var i=dynamicTree.trees[e.getTreeId()].getRootNode(),n=function o(e,t){return null===e.parent||e.parent===i?e.param.extra[t]:o(e.parent,t)};return n(e,t)},areNodesFromSameIsland:function(e,t){var i=e.any(function(e){return e.param.extra.isConstant});if(i)return!0;var n=1===e.pluck("parent").uniq().length;return n?!0:1===e.map(function(e){return domain.getDataIslandId(e,t||"itemId")}).uniq().length},NumberFormat:function(e,t){var i="."===e,n=new RegExp("["+e.gsub(/\s/,"\\s")+"]+"),o=new RegExp("["+t.gsub(/\s/,"\\s")+"]+"),s=new RegExp("^-|\\"+t+"?\\d+|\\"+t+"$|\\"+e+"+","g");return{toNumber:function(e){return!e||!i&&/[.]/.test(e)?0/0:Number(e.gsub(o,"").gsub(n,"."))},normalizeNumberEntry:function(i){var n=i.strip().match(s);if(!n)return"";for(var o=!1,r=0;r<n.length;r++)n[r].startsWith(e)?o?delete n[r]:(n[r]=e,o=!0):n[r].startsWith(t)&&o&&(n[r]=n[r].substring(1));var a=n.join("");return a},isInteger:function(e){return n.test(e)}}},baseValidator:function(e,t){var i=!0,n="";return e()&&(n=t,i=!1),{isValid:i,errorMessage:n}},maxLengthValidator:function(e,t,i){return domain.baseValidator(function(e,t){return e.length>t}.curry(e,t),i)},minLengthValidator:function(e,t,i){return domain.baseValidator(function(e,t){return e.length<t}.curry(e,t),i)},valueNotEmptyValidator:function(e,t){return domain.baseValidator(function(e){return Object.isArray(e)&&0===e.length||!e||!String(e).strip()}.curry(e),t)},stringIdValidator:function(e,t){return domain.baseValidator(function(e){return!/^[^0-9() .,'"=!+-/><//:][^() .,'"=!+-/><//:]*$/.test(e)}.curry(e),t)},numberValidator:function(e,t,i){return domain.baseValidator(isNaN.curry(t.toNumber(e)),i)},numberBoundsValidator:function(e,t,i){return domain.baseValidator(function(e,t){return 1/0===e||e===-1/0?!0:!(e<=t.max&&e>=t.min)}.curry(e,t),i)},rangeValidator:function(e,t,i){return domain.baseValidator(function(e,t){return!(t>e)}.curry(e,t),i)},dateValidator:function(e,t,i){return domain.baseValidator(function(e,t){return 0===getDateFromFormat(t,e)}.curry(t,e),i)}};domain.NodeCopyMoveController=function(){},domain.NodeCopyMoveController.addMethod("copy",function(e,t,i){if(e&&e.length>0&&t){var n=dynamicTree.trees[t.getTreeId()],o=e.collect(function(e){var o=e.param.id,s=this._copyParentStructure(e,n);return s?this._mergeToDestTree(s,t,o,i):null}.bind(this));return t.isloaded=!0,o.without(null)}}),domain.NodeCopyMoveController.addMethod("copySelected",function(e,t){return sourceTree&&t?this.copy(sourceTree.selectedNodes,t):void 0}),domain.NodeCopyMoveController.addMethod("move",function(e,t){if(e&&t){var i=this.copy(e,t);return this.hide(e),i}}),domain.NodeCopyMoveController.addMethod("moveSelected",function(e,t){return e&&t?this.move(e.selectedNodes,t):void 0}),domain.NodeCopyMoveController.addMethod("hide",function(e,t,i){if(e&&e.length>0){t||(t=this._getVisibleChildrenCount),i||(i=function(e,t){e.hide(t)});var n=dynamicTree.trees[e[0].getTreeId()];e.collect(function(e){return e.id}).each(function(e){var o=dynamicTree.nodes[e];i(o,!0);for(var s=o.parent;s&&s!=n.getRootNode()&&!(t(s)>0);)i(s,!1),s.refreshStyle(),s=s.parent}.bind(this))}}),domain.NodeCopyMoveController.addMethod("_handleDuplicatedNode",function(e){return e.param.id}),domain.NodeCopyMoveController.addMethod("_markAsLoaded",function(e){e.isloaded=!0,e.isParent()&&e.childs.each(function(e){this._markAsLoaded(e)}.bind(this))}),domain.NodeCopyMoveController.addMethod("_mergeToDestTree",function(e,t,i,n){if(t){var o=dynamicTree.trees[t.getTreeId()];if(n)return i=this._handleDuplicatedNode(e,t),o.findNodeById(i,e);var s=o.findNodeChildByMetaName(t,e.param.id);return null!=s?(s.isHidden()&&s.show(),e.hasChilds()&&(s.disabled&&s.enable(e.tooltip),e.childs.each(function(e){this._mergeToDestTree(e,s)}.bind(this))),o.findNodeById(i,s)):(t.addChild(e),this._markAsLoaded(e),o.findNodeById(i,e))}}),domain.NodeCopyMoveController.addMethod("_copyParentStructure",function(e,t){if(e&&t){var i=dynamicTree.trees[e.getTreeId()];if(e.disabled)return null;for(var n=this._copyNode(e,t,!0),o=e.parent,s=null;o&&o!=i.getRootNode();)s=this._copyNode(o,t,!1),s.addChild(n),n=s,o=o.parent;return n}}),domain.NodeCopyMoveController.addMethod("_buildMetanode",function(e){return deepClone(e.param)}),domain.NodeCopyMoveController.addMethod("_copyNode",function(e,t,i){if(e&&t){var n=t.processNode(this._buildMetanode(e));i&&(e.hasChilds()?e.childs.each(function(e){if(!e.disabled){var e=this._copyNode(e,t,i);e&&n.addChild(e)}}.bind(this)):n.setHasChilds(!1));var o=e.childs.findAll(function(e){return e.disabled});return e.childs.length>0&&o.length==e.childs.length?null:n}}),domain.NodeCopyMoveController.addMethod("_delete",function(e){e&&e.collect(function(e){return e.id}).each(function(e){var t=dynamicTree.nodes[e];t&&t.parent.removeChild(t)})}),domain.NodeCopyMoveController.addMethod("_getVisibleChildrenCount",function(e){var t=e.childs.findAll(function(e){return e.isHidden()});return e.childs.length-t.length}),domain.resetTreeSelectionHandler={_COMMON_ELEMENTS_TO_SAVE_SELECTION:["#pageDimmer","#detail","#standardConfirm"],_getTrees:null,_elementIds:null,_callback:null,_validator:null,init:function(e,t,i,n){domain.resetTreeSelectionHandler._init.bind(domain.resetTreeSelectionHandler,e,t,i,n)()},_init:function(e,t,i,n){this._getTrees=t,this._callback=i,this._validator=n,this._elementIds=this._COMMON_ELEMENTS_TO_SAVE_SELECTION.concat(e),domain.registerClickHandlers([this._removeTreeSelectionClickEventHandler.bind(this)],null,!0)},_removeTreeSelectionClickEventHandler:function(e){if(!matchAny(e,this._elementIds,!0)){var t=!1;return this._getTrees().each(function(e){if(e.selectedNodes&&e.selectedNodes.first())throw t=!0,$break}),t?this._validator&&!this._validator()?!0:(this._getTrees().each(function(e){e._deselectAllNodes()}),this._callback&&this._callback(),!1):!1}}},domain.NodeChangeOrderController=function(){},domain.NodeChangeOrderController.addMethod("findNodeWithSpecificOrder",function(e,t,i){for(var n=e.length-1;n>=0;n--)if(e[n].isSelected()==i&&e[n].orderNumber===t)return e[n];return null}),domain.NodeChangeOrderController.addMethod("findMaxSiblingNode",function(e,t,i){var n=null,o=null;return e.each(function(e){e.isSelected()==t&&(null===n||i==e.orderNumber<n)&&(n=e.orderNumber,o=e)}),o}),domain.NodeChangeOrderController.addMethod("moveNode",function(e,t,i,n){var o=e.orderNumber,s=e.parent.childs,r=null,a=null;i?(r=this.findMaxSiblingNode(s,!1,t,e.param.type),a=r?r.orderNumber:-1,s.each(function(i){i.param.id!==e.param.id&&(t==i.orderNumber>a&&t==i.orderNumber<o||i.orderNumber==a)&&(i.orderNumber=t?i.orderNumber+1:i.orderNumber-1,n&&n(i,i.orderNumber))}),n&&n(e,a),e.orderNumber=a):(a=t?e.orderNumber-1:e.orderNumber+1,r=this.findNodeWithSpecificOrder(s,a,!1),r&&(n&&n(e,a),n&&n(r,o),e.orderNumber=a,r.orderNumber=o))}),domain.NodeChangeOrderController.addMethod("nodeAscSorter",function(e,t){return e.orderNumber-t.orderNumber}),domain.NodeChangeOrderController.addMethod("nodeDescSorter",function(e,t){return t.orderNumber-e.orderNumber}),domain.DisplayNodeChangeOrderController=function(){domain.NodeChangeOrderController.call()},domain.DisplayNodeChangeOrderController.prototype=deepClone(domain.NodeChangeOrderController.prototype),domain.DisplayNodeChangeOrderController.addMethod("findMaxSiblingNode",function(e,t,i,n){var o=null,s=null;return e.each(function(e){e.isSelected()==t&&(null!==o&&i!=e.orderNumber<o||(n?e.param.type!==n:0)||(o=e.orderNumber,s=e))}),s}),define("domain.base",["jquery","underscore","backbone","utils.common"],function(e){return function(){var t;return t||e.domain}}(this));var REPORT_TYPE_PARAM="reportType",REPORT_TYPE_URL_PARAM_PATTERN=new RegExp("[\\?&]"+REPORT_TYPE_PARAM+"=([^&#]*)");domain.chooser={FLOW_ID:"adhocFlow",FIELDS:"dataChooserFields",DISPLAY:"dataChooserDisplay",SAVE_AS_TOPIC:"dataChooserSaveAsTopic",PRE_FILTERS:"dataChooserPreFilters",submitFormId:"stepDisplayForm",currentPage:null,flowExecutionKey:null,unsavedChangesPresent:!1,initialize:function(){var e=REPORT_TYPE_URL_PARAM_PATTERN.exec(location.search);if(this.reportType=null==e?"":decodeURIComponent(e[1].replace(/\+/g," ")),localContext.rsInitOptions){var t=localContext.rsInitOptions;this.currentPage=$(document.body).identify(),this.flowExecutionKey=t.flowExecutionKey,this.unsavedChangesPresent=t.unsavedChangesPresent;var i=this.pageInitFactory[this.currentPage]();this.initModule(i,t),domain.registerClickHandlers([this.getFlowControlsClickEventHandler()])}},initModule:function(e,t){e&&(e.fillForm&&(dc.fillForm=e.fillForm.bind(e)),e.getFlowControlsClickEventHandler&&(dc.getFlowControlsClickEventHandler=e.getFlowControlsClickEventHandler.bind(e)),e.init.bind(e)(t))},fillForm:function(){},getFlowControlsClickEventHandler:function(){return dc.flowControlsClickEventHandler.bind(dc)},flowControlsClickEventHandler:function(e){var t=!1;return this.flowControlsEventMap.each(function(i){if(domain.elementClicked(e,i.key)){if(t=!0,i.value.returnOnPage&&this.currentPage===i.value.returnOnPage)throw $break;if(i.value.confirmLeave&&!this.confirmAndLeave())throw $break;throw delete i.value.returnOnPage,i.value.flowId=this.FLOW_ID,i.value.flowExecutionKey=this.flowExecutionKey,i.value.reportType=this.reportType,__jrsConfigs__.initAdditionalUIComponents||(i.value.decorate="no"),"cancelRedirect"===i.value.eventId&&jQuery(document).trigger("adhocDesigner:cancel"),domain.submitForm(this.submitFormId,i.value,this.fillForm),$break}}.bind(this)),t}};var dc=domain.chooser;dc.confirmAndLeave=function(){return dc.unsavedChangesPresent?confirm(domain.getMessage("exitMessage")):!0},dc.setUnsavedChangesPresent=function(e){dc.unsavedChangesPresent=!!e},dc.isUnsavedChangesPresent=function(){return dc.unsavedChangesPresent},dc.pageInitFactory={dataChooserFields:function(){return dc_fields},dataChooserPreFilters:function(){return dc_filters},dataChooserDisplay:function(){return dc_display},dataChooserSaveAsTopic:function(){return dc_saveAs}},dc.flowControlsEventMap=$H({"#fieldsTab":{returnOnPage:domain.chooser.FIELDS,eventId:"fields"},"#filtersTab":{returnOnPage:domain.chooser.PRE_FILTERS,eventId:"preFilters"},"#displayTab":{returnOnPage:domain.chooser.DISPLAY,eventId:"display"},"#saveTopicTab":{returnOnPage:domain.chooser.SAVE_AS_TOPIC,eventId:"saveAsTopic"},"#goToDesigner":{eventId:"done",reportType:dc.reportType},"#cancel":{eventId:"cancelRedirect",confirmLeave:!0}}),define("domain.chooser",["domain.base"],function(e){return function(){var t;return t||e.domain}}(this)),domain.ItemNode=function(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("ItemGroupType"),Leaf:new dynamicTree.TreeNode.Type("ItemType")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_fields:fields",this._hidden=!1,this.disabled=!1},domain.ItemNode.prototype=deepClone(dynamicTree.TreeNode.prototype),domain.ItemNode.addMethod("hide",function(e){if(e&&this.hasChilds())for(var t=0;t<this.getChildCount();t++)this.childs[t].hide(!0);var i=(this.childs.findAll(function(e){return e.disabled}).length,this.childs.findAll(function(e){return e.isHidden()}).length),n=this.childs.length-i;this.disabled||0!=n?this.getType()===this.Types.Leaf&&(this.deselect(),this.disable(domain.getMessage(domain.disabledFolderTooltip))):(this._hidden=!0,this.deselect(),this.refreshStyle())}),domain.ItemNode.addMethod("show",function(){this._hidden=!1,this._getElement()&&this.refreshStyle(this._getElement())}),domain.ItemNode.addMethod("disable",function(e){e&&(this.tooltip=e),this.disabled=!0,this._getElement()&&this.refreshStyle(this._getElement())}),domain.ItemNode.addMethod("enable",function(e){e&&(this.tooltip=e),this.disabled=!1,this._getElement()&&this.refreshStyle(this._getElement())}),domain.ItemNode.addMethod("refreshStyle",function(e){if(e||(e=this._getElement())){dynamicTree.TreeNode.prototype.refreshStyle.call(this,e),this.isHidden()?e.addClassName(layoutModule.HIDDEN_CLASS):e.removeClassName(layoutModule.HIDDEN_CLASS);var t=e.select("p").first();t&&(t.title=this.tooltip?this.tooltip:"",this.disabled?(buttonManager.disable(t),buttonManager.disable(e)):(buttonManager.enable(t),buttonManager.enable(e)))}}),domain.ItemNode.addMethod("isHidden",function(){return this._hidden}),domain.ItemNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type};return e&&(t.labelId=e.labelId||"",t.descr=e.descr,t.descrId=e.descrId||"",t.dataType=e.dataType||"",t.resourceId=e.resourceId),this.isParent()&&(t.children=_.chain(this.childs).filter(function(e){return!e.isHidden()}).invoke("toJSON").value()),t}),domain.ItemNode.addMethod("hasVisibleChilds",function(){return this.hasChilds()&&!!this.childs.find(function(e){return!e.isHidden()})}),domain.ItemNode.addMethod("hasEnabledChilds",function(){return this.hasChilds()&&!!this.childs.find(function(e){return!e.disabled})}),domain.ItemNode.addMethod("removeChilds",function(){this.hasChilds()&&this.childs.each(function(e){this.removeChild(e)}.bind(this))}),domain.FieldsCopyMoveController=function(){domain.NodeCopyMoveController(this)},domain.FieldsCopyMoveController.prototype=deepClone(domain.NodeCopyMoveController.prototype),domain.FieldsCopyMoveController.addMethod("_buildMetanode",function(e){var t=deepClone(e.param);return t.label=e.name,t.order=e.orderNumber,t.tooltip=e.tooltip,t}),domain.TwoColumnNode=function(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("ItemGroupType",{}),Leaf:new dynamicTree.TreeNode.Type("ItemType",{})},this.nodeHeaderTemplateDomId="list_responsive:twoColumn"},domain.TwoColumnNode.prototype=deepClone(dynamicTree.TreeNode.prototype),domain.TwoColumnNode.addMethod("_createNode",function(){var e=this.id,t=(dynamicTree.trees[this.getTreeId()],this._getHeaderTemplateElement());t.id=this.NODE_ID_PREFIX+e,this.refreshStyle(t),t.treeNode=this;var i=t.childElements()[0];this.tooltip&&(i.title=this.tooltip);var n=i.childElements()[0];n.id=this.HANDLER_ID_PREFIX+e;var o=i.childElements()[1],s=this.param.extra&&this.param.extra.label?this.param.extra.label:this.name;o.insert(s);var r=i.childElements()[2];r.insert(this.name),this._element=t}),domain.TwoColumnNode.addMethod("_getTitle",function(){var e=this._getElement().childElements()[0].childElements()[2];return e.cleanWhitespace(),0==e.childNodes.length&&e.appendChild(document.createTextNode("")),e.childNodes[0]}),domain.TwoColumnNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type,order:this.orderNumber.toString()};return e&&(t.labelId=e.labelId||"",t.dataType=e.dataType||"",t.resourceId=e.resourceId),this.isParent()&&(t.children=_.invoke(this.childs,"toJSON")),t}),domain.TwoColumnNode.addMethod("expandAllChilds",function(){var e=dynamicTree.trees[this.getTreeId()];this.isParent()&&!this.isOpen()&&(e.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),this.refreshNode()),this.hasChilds()&&this.childs.each(function(e){e.expandAllChilds()})}),domain.TablesNode=function(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("level"),Leaf:new dynamicTree.TreeNode.Type("item")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_type_tables:tables"},domain.TablesNode.prototype=deepClone(domain.ItemNode.prototype),domain.TablesNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type};return e&&(t.originalId=e.originalId,t.datasourceId=e.datasourceId,t.repoId=e.repoId,t.itemId=e.itemId,t.dataSource=e.dataSource,t.table=e.table,this.isParent()?(t.query=e.query,t.dataSetType=e.dataSetType):(t.expression=e.expression,t.islandId=e.islandId,t.isConstant=e.isConstant,t.JavaType=e.JavaType,t.JdbcType=e.JdbcType),e.fieldDbName&&(t.fieldDbName=e.fieldDbName)),this.isParent()&&(t.children=_.chain(this.childs).filter(function(e){return!e.isHidden()}).invoke("toJSON").value()),t}),domain.TablesNode.addVar("CONSTANT_TABLE_ID","constant_fields_level"),domain.TablesNode.addVar("CROSSTABLES_FIELDS_TABLE_ID","crossTablesFieldsLevel"),domain.TablesNode.addVar("INVALID_NODE_CLASS","invalid"),domain.TablesNode.addVar("DATA_ISLAND_CLASS","dataIsland"),domain.TablesNode.addVar("DERIVED_TABLE_CLASS","table derived"),domain.TablesNode.addVar("CONSTANT_TABLE_CLASS","table constant"),domain.TablesNode.addVar("CALCULATED_FIELD_CLASS","field calculated"),domain.TablesNode.addMethod("refreshStyle",function(e){(e||(e=this._getElement()))&&(domain.ItemNode.prototype.refreshStyle.call(this,e),this.param.extra&&"true"===this.param.extra.isInvalid?e.addClassName(this.INVALID_NODE_CLASS):e.removeClassName(this.INVALID_NODE_CLASS),this.param.extra&&this.param.extra.expression&&e.addClassName(this.CALCULATED_FIELD_CLASS),this.param.extra&&this.param.extra.query&&e.addClassName(this.DERIVED_TABLE_CLASS),this.param.id===this.CONSTANT_TABLE_ID&&e.addClassName(this.CONSTANT_TABLE_CLASS),this.param.extra&&this.param.extra.isIsland&&e.addClassName(this.DATA_ISLAND_CLASS))}),domain.TablesNode.addMethod("edit",function(e){e&&"dblclick"!==e.type||domain.ItemNode.prototype.edit.call(this,e)}),domain.TablesCustomNode=function(e){domain.TablesNode.call(this,e),this.nodeHeaderTemplateDomId=e.param.type===this.Types.Folder.name?"list_responsive_collapsible_type_tables:tables":"list_responsive_collapsible_type_tables:fields"},domain.TablesCustomNode.prototype=deepClone(domain.TablesNode.prototype),domain.TablesCopyMoveController=function(){domain.NodeCopyMoveController(this)},domain.TablesCopyMoveController.prototype=deepClone(domain.NodeCopyMoveController.prototype),domain.TablesCopyMoveController.addMethod("_buildMetanode",function(e){var t={id:e.param.id,label:e.name,type:e.param.type,uri:e.param.uri};return e.param.extra&&(t.extra={originalId:e.param.extra.originalId,table:e.param.extra.table,itemId:e.param.extra.itemId,datasourceId:e.param.extra.datasourceId,repoId:e.param.extra.repoId,dataSource:e.param.extra.dataSource,dataSetType:e.param.extra.dataSetType,query:e.param.extra.query},e.param.extra.expression&&(t.extra.expression=e.param.extra.expression),e.param.extra.fieldDbName&&(t.extra.fieldDbName=e.param.extra.fieldDbName),e.isParent()||(t.extra.JavaType=e.param.extra.JavaType,t.extra.JdbcType=e.param.extra.JdbcType,t.extra.sourceItem=e.parent.param.extra.originalId)),t}),domain.TablesCopyMoveController.addMethod("_handleDuplicatedNode",function(e,t){if(e.isParent()){for(var i=1,n=e.param.extra.datasourceId+"."+e.param.extra.itemId+i,o=dynamicTree.trees[t.getTreeId()];o.findNodeChildByMetaName(t,n);)i++,n=e.param.extra.datasourceId+"."+e.param.extra.itemId+i;return e.param.id=n,e.param.extra.itemId+=i,e.name=e.param.extra.itemId,e.param.extra.originalId=e.param.extra.itemId,t.addChild(e),e.isloaded=!0,e.hasChilds()&&e.childs.each(function(t){this._handleDuplicatedNode(t,e)}.bind(this)),n}e.param.id=e.parent.param.id+"."+e.param.extra.itemId,e.param.extra.originalId=e.parent.param.extra.originalId+"."+e.param.extra.itemId}),domain.DerivedTablesNode=function(e){domain.TablesNode.call(this,e),e.param.type===this.Types.Folder.name&&e.param.extra&&e.param.extra.query&&(this.isSelectable=!0)},domain.DerivedTablesNode.prototype=deepClone(domain.TablesNode.prototype),domain.JoinsList=function(e,t){dynamicList.List.call(this,e,t)},domain.JoinsList.prototype=deepClone(dynamicList.List.prototype),domain.JoinsList.addMethod("_changeHandler",function(e){var t=this.getItemByEvent(e);t&&(t._respondOnItemEvents&&!e.isInvoked&&this.fire("item:change",{targetEvent:e,item:t}),e.isInvoked=!0)}),domain.JoinsList.addMethod("_initEvents",function(){dynamicList.List.prototype._initEvents.call(this);var e=this._getElement();jQuery(e).off("change").on("change","select",_.bind(this._changeHandler,this))}),domain.JoinsListItem=function(e){dynamicList.ListItem.call(this,e),this._hidden=!1},domain.JoinsListItem.prototype=deepClone(dynamicList.ListItem.prototype),domain.JoinsListItem.addMethod("hide",function(e){this._hidden=!!e,this.refreshStyle()}),domain.JoinsListItem.addMethod("refreshStyle",function(){dynamicList.ListItem.prototype.refreshStyle.call(this),this._getElement()&&(this._hidden?this._getElement().addClassName(layoutModule.HIDDEN_CLASS):this._getElement().removeClassName(layoutModule.HIDDEN_CLASS))}),domain.JoinsListItem.addMethod("processTemplate",function(e){var t=e.childElements()[0];t.cleanWhitespace();var i=t.childElements()[1],n=t.childElements()[2],o=t.childElements()[3],s=o.childElements()[0],r=s.childElements();return i.update(this._value.left.table.label+":"+this._value.left.label),n.update(this._value.right.table.label+":"+this._value.right.label),r.each(function(e){e.selected=e.value===this._value.type}.bind(this)),e}),domain.JoinsListItem.addMethod("setJoinType",function(e){this.getValue().type=e;var t=this._getElement();if(t){var i=t.childElements()[0].childElements()[3].childElements()[0];$(i).value=e}}),domain.JoinsListItem.addMethod("toJSON",function(){return{left:this._value.left.id,right:this._value.right.id,type:this._value.type}}),domain.DisplayNode=function(e){domain.ItemNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("ItemGroupType"),Leaf:new dynamicTree.TreeNode.Type("ItemType")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_type_sets:sets"},domain.DisplayNode.prototype=deepClone(domain.ItemNode.prototype),domain.DisplayNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type};return e&&(t.itemId=e.itemId,t.descr=e.descr,t.labelId=e.labelId||"",t.descrId=e.descrId||"",t.resourceId=e.resourceId||""),this.isParent()?t.children=_.chain(this.childs).filter(function(e){return!e.isHidden()&&!e._markAsDeleted}).invoke("toJSON").value():(t.dataType=e.dataType,t.dimensionOrMeasure=e.dimensionOrMeasure,t.defaultMask=e.defaultMask,t.defaultAgg=e.defaultAgg),t}),domain.DisplayNode.addVar("INVALID_NODE_CLASS","invalid"),domain.DisplayNode.addMethod("refreshStyle",function(e){(e||(e=this._getElement()))&&(domain.ItemNode.prototype.refreshStyle.call(this,e),this.param.extra&&"true"===this.param.extra.isInvalid?e.addClassName(this.INVALID_NODE_CLASS):e.removeClassName(this.INVALID_NODE_CLASS))}),domain.genericTreeParams={rootUri:"/",showRoot:!1,nodeClass:domain.ItemNode,treeClassName:"",multiSelectEnabled:!0},domain.createItemsTree=function(e){return e=Object.extend(deepClone(domain.genericTreeParams),e),new dynamicTree.TreeSupport(e.treeId,e)},domain.confirmDialog={MODE_OK_CANCEL:"okCancel",MODE_YES_NO:"yesNo",_CONFIRM_DIALOG_DOM_ID:"standardConfirm",_CONFIRM_DIALOG_BODY_DOM_PATTERN:"#standardConfirm > .content > .body",_CONFIRM_DIALOG_OK_BUTTON_ID:"#confirmYes",_CONFIRM_DIALOG_CANCEL_BUTTON_ID:"#confirmNo",_CONFIRM_DIALOG_OK_PATTERN:"#confirmYes > span",_CONFIRM_DIALOG_CANCEL_PATTERN:"#confirmNo > span",_yesMessageHolder:null,_noMessageHolder:null,_dialog:null,_onOk:null,_onCancel:null,_customEventHandler:null,_templateDomId:null,_visible:!1,init:function(){domain.confirmDialog._init.bind(domain.confirmDialog)()},show:function(e,t,i,n,o){domain.confirmDialog._show.bind(domain.confirmDialog,e,t,i,n,o)()},hideForDetails:function(){dialogs.popup.hide(domain.confirmDialog._dialog)},showFromDetails:function(){dialogs.popup.show(domain.confirmDialog._dialog,!0)},visible:function(){return domain.confirmDialog._visible},_init:function(){this._dialog=$(this._CONFIRM_DIALOG_DOM_ID),this._yesMessageHolder=$$(this._CONFIRM_DIALOG_OK_PATTERN).first(),this._noMessageHolder=$$(this._CONFIRM_DIALOG_CANCEL_PATTERN).first(),domain.registerClickHandlers([this._clickEventHandler.bind(this)])},_show:function(e,t,i,n,o){this._onOk=t,this._onCancel=i,this._customEventHandler=n,this._templateDomId=e,o&&o==this.MODE_YES_NO?(this._yesMessageHolder.update(domain.getMessage("yes")),this._noMessageHolder.update(domain.getMessage("no"))):(this._yesMessageHolder.update(domain.getMessage("ok")),this._noMessageHolder.update(domain.getMessage("cancel"))),$(this._templateDomId).removeClassName(layoutModule.HIDDEN_CLASS),dialogs.popup.show(this._dialog,!0),this._visible=!0},_hide:function(e){$(this._templateDomId).addClassName(layoutModule.HIDDEN_CLASS),dialogs.popup.hide(this._dialog),this._visible=!1,e&&e()},_clickEventHandler:function(e){return domain.elementClicked(e,this._CONFIRM_DIALOG_OK_BUTTON_ID)?(this._hide(this._onOk),!0):domain.elementClicked(e,this._CONFIRM_DIALOG_CANCEL_BUTTON_ID)?(this._hide(this._onCancel),!0):this._customEventHandler?this._customEventHandler(e):void 0}},domain.detailsDialog={_DETAIL_DIALOG_DOM_ID:"detail",_DETAIL_DIALOG_CLOSE_BUTTON_ID:"#close",_DETAIL_DIALOG_LIST_DOM_ID:"detailsList",_DETAIL_DIALOG_TEXT_DOM_ID:"detailsText",_LIST_TEMPLATE:"defaultListTemplate",_LIST_ITEM_TEMPLATE:"dynamicListItemTemplate",_dialog:null,_showConfirmAfterClose:!1,_list:null,_listItems:null,init:function(){domain.detailsDialog._init.bind(domain.detailsDialog)()},show:function(e){domain.detailsDialog._show.bind(domain.detailsDialog,e)()},_init:function(){this._dialog=$(this._DETAIL_DIALOG_DOM_ID),domain.registerClickHandlers([this._clickEventHandler.bind(this)])},_show:function(e){domain.confirmDialog.visible()?(domain.confirmDialog.hideForDetails(),this._showConfirmAfterClose=!0):this._showConfirmAfterClose=!1,this._createMessage(e),dialogs.popup.show(this._dialog,!0),$(this._DETAIL_DIALOG_LIST_DOM_ID).parentNode.scrollTop=0},_createMessage:function(e){"string"==typeof e?($(this._DETAIL_DIALOG_LIST_DOM_ID).addClassName(layoutModule.HIDDEN_CLASS),$(this._DETAIL_DIALOG_TEXT_DOM_ID).removeClassName(layoutModule.HIDDEN_CLASS).update(e)):($(this._DETAIL_DIALOG_TEXT_DOM_ID).addClassName(layoutModule.HIDDEN_CLASS),$(this._DETAIL_DIALOG_LIST_DOM_ID).removeClassName(layoutModule.HIDDEN_CLASS),this._items&&(this._list.removeItems(this._items),this._items=null,this._list=null),this._items=e.collect(function(e){return new dynamicList.ListItem({label:e})}),this._list=new dynamicList.List(this._DETAIL_DIALOG_LIST_DOM_ID,{listTemplateDomId:this._LIST_TEMPLATE,itemTemplateDomId:this._LIST_ITEM_TEMPLATE,items:this._items}),this._list.show())},_close:function(){dialogs.popup.hide(this._dialog),this._showConfirmAfterClose&&domain.confirmDialog.showFromDetails()},_clickEventHandler:function(e){return domain.elementClicked(e,this._DETAIL_DIALOG_CLOSE_BUTTON_ID)?(this._close(),!0):void 0}},define("domain.components",["domain.base","dynamicTree.utils","components.list"],function(e){return function(){var t;return t||e.domain}}(this)),domain.chooser.fields={SOURCE_FIELDS_DOM_ID:"sourceFieldsTree",DESTINATION_FIELDS_DOM_ID:"destinationFieldsTree",SOURCE_TABLES_COLUMN_DOM_ID:"sourceTablesColumn",DESTINATION_TABLES_COLUMN_DOM_ID:"destTablesColumn",SOURCE_FIELDS_TREE_PROVIDER:"semantic-layer-tree-data-provider",DESTINATION_FIELDS_TREE_PROVIDER:"semantic-layer-query-tree-data-provider",TREE_TEMPLATE_DOM_ID:"list_responsive_collapsible_fields",NODE_CLASS:domain.ItemNode,MOVE_BUTTONS_PATTERN_PREFIX:"#moveButtons > .",FLOW_NAVIGATION_BUTTONS:["filtersTab","displayTab","saveTopicTab","goToDesigner"],DRAG_PATTERN:".draggable",CONSTANT_TABLE_ID:"constant_fields_level",DOM_IDS_TO_SAVE_TREE_SELECTION:["#sourceTablesColumn","#destTablesColumn","#left","#right","#toLeft","#toRight"],TAB_CLASS_NAME:"tab",dataIslandParser:new RegExp("(^[^\\.]+)"),sourceFieldsTree:null,destinationFieldsTree:null,nodeCopyMoveController:new domain.FieldsCopyMoveController,DATA_CHOOSER_MODE:"dataChooserMode",RE_ENTRANCE_MODE:"reEntranceMode",mode:this.DATA_CHOOSER_MODE,reEntranceDialogCSSSelector:"#selectFields",fillForm:function(){var e=domain.chooser.fields.destinationFieldsTree.getRootNode().childs.first()?Object.toJSON(domain.chooser.fields.destinationFieldsTree.getRootNode().childs.findAll(function(e){return!e.isHidden()
})):"";$("selectedModel").writeAttribute("value",e),$("unsavedChangesPresent").writeAttribute("value",domain.chooser.isUnsavedChangesPresent().toString())},init:function(e){this.initTrees(),this.mode==this.RE_ENTRANCE_MODE?domain.registerClickHandlers([this.moveButtonsClickEventHandler.bind(this)],this.reEntranceDialogCSSSelector):domain.registerClickHandlers([this.moveButtonsClickEventHandler.bind(this)]),domain.detailsDialog.init(),domain.resetTreeSelectionHandler.init(this.DOM_IDS_TO_SAVE_TREE_SELECTION,function(){return[this.sourceFieldsTree,this.destinationFieldsTree]}.bind(this),this.updateButtonsState.bind(this)),this.updateButtonsState(),this.mode==this.DATA_CHOOSER_MODE&&this.processInvalidFields(e.invalidFields),this.sourceFieldsTree.showTree(100,this.sourceTreeUpdateCallback.bind(this),domain.treeErrorHandler,!1),this.destinationFieldsTree.showTree(100,this.destTreeUpdateCallback.bind(this),domain.treeErrorHandler,!1),disableSelectionWithoutCursorStyle($(document.body))},processInvalidFields:function(e){var t=e.deletedFields?"<p>"+e.deletedFields.join("</p><p>")+"</p>":null,i=e.movedFields?"<p>"+e.movedFields.join("</p><p>")+"</p>":null,n="";t&&(n+=domain.getMessage("error.itemsDeleted",{fields:t})),i&&(n+=domain.getMessage("error.movedFields",{fields:i})),n&&domain.detailsDialog.show(n)},sourceTreeUpdateCallback:function(){this.updateButtonsState()},destTreeUpdateCallback:function(){this.updateButtonsState(),this.disableNodesInAdhocReEntrance()},disableNodesInAdhocReEntrance:function(){},initTrees:function(){if(this.sourceFieldsTree=domain.createItemsTree({handleNodeOnDblclick:!1,treeId:this.SOURCE_FIELDS_DOM_ID,providerId:this.SOURCE_FIELDS_TREE_PROVIDER,templateDomId:this.TREE_TEMPLATE_DOM_ID,nodeClass:this.NODE_CLASS,dragPattern:this.DRAG_PATTERN,selectOnMousedown:!isIPad()}),this.destinationFieldsTree=domain.createItemsTree({handleNodeOnDblclick:!1,treeId:this.DESTINATION_FIELDS_DOM_ID,providerId:this.DESTINATION_FIELDS_TREE_PROVIDER,templateDomId:this.TREE_TEMPLATE_DOM_ID,nodeClass:this.NODE_CLASS,dragPattern:this.DRAG_PATTERN,selectOnMousedown:!isIPad()}),isIPad()){var e=$(this.SOURCE_FIELDS_DOM_ID);new TouchController(e,e.up(1));var t=$(this.DESTINATION_FIELDS_DOM_ID);new TouchController(t,t.up(1))}$H(this.treeEventFactory).each(function(e){[this.sourceFieldsTree,this.destinationFieldsTree].invoke("observe",e.key,e.value.bind(this))}.bind(this)),this.initDragAndDrop()},validateDataIslands:function(e,t){var i=dynamicTree.trees[t.first().getTreeId()];if(i!==this.sourceFieldsTree)return!0;var n=t.collect(function(e){return this.getNodeDataIsland(e)}.bind(this)).uniq(),o=this.getTreeDataIslands(e),s=n.without(this.CONSTANT_TABLE_ID).length>1;return!s&&this.isSameDataIslandsOnBothTrees(n,o)},moveNodes:function(e,t,i){if(e&&e.first()){domain.chooser.setUnsavedChangesPresent(!0);var n=dynamicTree.trees[t.getTreeId()];if(ValidationModule.hideError($(this.DESTINATION_FIELDS_DOM_ID)),!this.validateDataIslands(n,e))return void ValidationModule.showError($(this.DESTINATION_FIELDS_DOM_ID),domain.getMessage("error.fromDifferentIslands"));var o=this.nodeCopyMoveController.move(e,t);if(!i){var s=n.selectedNodes.collect(function(e){return e});n.resetSelected(),s.each(function(e){e.refreshStyle()}),o.each(function(e){n.openAndSelectNode(e.param.uri)}),o.each(function(e){e.select()})}this.updateButtonsState(),this.mode==this.DATA_CHOOSER_MODE&&sessionManager.resetSession(domain.chooser.flowExecutionKey)}},nodeDblClick:function(e){if(e){var t=dynamicTree.trees[e.getTreeId()],i=t===this.sourceFieldsTree?this.destinationFieldsTree:this.sourceFieldsTree;t&&i&&this.moveNodes(t.selectedNodes,i.getRootNode())}},initDragAndDrop:function(){var e=[this.SOURCE_FIELDS_DOM_ID,this.DESTINATION_FIELDS_DOM_ID,this.SOURCE_TABLES_COLUMN_DOM_ID,this.DESTINATION_TABLES_COLUMN_DOM_ID],t=new Hash;t.set(this.SOURCE_FIELDS_DOM_ID,[this.DESTINATION_FIELDS_DOM_ID,this.DESTINATION_TABLES_COLUMN_DOM_ID]),t.set(this.SOURCE_TABLES_COLUMN_DOM_ID,[this.DESTINATION_FIELDS_DOM_ID,this.DESTINATION_TABLES_COLUMN_DOM_ID]),t.set(this.DESTINATION_FIELDS_DOM_ID,[this.SOURCE_FIELDS_DOM_ID,this.SOURCE_TABLES_COLUMN_DOM_ID]),t.set(this.DESTINATION_TABLES_COLUMN_DOM_ID,[this.SOURCE_FIELDS_DOM_ID,this.SOURCE_TABLES_COLUMN_DOM_ID]);var i=function(e,t){var i=e.node;if(i){var n=dynamicTree.trees[i.getTreeId()],o=matchAny(t,["#"+this.SOURCE_TABLES_COLUMN_DOM_ID],!0)?this.sourceFieldsTree:this.destinationFieldsTree;n!==o&&this.moveNodes(n.selectedNodes,o.getRootNode())}};e.each(function(e){Droppables.remove(e),Droppables.add(e,{accept:t.get(e),onDrop:i.bind(this)})}.bind(this))},getTreeDataIslands:function(e){var t=e.getRootNode();return t?t.childs.collect(function(e){if(!e.isHidden()){var t=this.dataIslandParser.exec(e.param.extra.resourceId);if(t)return t[0]}}.bind(this)).compact().uniq():[]},getNodeDataIsland:function(e){if("/"!==e.parent.param.uri)return this.getNodeDataIsland(e.parent);var t=this.dataIslandParser.exec(e.param.extra.resourceId);return t?t[0]:void 0},isSameDataIslandsOnBothTrees:function(e,t){return e=e.without(this.CONSTANT_TABLE_ID),t=t.without(this.CONSTANT_TABLE_ID),e.length<=1&&t.concat(e).uniq().length<=1},updateButtonsState:function(){var e=this.destinationFieldsTree,t=this.sourceFieldsTree,i=e.getRootNode()&&e.getRootNode().hasVisibleChilds(),n=t.getRootNode()&&t.getRootNode().hasVisibleChilds(),o=i&&e.selectedNodes.length>0,s=n&&t.selectedNodes.length>0,r=e.getRootNode()&&e.getRootNode().hasEnabledChilds(),a={destTreeHasSelectedNodes:o,sourceTreeHasSelectedNodes:s,destTreeHasVisibleNodes:i,sourceTreeHasVisibleNodes:n,destTreeHasEnabledNodes:r,sourceTreeDataIslands:this.getTreeDataIslands(t),destTreeDataIslands:this.getTreeDataIslands(e)};this.updateMoveButtonsState(a),this.updateFlowButtonsState(a),this.updateTreeItems(a),this.updateReEntrantControls(a)},updateReEntrantControls:function(){},updateMoveButtonsState:function(e){this.moveButtonsUpdateStatusEventFactory.each(function(t){var i=$$(this.MOVE_BUTTONS_PATTERN_PREFIX+t.key)[0],n=t.value.bind(this)(e);domain.enableButton(i,n)}.bind(this))},updateFlowButtonsState:function(e){this.FLOW_NAVIGATION_BUTTONS.each(function(t){var i=$(t);if(i){domain.enableButton(i,e.destTreeHasVisibleNodes);var n=i.up();n.hasClassName(this.TAB_CLASS_NAME)&&domain.enableButton(n,e.destTreeHasVisibleNodes)}},this)},disableNode:function(e,t){t?e.disable():e.enable(),e.isParent()&&e.childs.each(function(e){this.disableNode(e,t)}.bind(this))},updateTreeItems:function(e){var t=this.sourceFieldsTree;if(t&&t.getRootNode()){var i=e.destTreeDataIslands.concat([this.CONSTANT_TABLE_ID]).uniq();t.getRootNode().childs.each(function(e,t){var i=1===e.length||e.include(this.getNodeDataIsland(t));this.disableNode(t,!i)}.bind(this,i))}},moveButtonsClickEventHandler:function(e){var t=!1;return this.moveButtonsClickEventMap.each(function(i){if(domain.elementClicked(e,i.key)){var n=dynamicTree.trees[i.value.sourceTree],o=dynamicTree.trees[i.value.destTree],s=n.selectedNodes;throw i.value.moveAll&&(s=n.getRootNode().childs.findAll(function(e){return!e.isHidden()})),this.moveNodes(s,o.getRootNode(),i.value.moveAll),t=!0,$break}}.bind(this)),t}};var dc_fields=domain.chooser.fields;dc_fields.moveButtonsClickEventMap=$H({"#left":{sourceTree:dc_fields.DESTINATION_FIELDS_DOM_ID,destTree:dc_fields.SOURCE_FIELDS_DOM_ID},"#right":{sourceTree:dc_fields.SOURCE_FIELDS_DOM_ID,destTree:dc_fields.DESTINATION_FIELDS_DOM_ID},"#toLeft":{moveAll:!0,sourceTree:dc_fields.DESTINATION_FIELDS_DOM_ID,destTree:dc_fields.SOURCE_FIELDS_DOM_ID},"#toRight":{moveAll:!0,sourceTree:dc_fields.SOURCE_FIELDS_DOM_ID,destTree:dc_fields.DESTINATION_FIELDS_DOM_ID}}),dc_fields.treeEventFactory={"leaf:dblclick":function(e){var t=e.memo.node;dc_fields.nodeDblClick(t),Event.stop(e)},"leaf:mouseup":function(e){dc_fields.updateButtonsState(),Event.stop(e)},"node:dblclick":function(e){var t=e.memo.node;dc_fields.nodeDblClick(t),Event.stop(e)},"node:mouseup":function(e){dc_fields.updateButtonsState(),Event.stop(e)}},dc_fields.moveButtonsUpdateStatusEventFactory=$H({left:function(e){return e.destTreeHasSelectedNodes},right:function(e){return e.sourceTreeHasSelectedNodes&&this.validateDataIslands(this.destinationFieldsTree,this.sourceFieldsTree.selectedNodes)},toLeft:function(e){return e.destTreeHasVisibleNodes&&e.destTreeHasEnabledNodes},toRight:function(e){return e.sourceTreeHasVisibleNodes&&this.isSameDataIslandsOnBothTrees(e.sourceTreeDataIslands,e.destTreeDataIslands)}}),"undefined"==typeof require&&document.observe("dom:loaded",dc.initialize.bind(dc)),define("domain.chooser.fields",["domain.chooser","domain.components"],function(e){return function(){var t;return t||e.domain}}(this));var customTooltip={};customTooltip.TOOLTIP_ID="custTooltip",define("components.customTooltip",function(e){return function(){var t;return t||e.customTooltip}}(this)),dialogs.dependentResources={dependenciesPanel:null,show:function(e,t,i){this.dependenciesPanel=jQuery("#dependencies"),this._$title=this.dependenciesPanel.find(".content .header .title"),i.dialogTitle&&(this._titleBackup=this._$title.html(),this._$title.html(i.dialogTitle)),dialogs.popup.show(this.dependenciesPanel[0]),this._changeMessage(i),this._switchButtons(i);var n=this._initList(e);this.dependenciesPanel.on("click",function(e){var i=jQuery(e.target).closest("button").attr("id"),o=t&&t[i];_.include(["dependenciesBtnSave","dependenciesBtnSaveAs","dependenciesBtnOk","dependenciesBtnCancel"],i)&&(dialogs.dependentResources.hide(),n.setItems([]),e.stopPropagation(),o&&o())})},hide:function(){this.dependenciesPanel&&(this.dependenciesPanel.off("click"),dialogs.popup.hide(this.dependenciesPanel[0]),this.dependenciesPanel=null),this._titleBackup&&this._$title&&(this._$title.html(this._titleBackup),this._titleBackup=null)},_changeMessage:function(e){jQuery("#topMessage").html(e.topMessage),jQuery("#bottomMessage").html(e.bottomMessage)},_initList:function(e){var t=new dynamicList.List("dependenciesList",{listTemplateDomId:"tabular_oneColumn",itemTemplateDomId:"tabular_oneColumn:leaf"}),i=[];return e&&(i=e.collect(function(e){var t=new dynamicList.ListItem({cssClassName:layoutModule.LEAF_CLASS,value:e});return t.processTemplate=function(e){var t,i=e.select(".uri")[0];return t="string"==typeof this.getValue()?this.getValue():this.getValue().uristring?this.getValue().uristring:this.getValue().URIString,i.update(t.escapeHTML()),e},t})),t.setItems(i),t.show(),t},_switchButtons:function(e){var t,i={save:jQuery("#dependenciesBtnSave"),saveAs:jQuery("#dependenciesBtnSaveAs"),ok:jQuery("#dependenciesBtnOk"),cancel:jQuery("#dependenciesBtnCancel")};t=e.buttons?e.buttons:e.okOnly?["ok"]:e.canSave?["save","saveAs","cancel"]:["ok","cancel"],_.each(i,function(e,i){t.indexOf(i)<0?e.addClass("hidden"):e.removeClass("hidden")})}},define("components.dependent.dialog",["prototype","components.dialogs","jquery","components.list"],function(e){return function(){var t;return t||e.dialogs.dependentResources}}(this));var picker={};picker.FileSelector=function(e){this._disabled=void 0!==e.disabled?e.disabled:!1,this._uriTextbox=$(e.uriTextboxId),this._browseButtonId=$(e.browseButtonId),this._onChange=e.onChange||!1,this._options=e,this._disabled?(buttonManager.disable(this._uriTextbox),buttonManager.disable(this._browseButtonId)):(this._id=e.id,this._suffix=e.suffix?e.suffix:(new Date).getTime(),this._treeDomId=e.treeId,this._selectLeavesOnly=void 0!==e.selectLeavesOnly?e.selectLeavesOnly:!1,this._selectedUri=$F(this._uriTextbox),this._process(e),this._assignHandlers(),this._refreshButtonsState())},picker.FileSelector.addVar("DEFAULT_TEMPLATE_DOM_ID","selectFromRepository"),picker.FileSelector.addVar("DEFAULT_TREE_ID","selectFromRepoTree"),picker.FileSelector.addVar("OK_BUTTON_ID","selectFromRepoBtnSelect"),picker.FileSelector.addVar("CANCEL_BUTTON_ID","selectFromRepoBtnCancel"),picker.FileSelector.addVar("TITLE_PATTERN","div.title"),picker.FileSelector.addMethod("_process",function(e){!this._id&&(this._id=this.DEFAULT_TEMPLATE_DOM_ID),!$(this._id)&&this._options.template&&this._options.i18n?(this._dom=jQuery(_.template(this._options.template,{i18n:this._options.i18n})),this._dom=this._dom[0]):this._dom=$(this._id).cloneNode(!0),this._dom.writeAttribute("id",this._id+this._suffix),this._okButton=this._dom.select("#"+this.OK_BUTTON_ID)[0],this._okButton.writeAttribute("id",this.OK_BUTTON_ID+this._suffix),this._cancelButton=this._dom.select("#"+this.CANCEL_BUTTON_ID)[0],this._cancelButton.writeAttribute("id",this.CANCEL_BUTTON_ID+this._suffix),!this._treeDomId&&(this._treeDomId=this.DEFAULT_TREE_ID),this._treeDom=this._dom.select("#"+this._treeDomId)[0],this._treeDom.writeAttribute("id",this._treeDomId+this._suffix),this._visible=!1,e.title&&this._dom.select(this.TITLE_PATTERN)[0].update(e.title),this._onOk=e.onOk,this._onCancel=e.onCancel,jQuery(document.body).append(this._dom);var t,i=this._dom.down(layoutModule.SWIPE_SCROLL_PATTERN);i&&(t=layoutModule.createScroller(i));var n=Object.extend({providerId:e.providerId,scroll:t},e.treeOptions);this._tree=dynamicTree.createRepositoryTree(this._treeDomId+this._suffix,n),this._selectedUri&&this._selectedUri.length>0?this._tree.showTreePrefetchNodes(this._selectedUri):this._tree.showTree(1)}),picker.FileSelector.addMethod("_assignHandlers",function(){this._dom.observe("click",this._dialogClickHandler.bindAsEventListener(this)),["node:dblclick","leaf:dblclick"].each(function(e){this._tree.observe(e,this._treeClickHandler.bindAsEventListener(this))},this),["node:click","leaf:click","node:selected","leaf:selected"].each(function(e){this._tree.observe(e,this._refreshButtonsState.bindAsEventListener(this))},this),["childredPrefetched:loaded","tree:loaded"].each(function(e){this._tree.observe(e,this._treeLoadHandler.bindAsEventListener(this))},this),this._browseButtonId.observe("click",this._browseClickHandler.bindAsEventListener(this))}),picker.FileSelector.addMethod("_canClickOk",function(){return this._tree.getSelectedNode()&&(this._selectLeavesOnly?this._tree.getSelectedNode().param.type!==this._tree.getSelectedNode().FOLDER_TYPE_NAME:!0)}),picker.FileSelector.addMethod("_dialogClickHandler",function(e){var t=e.element();if(matchAny(t,["#"+this.OK_BUTTON_ID+this._suffix],!0)){e.stop();var i=this._tree.getSelectedNode().param.uri;this._uriTextbox.setValue(i),this._onChange&&this._onChange(i),this._hide(),this._onOk&&this._onOk()}else matchAny(t,["#"+this.CANCEL_BUTTON_ID+this._suffix],!0)&&(e.stop(),this._hide(),this._onCancel&&this._onCancel())}),picker.FileSelector.addMethod("_treeClickHandler",function(){if(this._canClickOk()){var e=this._tree.getSelectedNode().param.uri;this._uriTextbox.setValue(e),this._onChange&&this._onChange(e),this._hide(),this._onOk&&this._onOk()}}),picker.FileSelector.addMethod("_treeLoadHandler",function(){this._visible&&this._selectedUri&&this._tree.openAndSelectNode(this._selectedUri)}),picker.FileSelector.addMethod("_browseClickHandler",function(e){e.stop(),this._show()}),picker.FileSelector.addMethod("_refreshButtonsState",function(){this._canClickOk()?buttonManager.enable(this._okButton):buttonManager.disable(this._okButton)}),picker.FileSelector.addMethod("_hide",function(){dialogs.popup.hide(this._dom),this._visible=!1}),picker.FileSelector.addMethod("_show",function(){this._selectedUri=$F(this._uriTextbox),this._selectedUri&&this._selectedUri.length>0?this._tree.showTreePrefetchNodes(this._selectedUri):this._tree.showTree(1),dialogs.popup.show(this._dom,!0),this._visible=!0,this._selectedUri&&this._tree.openAndSelectNode(this._selectedUri),this._refreshButtonsState()}),picker.FileSelector.addMethod("remove",function(){jQuery(this._dom).remove()}),define("components.pickers",["utils.common","components.dialogs","core.layout","core.events.bis","prototype","jquery","dynamicTree.utils"],function(e){return function(){var t;return t||e.picker}}(this)),DragListener.DRAGGING_STARTED="draggingStarted",DragListener.DRAGGING_FINISHED="draggingFinished",DragListener.DRAGGING="dragging",DragListener.prototype.registerAgent=function(e){this.agents[e]=new Array},DragListener.prototype.publishEvent=function(e,t,i){this.agents[e][t]=i},DragListener.prototype.notify=function(e,t){var i=this.agents[this.currentAgentName];if(i){var n=i[e];if(n){var o=this.dragger?this.dragger.draggingObjs:null;n(t,o)}}},DragListener.prototype.isDragging=function(){return null!=this.currentAgentName},DragListener.prototype.setCurrentAgentName=function(e){this.currentAgentName=e},DragListener.prototype.getCurrentAgentName=function(){return this.currentAgentName};var invokeDragging=function(e){return function(t){e.dragging(t)}},invokeDraggingFinished=function(e){return function(t){e.draggingFinished(t)}};Dragger.prototype.addAnotherDraggingObject=function(e,t){var e=e?e:event;this.draggingObjs[this.draggingObjs.length]=t,this.originalX[this.originalX.length]=parseInt(t.style.left),this.originalY[this.originalY.length]=parseInt(t.style.top),this.initDragger(e)},Dragger.prototype.initDragger=function(e){this.isDragging=!1,this.mouseX=e.clientX,this.mouseY=e.clientY,document.onmousemove=invokeDragging(this),document.onmouseup=invokeDraggingFinished(this)},Dragger.prototype.dragging=function(e){var t=e?e:event,n=!1,o=0,s=0;if(this.dragsX){var o=t.clientX-this.mouseX;n=Math.abs(o)>this.sigMove}if(this.dragsY){var s=t.clientY-this.mouseY;n=n||Math.abs(s)>this.sigMove}if(!this.isDragging&&n)for(this.isDragging=!0,this.dragListener&&this.dragListener.notify(DragListener.DRAGGING_STARTED,e),i=0;i<this.draggingObjs.length;i++)this.draggingObjs[i].style.display="block";if(this.isDragging){if(o){for(i=0;i<this.draggingObjs.length;i++){parseInt(this.originalX[i]+o)}if(o)for(i=0;i<this.draggingObjs.length;i++)this.draggingObjs[i].style.left=parseInt(this.originalX[i]+o)+"px"}if(s){for(i=0;i<this.draggingObjs.length;i++){parseInt(this.originalY[i]+s)}if(s)for(i=0;i<this.draggingObjs.length;i++)this.draggingObjs[i].style.top=parseInt(this.originalY[i]+s)+"px"}(o||s)&&this.dragListener.notify(DragListener.DRAGGING,e)}},Dragger.prototype.draggingFinished=function(e){document.onmousemove="default",document.onmouseup="default",this.isDragging?(this.isDragging=!1,this.cleanUpUtil&&this.cleanUpUtil(),this.dragListener&&(this.dragListener.notify(DragListener.DRAGGING_FINISHED,e),this.dragListener.setCurrentAgentName(null))):this.dragListener&&this.dragListener.setCurrentAgentName(null)},Dragger.prototype.clearDraggingObjects=function(){for(var e=0;e<this.draggingObjs.length;e++){var t=this.draggingObjs[e];t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}},define("tools.drag",["jquery","prototype"],function(e){return function(){var t;return t||e.Dragger}}(this)),JRS.reportExecutionCounter=function(e,t){var i="reportExecutionCountMessage.html",n=function(t){e.ajax(i,{dataType:"text"}).done(function(e){t&&t(e)})},o=function(){n(function(e){if(e)if(document.getElementById("systemMessage"))t.systemConfirm.showWarning(e,5e3);else{for(var i=0,n=window.parent;3>i&&n&&n.document;){if(n.document.getElementById("systemMessage"))return void n.dialogs.systemConfirm.showWarning(e,5e3);n=n.parent,i++}alert(e)}})};return{check:o}}(jQuery,window.dialogs),define("report.execution.count",["namespace","jquery","components.dialogs"],function(e){return function(){var t;return t||e.JRS.reportExecutionCounter}}(this));var theBody,fieldsTable,savePanel,canRunAndSave,nullStateValue="_null",multiSelect=!1,saveOldLabel="",saveOldFolder="",flowExecutionKey,notificationButton,notification,saveAsTree,editor,windowPopUp,controllerMap={ta:"/adhoc/table.html",cr:"/adhoc/crosstab.html",ch:"/adhoc/chart.html",ich:"/adhoc/intelligentChart.html",da:"/dashboard/dashboard.html",st:"/adhoc/status.html",co:"/adhoc/table.html","":"/adhoc/table.html?"},clientKey,cancelQueryTimer;SelectedFormula.prototype.reset=function(){this.formulaId=null,this.constant=null,this.isEdited=!1,this.isSwapped=!1,this.isChanged=!1};var selectedFormula=new SelectedFormula,selectionCategory=new SelectionCategory,selObjects=[],timeoutValue=null,TIMEOUT_INTERVAL=null,delayBeforeSessionTimeoutWarning,MILL_PER_MIN=6e4,MIN_WARN_BEFORE_TIMEOUT=2,ADHOC_SESSION_TIMEOUT_MESSAGE=null,ADHOC_EXIT_MESSAGE=null,DASHBOARD_SESSION_TIMEOUT_MESSAGE=null,DASHBOARD_EXIT_MESSAGE=null,designerBase={AVAILABLE_FIELDS_AREA:"af",DASHBOARD_SPECIAL_CONTENT_TREE_AREA:"dsc",DASHBOARD_REPO_TREE_AREA:"drp",CROSSTAB_SELECT_AREA:"cr",TABLE_SELECT_AREA:"tb",CHART_SELECT_AREA:"ch",TITLE_SELECT_AREA:"co",CHART_LEGEND_AREA:"clg",REPORT_MENU_LEVEL:"reportLevel",FIELD_MENU_LEVEL:"fieldLevel",FIELDSET_MENU_LEVEL:"fieldSetLevel",COLUMN_LEVEL:"columnLevel",GROUP_LEVEL:"groupLevel",CHART_LEVEL:"chartLevel",SUMMARY_LEVEL:"summaryLevel",COLUMN_GROUP_MENU_LEVEL:"columnGroupLevel",ROW_GROUP_MENU_LEVEL:"rowGroupLevel",MEASURE_MENU_LEVEL:"measureLevel",LEGEND_MENU_LEVEL:"legendItemLevel",MEMBER_GROUP_MENU_LEVEL:"memberGroupCell",GRID_SELECTOR_MENU:".selector.mutton",DASHBOARD_SPECIAL_CONTENT_TREE_LEVEL:"dashboardSpecialContentTreeLeafLevel",DASHBOARD_REPO_TREE_LEVEL:"dashboardRepoTreeLeafLevel",DASHBOARD_CONTENT_FRAME_MENU_LEVEL:"dashboardContentFrameLevel",DASHBOARD_TEXT_FRAME_MENU_LEVEL:"dashboardTextFrameLevel",DASHBOARD_CLICKABLE_FRAME_MENU_LEVEL:"dashboardClickableFrameLevel",DASHBOARD_CONTROL_FRAME_MENU_LEVEL:"dashboardControlFrameLevel",SPACER_NAME:"_spacer",ARTIFICIAL_NAME:"_artificial",DEFAULT_THEME_ID:"default",TABLE:"table",CHART:"chart",ICHART:"ichart",OLAP_ICHART:"olap_ichart",CROSSTAB:"crosstab",OLAP_CROSSTAB:"olap_crosstab",DASHBOARD:"dashboard",DASHBOARD_RUNTIME:"dashboardRuntime",SAVE_AS_TREE_DOM_ID:"saveAsFoldersTree",UNDEFINED_STRING:"undefined",CLOBBER:"clobber",LABEL_MAX_LEN:94,DESC_MAX_LEN:249,DRAGGABLE_GHOST_HEIGHT:"20px",DRAGGABLE_GHOST_WIDTH:"150px",superInitAll:function(){theBody=document.body,localContext.initAll(),localContext.getMode()!==designerBase.DASHBOARD&&adhocDesigner&&adhocDesigner.initExplorerObjectListeners(),restoreDefaultCursor()},updateFlowKey:function(){var e=$("flowId");e&&(flowExecutionKey=e.getAttribute("value"))},setState:function(){var stateSnapshotScript=$("stateSnapshotScript");null!=stateSnapshotScript&&(window.eval(stateSnapshotScript.text),state=eval("("+stateSnapshot+")"),stateSnapshotScript.parentNode.removeChild(stateSnapshotScript))},getCanRunAndSave:function(){return canRunAndSave},getControllerPrefix:function(){return localContext.controller?localContext.controller:"co"},handleSave:function(){saveLabel?designerBase.save(saveFolder,saveLabel,saveDesc,!0):designerBase.launchSaveDialog()},handleSaveAs:function(){designerBase.launchSaveDialog()},handleSaveAndGenerate:function(){saveLabel?designerBase.checkSave(saveFolder,saveLabel,saveDesc,!1,{reportName:saveLabel+" "+defaultReportSuffix}).then(function(){designerBase.launchSaveDialog({forDataView:!1,forReport:!0,reportGenerators:localContext.state.reportGenerators})}):designerBase.launchSaveDialog({forDataView:!0,forReport:!0,reportGenerators:localContext.state.reportGenerators})},getSelectedObject:function(e){return e&&!isNaN(e)&&e<selObjects.length?selObjects[e]:selObjects[0]},getSelectedObjects:function(){return selObjects},getLastSelectedObject:function(){return selObjects[selObjects.length-1]},isSelectedNodeAFolder:function(){if(1!=selObjects.length)return!0;if(selectionCategory.area===designerBase.AVAILABLE_FIELDS_AREA){var e=this.getSelectedObject();return e?e.isParent():!1}return!1},unSelectAll:function(){selObjects.clear()},addToSelected:function(e){var t=this.isInSelection(e);t||selObjects.push(e)},shouldClearSelections:function(e,t){var i=isMetaHeld(e),n=isShiftHeld(e);return t=selectionCategory.area==t,!(t&&(i||n))},unSelectGiven:function(e){selObjects=selObjects.without(e)},isInSelection:function(e){for(var t=0;t<selObjects.length;t++)if(selectionCategory.area===this.COLUMN_LEVEL){if(e.header&&selObjects[t].header&&e.header.getAttribute("data-fieldName")==selObjects[t].header.getAttribute("data-fieldName"))return selObjects[t].index==e.index}else if(selectionCategory.area===this.GROUP_LEVEL){if(e.fieldName===selObjects[t].fieldName)return!0}else if(selectionCategory.area===this.ROW_GROUP_MENU_LEVEL||selectionCategory.area===this.COLUMN_GROUP_MENU_LEVEL||selectionCategory.area===this.LEGEND_MENU_LEVEL||selectionCategory.area===this.MEASURE_MENU_LEVEL){if(e.id===selObjects[t].id)return!0}else if(e==selObjects[t])return!0;return!1},isObjectInSelection:function(e,t){for(var i=0;i<selObjects.length;i++)if(t){if(e[t]==selObjects[i][t])return!0}else if(e==selObjects[i])return!0;return!1},clearOverlaySet:function(e){e&&(_.each(e,function(e){var t=$(e).identify();$(t)&&$(t).remove()}),e={})},deselectOverlaySet:function(e,t){_.each(e,function(e){$(e).removeClassName(t)})},enableSelection:function(){localContext.getMode()!==designerBase.DASHBOARD&&adhocDesigner&&adhocDesigner.initEnableBrowserSelection($("designer"))},disableSelection:function(){localContext.getMode()!==designerBase.DASHBOARD&&adhocDesigner&&adhocDesigner.initPreventBrowserSelection($("designer"))},getLastSavedReportFolder:function(){var e=null;return window.localStorage&&(e=window.localStorage.getItem("lastSavedReportFolder")),e?e:saveFolder},setLastSavedReportFolder:function(e){if(window.localStorage)try{window.localStorage.setItem("lastSavedReportFolder",e)}catch(t){window.console&&console.log(t)}},createAdhocSaveDialog:function(){var e=this;savePanel=new JRS.SaveAsDialog({templateMatcher:"#saveDataViewAndReport",inputMatchers:{dataViewName:".dataViewName",dataViewDescription:".dataViewDescription",reportName:".reportName",reportDescription:".reportDescription"},organizationId:organizationId,publicFolderUri:publicFolderUri,prepareState:function(e){savePanel.generatorSelect&&"TEMPLATE"===savePanel.generatorSelect.state&&(e.params.reportTemplate=savePanel.generatorSelect.val())},validator:function(t){var i=!0;return t.params.forDataView&&(i=i&&e.validateSaveNamePresent(t.dataViewName,"dataView")&&e.validateDescription(t.dataViewDescription,"dataView"),i=i&&e.validateSaveFolder(t,"dataView")),t.params.forReport&&(i=i&&e.validateSaveNamePresent(t.reportName,"report")&&e.validateDescription(t.reportDescription,"report"),t.reportName!=t.dataViewName||!t.params.forDataView&&t.folder!=saveFolder||(alert(designerMessages.datasourceOverwrite),i=!1),i=i&&e.validateSaveReportFolder(t,"report")),savePanel.generatorSelect&&"TEMPLATE"===savePanel.generatorSelect.state&&(i=i&&e.validateTemplate(t,"templateNotSelected")),i},saveHandler:function(t){var i=!t.params.forDataView||saveLabel===t.dataViewName&&saveFolder===t.folder,n={dataViewOverwriteOk:i};if(t.params.forReport&&(n.reportName=t.reportName,n.reportDescription=t.reportDescription,n.dataViewFolder=t.folder,n.reportFolder=t.reportFolder,designerBase.setLastSavedReportFolder(t.reportFolder),savePanel.generatorSelect)){var o=savePanel.generatorSelect.val();"TEMPLATE"===savePanel.generatorSelect.state&&(n.reportTemplate=o,e.generatorConfig({template:o})),"GENERATOR"===savePanel.generatorSelect.state&&(n.reportGenerator={id:o},e.generatorConfig({generator:o}))}var s;return s=t.params.forDataView?e.saveAdHoc(t.folder,t.dataViewName,t.dataViewDescription,!1,n):e.saveAdHoc(null,null,null,!1,n),t.params.forDataView?s.then(function(){saveLabel=t.dataViewName,saveDesc=t.dataViewDescription,saveFolder=t.folder}):s}}),savePanel.generatorSelect=new JRS.generatorSelect({id:"adHocGeneratorSelect",parent:savePanel.dialogElement.get(0),reportGenerators:localContext.state.reportGenerators})},createDashboardSaveDialog:function(){var e=this;savePanel=new JRS.SaveAsDialog({templateMatcher:"#saveAs",foldersTreeMatcher:"#saveAsFoldersTree",okButtonMatcher:"#saveAsBtnSave",cancelButtonMatcher:"#saveAsBtnCancel",inputMatchers:{resourceName:"#saveAsInputName",resourceDescription:"#saveAsInputDescription"},organizationId:organizationId,publicFolderUri:publicFolderUri,validator:function(t){var i=e.validateSaveNamePresent(t.resourceName,"dashboard")&&e.validateDescription(t.resourceDescription,"dashboard")&&e.validateSaveFolder(t,"dashboard");return i},saveHandler:function(t){var i=saveLabel===t.resourceName&&saveFolder===t.folder;return e.save(t.folder,t.resourceName,t.resourceDescription,i).then(function(){saveLabel=t.resourceName,saveDesc=t.resourceDescription,saveFolder=t.folder})}})},_showAdhocSavePanel:function(e){var t=this,i=saveLabel||defaultSaveName,n={dataViewName:i,dataViewDescription:saveDesc,reportName:i+" "+defaultReportSuffix,reportTemplate:e.reportTemplate,reportGenerators:e.reportGenerators,reportDescription:"",params:e};e.forDataView&&(n.folder=_.isEmpty(saveFolder)?"/":saveFolder),e.forReport&&(n.reportFolder=designerBase.getLastSavedReportFolder()||"/"),savePanel.open(n).then(function(){void 0!==adhocDesigner&&adhocDesigner.initPreventBrowserSelection(savePanel.foldersTree[0]);var i=t.generatorConfig();i&&(i.template?savePanel.generatorSelect.val(i.template,"TEMPLATE"):i.generator&&savePanel.generatorSelect.val(i.generator,"GENERATOR")),e.forDataView?savePanel.dialogElement.find(".dataViewName").focus().select():e.forReport&&savePanel.dialogElement.find(".reportName").focus().select()})},launchSaveAdhocDialog:function(e){function t(e,t){t.forDataView?(e.dialogElement.addClass("forDataView"),e.dialogElement.find(".forDataView").removeClass("hidden")):(e.dialogElement.removeClass("forDataView"),e.dialogElement.find(".forDataView").addClass("hidden")),t.forReport?(e.dialogElement.addClass("forReport"),e.dialogElement.find(".forReport").removeClass("hidden")):(e.dialogElement.removeClass("forReport"),e.dialogElement.find(".forReport").addClass("hidden")),t.forDataView&&!t.forReport?(e.dialogElement.find(".forDataViewOnly").removeClass("hidden"),savePanel.generatorSelect.hide()):(e.dialogElement.find(".forDataViewOnly").addClass("hidden"),savePanel.generatorSelect.show()),0==localContext.state.reportGenerators.length&&e.dialogElement.addClass(layoutModule.NO_GENERATORS_CLASS)}void 0===e&&(e={forDataView:!0,forReport:!1}),savePanel||this.createAdhocSaveDialog(),t(savePanel,e),adhocDesigner.filtersController.hasNotAppliedFilters()?adhocDesigner.showSaveConfirmationDialog(function(){designerBase._showAdhocSavePanel(e)}):designerBase._showAdhocSavePanel(e)},launchSaveDashboardDialog:function(){savePanel||this.createDashboardSaveDialog();var e={resourceName:saveLabel||defaultSaveName,resourceDescription:saveDesc,folder:saveFolder&&saveFolder.length>0?saveFolder:"/"};savePanel.open(e).then(function(){savePanel.dialogElement.find("#saveAsInputName").focus().select()})},launchSaveDialog:function(e){localContext.getMode()==designerBase.DASHBOARD?this.launchSaveDashboardDialog():this.launchSaveAdhocDialog(e),designerBase.enableSelection()},launchDependenciesDialog:function(e,t){var i=jQuery.Deferred();return dialogs.dependentResources.show(e.dependentResources,{dependenciesBtnSave:function(){i.resolve()},dependenciesBtnSaveAs:function(){i.reject();var e=null!=t.addOns&&null!=t.addOns.reportName;designerBase.launchSaveDialog({forDataView:!0,forReport:e})},dependenciesBtnCancel:function(){i.reject()}},{canSave:!0,okOnly:"FORBID"==e.result||"WARN"==e.result,topMessage:e.topMessage,bottomMessage:e.bottomMessage}),i},selectSaveDirectory:function(){saveAsTree.openAndSelectNode(saveFolder)},okSaveDialog:function(){saveOldLabel="",saveOldFolder="",designerBase.hideSaveDialog(),this._saveConfirmMessage()},validateSaveNamePresent:function(e,t){return!e||e.blank()?(alert(designerMessages.emptyName[t]),!1):e.length>this.LABEL_MAX_LEN?(alert(designerMessages.saveLabelError[t].replace("{0}",this.LABEL_MAX_LEN)),!1):!0},validateDescription:function(e,t){return!e||e.blank()?!0:e.length>this.DESC_MAX_LEN?(alert(designerMessages.saveDescriptionError[t].replace("{0}",this.DESC_MAX_LEN)),!1):!0},validateSaveFolder:function(e,t){if(null==e.folder)return alert(designerMessages.nonSelectedFolder[t]),!1;if(!e.isFolderWritable){var i=designerMessages.selectedFolderIsNotWritable[t];return alert(i.replace("{0}",e.folder)),!1}return!0},validateSaveReportFolder:function(e,t){if(null==e.reportFolder)return alert(designerMessages.nonSelectedFolder[t]),!1;
if(!e.isReportFolderWritable){var i=designerMessages.selectedFolderIsNotWritable[t];return alert(i.replace("{0}",e.folder)),!1}return!0},validateTemplate:function(e,t){return _.isEmpty(e.params.reportTemplate)?(alert(designerMessages[t]),!1):!0},launchJSOverwriteConfirm:function(e){confirm(e)?this.overwriteConfirmed():saveLabel=null},overwriteConfirmed:function(){this.save(saveFolder,saveLabel,saveDesc,!0)},updateSessionWarning:function(){if(TIMEOUT_INTERVAL>0&&!delayBeforeSessionTimeoutWarning){var e=TIMEOUT_INTERVAL-MILL_PER_MIN*MIN_WARN_BEFORE_TIMEOUT;delayBeforeSessionTimeoutWarning=e>0?e:MILL_PER_MIN/2}delayBeforeSessionTimeoutWarning&&(window.clearTimeout(timeoutValue),timeoutValue=window.setTimeout(function(){return designerBase.showExpirationDialog()},delayBeforeSessionTimeoutWarning))},showExpirationDialog:function(){var e=!1;e=confirm(localContext.getMode()!==this.DASHBOARD?ADHOC_SESSION_TIMEOUT_MESSAGE+getSessionExpireTime():DASHBOARD_SESSION_TIMEOUT_MESSAGE+getSessionExpireTime()),e&&(localContext.getMode()!==designerBase.DASHBOARD?adhocDesigner.tryToKeepServerAlive():localContext.tryToKeepServerAlive())},initAdhocSpecificDesignerBaseVar:function(){TIMEOUT_INTERVAL=1e3*serverTimeoutInterval,ADHOC_SESSION_TIMEOUT_MESSAGE=adHocSessionExpireCode,ADHOC_EXIT_MESSAGE=adHocExitConfirmation},confirmAndLeave:function(){return localContext.getMode()===designerBase.DASHBOARD?confirm(DASHBOARD_EXIT_MESSAGE):localContext.state.canUndo&&localContext.state.isWritable?confirm(ADHOC_EXIT_MESSAGE):!0},generatorConfig:function(e){var t=window.localStorage;if(t&&t.getItem("reportGenerator")){var i=JSON.parse(t.reportGenerator);if(!e)return i;var n=i.sourceURI?{sourceURI:i.sourceURI}:{};i=jQuery.extend({},n,e),t.setItem("reportGenerator",JSON.stringify(i))}return null},sendAjaxActionRequest:function(e,t,i){var n=this.getFilterDialogFlowURL(e,i);ajaxTargettedUpdate(n,{fillLocation:"ajaxbuffer",callback:t,errorHandler:errorHandler,postData:i})},sendSelectiveAjaxActionRequest:function(e,t,i){var n=this.getFilterDialogFlowURL(e,i);ajaxTargettedUpdate(n,{fillLocation:"ajaxbuffer",callback:t,errorHandler:errorHandler,postData:i,mode:AjaxRequester.prototype.CUMULATIVE_UPDATE})},getFilterDialogFlowURL:function(e){var t=urlContext+"/flow.html?_flowId=adhocAjaxFilterDialogFlow";if(null!=e)for(var i=0;i<e.length;i++)t+="&"+e[i];return t=t+"&clientKey="+clientKey},sendRequestToAjaxBuffer:function(e,t,i){this.sendRequest(e,t,i,{target:"ajaxbuffer",mode:AjaxRequester.prototype.TARGETTED_REPLACE_UPDATE})},sendRequest:function(action,otherParams,postFillAction,options,customErrorHandler){var bPost=options&&options.bPost,target=options&&options.target;target=target||(isSupportsTouch()?$("mainTableContainer").down().identify():"mainTableContainer");var mode=options&&options.mode||AjaxRequester.prototype.EVAL_JSON,container=options&&options.container,hideLoader=options&&options.hideLoader,actionPrefix=getTextBeforeUnderscore(action),javaAction=getTextAfterUnderscore(action),thisURL=urlContext+controllerMap[actionPrefix],params="action="+javaAction;if(_.isArray(otherParams))params+="&"+_.compact(otherParams).join("&");else if(_.isObject(otherParams)){var cleanedParams=_.reduce(otherParams,function(e,t,i){return isNotNullORUndefined(t)&&(e[i]=t),e},{});params+="&"+jQuery.param(cleanedParams)}params+="&clientKey="+clientKey,bPost||(thisURL+="?"+params,params=null),localContext.getMode()!==this.DASHBOARD&&null==postFillAction&&(postFillAction=adhocDesigner.render);var internalErrorHandler=function(e){var t=errorHandler(e);return t&&customErrorHandler&&customErrorHandler(e),t};isIPad()&&"ta_fetchMoreRows"!=action&&designerBase.updateMainOverlay(""),"undefined"!=typeof adhocDesigner&&(actionModel&&actionModel.hideMenu(),adhocDesigner&&adhocDesigner.unSelectAvailableTreeNodes());var delayedFn=function(updateURL,ajaxResponseTarget,postResponseCallback,params){return function(){var callbackWrapper=function(){clearTimeout(cancelQueryTimer),cancelQueryTimer=null,designerBase.updateMainOverlay("hidden"),postResponseCallback&&("string"==typeof postResponseCallback?eval(postResponseCallback):postResponseCallback.apply(null,arguments)),JRS.reportExecutionCounter.check()};return target==designerBase.CLOBBER?ajaxClobberredUpdate(updateURL,{callback:callbackWrapper,errorHandler:internalErrorHandler,postData:params}):ajaxTargettedUpdate(updateURL,{fillLocation:ajaxResponseTarget,fromLocation:container,callback:callbackWrapper,errorHandler:internalErrorHandler,postData:params,mode:mode,hideLoader:hideLoader})}}(thisURL,target,postFillAction,params);setTimeout(delayedFn,0)},sendNonReturningRequest:function(e,t,i){var n=getTextBeforeUnderscore(e),o=getTextAfterUnderscore(e),s=urlContext+controllerMap[n]+"?action="+o;if(t)for(var r=0;r<t.length;r++)s+="&"+t[r];s+="&clientKey="+clientKey,ajaxNonReturningUpdate(s,{callback:i,errorHandler:errorHandler})},redirectToHomePage:function(){document.location="flow.html?_flowId=homeFlow"},save:function(e,t,i,n,o){return localContext.getMode()===designerBase.DASHBOARD?localContext.saveDashboard(e,t,i,n):designerBase.saveAdHocWithNotAppliedFiltersCheck(e,t,i,n,o)},saveAdHocWithNotAppliedFiltersCheck:function(e,t,i,n,o){return adhocDesigner.filtersController.hasNotAppliedFilters()?void adhocDesigner.showSaveConfirmationDialog(_.bind(function(){return this.saveAdHoc(e,t,i,n,o)},this)):this.saveAdHoc(e,t,i,n,o)},saveAdHoc:function(e,t,i,n,o){return this.checkSave(e,t,i,n,o).then(function(){return designerBase.doSave(e,t,i,n,o)})},createOverwriteHanlder:function(e,t){var i=this;return function(n){var o=n.getResponseHeader("fileExistsException");return o?(o=decodeURIComponent(o),void(confirm(o.replace(/@@/g," "))?i.doSave.apply(i,t).then(function(){e.resolve()},function(t){e.reject(t)}):e.reject())):void e.reject(n)}},doSave:function(e,t,i,n,o){var s=jQuery.Deferred();adhocDesigner&&jQuery("#designer").trigger("report_name_update",[t]);var r=function(e){localContext.standardOpCallback&&localContext.standardOpCallback(e),this._saveConfirmMessage(),s.resolve()}.bind(designerBase),a=designerBase.createOverwriteHanlder(s,[e,t,i,!0,o]),l=new Array("allOverwrite="+n);if(null!=t&&(l.push("aruLabel="+encodeText(t)),l.push("aruDesc="+encodeText(i)),l.push("aruFolder="+encodeText(e))),void 0!=o&&(l.push("aruOverwrite="+o.dataViewOverwriteOk),void 0!=o.reportName&&(l.push("reportLabel="+encodeText(o.reportName)),l.push("reportDesc="+encodeText(o.reportDescription)),l.push("reportFolder="+encodeText(o.reportFolder)),o.reportTemplate&&l.push("reportTemplate="+encodeText(o.reportTemplate)),o.reportGenerator))){var c=Object.toJSON(o.reportGenerator);l.push("reportGenerator="+encodeText(c))}return this.sendRequest(designerBase.getControllerPrefix()+"_save",l,r,null,a),s},checkSave:function(e,t,i,n,o){var s=this,r=jQuery.Deferred(),a=function(a){a.topMessage?s.launchDependenciesDialog(a,{folder:e,name:t,desc:i,overwrite:n,addOns:o}).then(function(){r.resolve()},function(){r.reject()}):r.resolve()}.bind(designerBase),l=new Array("aruFolder="+encodeText(e),"aruLabel="+encodeText(t));return o&&o.reportName&&(l.push("reportFolder="+encodeText(o.reportFolder)),l.push("reportLabel="+encodeText(o.reportName))),this.sendRequest("co_checkSave",l,a,null),r},_saveConfirmMessage:function(){dialogs.systemConfirm.show(saveConfirmation,5e3)},createDomObject:function(e,t){if(e)return Builder.node(e,{className:t});throw"Please provide a valid tag"},getContentDimensions:function(e){var e=$A(e),t=e.collect(function(e){var t=e.getDimensions(),i=e.positionedOffset();return{width:t.width+i[0],height:t.height+i[1]}}),i=t.collect(function(e){return e.width}).max(),n=t.collect(function(e){return e.height}).max();return{width:i,height:n}},updateIFrameScrolls:function(){},updateMainOverlay:function(e){var t=document.getElementById("mainTableContainerOverlay");t&&(t.className=e)}},errorHandler=function(e){clearTimeout(cancelQueryTimer),cancelQueryTimer=null;var t=e.getResponseHeader("LoginRequested");if(t)return document.location=urlContext,!0;var i=e.getResponseHeader("fileExistsException");if(i)return i=decodeURIComponent(i),!0;var n=e.getResponseHeader("multipleFileExistException");if(n)return n=decodeURIComponent(n),alert(n.replace(/@@/g," ")),$("saveAsBtnSave")&&($("saveAsBtnSave").disabled=!1),!0;var o=e.getResponseHeader("adhocException");return o?(showErrorPopup(o),!0):baseErrorHandler(e)};define("designer.base",["jquery","core.ajax","underscore","prototype","utils.common","actionModel.modelGenerator","report.execution.count"],function(e){return function(){var t;return t||e.designerBase}}(this));var toolbarButtonModule={UP:"up",DOWN:"down",OVER:"over",DISABLED:"disabled",PRESSED:"pressed",CONTENT_PREFIX:"toolbar_",MenuClass:"menu vertical dropDown",TOOLBAR_MENU_CLASS:"menu vertical dropDown fitable",ACTION_MODEL_TAG:"adhocActionModel",CAPSULE_PATTERN:"capsule",showButtonMenu:function(e,t){t=jQuery(t);var i=this.CONTENT_PREFIX+t.attr("id"),n="adhocActionModel"==this.ACTION_MODEL_TAG?this.actionModel:this.ACTION_MODEL_TAG;actionModel.showDropDownMenu(e,t,i,this.TOOLBAR_MENU_CLASS,n)},setActionModel:function(e){this.actionModel=e},isToolBarButton:function(e){return e?jQuery(e).hasClass("capsule"):!1},enable:function(e){buttonManager.enable(e)},disable:function(e){buttonManager.disable(e)},setButtonState:function(e,t){t?this.enable(e):this.disable(e)}};define("components.toolbarButtons",["jquery","prototype"],function(e){return function(){var t;return t||e.toolbarButtonModule}}(this)),toolbarButtonModule.initialize=function(e){toolbarButtonModule.actionMap=e,jQuery(".toolbar").on("mouseup mouseover mouseout","button",function(e){jQuery(this).prop("disabled")||toolbarButtonModule["mouse"+e.type.substring(5,6).toUpperCase()+e.type.substring(6)+"Handler"](e,this)}),isFirefox()&&jQuery(".toolbar li").each(function(e,t){jQuery(t).css("padding","0 2px")})},toolbarButtonModule.mouseUpHandler=function(e,t){var i=t.className.indexOf("capsule")>=0?toolbarButtonModule.actionMap[t.id]:null;if(i){var n=getAsFunction(i);n(e),e.stopPropagation()}},toolbarButtonModule.mouseOverHandler=function(e,t){t.className.indexOf("capsule")>=0&&t.className.indexOf("mutton")>=0&&!buttonManager.isDisabled(t)&&toolbarButtonModule.showButtonMenu(e.originalEvent,t)},toolbarButtonModule.mouseOutHandler=function(){},define("components.toolbar",["jquery","prototype","utils.common","components.toolbarButtons"],function(e){return function(){var t;return t||e.toolbarButtonModule}}(this)),function(e,t){"function"==typeof define&&define.amd?define("highcharts",["jquery"],e):t.Highcharts=e(t.jQuery)}(function(e){function t(e,t){var i;e||(e={});for(i in t)e[i]=t[i];return e}function i(){var e,t,i=arguments,n={},o=function(e,t){var i,n;"object"!=typeof e&&(e={});for(n in t)t.hasOwnProperty(n)&&(i=t[n],e[n]=i&&"object"==typeof i&&"[object Array]"!==Object.prototype.toString.call(i)&&"renderTo"!==n&&"number"!=typeof i.nodeType?o(e[n]||{},i):t[n]);return e};for(i[0]===!0&&(n=i[1],i=Array.prototype.slice.call(i,2)),t=i.length,e=0;t>e;e++)n=o(n,i[e]);return n}function n(e,t){return parseInt(e,t||10)}function o(e){return"string"==typeof e}function s(e){return e&&"object"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e){return"number"==typeof e}function l(e){return pt.log(e)/pt.LN10}function c(e){return pt.pow(10,e)}function d(e,t){for(var i=e.length;i--;)if(e[i]===t){e.splice(i,1);break}}function u(e){return e!==V&&null!==e}function h(e,t,i){var n,r;if(o(t))u(i)?e.setAttribute(t,i):e&&e.getAttribute&&(r=e.getAttribute(t));else if(u(t)&&s(t))for(n in t)e.setAttribute(n,t[n]);return r}function p(e){return r(e)?e:[e]}function m(){var e,t,i=arguments,n=i.length;for(e=0;n>e;e++)if(t=i[e],t!==V&&null!==t)return t}function f(e,i){xt&&!Lt&&i&&i.opacity!==V&&(i.filter="alpha(opacity="+100*i.opacity+")"),t(e.style,i)}function g(e,i,n,o,s){var r=ut.createElement(e);return i&&t(r,i),s&&f(r,{padding:0,border:Xt,margin:0}),n&&f(r,n),o&&o.appendChild(r),r}function v(e,i){var n=function(){return V};return n.prototype=new e,t(n.prototype,i),n}function _(e,t,i,o){var s=G.lang,r=+e||0,a=-1===t?(r.toString().split(".")[1]||"").length:isNaN(t=bt(t))?2:t,l=void 0===i?s.decimalPoint:i,c=void 0===o?s.thousandsSep:o,d=0>r?"-":"",u=String(n(r=bt(r).toFixed(a))),h=u.length>3?u.length%3:0;return d+(h?u.substr(0,h)+c:"")+u.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+c)+(a?l+bt(r-u).toFixed(a).slice(2):"")}function b(e,t){return new Array((t||2)+1-String(e).length).join(0)+e}function y(e,t,i){var n=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(n),i.apply(this,e)}}function T(e,t){var i,n=/f$/,o=/\.([0-9])/,s=G.lang;return n.test(e)?(i=e.match(o),i=i?i[1]:-1,null!==t&&(t=_(t,i,s.decimalPoint,e.indexOf(",")>-1?s.thousandsSep:""))):t=W(e,t),t}function S(e,t){for(var i,n,o,s,r,a,l,c="{",d=!1,u=[];-1!==(l=e.indexOf(c));){if(i=e.slice(0,l),d){for(n=i.split(":"),o=n.shift().split("."),r=o.length,a=t,s=0;r>s;s++)a=a[o[s]];n.length&&(a=T(n.join(":"),a)),u.push(a)}else u.push(i);e=e.slice(l+1),d=!d,c=d?"}":"{"}return u.push(e),u.join("")}function A(e){return pt.pow(10,ft(pt.log(e)/pt.LN10))}function C(e,t,i,n){var o,s;for(i=m(i,1),o=e/i,t||(t=[1,2,2.5,5,10],n&&n.allowDecimals===!1&&(1===i?t=[1,2,5,10]:.1>=i&&(t=[1/i]))),s=0;s<t.length&&(e=t[s],!(o<=(t[s]+(t[s+1]||t[s]))/2));s++);return e*=i}function E(e,t){var i,n,o=e.length;for(n=0;o>n;n++)e[n].ss_i=n;for(e.sort(function(e,n){return i=t(e,n),0===i?e.ss_i-n.ss_i:i}),n=0;o>n;n++)delete e[n].ss_i}function x(e){for(var t=e.length,i=e[0];t--;)e[t]<i&&(i=e[t]);return i}function M(e){for(var t=e.length,i=e[0];t--;)e[t]>i&&(i=e[t]);return i}function w(e,t){var i;for(i in e)e[i]&&e[i]!==t&&e[i].destroy&&e[i].destroy(),delete e[i]}function D(e){z||(z=g(jt)),e&&z.appendChild(e),z.innerHTML=""}function I(e){return parseFloat(e.toPrecision(14))}function O(e,t){$=m(e,t.animation)}function L(){var e=G.global.useUTC,t=e?"getUTC":"get",i=e?"setUTC":"set";J=6e4*(e&&G.global.timezoneOffset||0),Q=e?Date.UTC:function(e,t,i,n,o,s){return new Date(e,t,m(i,1),m(n,0),m(o,0),m(s,0)).getTime()},Z=t+"Minutes",et=t+"Hours",tt=t+"Day",it=t+"Date",nt=t+"Month",ot=t+"FullYear",st=i+"Minutes",rt=i+"Hours",at=i+"Date",lt=i+"Month",ct=i+"FullYear"}function N(e){return G=i(!0,G,e),L(),G}function R(){return G}function k(){}function P(e,t,i,n){this.axis=e,this.pos=t,this.type=i||"",this.isNew=!0,i||n||this.addLabel()}function F(){this.init.apply(this,arguments)}function H(){this.init.apply(this,arguments)}function B(e,t,i,n,o){var s=e.chart.inverted;this.axis=e,this.isNegative=i,this.options=t,this.x=n,this.total=null,this.points={},this.stack=o,this.alignOptions={align:t.align||(s?i?"left":"right":"center"),verticalAlign:t.verticalAlign||(s?"middle":i?"bottom":"top"),y:m(t.y,s?4:i?14:-6),x:m(t.x,s?i?-6:6:0)},this.textAlign=t.textAlign||(s?i?"right":"left":"center")}var V,U,j,z,G,W,$,q,Y,X,K,Q,J,Z,et,tt,it,nt,ot,st,rt,at,lt,ct,dt,ut=document,ht=window,pt=Math,mt=pt.round,ft=pt.floor,gt=pt.ceil,vt=pt.max,_t=pt.min,bt=pt.abs,yt=pt.cos,Tt=pt.sin,St=pt.PI,At=2*St/360,Ct=navigator.userAgent,Et=ht.opera,xt=/msie/i.test(Ct)&&!Et,Mt=8===ut.documentMode,wt=/AppleWebKit/.test(Ct),Dt=/Firefox/.test(Ct),It=/(Mobile|Android|Windows Phone)/.test(Ct),Ot="http://www.w3.org/2000/svg",Lt=!!ut.createElementNS&&!!ut.createElementNS(Ot,"svg").createSVGRect,Nt=Dt&&parseInt(Ct.split("Firefox/")[1],10)<4,Rt=!Lt&&!xt&&!!ut.createElement("canvas").getContext,kt={},Pt=0,Ft=function(){return V},Ht=[],Bt=0,Vt="Highcharts",Ut="4.0.3",jt="div",zt="absolute",Gt="relative",Wt="hidden",$t="highcharts-",qt="visible",Yt="px",Xt="none",Kt="M",Qt="L",Jt=/^[0-9]+$/,Zt="",ei="hover",ti="select",ii="stroke-width",ni={};dt=ht.Highcharts?X(16,!0):{},W=function(e,i,n){if(!u(i)||isNaN(i))return"Invalid date";e=m(e,"%Y-%m-%d %H:%M:%S");var o,s=new Date(i-J),r=s[et](),a=s[tt](),l=s[it](),c=s[nt](),d=s[ot](),h=G.lang,p=h.weekdays,f=t({a:p[a].substr(0,3),A:p[a],d:b(l),e:l,b:h.shortMonths[c],B:h.months[c],m:b(c+1),y:d.toString().substr(2,2),Y:d,H:b(r),I:b(r%12||12),l:r%12||12,M:b(s[Z]()),p:12>r?"AM":"PM",P:12>r?"am":"pm",S:b(s.getSeconds()),L:b(mt(i%1e3),3)},dt.dateFormats);for(o in f)for(;-1!==e.indexOf("%"+o);)e=e.replace("%"+o,"function"==typeof f[o]?f[o](i):f[o]);return n?e.substr(0,1).toUpperCase()+e.substr(1):e},X=function(e,t){var i="Highcharts error #"+e+": www.highcharts.com/errors/"+e;if(t)throw i;ht.console&&console.log(i)},Y={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:26784e5,year:31556952e3},q={init:function(e,t,i){t=t||"";var n,o,s,r,a,l=e.shift,c=t.indexOf("C")>-1,d=c?7:3,u=t.split(" "),h=[].concat(i),p=function(e){for(s=e.length;s--;)e[s]===Kt&&e.splice(s+1,0,e[s+1],e[s+2],e[s+1],e[s+2])};if(c&&(p(u),p(h)),e.isArea&&(r=u.splice(u.length-6,6),a=h.splice(h.length-6,6)),l<=h.length/d&&u.length===h.length)for(;l--;)h=[].concat(h).splice(0,d).concat(h);if(e.shift=0,u.length)for(n=h.length;u.length<n;)o=[].concat(u).splice(u.length-d,d),c&&(o[d-6]=o[d-2],o[d-5]=o[d-1]),u=u.concat(o);return r&&(u=u.concat(r),h=h.concat(a)),[u,h]},step:function(e,t,i,n){var o,s=[],r=e.length;if(1===i)s=n;else if(r===t.length&&1>i)for(;r--;)o=parseFloat(e[r]),s[r]=isNaN(o)?e[r]:i*parseFloat(t[r]-o)+o;else s=t;return s}},function(e){dt.__HighchartsAdapter__=ht.HighchartsAdapter||e&&{init:function(t){var i,n=e.fx,s=n.step,r=e.Tween,a=r&&r.propHooks,l=e.cssHooks.opacity;e.extend(e.easing,{easeOutQuad:function(e,t,i,n,o){return-n*(t/=o)*(t-2)+i}}),e.each(["cur","_default","width","height","opacity"],function(e,t){var i,o=s;"cur"===t?o=n.prototype:"_default"===t&&r&&(o=a[t],t="set"),i=o[t],i&&(o[t]=function(n){var o;return n=e?n:this,"align"!==n.prop?(o=n.elem,o.attr?o.attr(n.prop,"cur"===t?V:n.now):i.apply(this,arguments)):void 0})}),y(l,"get",function(e,t,i){return t.attr?t.opacity||0:e.call(this,t,i)}),i=function(e){var i,n=e.elem;e.started||(i=t.init(n,n.d,n.toD),e.start=i[0],e.end=i[1],e.started=!0),n.attr("d",t.step(e.start,e.end,e.pos,n.toD))},r?a.d={set:i}:s.d=i,this.each=Array.prototype.forEach?function(e,t){return Array.prototype.forEach.call(e,t)}:function(e,t){var i,n=e.length;for(i=0;n>i;i++)if(t.call(e[i],e[i],i,e)===!1)return i},e.fn.highcharts=function(){var e,t,i,n="Chart",s=arguments;return this[0]&&(o(s[0])&&(n=s[0],s=Array.prototype.slice.call(s,1)),e=s[0],e!==V&&(e.chart=e.chart||{},e.chart.renderTo=this[0],i=new dt[n](e,s[1]),t=this),e===V&&(t=Ht[h(this[0],"data-highcharts-chart")])),t}},getScript:e.getScript,inArray:e.inArray,adapterRun:function(t,i){return e(t)[i]()},grep:e.grep,map:function(e,t){for(var i=[],n=0,o=e.length;o>n;n++)i[n]=t.call(e[n],e[n],n,e);return i},offset:function(t){return e(t).offset()},addEvent:function(t,i,n){e(t).bind(i,n)},removeEvent:function(t,i,n){var o=ut.removeEventListener?"removeEventListener":"detachEvent";ut[o]&&t&&!t[o]&&(t[o]=function(){}),e(t).unbind(i,n)},fireEvent:function(i,n,o,s){var r,a=e.Event(n),l="detached"+n;!xt&&o&&(delete o.layerX,delete o.layerY,delete o.returnValue),t(a,o),i[n]&&(i[l]=i[n],i[n]=null),e.each(["preventDefault","stopPropagation"],function(e,t){var i=a[t];a[t]=function(){try{i.call(a)}catch(e){"preventDefault"===t&&(r=!0)}}}),e(i).trigger(a),i[l]&&(i[n]=i[l],i[l]=null),!s||a.isDefaultPrevented()||r||s(a)},washMouseEvent:function(e){var t=e.originalEvent||e;return t.pageX===V&&(t.pageX=e.pageX,t.pageY=e.pageY),t},animate:function(t,i,n){var o=e(t);t.style||(t.style={}),i.d&&(t.toD=i.d,i.d=1),o.stop(),i.opacity!==V&&t.attr&&(i.opacity+="px"),o.animate(i,n)},stop:function(t){e(t).stop()}}}(e);var oi=dt.__HighchartsAdapter__,si=oi||{};oi&&oi.init.call(oi,q);var ri=si.adapterRun,ai=si.getScript,li=si.inArray,ci=si.each,di=si.grep,ui=si.offset,hi=si.map,pi=si.addEvent,mi=si.removeEvent,fi=si.fireEvent,gi=si.washMouseEvent,vi=si.animate,_i=si.stop,bi={enabled:!0,x:0,y:15,style:{color:"#606060",cursor:"default",fontSize:"11px"}};G={colors:["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#8085e8","#8d4653","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/4.0.3/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/4.0.3/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#333333",fontSize:"18px"}},subtitle:{text:"",align:"center",style:{color:"#555555"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0,lineWidthPlus:1,radiusPlus:2},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:i(bi,{align:"center",enabled:!1,formatter:function(){return null===this.y?"":_(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,states:{hover:{lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3}},labels:{style:{position:zt,color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#909090",borderRadius:0,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:zt,width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:Gt,top:"45%"},style:{position:zt,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:Lt,backgroundColor:"rgba(249, 249, 249, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,snap:It?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var yi=G.plotOptions,Ti=yi.line;L();var Si=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,Ai=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,Ci=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,Ei=function(e){function t(e){e&&e.stops?c=hi(e.stops,function(e){return Ei(e[1])}):(l=Si.exec(e),l?d=[n(l[1]),n(l[2]),n(l[3]),parseFloat(l[4],10)]:(l=Ai.exec(e),l?d=[n(l[1],16),n(l[2],16),n(l[3],16),1]:(l=Ci.exec(e),l&&(d=[n(l[1]),n(l[2]),n(l[3]),1]))))}function o(t){var n;return c?(n=i(e),n.stops=[].concat(n.stops),ci(c,function(e,i){n.stops[i]=[n.stops[i][0],e.get(t)]})):n=d&&!isNaN(d[0])?"rgb"===t?"rgb("+d[0]+","+d[1]+","+d[2]+")":"a"===t?d[3]:"rgba("+d.join(",")+")":e,n}function s(e){if(c)ci(c,function(t){t.brighten(e)});else if(a(e)&&0!==e){var t;for(t=0;3>t;t++)d[t]+=n(255*e),d[t]<0&&(d[t]=0),d[t]>255&&(d[t]=255)}return this}function r(e){return d[3]=e,this}var l,c,d=[];return t(e),{get:o,brighten:s,rgba:d,setOpacity:r}};k.prototype={opacity:1,textProps:["fontSize","fontWeight","fontFamily","color","lineHeight","width","textDecoration","textShadow","HcTextStroke"],init:function(e,t){var i=this;i.element="span"===t?g(t):ut.createElementNS(Ot,t),i.renderer=e},animate:function(e,t,n){var o=m(t,$,!0);return _i(this),o?(o=i(o,{}),n&&(o.complete=n),vi(this,e,o)):(this.attr(e),n&&n()),this},colorGradient:function(e,t,n){var o,s,a,l,c,d,h,p,m,f,g,v=this.renderer,_=[];if(e.linearGradient?s="linearGradient":e.radialGradient&&(s="radialGradient"),s){a=e[s],l=v.gradients,d=e.stops,m=n.radialReference,r(a)&&(e[s]=a={x1:a[0],y1:a[1],x2:a[2],y2:a[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===s&&m&&!u(a.gradientUnits)&&(a=i(a,{cx:m[0]-m[2]/2+a.cx*m[2],cy:m[1]-m[2]/2+a.cy*m[2],r:a.r*m[2],gradientUnits:"userSpaceOnUse"}));for(f in a)"id"!==f&&_.push(f,a[f]);for(f in d)_.push(d[f]);_=_.join(","),l[_]?g=l[_].attr("id"):(a.id=g=$t+Pt++,l[_]=c=v.createElement(s).attr(a).add(v.defs),c.stops=[],ci(d,function(e){var t;0===e[1].indexOf("rgba")?(o=Ei(e[1]),h=o.get("rgb"),p=o.get("a")):(h=e[1],p=1),t=v.createElement("stop").attr({offset:e[0],"stop-color":h,"stop-opacity":p}).add(c),c.stops.push(t)})),n.setAttribute(t,"url("+v.url+"#"+g+")")}},attr:function(e,t){var i,n,o,s,r=this.element,a=this;if("string"==typeof e&&t!==V&&(i=e,e={},e[i]=t),"string"==typeof e)a=(this[e+"Getter"]||this._defaultGetter).call(this,e,r);else{for(i in e)n=e[i],s=!1,this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(i)&&(o||(this.symbolAttr(e),o=!0),s=!0),!this.rotation||"x"!==i&&"y"!==i||(this.doTransform=!0),s||(this[i+"Setter"]||this._defaultSetter).call(this,n,i,r),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(i)&&this.updateShadows(i,n);this.doTransform&&(this.updateTransform(),this.doTransform=!1)}return a},updateShadows:function(e,t){for(var i=this.shadows,n=i.length;n--;)i[n].setAttribute(e,"height"===e?vt(t-(i[n].cutHeight||0),0):"d"===e?this.d:t)},addClass:function(e){var t=this.element,i=h(t,"class")||"";return-1===i.indexOf(e)&&h(t,"class",i+" "+e),this},symbolAttr:function(e){var t=this;ci(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(i){t[i]=m(e[i],t[i])}),t.attr({d:t.renderer.symbols[t.symbolName](t.x,t.y,t.width,t.height,t)})},clip:function(e){return this.attr("clip-path",e?"url("+this.renderer.url+"#"+e.id+")":Xt)},crisp:function(e){var t,i,n=this,o={},s=e.strokeWidth||n.strokeWidth||0;i=mt(s)%2/2,e.x=ft(e.x||n.x||0)+i,e.y=ft(e.y||n.y||0)+i,e.width=ft((e.width||n.width||0)-2*i),e.height=ft((e.height||n.height||0)-2*i),e.strokeWidth=s;for(t in e)n[t]!==e[t]&&(n[t]=o[t]=e[t]);return o},css:function(e){var i,o,s,r=this,a=r.styles,l={},c=r.element,d="",u=!a;if(e&&e.color&&(e.fill=e.color),a)for(o in e)e[o]!==a[o]&&(l[o]=e[o],u=!0);if(u){if(i=r.textWidth=e&&e.width&&"text"===c.nodeName.toLowerCase()&&n(e.width),a&&(e=t(a,l)),r.styles=e,i&&(Rt||!Lt&&r.renderer.forExport)&&delete e.width,xt&&!Lt)f(r.element,e);else{s=function(e,t){return"-"+t.toLowerCase()};for(o in e)d+=o.replace(/([A-Z])/g,s)+":"+e[o]+";";h(c,"style",d)}i&&r.added&&r.renderer.buildText(r)}return r},on:function(e,t){var i=this,n=i.element;return j&&"click"===e?(n.ontouchstart=function(e){i.touchEventFired=Date.now(),e.preventDefault(),t.call(n,e)},n.onclick=function(e){(-1===Ct.indexOf("Android")||Date.now()-(i.touchEventFired||0)>1100)&&t.call(n,e)}):n["on"+e]=t,this},setRadialReference:function(e){return this.element.radialReference=e,this},translate:function(e,t){return this.attr({translateX:e,translateY:t})},invert:function(){var e=this;return e.inverted=!0,e.updateTransform(),e},updateTransform:function(){var e,t=this,i=t.translateX||0,n=t.translateY||0,o=t.scaleX,s=t.scaleY,r=t.inverted,a=t.rotation,l=t.element;r&&(i+=t.attr("width"),n+=t.attr("height")),e=["translate("+i+","+n+")"],r?e.push("rotate(90) scale(-1,1)"):a&&e.push("rotate("+a+" "+(l.getAttribute("x")||0)+" "+(l.getAttribute("y")||0)+")"),(u(o)||u(s))&&e.push("scale("+m(o,1)+" "+m(s,1)+")"),e.length&&l.setAttribute("transform",e.join(" "))},toFront:function(){var e=this.element;return e.parentNode.appendChild(e),this},align:function(e,t,i){var n,s,r,a,l,c={},u=this.renderer,h=u.alignedObjects;return e?(this.alignOptions=e,this.alignByTranslate=t,(!i||o(i))&&(this.alignTo=l=i||"renderer",d(h,this),h.push(this),i=null)):(e=this.alignOptions,t=this.alignByTranslate,l=this.alignTo),i=m(i,u[l],u),n=e.align,s=e.verticalAlign,r=(i.x||0)+(e.x||0),a=(i.y||0)+(e.y||0),("right"===n||"center"===n)&&(r+=(i.width-(e.width||0))/{right:1,center:2}[n]),c[t?"translateX":"x"]=mt(r),("bottom"===s||"middle"===s)&&(a+=(i.height-(e.height||0))/({bottom:1,middle:2}[s]||1)),c[t?"translateY":"y"]=mt(a),this[this.placed?"animate":"attr"](c),this.placed=!0,this.alignAttr=c,this},getBBox:function(){var e,i,n,o=this,s=o.bBox,r=o.renderer,a=o.rotation,l=o.element,c=o.styles,d=a*At,u=o.textStr;if((""===u||Jt.test(u))&&(n="num."+u.toString().length+(c?"|"+c.fontSize+"|"+c.fontFamily:"")),n&&(s=r.cache[n]),!s){if(l.namespaceURI===Ot||r.forExport){try{s=l.getBBox?t({},l.getBBox()):{width:l.offsetWidth,height:l.offsetHeight}}catch(h){}(!s||s.width<0)&&(s={width:0,height:0})}else s=o.htmlGetBBox();r.isSVG&&(e=s.width,i=s.height,xt&&c&&"11px"===c.fontSize&&"16.9"===i.toPrecision(3)&&(s.height=i=14),a&&(s.width=bt(i*Tt(d))+bt(e*yt(d)),s.height=bt(i*yt(d))+bt(e*Tt(d)))),o.bBox=s,n&&(r.cache[n]=s)}return s},show:function(e){return e&&this.element.namespaceURI===Ot?(this.element.removeAttribute("visibility"),this):this.attr({visibility:e?"inherit":qt})},hide:function(){return this.attr({visibility:Wt})},fadeOut:function(e){var t=this;t.animate({opacity:0},{duration:e||150,complete:function(){t.hide()}})},add:function(e){var t,i,o,s,r,a=this.renderer,l=e||a,c=l.element||a.box,d=this.element,p=this.zIndex;if(e&&(this.parentGroup=e),this.parentInverted=e&&e.inverted,void 0!==this.textStr&&a.buildText(this),p&&(l.handleZ=!0,p=n(p)),l.handleZ)for(t=c.childNodes,s=0;s<t.length;s++)if(i=t[s],o=h(i,"zIndex"),i!==d&&(n(o)>p||!u(p)&&u(o))){c.insertBefore(d,i),r=!0;break}return r||c.appendChild(d),this.added=!0,this.onAdd&&this.onAdd(),this},safeRemoveChild:function(e){var t=e.parentNode;t&&t.removeChild(e)},destroy:function(){var e,t,i,n=this,o=n.element||{},s=n.shadows,r=n.renderer.isSVG&&"SPAN"===o.nodeName&&n.parentGroup;if(o.onclick=o.onmouseout=o.onmouseover=o.onmousemove=o.point=null,_i(n),n.clipPath&&(n.clipPath=n.clipPath.destroy()),n.stops){for(i=0;i<n.stops.length;i++)n.stops[i]=n.stops[i].destroy();n.stops=null}for(n.safeRemoveChild(o),s&&ci(s,function(e){n.safeRemoveChild(e)});r&&r.div&&0===r.div.childNodes.length;)e=r.parentGroup,n.safeRemoveChild(r.div),delete r.div,r=e;n.alignTo&&d(n.renderer.alignedObjects,n);for(t in n)delete n[t];return null},shadow:function(e,t,i){var n,o,s,r,a,l,c=[],d=this.element;if(e){for(r=m(e.width,3),a=(e.opacity||.15)/r,l=this.parentInverted?"(-1,-1)":"("+m(e.offsetX,1)+", "+m(e.offsetY,1)+")",n=1;r>=n;n++)o=d.cloneNode(0),s=2*r+1-2*n,h(o,{isShadow:"true",stroke:e.color||"black","stroke-opacity":a*n,"stroke-width":s,transform:"translate"+l,fill:Xt}),i&&(h(o,"height",vt(h(o,"height")-s,0)),o.cutHeight=s),t?t.element.appendChild(o):d.parentNode.insertBefore(o,d),c.push(o);this.shadows=c}return this},xGetter:function(e){return"circle"===this.element.nodeName&&(e={x:"cx",y:"cy"}[e]||e),this._defaultGetter(e)},_defaultGetter:function(e){var t=m(this[e],this.element?this.element.getAttribute(e):null,0);return/^[\-0-9\.]+$/.test(t)&&(t=parseFloat(t)),t},dSetter:function(e,t,i){e&&e.join&&(e=e.join(" ")),/(NaN| {2}|^$)/.test(e)&&(e="M 0 0"),i.setAttribute(t,e),this[t]=e},dashstyleSetter:function(e){var t;if(e=e&&e.toLowerCase()){for(e=e.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").replace("solid",1).split(","),t=e.length;t--;)e[t]=n(e[t])*this["stroke-width"];
e=e.join(","),this.element.setAttribute("stroke-dasharray",e)}},alignSetter:function(e){this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[e])},opacitySetter:function(e,t,i){this[t]=e,i.setAttribute(t,e)},titleSetter:function(e){var t=this.element.getElementsByTagName("title")[0];t||(t=ut.createElementNS(Ot,"title"),this.element.appendChild(t)),t.textContent=e},textSetter:function(e){e!==this.textStr&&(delete this.bBox,this.textStr=e,this.added&&this.renderer.buildText(this))},fillSetter:function(e,t,i){"string"==typeof e?i.setAttribute(t,e):e&&this.colorGradient(e,t,i)},zIndexSetter:function(e,t,i){i.setAttribute(t,e),this[t]=e},_defaultSetter:function(e,t,i){i.setAttribute(t,e)}},k.prototype.yGetter=k.prototype.xGetter,k.prototype.translateXSetter=k.prototype.translateYSetter=k.prototype.rotationSetter=k.prototype.verticalAlignSetter=k.prototype.scaleXSetter=k.prototype.scaleYSetter=function(e,t){this[t]=e,this.doTransform=!0},k.prototype["stroke-widthSetter"]=k.prototype.strokeSetter=function(e,t,i){this[t]=e,this.stroke&&this["stroke-width"]?(this.strokeWidth=this["stroke-width"],k.prototype.fillSetter.call(this,this.stroke,"stroke",i),i.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===t&&0===e&&this.hasStroke&&(i.removeAttribute("stroke"),this.hasStroke=!1)};var xi=function(){this.init.apply(this,arguments)};xi.prototype={Element:k,init:function(e,t,i,n,o){var s,r,a,l=this,c=location;s=l.createElement("svg").attr({version:"1.1"}).css(this.getStyle(n)),r=s.element,e.appendChild(r),-1===e.innerHTML.indexOf("xmlns")&&h(r,"xmlns",Ot),l.isSVG=!0,l.box=r,l.boxWrapper=s,l.alignedObjects=[],l.url=(Dt||wt)&&ut.getElementsByTagName("base").length?c.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",a=this.createElement("desc").add(),a.element.appendChild(ut.createTextNode("Created with "+Vt+" "+Ut)),l.defs=this.createElement("defs").add(),l.forExport=o,l.gradients={},l.cache={},l.setSize(t,i,!1);var d,u;Dt&&e.getBoundingClientRect&&(l.subPixelFix=d=function(){f(e,{left:0,top:0}),u=e.getBoundingClientRect(),f(e,{left:gt(u.left)-u.left+Yt,top:gt(u.top)-u.top+Yt})},d(),pi(ht,"resize",d))},getStyle:function(e){return this.style=t({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},e)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var e=this,t=e.defs;return e.box=null,e.boxWrapper=e.boxWrapper.destroy(),w(e.gradients||{}),e.gradients=null,t&&(e.defs=t.destroy()),e.subPixelFix&&mi(ht,"resize",e.subPixelFix),e.alignedObjects=null,null},createElement:function(e){var t=new this.Element;return t.init(this,e),t},draw:function(){},buildText:function(e){for(var t,i,o,s=e.element,r=this,a=r.forExport,l=m(e.textStr,"").toString(),c=-1!==l.indexOf("<"),d=s.childNodes,u=h(s,"x"),p=e.styles,g=e.textWidth,v=p&&p.lineHeight,_=p&&p.HcTextStroke,b=d.length,y=function(e){return v?n(v):r.fontMetrics(/(px|em)$/.test(e&&e.style.fontSize)?e.style.fontSize:p&&p.fontSize||r.style.fontSize||12,e).h};b--;)s.removeChild(d[b]);return c||_||-1!==l.indexOf(" ")?(i=/<.*style="([^"]+)".*>/,o=/<.*href="(http[^"]+)".*>/,g&&!e.added&&this.box.appendChild(s),t=c?l.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[l],""===t[t.length-1]&&t.pop(),ci(t,function(t,n){var l,c=0;t=t.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),l=t.split("|||"),ci(l,function(t){if(""!==t||1===l.length){var d,m={},v=ut.createElementNS(Ot,"tspan");if(i.test(t)&&(d=t.match(i)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),h(v,"style",d)),o.test(t)&&!a&&(h(v,"onclick",'location.href="'+t.match(o)[1]+'"'),f(v,{cursor:"pointer"})),t=(t.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">")," "!==t){if(v.appendChild(ut.createTextNode(t)),c?m.dx=0:n&&null!==u&&(m.x=u),h(v,m),s.appendChild(v),!c&&n&&(!Lt&&a&&f(v,{display:"block"}),h(v,"dy",y(v))),g)for(var _,b,T,S=t.replace(/([^\^])-/g,"$1- ").split(" "),A=l.length>1||S.length>1&&"nowrap"!==p.whiteSpace,C=p.HcHeight,E=[],x=y(v),M=1;A&&(S.length||E.length);)delete e.bBox,T=e.getBBox(),b=T.width,!Lt&&r.forExport&&(b=r.measureSpanWidth(v.firstChild.data,e.styles)),_=b>g,_&&1!==S.length?(v.removeChild(v.firstChild),E.unshift(S.pop())):(S=E,E=[],S.length&&(M++,C&&M*x>C?(S=["..."],e.attr("title",e.textStr)):(v=ut.createElementNS(Ot,"tspan"),h(v,{dy:x,x:u}),d&&h(v,"style",d),s.appendChild(v))),b>g&&(g=b)),S.length&&v.appendChild(ut.createTextNode(S.join(" ").replace(/- /g,"-")));c++}}})}),void 0):void s.appendChild(ut.createTextNode(l))},button:function(e,n,o,s,r,a,l,c,d,u){var h,p,m,f,g,v,_=this.label(e,n,o,d,null,null,u,null,"button"),b=0,y={x1:0,y1:0,x2:0,y2:1};return r=i({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:y,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},r),m=r.style,delete r.style,a=i(r,{stroke:"#68A",fill:{linearGradient:y,stops:[[0,"#FFF"],[1,"#ACF"]]}},a),f=a.style,delete a.style,l=i(r,{stroke:"#68A",fill:{linearGradient:y,stops:[[0,"#9BD"],[1,"#CDF"]]}},l),g=l.style,delete l.style,c=i(r,{style:{color:"#CCC"}},c),v=c.style,delete c.style,pi(_.element,xt?"mouseover":"mouseenter",function(){3!==b&&_.attr(a).css(f)}),pi(_.element,xt?"mouseout":"mouseleave",function(){3!==b&&(h=[r,a,l][b],p=[m,f,g][b],_.attr(h).css(p))}),_.setState=function(e){_.state=b=e,e?2===e?_.attr(l).css(g):3===e&&_.attr(c).css(v):_.attr(r).css(m)},_.on("click",function(){3!==b&&s.call(_)}).attr(r).css(t({cursor:"default"},m))},crispLine:function(e,t){return e[1]===e[4]&&(e[1]=e[4]=mt(e[1])-t%2/2),e[2]===e[5]&&(e[2]=e[5]=mt(e[2])+t%2/2),e},path:function(e){var i={fill:Xt};return r(e)?i.d=e:s(e)&&t(i,e),this.createElement("path").attr(i)},circle:function(e,t,i){var n=s(e)?e:{x:e,y:t,r:i},o=this.createElement("circle");return o.xSetter=function(e){this.element.setAttribute("cx",e)},o.ySetter=function(e){this.element.setAttribute("cy",e)},o.attr(n)},arc:function(e,t,i,n,o,r){var a;return s(e)&&(t=e.y,i=e.r,n=e.innerR,o=e.start,r=e.end,e=e.x),a=this.symbol("arc",e||0,t||0,i||0,i||0,{innerR:n||0,start:o||0,end:r||0}),a.r=i,a},rect:function(e,t,i,n,o,r){o=s(e)?e.r:o;var a=this.createElement("rect"),l=s(e)?e:e===V?{}:{x:e,y:t,width:vt(i,0),height:vt(n,0)};return r!==V&&(l.strokeWidth=r,l=a.crisp(l)),o&&(l.r=o),a.rSetter=function(e){h(this.element,{rx:e,ry:e})},a.attr(l)},setSize:function(e,t,i){var n=this,o=n.alignedObjects,s=o.length;for(n.width=e,n.height=t,n.boxWrapper[m(i,!0)?"animate":"attr"]({width:e,height:t});s--;)o[s].align()},g:function(e){var t=this.createElement("g");return u(e)?t.attr({"class":$t+e}):t},image:function(e,i,n,o,s){var r,a={preserveAspectRatio:Xt};return arguments.length>1&&t(a,{x:i,y:n,width:o,height:s}),r=this.createElement("image").attr(a),r.element.setAttributeNS?r.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):r.element.setAttribute("hc-svg-href",e),r},symbol:function(e,i,n,o,s,r){var a,l,c,d,u,h=this.symbols[e],p=h&&h(mt(i),mt(n),o,s,r),m=/^url\((.*?)\)$/;return p?(a=this.path(p),t(a,{symbolName:e,x:i,y:n,width:o,height:s}),r&&t(a,r)):m.test(e)&&(u=function(e,t){e.element&&(e.attr({width:t[0],height:t[1]}),e.alignByTranslate||e.translate(mt((o-t[0])/2),mt((s-t[1])/2)))},c=e.match(m)[1],d=kt[c],a=this.image(c).attr({x:i,y:n}),a.isImg=!0,d?u(a,d):(a.attr({width:0,height:0}),l=g("img",{onload:function(){u(a,kt[c]=[this.width,this.height])},src:c}))),a},symbols:{circle:function(e,t,i,n){var o=.166*i;return[Kt,e+i/2,t,"C",e+i+o,t,e+i+o,t+n,e+i/2,t+n,"C",e-o,t+n,e-o,t,e+i/2,t,"Z"]},square:function(e,t,i,n){return[Kt,e,t,Qt,e+i,t,e+i,t+n,e,t+n,"Z"]},triangle:function(e,t,i,n){return[Kt,e+i/2,t,Qt,e+i,t+n,e,t+n,"Z"]},"triangle-down":function(e,t,i,n){return[Kt,e,t,Qt,e+i,t,e+i/2,t+n,"Z"]},diamond:function(e,t,i,n){return[Kt,e+i/2,t,Qt,e+i,t+n/2,e+i/2,t+n,e,t+n/2,"Z"]},arc:function(e,t,i,n,o){var s=o.start,r=o.r||i||n,a=o.end-.001,l=o.innerR,c=o.open,d=yt(s),u=Tt(s),h=yt(a),p=Tt(a),m=o.end-s<St?0:1;return[Kt,e+r*d,t+r*u,"A",r,r,0,m,1,e+r*h,t+r*p,c?Kt:Qt,e+l*h,t+l*p,"A",l,l,0,m,0,e+l*d,t+l*u,c?"":"Z"]},callout:function(e,t,i,n,o){var s,r=6,a=6,l=_t(o&&o.r||0,i,n),c=l+a,d=o&&o.anchorX,u=o&&o.anchorY,h=mt(o.strokeWidth||0)%2/2;return e+=h,t+=h,s=["M",e+l,t,"L",e+i-l,t,"C",e+i,t,e+i,t,e+i,t+l,"L",e+i,t+n-l,"C",e+i,t+n,e+i,t+n,e+i-l,t+n,"L",e+l,t+n,"C",e,t+n,e,t+n,e,t+n-l,"L",e,t+l,"C",e,t,e,t,e+l,t],d&&d>i&&u>t+c&&t+n-c>u?s.splice(13,3,"L",e+i,u-a,e+i+r,u,e+i,u+a,e+i,t+n-l):d&&0>d&&u>t+c&&t+n-c>u?s.splice(33,3,"L",e,u+a,e-r,u,e,u-a,e,t+l):u&&u>n&&d>e+c&&e+i-c>d?s.splice(23,3,"L",d+a,t+n,d,t+n+r,d-a,t+n,e+l,t+n):u&&0>u&&d>e+c&&e+i-c>d&&s.splice(3,3,"L",d-a,t,d,t-r,d+a,t,i-l,t),s}},clipRect:function(e,t,i,n){var o,s=$t+Pt++,r=this.createElement("clipPath").attr({id:s}).add(this.defs);return o=this.rect(e,t,i,n,0).add(r),o.id=s,o.clipPath=r,o},text:function(e,t,i,n){var o,s=this,r=Rt||!Lt&&s.forExport,a={};return n&&!s.forExport?s.html(e,t,i):(a.x=Math.round(t||0),i&&(a.y=Math.round(i)),(e||0===e)&&(a.text=e),o=s.createElement("text").attr(a),r&&o.css({position:zt}),n||(o.xSetter=function(e,t,i){var n,o,s=i.getElementsByTagName("tspan"),r=i.getAttribute(t);for(o=0;o<s.length;o++)n=s[o],n.getAttribute(t)===r&&n.setAttribute(t,e);i.setAttribute(t,e)}),o)},fontMetrics:function(e,t){e=e||this.style.fontSize,t&&ht.getComputedStyle&&(t=t.element||t,e=ht.getComputedStyle(t,"").fontSize),e=/px/.test(e)?n(e):/em/.test(e)?12*parseFloat(e):12;var i=24>e?e+4:mt(1.2*e),o=mt(.8*i);return{h:i,b:o,f:e}},label:function(e,n,o,s,r,a,l,c,d){function h(){var e,i,n=E.element.style;g=(void 0===v||void 0===_||C.styles.textAlign)&&E.textStr&&E.getBBox(),C.width=(v||g.width||0)+2*M+w,C.height=(_||g.height||0)+2*M,T=M+A.fontMetrics(n&&n.fontSize,E).b,S&&(f||(e=mt(-x*M),i=c?-T:0,C.box=f=s?A.symbol(s,e,i,C.width,C.height,I):A.rect(e,i,C.width,C.height,0,I[ii]),f.attr("fill",Xt).add(C)),f.isImg||f.attr(t({width:mt(C.width),height:mt(C.height)},I)),I=null)}function p(){var e,t=C.styles,i=t&&t.textAlign,n=w+M*(1-x);e=c?0:T,u(v)&&g&&("center"===i||"right"===i)&&(n+={center:.5,right:1}[i]*(v-g.width)),(n!==E.x||e!==E.y)&&(E.attr("x",n),e!==V&&E.attr("y",e)),E.x=n,E.y=e}function m(e,t){f?f.attr(e,t):I[e]=t}var f,g,v,_,b,y,T,S,A=this,C=A.g(d),E=C.text=A.text("",0,0,l).attr({zIndex:1}),x=0,M=3,w=0,D=0,I={};C.onAdd=function(){E.add(C),C.attr({text:e||"",x:n,y:o}),f&&u(r)&&C.attr({anchorX:r,anchorY:a})},C.widthSetter=function(e){v=e},C.heightSetter=function(e){_=e},C.paddingSetter=function(e){u(e)&&e!==M&&(M=e,p())},C.paddingLeftSetter=function(e){u(e)&&e!==w&&(w=e,p())},C.alignSetter=function(e){x={left:0,center:.5,right:1}[e]},C.textSetter=function(e){e!==V&&E.textSetter(e),h(),p()},C["stroke-widthSetter"]=function(e,t){e&&(S=!0),D=e%2/2,m(t,e)},C.strokeSetter=C.fillSetter=C.rSetter=function(e,t){"fill"===t&&e&&(S=!0),m(t,e)},C.anchorXSetter=function(e,t){r=e,m(t,e+D-b)},C.anchorYSetter=function(e,t){a=e,m(t,e-y)},C.xSetter=function(e){C.x=e,x&&(e-=x*((v||g.width)+M)),b=mt(e),C.attr("translateX",b)},C.ySetter=function(e){y=C.y=mt(e),C.attr("translateY",y)};var O=C.css;return t(C,{css:function(e){if(e){var t={};e=i(e),ci(C.textProps,function(i){e[i]!==V&&(t[i]=e[i],delete e[i])}),E.css(t)}return O.call(C,e)},getBBox:function(){return{width:g.width+2*M,height:g.height+2*M,x:g.x-M,y:g.y-M}},shadow:function(e){return f&&f.shadow(e),C},destroy:function(){mi(C.element,"mouseenter"),mi(C.element,"mouseleave"),E&&(mi(E,"click"),E=E.destroy()),f&&(f=f.destroy()),k.prototype.destroy.call(C),C=A=h=p=m=null}})}},U=xi,t(k.prototype,{htmlCss:function(e){var i=this,n=i.element,o=e&&"SPAN"===n.tagName&&e.width;return o&&(delete e.width,i.textWidth=o,i.updateTransform()),i.styles=t(i.styles,e),f(i.element,e),i},htmlGetBBox:function(){var e=this,t=e.element,i=e.bBox;return i||("text"===t.nodeName&&(t.style.position=zt),i=e.bBox={x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}),i},htmlUpdateTransform:function(){if(!this.added)return void(this.alignOnAdd=!0);var e=this,t=e.renderer,i=e.element,o=e.translateX||0,s=e.translateY||0,r=e.x||0,a=e.y||0,l=e.textAlign||"left",c={left:0,center:.5,right:1}[l],d=e.shadows;if(f(i,{marginLeft:o,marginTop:s}),d&&ci(d,function(e){f(e,{marginLeft:o+1,marginTop:s+1})}),e.inverted&&ci(i.childNodes,function(e){t.invertChild(e,i)}),"SPAN"===i.tagName){var h,p,g=e.rotation,v=n(e.textWidth),_=[g,l,i.innerHTML,e.textWidth].join(",");_!==e.cTT&&(p=t.fontMetrics(i.style.fontSize).b,u(g)&&e.setSpanRotation(g,c,p),h=m(e.elemWidth,i.offsetWidth),h>v&&/[ \-]/.test(i.textContent||i.innerText)&&(f(i,{width:v+Yt,display:"block",whiteSpace:"normal"}),h=v),e.getSpanCorrection(h,p,c,g,l)),f(i,{left:r+(e.xCorr||0)+Yt,top:a+(e.yCorr||0)+Yt}),wt&&(p=i.offsetHeight),e.cTT=_}},setSpanRotation:function(e,t,i){var n={},o=xt?"-ms-transform":wt?"-webkit-transform":Dt?"MozTransform":Et?"-o-transform":"";n[o]=n.transform="rotate("+e+"deg)",n[o+(Dt?"Origin":"-origin")]=n.transformOrigin=100*t+"% "+i+"px",f(this.element,n)},getSpanCorrection:function(e,t,i){this.xCorr=-e*i,this.yCorr=-t}}),t(xi.prototype,{html:function(e,i,n){var o=this.createElement("span"),s=o.element,r=o.renderer;return o.textSetter=function(e){e!==s.innerHTML&&delete this.bBox,s.innerHTML=this.textStr=e},o.xSetter=o.ySetter=o.alignSetter=o.rotationSetter=function(e,t){"align"===t&&(t="textAlign"),o[t]=e,o.htmlUpdateTransform()},o.attr({text:e,x:mt(i),y:mt(n)}).css({position:zt,whiteSpace:"nowrap",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),o.css=o.htmlCss,r.isSVG&&(o.add=function(e){var i,n,a=r.box.parentNode,l=[];if(this.parentGroup=e,e){if(i=e.div,!i){for(n=e;n;)l.push(n),n=n.parentGroup;ci(l.reverse(),function(e){var n;i=e.div=e.div||g(jt,{className:h(e.element,"class")},{position:zt,left:(e.translateX||0)+Yt,top:(e.translateY||0)+Yt},i||a),n=i.style,t(e,{translateXSetter:function(t,i){n.left=t+Yt,e[i]=t,e.doTransform=!0},translateYSetter:function(t,i){n.top=t+Yt,e[i]=t,e.doTransform=!0},visibilitySetter:function(e,t){n[t]=e}})})}}else i=a;return i.appendChild(s),o.added=!0,o.alignOnAdd&&o.htmlUpdateTransform(),o}),o}});var Mi,wi;if(!Lt&&!Rt){wi={init:function(e,t){var i=this,n=["<",t,' filled="f" stroked="f"'],o=["position: ",zt,";"],s=t===jt;("shape"===t||s)&&o.push("left:0;top:0;width:1px;height:1px;"),o.push("visibility: ",s?Wt:qt),n.push(' style="',o.join(""),'"/>'),t&&(n=s||"span"===t||"img"===t?n.join(""):e.prepVML(n),i.element=g(n)),i.renderer=e},add:function(e){var t=this,i=t.renderer,n=t.element,o=i.box,s=e&&e.inverted,r=e?e.element||e:o;return s&&i.invertChild(n,r),r.appendChild(n),t.added=!0,t.alignOnAdd&&!t.deferUpdateTransform&&t.updateTransform(),t.onAdd&&t.onAdd(),t},updateTransform:k.prototype.htmlUpdateTransform,setSpanRotation:function(){var e=this.rotation,t=yt(e*At),i=Tt(e*At);f(this.element,{filter:e?["progid:DXImageTransform.Microsoft.Matrix(M11=",t,", M12=",-i,", M21=",i,", M22=",t,", sizingMethod='auto expand')"].join(""):Xt})},getSpanCorrection:function(e,t,i,n,o){var s,r=n?yt(n*At):1,a=n?Tt(n*At):0,l=m(this.elemHeight,this.element.offsetHeight),c=o&&"left"!==o;this.xCorr=0>r&&-e,this.yCorr=0>a&&-l,s=0>r*a,this.xCorr+=a*t*(s?1-i:i),this.yCorr-=r*t*(n?s?i:1-i:1),c&&(this.xCorr-=e*i*(0>r?-1:1),n&&(this.yCorr-=l*i*(0>a?-1:1)),f(this.element,{textAlign:o}))},pathToVML:function(e){for(var t=e.length,i=[];t--;)a(e[t])?i[t]=mt(10*e[t])-5:"Z"===e[t]?i[t]="x":(i[t]=e[t],!e.isArc||"wa"!==e[t]&&"at"!==e[t]||(i[t+5]===i[t+7]&&(i[t+7]+=e[t+7]>e[t+5]?1:-1),i[t+6]===i[t+8]&&(i[t+8]+=e[t+8]>e[t+6]?1:-1)));return i.join(" ")||"x"},clip:function(e){var t,i,n=this;return e?(t=e.members,d(t,n),t.push(n),n.destroyClip=function(){d(t,n)},i=e.getCSS(n)):(n.destroyClip&&n.destroyClip(),i={clip:Mt?"inherit":"rect(auto)"}),n.css(i)},css:k.prototype.htmlCss,safeRemoveChild:function(e){e.parentNode&&D(e)},destroy:function(){return this.destroyClip&&this.destroyClip(),k.prototype.destroy.apply(this)},on:function(e,t){return this.element["on"+e]=function(){var e=ht.event;e.target=e.srcElement,t(e)},this},cutOffPath:function(e,t){var i;return e=e.split(/[ ,]/),i=e.length,(9===i||11===i)&&(e[i-4]=e[i-2]=n(e[i-2])-10*t),e.join(" ")},shadow:function(e,t,i){var o,s,r,a,l,c,d,u=[],h=this.element,p=this.renderer,f=h.style,v=h.path;if(v&&"string"!=typeof v.value&&(v="x"),l=v,e){for(c=m(e.width,3),d=(e.opacity||.15)/c,o=1;3>=o;o++)a=2*c+1-2*o,i&&(l=this.cutOffPath(v.value,a+.5)),r=['<shape isShadow="true" strokeweight="',a,'" filled="false" path="',l,'" coordsize="10 10" style="',h.style.cssText,'" />'],s=g(p.prepVML(r),null,{left:n(f.left)+m(e.offsetX,1),top:n(f.top)+m(e.offsetY,1)}),i&&(s.cutOff=a+1),r=['<stroke color="',e.color||"black",'" opacity="',d*o,'"/>'],g(p.prepVML(r),null,null,s),t?t.element.appendChild(s):h.parentNode.insertBefore(s,h),u.push(s);this.shadows=u}return this},updateShadows:Ft,setAttr:function(e,t){Mt?this.element[e]=t:this.element.setAttribute(e,t)},classSetter:function(e){this.element.className=e},dashstyleSetter:function(e,t,i){var n=i.getElementsByTagName("stroke")[0]||g(this.renderer.prepVML(["<stroke/>"]),null,null,i);n[t]=e||"solid",this[t]=e},dSetter:function(e,t,i){var n,o=this.shadows;if(e=e||[],this.d=e.join&&e.join(" "),i.path=e=this.pathToVML(e),o)for(n=o.length;n--;)o[n].path=o[n].cutOff?this.cutOffPath(e,o[n].cutOff):e;this.setAttr(t,e)},fillSetter:function(e,t,i){var n=i.nodeName;"SPAN"===n?i.style.color=e:"IMG"!==n&&(i.filled=e!==Xt,this.setAttr("fillcolor",this.renderer.color(e,i,t,this)))},opacitySetter:Ft,rotationSetter:function(e,t,i){var n=i.style;this[t]=n[t]=e,n.left=-mt(Tt(e*At)+1)+Yt,n.top=mt(yt(e*At))+Yt},strokeSetter:function(e,t,i){this.setAttr("strokecolor",this.renderer.color(e,i,t))},"stroke-widthSetter":function(e,t,i){i.stroked=!!e,this[t]=e,a(e)&&(e+=Yt),this.setAttr("strokeweight",e)},titleSetter:function(e,t){this.setAttr(t,e)},visibilitySetter:function(e,t,i){"inherit"===e&&(e=qt),this.shadows&&ci(this.shadows,function(i){i.style[t]=e}),"DIV"===i.nodeName&&(e=e===Wt?"-999em":0,Mt||(i.style[t]=e?qt:Wt),t="top"),i.style[t]=e},xSetter:function(e,t,i){this[t]=e,"x"===t?t="left":"y"===t&&(t="top"),this.updateClipping?(this[t]=e,this.updateClipping()):i.style[t]=e},zIndexSetter:function(e,t,i){i.style[t]=e}},dt.VMLElement=wi=v(k,wi),wi.prototype.ySetter=wi.prototype.widthSetter=wi.prototype.heightSetter=wi.prototype.xSetter;var Di={Element:wi,isIE8:Ct.indexOf("MSIE 8.0")>-1,init:function(e,i,n,o){var s,r,a,l=this;if(l.alignedObjects=[],s=l.createElement(jt).css(t(this.getStyle(o),{position:Gt})),r=s.element,e.appendChild(s.element),l.isVML=!0,l.box=r,l.boxWrapper=s,l.cache={},l.setSize(i,n,!1),!ut.namespaces.hcv){ut.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),a="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ";try{ut.createStyleSheet().cssText=a}catch(c){ut.styleSheets[0].cssText+=a}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,i,n,o){var r=this.createElement(),a=s(e);return t(r,{members:[],left:(a?e.x:e)+1,top:(a?e.y:i)+1,width:(a?e.width:n)-1,height:(a?e.height:o)-1,getCSS:function(e){var i=e.element,n=i.nodeName,o="shape"===n,s=e.inverted,r=this,a=r.top-(o?i.offsetTop:0),l=r.left,c=l+r.width,d=a+r.height,u={clip:"rect("+mt(s?l:a)+"px,"+mt(s?d:c)+"px,"+mt(s?c:d)+"px,"+mt(s?a:l)+"px)"};return!s&&Mt&&"DIV"===n&&t(u,{width:c+Yt,height:d+Yt}),u},updateClipping:function(){ci(r.members,function(e){e.element&&e.css(r.getCSS(e))})}})},color:function(e,t,i,n){var o,s,r,a=this,l=/^rgba/,c=Xt;if(e&&e.linearGradient?r="gradient":e&&e.radialGradient&&(r="pattern"),r){var d,u,h,p,m,f,v,_,b,y,T,S,A=e.linearGradient||e.radialGradient,C="",E=e.stops,x=[],M=function(){s=['<fill colors="'+x.join(",")+'" opacity="',_,'" o:opacity2="',v,'" type="',r,'" ',C,'focus="100%" method="any" />'],g(a.prepVML(s),null,null,t)};if(T=E[0],S=E[E.length-1],T[0]>0&&E.unshift([0,T[1]]),S[0]<1&&E.push([1,S[1]]),ci(E,function(e,t){l.test(e[1])?(o=Ei(e[1]),d=o.get("rgb"),u=o.get("a")):(d=e[1],u=1),x.push(100*e[0]+"% "+d),t?(_=u,b=d):(v=u,y=d)}),"fill"===i)if("gradient"===r)h=A.x1||A[0]||0,p=A.y1||A[1]||0,m=A.x2||A[2]||0,f=A.y2||A[3]||0,C='angle="'+(90-180*pt.atan((f-p)/(m-h))/St)+'"',M();else{var w,D=A.r,I=2*D,O=2*D,L=A.cx,N=A.cy,R=t.radialReference,k=function(){R&&(w=n.getBBox(),L+=(R[0]-w.x)/w.width-.5,N+=(R[1]-w.y)/w.height-.5,I*=R[2]/w.width,O*=R[2]/w.height),C='src="'+G.global.VMLRadialGradientURL+'" size="'+I+","+O+'" origin="0.5,0.5" position="'+L+","+N+'" color2="'+y+'" ',M()};n.added?k():n.onAdd=k,c=b}else c=d}else if(l.test(e)&&"IMG"!==t.tagName)o=Ei(e),s=["<",i,' opacity="',o.get("a"),'"/>'],g(this.prepVML(s),null,null,t),c=o.get("rgb");else{var P=t.getElementsByTagName(i);P.length&&(P[0].opacity=1,P[0].type="solid"),c=e}return c},prepVML:function(e){var t="display:inline-block;behavior:url(#default#VML);",i=this.isIE8;return e=e.join(""),i?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e=-1===e.indexOf('style="')?e.replace("/>",' style="'+t+'" />'):e.replace('style="','style="'+t)):e=e.replace("<","<hcv:"),e},text:xi.prototype.html,path:function(e){var i={coordsize:"10 10"};return r(e)?i.d=e:s(e)&&t(i,e),this.createElement("shape").attr(i)},circle:function(e,t,i){var n=this.symbol("circle");return s(e)&&(i=e.r,t=e.y,e=e.x),n.isCircle=!0,n.r=i,n.attr({x:e,y:t})},g:function(e){var t,i;return e&&(i={className:$t+e,"class":$t+e}),t=this.createElement(jt).attr(i)},image:function(e,t,i,n,o){var s=this.createElement("img").attr({src:e});return arguments.length>1&&s.attr({x:t,y:i,width:n,height:o}),s},createElement:function(e){return"rect"===e?this.symbol(e):xi.prototype.createElement.call(this,e)},invertChild:function(e,t){var i=this,o=t.style,s="IMG"===e.tagName&&e.style;f(e,{flip:"x",left:n(o.width)-(s?n(s.top):1),top:n(o.height)-(s?n(s.left):1),rotation:-90}),ci(e.childNodes,function(t){i.invertChild(t,e)})},symbols:{arc:function(e,t,i,n,o){var s,r=o.start,a=o.end,l=o.r||i||n,c=o.innerR,d=yt(r),u=Tt(r),h=yt(a),p=Tt(a);return a-r===0?["x"]:(s=["wa",e-l,t-l,e+l,t+l,e+l*d,t+l*u,e+l*h,t+l*p],o.open&&!c&&s.push("e",Kt,e,t),s.push("at",e-c,t-c,e+c,t+c,e+c*h,t+c*p,e+c*d,t+c*u,"x","e"),s.isArc=!0,s)},circle:function(e,t,i,n,o){return o&&(i=n=2*o.r),o&&o.isCircle&&(e-=i/2,t-=n/2),["wa",e,t,e+i,t+n,e+i,t+n/2,e+i,t+n/2,"e"]},rect:function(e,t,i,n,o){return xi.prototype.symbols[u(o)&&o.r?"callout":"square"].call(0,e,t,i,n,o)}}};dt.VMLRenderer=Mi=function(){this.init.apply(this,arguments)},Mi.prototype=i(xi.prototype,Di),U=Mi}xi.prototype.measureSpanWidth=function(e,t){var i,n=ut.createElement("span"),o=ut.createTextNode(e);return n.appendChild(o),f(n,t),this.box.appendChild(n),i=n.offsetWidth,D(n),i};var Ii,Oi;Rt&&(dt.CanVGRenderer=Ii=function(){Ot="http://www.w3.org/1999/xhtml"},Ii.prototype.symbols={},Oi=function(){function e(){var e,i=t.length;for(e=0;i>e;e++)t[e]();t=[]}var t=[];return{push:function(i,n){0===t.length&&ai(n,e),t.push(i)}}}(),U=Ii),P.prototype={addLabel:function(){var e,i,n,o,s=this,r=s.axis,l=r.options,d=r.chart,h=r.horiz,p=r.categories,f=r.names,g=s.pos,v=l.labels,_=v.rotation,b=r.tickPositions,y=h&&p&&!v.step&&!v.staggerLines&&!v.rotation&&d.plotWidth/b.length||!h&&(d.margin[3]||.33*d.chartWidth),T=g===b[0],S=g===b[b.length-1],A=p?m(p[g],f[g],g):g,C=s.label,E=b.info;r.isDatetimeAxis&&E&&(o=l.dateTimeLabelFormats[E.higherRanks[g]||E.unitName]),s.isFirst=T,s.isLast=S,e=r.labelFormatter.call({axis:r,chart:d,isFirst:T,isLast:S,dateTimeLabelFormat:o,value:r.isLog?I(c(A)):A}),i=y&&{width:vt(1,mt(y-2*(v.padding||10)))+Yt},i=t(i,v.style),u(C)?C&&C.attr({text:e}).css(i):(n={align:r.labelAlign},a(_)&&(n.rotation=_),y&&v.ellipsis&&(i.HcHeight=r.len/b.length),s.label=C=u(e)&&v.enabled?d.renderer.text(e,0,0,v.useHTML).attr(n).css(i).add(r.labelGroup):null,r.tickBaseline=d.renderer.fontMetrics(v.style.fontSize,C).b,_&&2===r.side&&(r.tickBaseline*=yt(_*At))),s.yOffset=C?m(v.y,r.tickBaseline+(2===r.side?8:-(C.getBBox().height/2))):0},getLabelSize:function(){var e=this.label,t=this.axis;return e?e.getBBox()[t.horiz?"height":"width"]:0},getLabelSides:function(){var e=this.label.getBBox(),t=this.axis,i=t.horiz,n=t.options,o=n.labels,s=i?e.width:e.height,r=i?o.x-s*{left:0,center:.5,right:1}[t.labelAlign]:0,a=i?s+r:s;return[r,a]},handleOverflow:function(e,t){var i,n,o,s,r,a=!0,l=this.axis,c=this.isFirst,d=this.isLast,u=l.horiz,h=u?t.x:t.y,p=l.reversed,m=l.tickPositions,f=this.getLabelSides(),g=f[0],v=f[1],_=this.label.line||0,b=l.labelEdge,y=l.justifyLabels&&(c||d);if(b[_]===V||h+g>b[_]?b[_]=h+v:y||(a=!1),y){r=l.justifyToPlot,i=r?l.pos:0,n=r?i+l.len:l.chart.chartWidth;do e+=c?1:-1,o=l.ticks[m[e]];while(m[e]&&(!o||!o.label||o.label.line!==_));s=o&&o.label.xy&&o.label.xy.x+o.getLabelSides()[c?0:1],c&&!p||d&&p?i>h+g&&(h=i-g,o&&h+v>s&&(a=!1)):h+v>n&&(h=n-v,o&&s>h+g&&(a=!1)),t.x=h}return a},getPosition:function(e,t,i,n){var o=this.axis,s=o.chart,r=n&&s.oldChartHeight||s.chartHeight;return{x:e?o.translate(t+i,null,null,n)+o.transB:o.left+o.offset+(o.opposite?(n&&s.oldChartWidth||s.chartWidth)-o.right-o.left:0),y:e?r-o.bottom+o.offset-(o.opposite?o.height:0):r-o.translate(t+i,null,null,n)-o.transB}},getLabelPosition:function(e,t,i,n,o,s,r,a){var l=this.axis,c=l.transA,d=l.reversed,u=l.staggerLines;return e=e+o.x-(s&&n?s*c*(d?-1:1):0),t=t+("xAxis"!==l.coll||n?this.yOffset:0)-(s&&!n?s*c*(d?1:-1):0),u&&(i.line=r/(a||1)%u,t+=i.line*(l.labelOffset/u)),{x:e,y:t}},getMarkPath:function(e,t,i,n,o,s){return s.crispLine([Kt,e,t,Qt,e+(o?0:-i),t+(o?i:0)],n)},render:function(e,t,i){var n,o,s,r=this,a=r.axis,l=a.options,c=a.chart,d=c.renderer,u=a.horiz,h=r.type,p=r.label,f=r.pos,g=l.labels,v=r.gridLine,_=h?h+"Grid":"grid",b=h?h+"Tick":"tick",y=l[_+"LineWidth"],T=l[_+"LineColor"],S=l[_+"LineDashStyle"],A=l[b+"Length"],C=l[b+"Width"]||0,E=l[b+"Color"],x=l[b+"Position"],M=r.mark,w=g.step,D=!0,I=a.tickmarkOffset,O=r.getPosition(u,f,I,t),L=O.x,N=O.y,R=u&&L===a.pos+a.len||!u&&N===a.pos?-1:1;i=m(i,1),this.isActive=!0,y&&(n=a.getPlotLinePath(f+I,y*R,t,!0),v===V&&(s={stroke:T,"stroke-width":y},S&&(s.dashstyle=S),h||(s.zIndex=1),t&&(s.opacity=0),r.gridLine=v=y?d.path(n).attr(s).add(a.gridGroup):null),!t&&v&&n&&v[r.isNew?"attr":"animate"]({d:n,opacity:i})),C&&A&&("inside"===x&&(A=-A),a.opposite&&(A=-A),o=r.getMarkPath(L,N,A,C*R,u,d),M?M.animate({d:o,opacity:i}):r.mark=d.path(o).attr({stroke:E,"stroke-width":C,opacity:i}).add(a.axisGroup)),p&&!isNaN(L)&&(p.xy=O=r.getLabelPosition(L,N,p,u,g,I,e,w),r.isFirst&&!r.isLast&&!m(l.showFirstLabel,1)||r.isLast&&!r.isFirst&&!m(l.showLastLabel,1)?D=!1:a.isRadial||g.step||g.rotation||t||0===i||(D=r.handleOverflow(e,O)),e=a.tickAmount&&!u?a.tickAmount-e-1:e,w&&e%w&&(D=!1),D&&!isNaN(O.y)?(O.opacity=i,p[r.isNew?"attr":"animate"](O),r.isNew=!1):p.attr("y",-9999))},destroy:function(){w(this,this.axis)}},dt.PlotLineOrBand=function(e,t){this.axis=e,t&&(this.options=t,this.id=t.id)},dt.PlotLineOrBand.prototype={render:function(){var e,t,n,o,s,r,a=this,c=a.axis,d=c.horiz,h=(c.pointRange||0)/2,p=a.options,m=p.label,f=a.label,g=p.width,v=p.to,_=p.from,b=u(_)&&u(v),y=p.value,T=p.dashStyle,S=a.svgElem,A=[],C=p.color,E=p.zIndex,w=p.events,D={},I=c.chart.renderer;if(c.isLog&&(_=l(_),v=l(v),y=l(y)),g)A=c.getPlotLinePath(y,g),D={stroke:C,"stroke-width":g},T&&(D.dashstyle=T);else{if(!b)return;_=vt(_,c.min-h),v=_t(v,c.max+h),A=c.getPlotBandPath(_,v,p),C&&(D.fill=C),p.borderWidth&&(D.stroke=p.borderColor,D["stroke-width"]=p.borderWidth)}if(u(E)&&(D.zIndex=E),S)A?S.animate({d:A},null,S.onGetPath):(S.hide(),S.onGetPath=function(){S.show()},f&&(a.label=f=f.destroy()));else if(A&&A.length&&(a.svgElem=S=I.path(A).attr(D).add(),w)){e=function(e){S.on(e,function(t){w[e].apply(a,[t])})};for(t in w)e(t)}return m&&u(m.text)&&A&&A.length&&c.width>0&&c.height>0?(m=i({align:d&&b&&"center",x:d?!b&&4:10,verticalAlign:!d&&b&&"middle",y:d?b?16:10:b?6:-4,rotation:d&&!b&&90},m),f||(D={align:m.textAlign||m.align,rotation:m.rotation},u(E)&&(D.zIndex=E),a.label=f=I.text(m.text,0,0,m.useHTML).attr(D).css(m.style).add()),n=[A[1],A[4],b?A[6]:A[1]],o=[A[2],A[5],b?A[7]:A[2]],s=x(n),r=x(o),f.align(m,!1,{x:s,y:r,width:M(n)-s,height:M(o)-r}),f.show()):f&&f.hide(),a},destroy:function(){d(this.axis.plotLinesAndBands,this),delete this.axis,w(this)}},K={getPlotBandPath:function(e,t){var i=this.getPlotLinePath(t),n=this.getPlotLinePath(e);return n&&i?n.push(i[4],i[5],i[1],i[2]):n=null,n},addPlotBand:function(e){return this.addPlotBandOrLine(e,"plotBands")},addPlotLine:function(e){return this.addPlotBandOrLine(e,"plotLines")},addPlotBandOrLine:function(e,t){var i=new dt.PlotLineOrBand(this,e).render(),n=this.userOptions;return i&&(t&&(n[t]=n[t]||[],n[t].push(e)),this.plotLinesAndBands.push(i)),i},removePlotBandOrLine:function(e){for(var t=this.plotLinesAndBands,i=this.options,n=this.userOptions,o=t.length;o--;)t[o].id===e&&t[o].destroy();ci([i.plotLines||[],n.plotLines||[],i.plotBands||[],n.plotBands||[]],function(t){for(o=t.length;o--;)t[o].id===e&&d(t,t[o])})}},F.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:bi,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#707070"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return _(this.total,-1)},style:bi.style}},defaultLeftAxisOptions:{labels:{x:-15,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:null},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-15},title:{rotation:0}},init:function(e,t){var i=t.isX,n=this;n.horiz=e.inverted?!i:i,n.isXAxis=i,n.coll=i?"xAxis":"yAxis",n.opposite=t.opposite,n.side=t.side||(n.horiz?n.opposite?0:2:n.opposite?1:3),n.setOptions(t);var o=this.options,s=o.type,r="datetime"===s;n.labelFormatter=o.labels.formatter||n.defaultLabelFormatter,n.userOptions=t,n.minPixelPadding=0,n.chart=e,n.reversed=o.reversed,n.zoomEnabled=o.zoomEnabled!==!1,n.categories=o.categories||"category"===s,n.names=[],n.isLog="logarithmic"===s,n.isDatetimeAxis=r,n.isLinked=u(o.linkedTo),n.tickmarkOffset=n.categories&&"between"===o.tickmarkPlacement?.5:0,n.ticks={},n.labelEdge=[],n.minorTicks={},n.plotLinesAndBands=[],n.alternateBands={},n.len=0,n.minRange=n.userMinRange=o.minRange||o.maxZoom,n.range=o.range,n.offset=o.offset||0,n.stacks={},n.oldStacks={},n.max=null,n.min=null,n.crosshair=m(o.crosshair,p(e.options.tooltip.crosshairs)[i?0:1],!1);var a,d=n.options.events;-1===li(n,e.axes)&&(i&&!this.isColorAxis?e.axes.splice(e.xAxis.length,0,n):e.axes.push(n),e[n.coll].push(n)),n.series=n.series||[],e.inverted&&i&&n.reversed===V&&(n.reversed=!0),n.removePlotBand=n.removePlotBandOrLine,n.removePlotLine=n.removePlotBandOrLine;for(a in d)pi(n,a,d[a]);n.isLog&&(n.val2lin=l,n.lin2val=c)},setOptions:function(e){this.options=i(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],i(G[this.coll],e))},defaultLabelFormatter:function(){var e,t,i=this.axis,n=this.value,o=i.categories,s=this.dateTimeLabelFormat,r=G.lang.numericSymbols,a=r&&r.length,l=i.options.labels.format,c=i.isLog?n:i.tickInterval;if(l)t=S(l,this);else if(o)t=n;else if(s)t=W(s,n);else if(a&&c>=1e3)for(;a--&&t===V;)e=Math.pow(1e3,a+1),c>=e&&null!==r[a]&&(t=_(n/e,-1)+r[a]);
return t===V&&(t=bt(n)>=1e3?_(n,0):_(n,-1,V,"")),t},getSeriesExtremes:function(){var e=this,t=e.chart;e.hasVisibleSeries=!1,e.dataMin=e.dataMax=null,e.buildStacks&&e.buildStacks(),ci(e.series,function(i){if(i.visible||!t.options.chart.ignoreHiddenSeries){var n,o,s,r=i.options,a=r.threshold;e.hasVisibleSeries=!0,e.isLog&&0>=a&&(a=null),e.isXAxis?(n=i.xData,n.length&&(e.dataMin=_t(m(e.dataMin,n[0]),x(n)),e.dataMax=vt(m(e.dataMax,n[0]),M(n)))):(i.getExtremes(),s=i.dataMax,o=i.dataMin,u(o)&&u(s)&&(e.dataMin=_t(m(e.dataMin,o),o),e.dataMax=vt(m(e.dataMax,s),s)),u(a)&&(e.dataMin>=a?(e.dataMin=a,e.ignoreMinPadding=!0):e.dataMax<a&&(e.dataMax=a,e.ignoreMaxPadding=!0)))}})},translate:function(e,t,i,n,o,s){var r,l=this,c=1,d=0,u=n?l.oldTransA:l.transA,h=n?l.oldMin:l.min,p=l.minPixelPadding,m=(l.options.ordinal||l.isLog&&o)&&l.lin2val;return u||(u=l.transA),i&&(c*=-1,d=l.len),l.reversed&&(c*=-1,d-=c*(l.sector||l.len)),t?(e=e*c+d,e-=p,r=e/u+h,m&&(r=l.lin2val(r))):(m&&(e=l.val2lin(e)),"between"===s&&(s=.5),r=c*(e-h)*u+d+c*p+(a(s)?u*s*l.pointRange:0)),r},toPixels:function(e,t){return this.translate(e,!1,!this.horiz,null,!0)+(t?0:this.pos)},toValue:function(e,t){return this.translate(e-(t?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(e,t,i,n,o){var s,r,a,l,c,d=this,u=d.chart,h=d.left,p=d.top,f=i&&u.oldChartHeight||u.chartHeight,g=i&&u.oldChartWidth||u.chartWidth,v=d.transB;return o=m(o,d.translate(e,null,null,i)),s=a=mt(o+v),r=l=mt(f-o-v),isNaN(o)?c=!0:d.horiz?(r=p,l=f-d.bottom,(h>s||s>h+d.width)&&(c=!0)):(s=h,a=g-d.right,(p>r||r>p+d.height)&&(c=!0)),c&&!n?null:u.renderer.crispLine([Kt,s,r,Qt,a,l],t||1)},getLinearTickPositions:function(e,t,i){var n,o,s=I(ft(t/e)*e),r=I(gt(i/e)*e),l=[];if(t===i&&a(t))return[t];for(n=s;r>=n&&(l.push(n),n=I(n+e),n!==o);)o=n;return l},getMinorTickPositions:function(){var e,t,i,n=this,o=n.options,s=n.tickPositions,r=n.minorTickInterval,a=[];if(n.isLog)for(i=s.length,t=1;i>t;t++)a=a.concat(n.getLogTickPositions(r,s[t-1],s[t],!0));else if(n.isDatetimeAxis&&"auto"===o.minorTickInterval)a=a.concat(n.getTimeTicks(n.normalizeTimeTickInterval(r),n.min,n.max,o.startOfWeek)),a[0]<n.min&&a.shift();else for(e=n.min+(s[0]-n.min)%r;e<=n.max;e+=r)a.push(e);return a},adjustForMinRange:function(){var e,t,i,n,o,s,r,a,l=this,c=l.options,d=l.min,h=l.max,p=l.dataMax-l.dataMin>=l.minRange;if(l.isXAxis&&l.minRange===V&&!l.isLog&&(u(c.min)||u(c.max)?l.minRange=null:(ci(l.series,function(e){for(o=e.xData,s=e.xIncrement?1:o.length-1,i=s;i>0;i--)n=o[i]-o[i-1],(t===V||t>n)&&(t=n)}),l.minRange=_t(5*t,l.dataMax-l.dataMin))),h-d<l.minRange){var f=l.minRange;e=(f-h+d)/2,r=[d-e,m(c.min,d-e)],p&&(r[2]=l.dataMin),d=M(r),a=[d+f,m(c.max,d+f)],p&&(a[2]=l.dataMax),h=x(a),f>h-d&&(r[0]=h-f,r[1]=m(c.min,h-f),d=M(r))}l.min=d,l.max=h},setAxisTranslation:function(e){var t,i,n=this,s=n.max-n.min,r=n.axisPointRange||0,a=0,l=0,c=n.linkedParent,d=!!n.categories,h=n.transA;(n.isXAxis||d||r)&&(c?(a=c.minPointOffset,l=c.pointRangePadding):ci(n.series,function(e){var i=d?1:n.isXAxis?e.pointRange:n.axisPointRange||0,c=e.options.pointPlacement,h=e.closestPointRange;i>s&&(i=0),r=vt(r,i),a=vt(a,o(c)?0:i/2),l=vt(l,"on"===c?0:i),!e.noSharedTooltip&&u(h)&&(t=u(t)?_t(t,h):h)}),i=n.ordinalSlope&&t?n.ordinalSlope/t:1,n.minPointOffset=a*=i,n.pointRangePadding=l*=i,n.pointRange=_t(r,s),n.closestPointRange=t),e&&(n.oldTransA=h),n.translationSlope=n.transA=h=n.len/(s+l||1),n.transB=n.horiz?n.left:n.bottom,n.minPixelPadding=h*a},setTickPositions:function(e){var t,i,n,o,s=this,r=s.chart,c=s.options,d=c.startOnTick,h=c.endOnTick,p=s.isLog,f=s.isDatetimeAxis,g=s.isXAxis,v=s.isLinked,_=s.options.tickPositioner,b=c.maxPadding,y=c.minPadding,T=c.tickInterval,S=c.minTickInterval,E=c.tickPixelInterval,x=s.categories;if(v?(s.linkedParent=r[s.coll][c.linkedTo],i=s.linkedParent.getExtremes(),s.min=m(i.min,i.dataMin),s.max=m(i.max,i.dataMax),c.type!==s.linkedParent.options.type&&X(11,1)):(s.min=m(s.userMin,c.min,s.dataMin),s.max=m(s.userMax,c.max,s.dataMax)),p&&(!e&&_t(s.min,m(s.dataMin,s.min))<=0&&X(10,1),s.min=I(l(s.min)),s.max=I(l(s.max))),s.range&&u(s.max)&&(s.userMin=s.min=vt(s.min,s.max-s.range),s.userMax=s.max,s.range=null),s.beforePadding&&s.beforePadding(),s.adjustForMinRange(),x||s.axisPointRange||s.usePercentage||v||!u(s.min)||!u(s.max)||(t=s.max-s.min,t&&(u(c.min)||u(s.userMin)||!y||!(s.dataMin<0)&&s.ignoreMinPadding||(s.min-=t*y),u(c.max)||u(s.userMax)||!b||!(s.dataMax>0)&&s.ignoreMaxPadding||(s.max+=t*b))),a(c.floor)&&(s.min=vt(s.min,c.floor)),a(c.ceiling)&&(s.max=_t(s.max,c.ceiling)),s.min===s.max||void 0===s.min||void 0===s.max?s.tickInterval=1:v&&!T&&E===s.linkedParent.options.tickPixelInterval?s.tickInterval=s.linkedParent.tickInterval:(s.tickInterval=m(T,x?1:(s.max-s.min)*E/vt(s.len,E)),!u(T)&&s.len<E&&!this.isRadial&&!this.isLog&&!x&&d&&h&&(o=!0,s.tickInterval/=4)),g&&!e&&ci(s.series,function(e){e.processData(s.min!==s.oldMin||s.max!==s.oldMax)}),s.setAxisTranslation(!0),s.beforeSetTickPositions&&s.beforeSetTickPositions(),s.postProcessTickInterval&&(s.tickInterval=s.postProcessTickInterval(s.tickInterval)),s.pointRange&&(s.tickInterval=vt(s.pointRange,s.tickInterval)),!T&&s.tickInterval<S&&(s.tickInterval=S),f||p||T||(s.tickInterval=C(s.tickInterval,null,A(s.tickInterval),c)),s.minorTickInterval="auto"===c.minorTickInterval&&s.tickInterval?s.tickInterval/5:c.minorTickInterval,s.tickPositions=n=c.tickPositions?[].concat(c.tickPositions):_&&_.apply(s,[s.min,s.max]),n||(!s.ordinalPositions&&(s.max-s.min)/s.tickInterval>vt(2*s.len,200)&&X(19,!0),n=f?s.getTimeTicks(s.normalizeTimeTickInterval(s.tickInterval,c.units),s.min,s.max,c.startOfWeek,s.ordinalPositions,s.closestPointRange,!0):p?s.getLogTickPositions(s.tickInterval,s.min,s.max):s.getLinearTickPositions(s.tickInterval,s.min,s.max),o&&n.splice(1,n.length-2),s.tickPositions=n),!v){var M,w=n[0],D=n[n.length-1],O=s.minPointOffset||0;d?s.min=w:s.min-O>w&&n.shift(),h?s.max=D:s.max+O<D&&n.pop(),0===n.length&&u(w)&&n.push((D+w)/2),1===n.length&&(M=bt(s.max)>1e13?1:.001,s.min-=M,s.max+=M)}},setMaxTicks:function(){var e=this.chart,t=e.maxTicks||{},i=this.tickPositions,n=this._maxTicksKey=[this.coll,this.pos,this.len].join("-");!this.isLinked&&!this.isDatetimeAxis&&i&&i.length>(t[n]||0)&&this.options.alignTicks!==!1&&(t[n]=i.length),e.maxTicks=t},adjustTickAmount:function(){var e=this,t=e.chart,i=e._maxTicksKey,n=e.tickPositions,o=t.maxTicks;if(o&&o[i]&&!e.isDatetimeAxis&&!e.categories&&!e.isLinked&&e.options.alignTicks!==!1&&this.min!==V){var s,r=e.tickAmount,a=n.length;if(e.tickAmount=s=o[i],s>a){for(;n.length<s;)n.push(I(n[n.length-1]+e.tickInterval));e.transA*=(a-1)/(s-1),e.max=n[n.length-1]}u(r)&&s!==r&&(e.isDirty=!0)}},setScale:function(){var e,t,i,n,o=this,s=o.stacks;if(o.oldMin=o.min,o.oldMax=o.max,o.oldAxisLength=o.len,o.setAxisSize(),n=o.len!==o.oldAxisLength,ci(o.series,function(e){(e.isDirtyData||e.isDirty||e.xAxis.isDirty)&&(i=!0)}),n||i||o.isLinked||o.forceRedraw||o.userMin!==o.oldUserMin||o.userMax!==o.oldUserMax){if(!o.isXAxis)for(e in s)for(t in s[e])s[e][t].total=null,s[e][t].cum=0;o.forceRedraw=!1,o.getSeriesExtremes(),o.setTickPositions(),o.oldUserMin=o.userMin,o.oldUserMax=o.userMax,o.isDirty||(o.isDirty=n||o.min!==o.oldMin||o.max!==o.oldMax)}else if(!o.isXAxis){o.oldStacks&&(s=o.stacks=o.oldStacks);for(e in s)for(t in s[e])s[e][t].cum=s[e][t].total}o.setMaxTicks()},setExtremes:function(e,i,n,o,s){var r=this,a=r.chart;n=m(n,!0),s=t(s,{min:e,max:i}),fi(r,"setExtremes",s,function(){r.userMin=e,r.userMax=i,r.eventArgs=s,r.isDirtyExtremes=!0,n&&a.redraw(o)})},zoom:function(e,t){var i=this.dataMin,n=this.dataMax,o=this.options;return this.allowZoomOutside||(u(i)&&e<=_t(i,m(o.min,i))&&(e=V),u(n)&&t>=vt(n,m(o.max,n))&&(t=V)),this.displayBtn=e!==V||t!==V,this.setExtremes(e,t,!1,V,{trigger:"zoom"}),!0},setAxisSize:function(){var e=this.chart,t=this.options,i=t.offsetLeft||0,n=t.offsetRight||0,o=this.horiz,s=m(t.width,e.plotWidth-i+n),r=m(t.height,e.plotHeight),a=m(t.top,e.plotTop),l=m(t.left,e.plotLeft+i),c=/%$/;c.test(r)&&(r=parseInt(r,10)/100*e.plotHeight),c.test(a)&&(a=parseInt(a,10)/100*e.plotHeight+e.plotTop),this.left=l,this.top=a,this.width=s,this.height=r,this.bottom=e.chartHeight-r-a,this.right=e.chartWidth-s-l,this.len=vt(o?s:r,0),this.pos=o?l:a},getExtremes:function(){var e=this,t=e.isLog;return{min:t?I(c(e.min)):e.min,max:t?I(c(e.max)):e.max,dataMin:e.dataMin,dataMax:e.dataMax,userMin:e.userMin,userMax:e.userMax}},getThreshold:function(e){var t=this,i=t.isLog,n=i?c(t.min):t.min,o=i?c(t.max):t.max;return n>e||null===e?e=n:e>o&&(e=o),t.translate(e,0,1,0,1)},autoLabelAlign:function(e){var t,i=(m(e,0)-90*this.side+720)%360;return t=i>15&&165>i?"right":i>195&&345>i?"left":"center"},getOffset:function(){var e,t,i,n,o,s,r,a,l,c,d,h,p,f,g,v=this,_=v.chart,b=_.renderer,y=v.options,T=v.tickPositions,S=v.ticks,A=v.horiz,C=v.side,E=_.inverted?[1,0,3,2][C]:C,x=0,M=0,w=y.title,D=y.labels,I=0,O=_.axisOffset,L=_.clipOffset,N=[-1,1,1,-1][C],R=1,k=m(D.maxStaggerLines,5);if(v.hasData=e=v.hasVisibleSeries||u(v.min)&&u(v.max)&&!!T,v.showAxis=t=e||m(y.showEmpty,!0),v.staggerLines=v.horiz&&D.staggerLines,v.axisGroup||(v.gridGroup=b.g("grid").attr({zIndex:y.gridZIndex||1}).add(),v.axisGroup=b.g("axis").attr({zIndex:y.zIndex||2}).add(),v.labelGroup=b.g("axis-labels").attr({zIndex:D.zIndex||7}).addClass($t+v.coll.toLowerCase()+"-labels").add()),e||v.isLinked){if(v.labelAlign=m(D.align||v.autoLabelAlign(D.rotation)),ci(T,function(e){S[e]?S[e].addLabel():S[e]=new P(v,e)}),v.horiz&&!v.staggerLines&&k&&!D.rotation){for(r=v.reversed?[].concat(T).reverse():T;k>R;){for(a=[],l=!1,s=0;s<r.length;s++)c=r[s],d=S[c].label&&S[c].label.getBBox(),p=d?d.width:0,f=s%R,p&&(h=v.translate(c),a[f]!==V&&h<a[f]&&(l=!0),a[f]=h+p);if(!l)break;R++}R>1&&(v.staggerLines=R)}(1===C||3===C)&&v.userOptions.labels&&Math.abs(v.userOptions.labels.rotation)>=75&&(v.isXAxis&&_.inverted||!v.isXAxis&&!_.inverted)&&T.length?I=S[T[0]].label.getBBox().width:ci(T,function(e){(0===C||2===C||{1:"left",3:"right"}[C]===v.labelAlign)&&(I=vt(S[e].getLabelSize(),I))}),v.staggerLines&&(I*=v.staggerLines,v.labelOffset=I)}else for(o in S)S[o].destroy(),delete S[o];w&&w.text&&w.enabled!==!1&&(v.axisTitle||(v.axisTitle=b.text(w.text,0,0,w.useHTML).attr({zIndex:7,rotation:w.rotation||0,align:w.textAlign||{low:"left",middle:"center",high:"right"}[w.align]}).addClass($t+this.coll.toLowerCase()+"-title").css(w.style).add(v.axisGroup),v.axisTitle.isNew=!0),t&&(x=v.axisTitle.getBBox()[A?"height":"width"],i=w.offset,M=u(i)?0:m(w.margin,A?5:10)),v.axisTitle[t?"show":"hide"]()),v.offset=N*m(y.offset,O[C]),g=2===C?v.tickBaseline:0,n=I+M+(I&&N*(A?m(D.y,v.tickBaseline+8):D.x)-g),v.axisTitleMargin=m(i,n),O[C]=vt(O[C],v.axisTitleMargin+x+N*v.offset,n),L[E]=vt(L[E],2*ft(y.lineWidth/2))},getLinePath:function(e){var t=this.chart,i=this.opposite,n=this.offset,o=this.horiz,s=this.left+(i?this.width:0)+n,r=t.chartHeight-this.bottom-(i?this.height:0)+n;return i&&(e*=-1),t.renderer.crispLine([Kt,o?this.left:s,o?r:this.top,Qt,o?t.chartWidth-this.right:s,o?r:t.chartHeight-this.bottom],e)},getTitlePosition:function(){var e=this.horiz,t=this.left,i=this.top,o=this.len,s=this.options.title,r=e?t:i,a=this.opposite,l=this.offset,c=n(s.style.fontSize||12),d={low:r+(e?0:o),middle:r+o/2,high:r+(e?o:0)}[s.align],u=(e?i+this.height:t)+(e?1:-1)*(a?-1:1)*this.axisTitleMargin+(2===this.side?c:0);return{x:e?d:u+(a?this.width:0)+l+(s.x||0),y:e?u-(a?this.height:0)+l:d+(s.y||0)}},render:function(){var e,t,i,n,o=this,s=o.horiz,r=o.reversed,a=o.chart,l=a.renderer,d=o.options,h=o.isLog,p=o.isLinked,m=o.tickPositions,f=o.axisTitle,g=o.ticks,v=o.minorTicks,_=o.alternateBands,b=d.stackLabels,y=d.alternateGridColor,T=o.tickmarkOffset,S=d.lineWidth,A=a.hasRendered,C=A&&u(o.oldMin)&&!isNaN(o.oldMin),E=o.hasData,x=o.showAxis,M=d.labels.overflow,w=o.justifyLabels=s&&M!==!1;o.labelEdge.length=0,o.justifyToPlot="justify"===M,ci([g,v,_],function(e){var t;for(t in e)e[t].isActive=!1}),(E||p)&&(o.minorTickInterval&&!o.categories&&ci(o.getMinorTickPositions(),function(e){v[e]||(v[e]=new P(o,e,"minor")),C&&v[e].isNew&&v[e].render(null,!0),v[e].render(null,!1,1)}),m.length&&(e=m.slice(),(s&&r||!s&&!r)&&e.reverse(),w&&(e=e.slice(1).concat([e[0]])),ci(e,function(t,i){w&&(i=i===e.length-1?0:i+1),(!p||t>=o.min&&t<=o.max)&&(g[t]||(g[t]=new P(o,t)),C&&g[t].isNew&&g[t].render(i,!0,.1),g[t].render(i))}),T&&0===o.min&&(g[-1]||(g[-1]=new P(o,-1,null,!0)),g[-1].render(-1))),y&&ci(m,function(e,t){t%2===0&&e<o.max&&(_[e]||(_[e]=new dt.PlotLineOrBand(o)),i=e+T,n=m[t+1]!==V?m[t+1]+T:o.max,_[e].options={from:h?c(i):i,to:h?c(n):n,color:y},_[e].render(),_[e].isActive=!0)}),o._addedPlotLB||(ci((d.plotLines||[]).concat(d.plotBands||[]),function(e){o.addPlotBandOrLine(e)}),o._addedPlotLB=!0)),ci([g,v,_],function(e){var t,i,n=[],o=$?$.duration||500:0,s=function(){for(i=n.length;i--;)e[n[i]]&&!e[n[i]].isActive&&(e[n[i]].destroy(),delete e[n[i]])};for(t in e)e[t].isActive||(e[t].render(t,!1,0),e[t].isActive=!1,n.push(t));e!==_&&a.hasRendered&&o?o&&setTimeout(s,o):s()}),S&&(t=o.getLinePath(S),o.axisLine?o.axisLine.animate({d:t}):o.axisLine=l.path(t).attr({stroke:d.lineColor,"stroke-width":S,zIndex:7}).add(o.axisGroup),o.axisLine[x?"show":"hide"]()),f&&x&&(f[f.isNew?"attr":"animate"](o.getTitlePosition()),f.isNew=!1),b&&b.enabled&&o.renderStackTotals(),o.isDirty=!1},redraw:function(){this.render(),ci(this.plotLinesAndBands,function(e){e.render()}),ci(this.series,function(e){e.isDirty=!0})},destroy:function(e){var t,i,n=this,o=n.stacks,s=n.plotLinesAndBands;e||mi(n);for(t in o)w(o[t]),o[t]=null;for(ci([n.ticks,n.minorTicks,n.alternateBands],function(e){w(e)}),i=s.length;i--;)s[i].destroy();ci(["stackTotalGroup","axisLine","axisTitle","axisGroup","cross","gridGroup","labelGroup"],function(e){n[e]&&(n[e]=n[e].destroy())}),this.cross&&this.cross.destroy()},drawCrosshair:function(e,t){if(this.crosshair){if((u(t)||!m(this.crosshair.snap,!0))===!1)return void this.hideCrosshair();var i,n,o=this.crosshair,s=o.animation;if(m(o.snap,!0)?u(t)&&(n=this.chart.inverted!=this.horiz?t.plotX:this.len-t.plotY):n=this.horiz?e.chartX-this.pos:this.len-e.chartY+this.pos,i=this.isRadial?this.getPlotLinePath(this.isXAxis?t.x:m(t.stackY,t.y)):this.getPlotLinePath(null,null,null,null,n),null===i)return void this.hideCrosshair();if(this.cross)this.cross.attr({visibility:qt})[s?"animate":"attr"]({d:i},s);else{var r={"stroke-width":o.width||1,stroke:o.color||"#C0C0C0",zIndex:o.zIndex||2};o.dashStyle&&(r.dashstyle=o.dashStyle),this.cross=this.chart.renderer.path(i).attr(r).add()}}},hideCrosshair:function(){this.cross&&this.cross.hide()}},t(F.prototype,K),F.prototype.getTimeTicks=function(e,i,n,o){var s,r,a=[],l={},c=G.global.useUTC,d=new Date(i-J),h=e.unitRange,p=e.count;if(u(i)){h>=Y.second&&(d.setMilliseconds(0),d.setSeconds(h>=Y.minute?0:p*ft(d.getSeconds()/p))),h>=Y.minute&&d[st](h>=Y.hour?0:p*ft(d[Z]()/p)),h>=Y.hour&&d[rt](h>=Y.day?0:p*ft(d[et]()/p)),h>=Y.day&&d[at](h>=Y.month?1:p*ft(d[it]()/p)),h>=Y.month&&(d[lt](h>=Y.year?0:p*ft(d[nt]()/p)),r=d[ot]()),h>=Y.year&&(r-=r%p,d[ct](r)),h===Y.week&&d[at](d[it]()-d[tt]()+m(o,1)),s=1,J&&(d=new Date(d.getTime()+J)),r=d[ot]();for(var f=d.getTime(),g=d[nt](),v=d[it](),_=c?J:(864e5+60*d.getTimezoneOffset()*1e3)%864e5;n>f;)a.push(f),h===Y.year?f=Q(r+s*p,0):h===Y.month?f=Q(r,g+s*p):c||h!==Y.day&&h!==Y.week?f+=h*p:f=Q(r,g,v+s*p*(h===Y.day?1:7)),s++;a.push(f),ci(di(a,function(e){return h<=Y.hour&&e%Y.day===_}),function(e){l[e]="day"})}return a.info=t(e,{higherRanks:l,totalRange:h*p}),a},F.prototype.normalizeTimeTickInterval=function(e,t){var i,n,o=t||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],s=o[o.length-1],r=Y[s[0]],a=s[1];for(n=0;n<o.length;n++)if(s=o[n],r=Y[s[0]],a=s[1],o[n+1]){var l=(r*a[a.length-1]+Y[o[n+1][0]])/2;if(l>=e)break}return r===Y.year&&5*r>e&&(a=[1,2,5]),i=C(e/r,a,"year"===s[0]?vt(A(e/r),1):1),{unitRange:r,count:i,unitName:s[0]}},F.prototype.getLogTickPositions=function(e,t,i,n){var o=this,s=o.options,r=o.len,a=[];if(n||(o._minorAutoInterval=null),e>=.5)e=mt(e),a=o.getLinearTickPositions(e,t,i);else if(e>=.08){var d,u,h,p,f,g,v,_=ft(t);for(d=e>.3?[1,2,4]:e>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],u=_;i+1>u&&!v;u++)for(p=d.length,h=0;p>h&&!v;h++)f=l(c(u)*d[h]),f>t&&(!n||i>=g)&&g!==V&&a.push(g),g>i&&(v=!0),g=f}else{var b=c(t),y=c(i),T=s[n?"minorTickInterval":"tickInterval"],S="auto"===T?null:T,E=s.tickPixelInterval/(n?5:1),x=n?r/o.tickPositions.length:r;e=m(S,o._minorAutoInterval,(y-b)*E/(x||1)),e=C(e,null,A(e)),a=hi(o.getLinearTickPositions(e,b,y),l),n||(o._minorAutoInterval=e/5)}return n||(o.tickInterval=e),a};var Li=dt.Tooltip=function(){this.init.apply(this,arguments)};Li.prototype={init:function(e,t){var i=t.borderWidth,o=t.style,s=n(o.padding);this.chart=e,this.options=t,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=e.renderer.label("",0,0,t.shape||"callout",null,null,t.useHTML,null,"tooltip").attr({padding:s,fill:t.backgroundColor,"stroke-width":i,r:t.borderRadius,zIndex:8}).css(o).css({padding:0}).add().attr({y:-9999}),Rt||this.label.shadow(t.shadow),this.shared=t.shared},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(e,i,n,o){var s=this,r=s.now,a=s.options.animation!==!1&&!s.isHidden&&(bt(e-r.x)>1||bt(i-r.y)>1),l=s.followPointer||s.len>1;t(r,{x:a?(2*r.x+e)/3:e,y:a?(r.y+i)/2:i,anchorX:l?V:a?(2*r.anchorX+n)/3:n,anchorY:l?V:a?(r.anchorY+o)/2:o}),s.label.attr(r),a&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){s&&s.move(e,i,n,o)},32))},hide:function(){var e,t=this;clearTimeout(this.hideTimer),this.isHidden||(e=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){t.label.fadeOut(),t.isHidden=!0},m(this.options.hideDelay,500)),e&&ci(e,function(e){e.setState()}),this.chart.hoverPoints=null)},getAnchor:function(e,t){var i,n,o=this.chart,s=o.inverted,r=o.plotTop,a=0,l=0;return e=p(e),i=e[0].tooltipPos,this.followPointer&&t&&(t.chartX===V&&(t=o.pointer.normalize(t)),i=[t.chartX-o.plotLeft,t.chartY-r]),i||(ci(e,function(e){n=e.series.yAxis,a+=e.plotX,l+=(e.plotLow?(e.plotLow+e.plotHigh)/2:e.plotY)+(!s&&n?n.top-r:0)}),a/=e.length,l/=e.length,i=[s?o.plotWidth-l:a,this.shared&&!s&&e.length>1&&t?t.chartY-r:s?o.plotHeight-a:l]),hi(i,mt)},getPosition:function(e,t,i){var n,o=this.chart,s=this.distance,r={},a=["y",o.chartHeight,t,i.plotY+o.plotTop],l=["x",o.chartWidth,e,i.plotX+o.plotLeft],c=i.ttBelow||o.inverted&&!i.negative||!o.inverted&&i.negative,d=function(e,t,i,n){var o=n-s>i,a=t>n+s+i,l=n-s-i,d=n+s;if(c&&a)r[e]=d;else if(!c&&o)r[e]=l;else if(o)r[e]=l;else{if(!a)return!1;r[e]=d}},u=function(e,t,i,n){return s>n||n>t-s?!1:void(r[e]=i/2>n?1:n>t-i/2?t-i-2:n-i/2)},h=function(e){var t=a;a=l,l=t,n=e},p=function(){d.apply(0,a)!==!1?u.apply(0,l)!==!1||n||(h(!0),p()):n?r.x=r.y=0:(h(!0),p())};return(o.inverted||this.len>1)&&h(),p(),r},defaultFormatter:function(e){var t,i=this.points||p(this),n=i[0].series;return t=[e.tooltipHeaderFormatter(i[0])],ci(i,function(e){n=e.series,t.push(n.tooltipFormatter&&n.tooltipFormatter(e)||e.point.tooltipFormatter(n.tooltipOptions.pointFormat))}),t.push(e.options.footerFormat||""),t.join("")},refresh:function(e,t){var i,n,o,s,r,a,l=this,c=l.chart,d=l.label,u=l.options,h={},f=[],g=u.formatter||l.defaultFormatter,v=c.hoverPoints,_=l.shared;clearTimeout(this.hideTimer),l.followPointer=p(e)[0].series.tooltipOptions.followPointer,o=l.getAnchor(e,t),i=o[0],n=o[1],!_||e.series&&e.series.noSharedTooltip?h=e.getLabelConfig():(c.hoverPoints=e,v&&ci(v,function(e){e.setState()}),ci(e,function(e){e.setState(ei),f.push(e.getLabelConfig())}),h={x:e[0].category,y:e[0].y},h.points=f,this.len=f.length,e=e[0]),s=g.call(h,l),a=e.series,this.distance=m(a.tooltipOptions.distance,16),s===!1?this.hide():(l.isHidden&&(_i(d),d.attr("opacity",1).show()),d.attr({text:s}),r=u.borderColor||e.color||a.color||"#606060",d.attr({stroke:r}),l.updatePosition({plotX:i,plotY:n,negative:e.negative,ttBelow:e.ttBelow}),this.isHidden=!1),fi(c,"tooltipRefresh",{text:s,x:i+c.plotLeft,y:n+c.plotTop,borderColor:r})},updatePosition:function(e){var t=this.chart,i=this.label,n=(this.options.positioner||this.getPosition).call(this,i.width,i.height,e);this.move(mt(n.x),mt(n.y),e.plotX+t.plotLeft,e.plotY+t.plotTop)},tooltipHeaderFormatter:function(e){var t,i=e.series,n=i.tooltipOptions,o=n.dateTimeLabelFormats,s=n.xDateFormat,r=i.xAxis,l=r&&"datetime"===r.options.type&&a(e.key),c=n.headerFormat,d=r&&r.closestPointRange;if(l&&!s){if(d){for(t in Y)if(Y[t]>=d||Y[t]<=Y.day&&e.key%Y[t]>0){s=o[t];break}}else s=o.day;s=s||o.year}return l&&s&&(c=c.replace("{point.key}","{point.key:"+s+"}")),S(c,{point:e,series:i})}};var Ni;j=ut.documentElement.ontouchstart!==V;var Ri=dt.Pointer=function(e,t){this.init(e,t)};if(Ri.prototype={init:function(e,t){var i,n,o=t.chart,s=o.events,r=Rt?"":o.zoomType,a=e.inverted;this.options=t,this.chart=e,this.zoomX=i=/x/.test(r),this.zoomY=n=/y/.test(r),this.zoomHor=i&&!a||n&&a,this.zoomVert=n&&!a||i&&a,this.hasZoom=i||n,this.runChartClick=s&&!!s.click,this.pinchDown=[],this.lastValidTouch={},dt.Tooltip&&t.tooltip.enabled&&(e.tooltip=new Li(e,t.tooltip),this.followTouchMove=t.tooltip.followTouchMove),this.setDOMEvents()},normalize:function(e,i){var n,o,s;return e=e||window.event,e=gi(e),e.target||(e.target=e.srcElement),s=e.touches?e.touches.length?e.touches.item(0):e.changedTouches[0]:e,i||(this.chartPosition=i=ui(this.chart.container)),s.pageX===V?(n=vt(e.x,e.clientX-i.left),o=e.y):(n=s.pageX-i.left,o=s.pageY-i.top),t(e,{chartX:mt(n),chartY:mt(o)})},getCoordinates:function(e){var t={xAxis:[],yAxis:[]};return ci(this.chart.axes,function(i){t[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(e[i.horiz?"chartX":"chartY"])})}),t},getIndex:function(e){var t=this.chart;return t.inverted?t.plotHeight+t.plotTop-e.chartY:e.chartX-t.plotLeft},runPointActions:function(e){var t,i,n,o,s,r,a=this,l=a.chart,c=l.series,d=l.tooltip,u=l.hoverPoint,h=l.hoverSeries,p=l.chartWidth,f=a.getIndex(e);if(d&&a.options.tooltip.shared&&(!h||!h.noSharedTooltip)){for(n=[],o=c.length,s=0;o>s;s++)c[s].visible&&c[s].options.enableMouseTracking!==!1&&!c[s].noSharedTooltip&&c[s].singularTooltips!==!0&&c[s].tooltipPoints.length&&(i=c[s].tooltipPoints[f],i&&i.series&&(i._dist=bt(f-i.clientX),p=_t(p,i._dist),n.push(i)));for(o=n.length;o--;)n[o]._dist>p&&n.splice(o,1);n.length&&n[0].clientX!==a.hoverX&&(d.refresh(n,e),a.hoverX=n[0].clientX)}t=h&&h.tooltipOptions.followPointer,h&&h.tracker&&!t?(i=h.tooltipPoints[f],i&&i!==u&&i.onMouseOver(e)):d&&t&&!d.isHidden&&(r=d.getAnchor([{}],e),d.updatePosition({plotX:r[0],plotY:r[1]})),d&&!a._onDocumentMouseMove&&(a._onDocumentMouseMove=function(e){Ht[Ni]&&Ht[Ni].pointer.onDocumentMouseMove(e)},pi(ut,"mousemove",a._onDocumentMouseMove)),ci(l.axes,function(t){t.drawCrosshair(e,m(i,u))})},reset:function(e){var t=this,i=t.chart,n=i.hoverSeries,o=i.hoverPoint,s=i.tooltip,r=s&&s.shared?i.hoverPoints:o;e=e&&s&&r,e&&p(r)[0].plotX===V&&(e=!1),e?(s.refresh(r),o&&o.setState(o.state,!0)):(o&&o.onMouseOut(),n&&n.onMouseOut(),s&&s.hide(),t._onDocumentMouseMove&&(mi(ut,"mousemove",t._onDocumentMouseMove),t._onDocumentMouseMove=null),ci(i.axes,function(e){e.hideCrosshair()}),t.hoverX=null)},scaleGroups:function(e,t){var i,n=this.chart;ci(n.series,function(o){i=e||o.getPlotBox(),o.xAxis&&o.xAxis.zoomEnabled&&(o.group.attr(i),o.markerGroup&&(o.markerGroup.attr(i),o.markerGroup.clip(t?n.clipRect:null)),o.dataLabelsGroup&&o.dataLabelsGroup.attr(i))}),n.clipRect.attr(t||n.clipBox)},dragStart:function(e){var t=this.chart;t.mouseIsDown=e.type,t.cancelClick=!1,t.mouseDownX=this.mouseDownX=e.chartX,t.mouseDownY=this.mouseDownY=e.chartY},drag:function(e){var t,i,n=this.chart,o=n.options.chart,s=e.chartX,r=e.chartY,a=this.zoomHor,l=this.zoomVert,c=n.plotLeft,d=n.plotTop,u=n.plotWidth,h=n.plotHeight,p=this.mouseDownX,m=this.mouseDownY,f=o.panKey&&e[o.panKey+"Key"];c>s?s=c:s>c+u&&(s=c+u),d>r?r=d:r>d+h&&(r=d+h),this.hasDragged=Math.sqrt(Math.pow(p-s,2)+Math.pow(m-r,2)),this.hasDragged>10&&(t=n.isInsidePlot(p-c,m-d),n.hasCartesianSeries&&(this.zoomX||this.zoomY)&&t&&!f&&(this.selectionMarker||(this.selectionMarker=n.renderer.rect(c,d,a?1:u,l?1:h,0).attr({fill:o.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add())),this.selectionMarker&&a&&(i=s-p,this.selectionMarker.attr({width:bt(i),x:(i>0?0:i)+p})),this.selectionMarker&&l&&(i=r-m,this.selectionMarker.attr({height:bt(i),y:(i>0?0:i)+m})),t&&!this.selectionMarker&&o.panning&&n.pan(e,o.panning))},drop:function(e){var i=this.chart,n=this.hasPinched;if(this.selectionMarker){var o,s={xAxis:[],yAxis:[],originalEvent:e.originalEvent||e},r=this.selectionMarker,a=r.attr?r.attr("x"):r.x,l=r.attr?r.attr("y"):r.y,c=r.attr?r.attr("width"):r.width,d=r.attr?r.attr("height"):r.height;(this.hasDragged||n)&&(ci(i.axes,function(t){if(t.zoomEnabled){var i=t.horiz,n="touchend"===e.type?t.minPixelPadding:0,r=t.toValue((i?a:l)+n),u=t.toValue((i?a+c:l+d)-n);isNaN(r)||isNaN(u)||(s[t.coll].push({axis:t,min:_t(r,u),max:vt(r,u)}),o=!0)}}),o&&fi(i,"selection",s,function(e){i.zoom(t(e,n?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),n&&this.scaleGroups()}i&&(f(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(e){e=this.normalize(e),e.preventDefault&&e.preventDefault(),this.dragStart(e)},onDocumentMouseUp:function(e){Ht[Ni]&&Ht[Ni].pointer.drop(e)},onDocumentMouseMove:function(e){var t=this.chart,i=this.chartPosition,n=t.hoverSeries;e=this.normalize(e,i),i&&n&&!this.inClass(e.target,"highcharts-tracker")&&!t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)&&this.reset()},onContainerMouseLeave:function(){var e=Ht[Ni];e&&(e.pointer.reset(),e.pointer.chartPosition=null)},onContainerMouseMove:function(e){var t=this.chart;Ni=t.index,e=this.normalize(e),e.returnValue=!1,"mousedown"===t.mouseIsDown&&this.drag(e),!this.inClass(e.target,"highcharts-tracker")&&!t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)||t.openMenu||this.runPointActions(e)},inClass:function(e,t){for(var i;e;){if(i=h(e,"class")){if(-1!==i.indexOf(t))return!0;if(-1!==i.indexOf($t+"container"))return!1}e=e.parentNode}},onTrackerMouseOut:function(e){var t=this.chart.hoverSeries,i=e.relatedTarget||e.toElement,n=i&&i.point&&i.point.series;!t||t.options.stickyTracking||this.inClass(i,$t+"tooltip")||n===t||t.onMouseOut()},onContainerClick:function(e){var i=this.chart,n=i.hoverPoint,o=i.plotLeft,s=i.plotTop;e=this.normalize(e),e.cancelBubble=!0,i.cancelClick||(n&&this.inClass(e.target,$t+"tracker")?(fi(n.series,"click",t(e,{point:n})),i.hoverPoint&&n.firePointEvent("click",e)):(t(e,this.getCoordinates(e)),i.isInsidePlot(e.chartX-o,e.chartY-s)&&fi(i,"click",e)))},setDOMEvents:function(){var e=this,t=e.chart.container;t.onmousedown=function(t){e.onContainerMouseDown(t)},t.onmousemove=function(t){e.onContainerMouseMove(t)},t.onclick=function(t){e.onContainerClick(t)},pi(t,"mouseleave",e.onContainerMouseLeave),1===Bt&&pi(ut,"mouseup",e.onDocumentMouseUp),j&&(t.ontouchstart=function(t){e.onContainerTouchStart(t)},t.ontouchmove=function(t){e.onContainerTouchMove(t)},1===Bt&&pi(ut,"touchend",e.onDocumentTouchEnd))},destroy:function(){var e;mi(this.chart.container,"mouseleave",this.onContainerMouseLeave),Bt||(mi(ut,"mouseup",this.onDocumentMouseUp),mi(ut,"touchend",this.onDocumentTouchEnd)),clearInterval(this.tooltipTimeout);for(e in this)this[e]=null}},t(dt.Pointer.prototype,{pinchTranslate:function(e,t,i,n,o,s){(this.zoomHor||this.pinchHor)&&this.pinchTranslateDirection(!0,e,t,i,n,o,s),(this.zoomVert||this.pinchVert)&&this.pinchTranslateDirection(!1,e,t,i,n,o,s)},pinchTranslateDirection:function(e,t,i,n,o,s,r,a){var l,c,d,u,h,p,m=this.chart,f=e?"x":"y",g=e?"X":"Y",v="chart"+g,_=e?"width":"height",b=m["plot"+(e?"Left":"Top")],y=a||1,T=m.inverted,S=m.bounds[e?"h":"v"],A=1===t.length,C=t[0][v],E=i[0][v],x=!A&&t[1][v],M=!A&&i[1][v],w=function(){!A&&bt(C-x)>20&&(y=a||bt(E-M)/bt(C-x)),d=(b-E)/y+C,l=m["plot"+(e?"Width":"Height")]/y};w(),c=d,c<S.min?(c=S.min,u=!0):c+l>S.max&&(c=S.max-l,u=!0),u?(E-=.8*(E-r[f][0]),A||(M-=.8*(M-r[f][1])),w()):r[f]=[E,M],T||(s[f]=d-b,s[_]=l),p=T?e?"scaleY":"scaleX":"scale"+g,h=T?1/y:y,o[_]=l,o[f]=c,n[p]=y,n["translate"+g]=h*b+(E-h*C)},pinch:function(e){var i=this,n=i.chart,o=i.pinchDown,s=i.followTouchMove,r=e.touches,a=r.length,l=i.lastValidTouch,c=i.hasZoom,d=i.selectionMarker,u={},h=1===a&&(i.inClass(e.target,$t+"tracker")&&n.runTrackerClick||n.runChartClick),p={};!c&&!s||h||e.preventDefault(),hi(r,function(e){return i.normalize(e)}),"touchstart"===e.type?(ci(r,function(e,t){o[t]={chartX:e.chartX,chartY:e.chartY}}),l.x=[o[0].chartX,o[1]&&o[1].chartX],l.y=[o[0].chartY,o[1]&&o[1].chartY],ci(n.axes,function(e){if(e.zoomEnabled){var t=n.bounds[e.horiz?"h":"v"],i=e.minPixelPadding,o=e.toPixels(m(e.options.min,e.dataMin)),s=e.toPixels(m(e.options.max,e.dataMax)),r=_t(o,s),a=vt(o,s);t.min=_t(e.pos,r-i),t.max=vt(e.pos+e.len,a+i)}})):o.length&&(d||(i.selectionMarker=d=t({destroy:Ft},n.plotBox)),i.pinchTranslate(o,r,u,d,p,l),i.hasPinched=c,i.scaleGroups(u,p),!c&&s&&1===a&&this.runPointActions(i.normalize(e)))},onContainerTouchStart:function(e){var t=this.chart;Ni=t.index,1===e.touches.length?(e=this.normalize(e),t.isInsidePlot(e.chartX-t.plotLeft,e.chartY-t.plotTop)?(this.runPointActions(e),this.pinch(e)):this.reset()):2===e.touches.length&&this.pinch(e)},onContainerTouchMove:function(e){(1===e.touches.length||2===e.touches.length)&&this.pinch(e)},onDocumentTouchEnd:function(e){Ht[Ni]&&Ht[Ni].pointer.drop(e)}}),ht.PointerEvent||ht.MSPointerEvent){var ki={},Pi=!!ht.PointerEvent,Fi=function(){var e,t=[];t.item=function(e){return this[e]};for(e in ki)ki.hasOwnProperty(e)&&t.push({pageX:ki[e].pageX,pageY:ki[e].pageY,target:ki[e].target});return t},Hi=function(e,t,i,n){var o;e=e.originalEvent||e,"touch"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH||!Ht[Ni]||(n(e),o=Ht[Ni].pointer,o[t]({type:i,target:e.currentTarget,preventDefault:Ft,touches:Fi()}))};t(Ri.prototype,{onContainerPointerDown:function(e){Hi(e,"onContainerTouchStart","touchstart",function(e){ki[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})},onContainerPointerMove:function(e){Hi(e,"onContainerTouchMove","touchmove",function(e){ki[e.pointerId]={pageX:e.pageX,pageY:e.pageY},ki[e.pointerId].target||(ki[e.pointerId].target=e.currentTarget)})},onDocumentPointerUp:function(e){Hi(e,"onContainerTouchEnd","touchend",function(e){delete ki[e.pointerId]})},batchMSEvents:function(e){e(this.chart.container,Pi?"pointerdown":"MSPointerDown",this.onContainerPointerDown),e(this.chart.container,Pi?"pointermove":"MSPointerMove",this.onContainerPointerMove),e(ut,Pi?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),y(Ri.prototype,"init",function(e,t,i){e.call(this,t,i),(this.hasZoom||this.followTouchMove)&&f(t.container,{"-ms-touch-action":Xt,"touch-action":Xt})}),y(Ri.prototype,"setDOMEvents",function(e){e.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(pi)}),y(Ri.prototype,"destroy",function(e){this.batchMSEvents(mi),e.call(this)})}var Bi=dt.Legend=function(e,t){this.init(e,t)};Bi.prototype={init:function(e,t){var n=this,o=t.itemStyle,s=m(t.padding,8),r=t.itemMarginTop||0;this.options=t,t.enabled&&(n.itemStyle=o,n.itemHiddenStyle=i(o,t.itemHiddenStyle),n.itemMarginTop=r,n.padding=s,n.initialItemX=s,n.initialItemY=s-5,n.maxItemWidth=0,n.chart=e,n.itemHeight=0,n.lastLineHeight=0,n.symbolWidth=m(t.symbolWidth,16),n.pages=[],n.render(),pi(n.chart,"endResize",function(){n.positionCheckboxes()}))},colorizeItem:function(e,t){var i,n,o=this,s=o.options,r=e.legendItem,a=e.legendLine,l=e.legendSymbol,c=o.itemHiddenStyle.color,d=t?s.itemStyle.color:c,u=t?e.legendColor||e.color||"#CCC":c,h=e.options&&e.options.marker,p={fill:u};if(r&&r.css({fill:d,color:d}),a&&a.attr({stroke:u}),l){if(h&&l.isMarker){p.stroke=u,h=e.convertAttribs(h);
for(i in h)n=h[i],n!==V&&(p[i]=n)}l.attr(p)}},positionItem:function(e){var t=this,i=t.options,n=i.symbolPadding,o=!i.rtl,s=e._legendItemPos,r=s[0],a=s[1],l=e.checkbox;e.legendGroup&&e.legendGroup.translate(o?r:t.legendWidth-r-2*n-4,a),l&&(l.x=r,l.y=a)},destroyItem:function(e){var t=e.checkbox;ci(["legendItem","legendLine","legendSymbol","legendGroup"],function(t){e[t]&&(e[t]=e[t].destroy())}),t&&D(e.checkbox)},destroy:function(){var e=this,t=e.group,i=e.box;i&&(e.box=i.destroy()),t&&(e.group=t.destroy())},positionCheckboxes:function(e){var t,i=this.group.alignAttr,n=this.clipHeight||this.legendHeight;i&&(t=i.translateY,ci(this.allItems,function(o){var s,r=o.checkbox;r&&(s=t+r.y+(e||0)+3,f(r,{left:i.translateX+o.checkboxOffset+r.x-20+Yt,top:s+Yt,display:s>t-6&&t+n-6>s?"":Xt}))}))},renderTitle:function(){var e,t=this.options,i=this.padding,n=t.title,o=0;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,i-3,i-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),e=this.title.getBBox(),o=e.height,this.offsetWidth=e.width,this.contentGroup.attr({translateY:o})),this.titleHeight=o},renderItem:function(e){var t,n,o,s=this,r=s.chart,a=r.renderer,l=s.options,c="horizontal"===l.layout,d=s.symbolWidth,u=l.symbolPadding,h=s.itemStyle,p=s.itemHiddenStyle,f=s.padding,g=c?m(l.itemDistance,20):0,v=!l.rtl,_=l.width,b=l.itemMarginBottom||0,y=s.itemMarginTop,T=s.initialItemX,A=e.legendItem,C=e.series&&e.series.drawLegendSymbol?e.series:e,E=C.options,x=s.createCheckboxForItem&&E&&E.showCheckbox,M=l.useHTML;A||(e.legendGroup=a.g("legend-item").attr({zIndex:1}).add(s.scrollGroup),e.legendItem=A=a.text(l.labelFormat?S(l.labelFormat,e):l.labelFormatter.call(e),v?d+u:-u,s.baseline||0,M).css(i(e.visible?h:p)).attr({align:v?"left":"right",zIndex:2}).add(e.legendGroup),s.baseline||(s.baseline=a.fontMetrics(h.fontSize,A).f+3+y,A.attr("y",s.baseline)),C.drawLegendSymbol(s,e),s.setItemEvents&&s.setItemEvents(e,A,M,h,p),s.colorizeItem(e,e.visible),x&&s.createCheckboxForItem(e)),n=A.getBBox(),o=e.checkboxOffset=l.itemWidth||e.legendItemWidth||d+u+n.width+g+(x?20:0),s.itemHeight=t=mt(e.legendItemHeight||n.height),c&&s.itemX-T+o>(_||r.chartWidth-2*f-T-l.x)&&(s.itemX=T,s.itemY+=y+s.lastLineHeight+b,s.lastLineHeight=0),s.maxItemWidth=vt(s.maxItemWidth,o),s.lastItemY=y+s.itemY+b,s.lastLineHeight=vt(t,s.lastLineHeight),e._legendItemPos=[s.itemX,s.itemY],c?s.itemX+=o:(s.itemY+=y+t+b,s.lastLineHeight=t),s.offsetWidth=_||vt((c?s.itemX-T-g:o)+f,s.offsetWidth)},getAllItems:function(){var e=[];return ci(this.chart.series,function(t){var i=t.options;m(i.showInLegend,u(i.linkedTo)?!1:V,!0)&&(e=e.concat(t.legendItems||("point"===i.legendType?t.data:t)))}),e},render:function(){var e,i,n,o,s=this,r=s.chart,a=r.renderer,l=s.group,c=s.box,d=s.options,u=s.padding,h=d.borderWidth,p=d.backgroundColor;s.itemX=s.initialItemX,s.itemY=s.initialItemY,s.offsetWidth=0,s.lastItemY=0,l||(s.group=l=a.g("legend").attr({zIndex:7}).add(),s.contentGroup=a.g().attr({zIndex:1}).add(l),s.scrollGroup=a.g().add(s.contentGroup)),s.symbolWidth=this.chart.renderer.fontMetrics(!1,l).f,d.symbolPadding=mt(s.symbolWidth/2.8),s.renderTitle(),e=s.getAllItems(),E(e,function(e,t){return(e.options&&e.options.legendIndex||0)-(t.options&&t.options.legendIndex||0)}),d.reversed&&e.reverse(),s.allItems=e,s.display=i=!!e.length,ci(e,function(e){s.renderItem(e)}),n=d.width||s.offsetWidth,o=s.lastItemY+s.lastLineHeight+s.titleHeight,o=s.handleOverflow(o),(h||p)&&(n+=u,o+=u,c?n>0&&o>0&&(c[c.isNew?"attr":"animate"](c.crisp({width:n,height:o})),c.isNew=!1):(s.box=c=a.rect(0,0,n,o,d.borderRadius,h||0).attr({stroke:d.borderColor,"stroke-width":h||0,fill:p||Xt}).add(l).shadow(d.shadow),c.isNew=!0),c[i?"show":"hide"]()),s.legendWidth=n,s.legendHeight=o,ci(e,function(e){s.positionItem(e)}),i&&l.align(t({width:n,height:o},d),!0,"spacingBox"),r.isResizing||this.positionCheckboxes()},handleOverflow:function(e){var t,i,n=this,o=this.chart,s=o.renderer,r=this.options,a=r.y,l="top"===r.verticalAlign,c=o.spacingBox.height+(l?-a:a)-this.padding,d=r.maxHeight,u=this.clipRect,h=r.navigation,p=m(h.animation,!0),f=h.arrowSize||12,g=this.nav,v=this.pages,_=this.allItems;return"horizontal"===r.layout&&(c/=2),d&&(c=_t(c,d)),v.length=0,e>c&&!r.useHTML?(this.clipHeight=t=vt(c-20-this.titleHeight-this.padding,0),this.currentPage=m(this.currentPage,1),this.fullHeight=e,ci(_,function(e,n){var o=e._legendItemPos[1],s=mt(e.legendItem.getBBox().height),r=v.length;(!r||o-v[r-1]>t&&(i||o)!==v[r-1])&&(v.push(i||o),r++),n===_.length-1&&o+s-v[r-1]>t&&v.push(o),o!==i&&(i=o)}),u||(u=n.clipRect=s.clipRect(0,this.padding,9999,0),n.contentGroup.clip(u)),u.attr({height:t}),g||(this.nav=g=s.g().attr({zIndex:1}).add(this.group),this.up=s.symbol("triangle",0,0,f,f).on("click",function(){n.scroll(-1,p)}).add(g),this.pager=s.text("",15,10).css(h.style).add(g),this.down=s.symbol("triangle-down",0,0,f,f).on("click",function(){n.scroll(1,p)}).add(g)),n.scroll(0),e=c):g&&(u.attr({height:o.chartHeight}),g.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),e},scroll:function(e,t){var i,n=this.pages,o=n.length,s=this.currentPage+e,r=this.clipHeight,a=this.options.navigation,l=a.activeColor,c=a.inactiveColor,d=this.pager,u=this.padding;s>o&&(s=o),s>0&&(t!==V&&O(t,this.chart),this.nav.attr({translateX:u,translateY:r+this.padding+7+this.titleHeight,visibility:qt}),this.up.attr({fill:1===s?c:l}).css({cursor:1===s?"default":"pointer"}),d.attr({text:s+"/"+o}),this.down.attr({x:18+this.pager.getBBox().width,fill:s===o?c:l}).css({cursor:s===o?"default":"pointer"}),i=-n[s-1]+this.initialItemY,this.scrollGroup.animate({translateY:i}),this.currentPage=s,this.positionCheckboxes(i))}};var Vi=dt.LegendSymbolMixin={drawRectangle:function(e,t){var i=e.options.symbolHeight||this.chart.renderer.fontMetrics(!1,t.legendItem).f||12;t.legendSymbol=this.chart.renderer.rect(0,mt(e.baseline-i/1.1),e.symbolWidth,i,e.options.symbolRadius||0).attr({zIndex:3}).add(t.legendGroup)},drawLineMarker:function(e){var t,i,n,o=this.options,s=o.marker,r=e.options,a=e.symbolWidth,l=this.chart.renderer,c=this.legendGroup,d=e.baseline-mt(.3*l.fontMetrics(r.itemStyle.fontSize,this.legendItem).b);o.lineWidth&&(n={"stroke-width":o.lineWidth},o.dashStyle&&(n.dashstyle=o.dashStyle),this.legendLine=l.path([Kt,0,d,Qt,a,d]).attr(n).add(c)),s&&s.enabled!==!1&&(t=s.radius,this.legendSymbol=i=l.symbol(this.symbol,a/2-t,d-t,2*t,2*t).add(c),i.isMarker=!0)}};(/Trident\/7\.0/.test(Ct)||Dt)&&y(Bi.prototype,"positionItem",function(e,t){var i=this,n=function(){t._legendItemPos&&e.call(i,t)};n(),setTimeout(n)}),H.prototype={init:function(e,t){var n,o=e.series;e.series=null,n=i(G,e),n.series=e.series=o,this.userOptions=e;var s=n.chart;this.margin=this.splashArray("margin",s),this.spacing=this.splashArray("spacing",s);var r=s.events;this.bounds={h:{},v:{}},this.callback=t,this.isResizing=0,this.options=n,this.axes=[],this.series=[],this.hasCartesianSeries=s.showAxes;var a,l=this;if(l.index=Ht.length,Ht.push(l),Bt++,s.reflow!==!1&&pi(l,"load",function(){l.initReflow()}),r)for(a in r)pi(l,a,r[a]);l.xAxis=[],l.yAxis=[],l.animation=Rt?!1:m(s.animation,!0),l.pointCount=l.colorCounter=l.symbolCounter=0,l.firstRender()},initSeries:function(e){var t,i=this,n=i.options.chart,o=e.type||n.type||n.defaultSeriesType,s=ni[o];return s||X(17,!0),t=new s,t.init(this,e),t},isInsidePlot:function(e,t,i){var n=i?t:e,o=i?e:t;return n>=0&&n<=this.plotWidth&&o>=0&&o<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&ci(this.axes,function(e){e.adjustTickAmount()}),this.maxTicks=null},redraw:function(e){var i,n,o,s=this,r=s.axes,a=s.series,l=s.pointer,c=s.legend,d=s.isDirtyLegend,u=s.hasCartesianSeries,h=s.isDirtyBox,p=a.length,m=p,f=s.renderer,g=f.isHidden(),v=[];for(O(e,s),g&&s.cloneRenderTo(),s.layOutTitles();m--;)if(o=a[m],o.options.stacking&&(i=!0,o.isDirty)){n=!0;break}if(n)for(m=p;m--;)o=a[m],o.options.stacking&&(o.isDirty=!0);ci(a,function(e){e.isDirty&&"point"===e.options.legendType&&(d=!0)}),d&&c.options.enabled&&(c.render(),s.isDirtyLegend=!1),i&&s.getStacks(),u&&(s.isResizing||(s.maxTicks=null,ci(r,function(e){e.setScale()})),s.adjustTickAmounts()),s.getMargins(),u&&(ci(r,function(e){e.isDirty&&(h=!0)}),ci(r,function(e){e.isDirtyExtremes&&(e.isDirtyExtremes=!1,v.push(function(){fi(e,"afterSetExtremes",t(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(h||i)&&e.redraw()})),h&&s.drawChartBox(),ci(a,function(e){e.isDirty&&e.visible&&(!e.isCartesian||e.xAxis)&&e.redraw()}),l&&l.reset(!0),f.draw(),fi(s,"redraw"),g&&s.cloneRenderTo(!0),ci(v,function(e){e.call()})},get:function(e){var t,i,n,o=this,s=o.axes,r=o.series;for(t=0;t<s.length;t++)if(s[t].options.id===e)return s[t];for(t=0;t<r.length;t++)if(r[t].options.id===e)return r[t];for(t=0;t<r.length;t++)for(n=r[t].points||[],i=0;i<n.length;i++)if(n[i].id===e)return n[i];return null},getAxes:function(){var e,t,i=this,n=this.options,o=n.xAxis=p(n.xAxis||{}),s=n.yAxis=p(n.yAxis||{});ci(o,function(e,t){e.index=t,e.isX=!0}),ci(s,function(e,t){e.index=t}),e=o.concat(s),ci(e,function(e){t=new F(i,e)}),i.adjustTickAmounts()},getSelectedPoints:function(){var e=[];return ci(this.series,function(t){e=e.concat(di(t.points||[],function(e){return e.selected}))}),e},getSelectedSeries:function(){return di(this.series,function(e){return e.selected})},getStacks:function(){var e=this;ci(e.yAxis,function(e){e.stacks&&e.hasVisibleSeries&&(e.oldStacks=e.stacks)}),ci(e.series,function(t){!t.options.stacking||t.visible!==!0&&e.options.chart.ignoreHiddenSeries!==!1||(t.stackKey=t.type+m(t.options.stack,""))})},setTitle:function(e,t,n){var o,s,r=this,a=r.options;o=a.title=i(a.title,e),s=a.subtitle=i(a.subtitle,t),ci([["title",e,o],["subtitle",t,s]],function(e){var t=e[0],i=r[t],n=e[1],o=e[2];i&&n&&(r[t]=i=i.destroy()),o&&o.text&&!i&&(r[t]=r.renderer.text(o.text,0,0,o.useHTML).attr({align:o.align,"class":$t+t,zIndex:o.zIndex||4}).css(o.style).add())}),r.layOutTitles(n)},layOutTitles:function(e){var i,n=0,o=this.title,s=this.subtitle,r=this.options,a=r.title,l=r.subtitle,c=this.renderer,d=this.spacingBox.width-44;o&&(o.css({width:(a.width||d)+Yt}).align(t({y:c.fontMetrics(a.style.fontSize,o).b-3},a),!1,"spacingBox"),a.floating||a.verticalAlign||(n=o.getBBox().height)),s&&(s.css({width:(l.width||d)+Yt}).align(t({y:n+(a.margin-13)+c.fontMetrics(a.style.fontSize,s).b},l),!1,"spacingBox"),l.floating||l.verticalAlign||(n=gt(n+s.getBBox().height))),i=this.titleOffset!==n,this.titleOffset=n,!this.isDirtyBox&&i&&(this.isDirtyBox=i,this.hasRendered&&m(e,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this,t=e.options.chart,i=t.width,n=t.height,o=e.renderToClone||e.renderTo;u(i)||(e.containerWidth=ri(o,"width")),u(n)||(e.containerHeight=ri(o,"height")),e.chartWidth=vt(0,i||e.containerWidth||600),e.chartHeight=vt(0,m(n,e.containerHeight>19?e.containerHeight:400))},cloneRenderTo:function(e){var t=this.renderToClone,i=this.container;e?t&&(this.renderTo.appendChild(i),D(t),delete this.renderToClone):(i&&i.parentNode===this.renderTo&&this.renderTo.removeChild(i),this.renderToClone=t=this.renderTo.cloneNode(0),f(t,{position:zt,top:"-9999px",display:"block"}),t.style.setProperty&&t.style.setProperty("display","block","important"),ut.body.appendChild(t),i&&t.appendChild(i))},getContainer:function(){var e,i,s,r,a,l,c=this,d=c.options.chart,u="data-highcharts-chart";c.renderTo=r=d.renderTo,l=$t+Pt++,o(r)&&(c.renderTo=r=ut.getElementById(r)),r||X(13,!0),ut=r.ownerDocument,a=n(h(r,u)),!isNaN(a)&&Ht[a]&&Ht[a].hasRendered&&Ht[a].destroy(),h(r,u,c.index),r.innerHTML="",d.skipClone||r.offsetWidth||c.cloneRenderTo(),c.getChartSize(),i=c.chartWidth,s=c.chartHeight,c.container=e=g(jt,{className:$t+"container"+(d.className?" "+d.className:""),id:l},t({position:Gt,overflow:Wt,width:i+Yt,height:s+Yt,textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},d.style),c.renderToClone||r),c._cursor=e.style.cursor,c.renderer=d.forExport?new xi(e,i,s,d.style,!0):new U(e,i,s,d.style),Rt&&c.renderer.create(c,e,i,s)},getMargins:function(){var e,t=this,i=t.spacing,n=t.legend,o=t.margin,s=t.options.legend,r=m(s.margin,20),a=s.x,l=s.y,c=s.align,d=s.verticalAlign,h=t.titleOffset;t.resetMargins(),e=t.axisOffset,h&&!u(o[0])&&(t.plotTop=vt(t.plotTop,h+t.options.title.margin+i[0])),n.display&&!s.floating&&("right"===c?u(o[1])||(t.marginRight=vt(t.marginRight,n.legendWidth-a+r+i[1])):"left"===c?u(o[3])||(t.plotLeft=vt(t.plotLeft,n.legendWidth+a+r+i[3])):"top"===d?u(o[0])||(t.plotTop=vt(t.plotTop,n.legendHeight+l+r+i[0])):"bottom"===d&&(u(o[2])||(t.marginBottom=vt(t.marginBottom,n.legendHeight-l+r+i[2])))),t.extraBottomMargin&&(t.marginBottom+=t.extraBottomMargin),t.extraTopMargin&&(t.plotTop+=t.extraTopMargin),t.hasCartesianSeries&&ci(t.axes,function(e){e.getOffset()}),u(o[3])||(t.plotLeft+=e[3]),u(o[0])||(t.plotTop+=e[0]),u(o[2])||(t.marginBottom+=e[2]),u(o[1])||(t.marginRight+=e[1]),t.setChartSize()},reflow:function(e){var t=this,i=t.options.chart,n=t.renderTo,o=i.width||ri(n,"width"),s=i.height||ri(n,"height"),r=e?e.target:ht,a=function(){t.container&&(t.setSize(o,s,!1),t.hasUserSize=null)};t.hasUserSize||!o||!s||r!==ht&&r!==ut||((o!==t.containerWidth||s!==t.containerHeight)&&(clearTimeout(t.reflowTimeout),e?t.reflowTimeout=setTimeout(a,100):a()),t.containerWidth=o,t.containerHeight=s)},initReflow:function(){var e=this,t=function(t){e.reflow(t)};pi(ht,"resize",t),pi(e,"destroy",function(){mi(ht,"resize",t)})},setSize:function(e,t,i){var n,o,s,r=this;r.isResizing+=1,s=function(){r&&fi(r,"endResize",null,function(){r.isResizing-=1})},O(i,r),r.oldChartHeight=r.chartHeight,r.oldChartWidth=r.chartWidth,u(e)&&(r.chartWidth=n=vt(0,mt(e)),r.hasUserSize=!!n),u(t)&&(r.chartHeight=o=vt(0,mt(t))),($?vi:f)(r.container,{width:n+Yt,height:o+Yt},$),r.setChartSize(!0),r.renderer.setSize(n,o,i),r.maxTicks=null,ci(r.axes,function(e){e.isDirty=!0,e.setScale()}),ci(r.series,function(e){e.isDirty=!0}),r.isDirtyLegend=!0,r.isDirtyBox=!0,r.layOutTitles(),r.getMargins(),r.redraw(i),r.oldChartHeight=null,fi(r,"resize"),$===!1?s():setTimeout(s,$&&$.duration||500)},setChartSize:function(e){var t,i,n,o,s,r,a,l=this,c=l.inverted,d=l.renderer,u=l.chartWidth,h=l.chartHeight,p=l.options.chart,m=l.spacing,f=l.clipOffset;l.plotLeft=n=mt(l.plotLeft),l.plotTop=o=mt(l.plotTop),l.plotWidth=s=vt(0,mt(u-n-l.marginRight)),l.plotHeight=r=vt(0,mt(h-o-l.marginBottom)),l.plotSizeX=c?r:s,l.plotSizeY=c?s:r,l.plotBorderWidth=p.plotBorderWidth||0,l.spacingBox=d.spacingBox={x:m[3],y:m[0],width:u-m[3]-m[1],height:h-m[0]-m[2]},l.plotBox=d.plotBox={x:n,y:o,width:s,height:r},a=2*ft(l.plotBorderWidth/2),t=gt(vt(a,f[3])/2),i=gt(vt(a,f[0])/2),l.clipBox={x:t,y:i,width:ft(l.plotSizeX-vt(a,f[1])/2-t),height:vt(0,ft(l.plotSizeY-vt(a,f[2])/2-i))},e||ci(l.axes,function(e){e.setAxisSize(),e.setAxisTranslation()})},resetMargins:function(){var e=this,t=e.spacing,i=e.margin;e.plotTop=m(i[0],t[0]),e.marginRight=m(i[1],t[1]),e.marginBottom=m(i[2],t[2]),e.plotLeft=m(i[3],t[3]),e.axisOffset=[0,0,0,0],e.clipOffset=[0,0,0,0]},drawChartBox:function(){var e,t,i=this,n=i.options.chart,o=i.renderer,s=i.chartWidth,r=i.chartHeight,a=i.chartBackground,l=i.plotBackground,c=i.plotBorder,d=i.plotBGImage,u=n.borderWidth||0,h=n.backgroundColor,p=n.plotBackgroundColor,m=n.plotBackgroundImage,f=n.plotBorderWidth||0,g=i.plotLeft,v=i.plotTop,_=i.plotWidth,b=i.plotHeight,y=i.plotBox,T=i.clipRect,S=i.clipBox;e=u+(n.shadow?8:0),(u||h)&&(a?a.animate(a.crisp({width:s-e,height:r-e})):(t={fill:h||Xt},u&&(t.stroke=n.borderColor,t["stroke-width"]=u),i.chartBackground=o.rect(e/2,e/2,s-e,r-e,n.borderRadius,u).attr(t).addClass($t+"background").add().shadow(n.shadow))),p&&(l?l.animate(y):i.plotBackground=o.rect(g,v,_,b,0).attr({fill:p}).add().shadow(n.plotShadow)),m&&(d?d.animate(y):i.plotBGImage=o.image(m,g,v,_,b).add()),T?T.animate({width:S.width,height:S.height}):i.clipRect=o.clipRect(S),f&&(c?c.animate(c.crisp({x:g,y:v,width:_,height:b})):i.plotBorder=o.rect(g,v,_,b,0,-f).attr({stroke:n.plotBorderColor,"stroke-width":f,fill:Xt,zIndex:1}).add()),i.isDirtyBox=!1},propFromSeries:function(){var e,t,i,n=this,o=n.options.chart,s=n.options.series;ci(["inverted","angular","polar"],function(r){for(e=ni[o.type||o.defaultSeriesType],i=n[r]||o[r]||e&&e.prototype[r],t=s&&s.length;!i&&t--;)e=ni[s[t].type],e&&e.prototype[r]&&(i=!0);n[r]=i})},linkSeries:function(){var e=this,t=e.series;ci(t,function(e){e.linkedSeries.length=0}),ci(t,function(t){var i=t.options.linkedTo;o(i)&&(i=":previous"===i?e.series[t.index-1]:e.get(i),i&&(i.linkedSeries.push(t),t.linkedParent=i))})},renderSeries:function(){ci(this.series,function(e){e.translate(),e.setTooltipPoints&&e.setTooltipPoints(),e.render()})},renderLabels:function(){var e=this,i=e.options.labels;i.items&&ci(i.items,function(o){var s=t(i.style,o.style),r=n(s.left)+e.plotLeft,a=n(s.top)+e.plotTop+12;delete s.left,delete s.top,e.renderer.text(o.html,r,a).attr({zIndex:2}).css(s).add()})},render:function(){var e=this,t=e.axes,i=e.renderer,n=e.options;e.setTitle(),e.legend=new Bi(e,n.legend),e.getStacks(),ci(t,function(e){e.setScale()}),e.getMargins(),e.maxTicks=null,ci(t,function(e){e.setTickPositions(!0),e.setMaxTicks()}),e.adjustTickAmounts(),e.getMargins(),e.drawChartBox(),e.hasCartesianSeries&&ci(t,function(e){e.render()}),e.seriesGroup||(e.seriesGroup=i.g("series-group").attr({zIndex:3}).add()),e.renderSeries(),e.renderLabels(),e.showCredits(n.credits),e.hasRendered=!0},showCredits:function(e){e.enabled&&!this.credits&&(this.credits=this.renderer.text(e.text,0,0).on("click",function(){e.href&&(location.href=e.href)}).attr({align:e.position.align,zIndex:8}).css(e.style).add().align(e.position))},destroy:function(){var e,t=this,i=t.axes,n=t.series,o=t.container,s=o&&o.parentNode;for(fi(t,"destroy"),Ht[t.index]=V,Bt--,t.renderTo.removeAttribute("data-highcharts-chart"),mi(t),e=i.length;e--;)i[e]=i[e].destroy();for(e=n.length;e--;)n[e]=n[e].destroy();ci(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","scroller","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(e){var i=t[e];i&&i.destroy&&(t[e]=i.destroy())}),o&&(o.innerHTML="",mi(o),s&&D(o));for(e in t)delete t[e]},isReadyToRender:function(){var e=this;return!Lt&&ht==ht.top&&"complete"!==ut.readyState||Rt&&!ht.canvg?(Rt?Oi.push(function(){e.firstRender()},e.options.global.canvasToolsURL):ut.attachEvent("onreadystatechange",function(){ut.detachEvent("onreadystatechange",e.firstRender),"complete"===ut.readyState&&e.firstRender()}),!1):!0},firstRender:function(){var e=this,t=e.options,i=e.callback;e.isReadyToRender()&&(e.getContainer(),fi(e,"init"),e.resetMargins(),e.setChartSize(),e.propFromSeries(),e.getAxes(),ci(t.series||[],function(t){e.initSeries(t)}),e.linkSeries(),fi(e,"beforeRender"),dt.Pointer&&(e.pointer=new Ri(e,t)),e.render(),e.renderer.draw(),i&&i.apply(e,[e]),ci(e.callbacks,function(t){t.apply(e,[e])}),e.cloneRenderTo(!0),fi(e,"load"))},splashArray:function(e,t){var i=t[e],n=s(i)?i:[i,i,i,i];return[m(t[e+"Top"],n[0]),m(t[e+"Right"],n[1]),m(t[e+"Bottom"],n[2]),m(t[e+"Left"],n[3])]}},H.prototype.callbacks=[];var Ui=dt.CenteredSeriesMixin={getCenter:function(){var e,t,i=this.options,o=this.chart,s=2*(i.slicedOffset||0),r=o.plotWidth-2*s,a=o.plotHeight-2*s,l=i.center,c=[m(l[0],"50%"),m(l[1],"50%"),i.size||"100%",i.innerSize||0],d=_t(r,a);return hi(c,function(i,o){return t=/%$/.test(i),e=2>o||2===o&&t,(t?[r,a,d,d][o]*n(i)/100:i)+(e?s:0)})}},ji=function(){};ji.prototype={init:function(e,t,i){var n,o=this;return o.series=e,o.applyOptions(t,i),o.pointAttr={},e.options.colorByPoint&&(n=e.options.colors||e.chart.options.colors,o.color=o.color||n[e.colorCounter++],e.colorCounter===n.length&&(e.colorCounter=0)),e.chart.pointCount++,o},applyOptions:function(e,i){var n=this,o=n.series,s=o.options.pointValKey||o.pointValKey;return e=ji.prototype.optionsToObject.call(this,e),t(n,e),n.options=n.options?t(n.options,e):e,s&&(n.y=n[s]),n.x===V&&o&&(n.x=i===V?o.autoIncrement():i),n},optionsToObject:function(e){var t,i={},n=this.series,o=n.pointArrayMap||["y"],s=o.length,a=0,l=0;if("number"==typeof e||null===e)i[o[0]]=e;else if(r(e))for(e.length>s&&(t=typeof e[0],"string"===t?i.name=e[0]:"number"===t&&(i.x=e[0]),a++);s>l;)i[o[l++]]=e[a++];else"object"==typeof e&&(i=e,e.dataLabels&&(n._hasPointLabels=!0),e.marker&&(n._hasPointMarkers=!0));return i},destroy:function(){var e,t=this,i=t.series,n=i.chart,o=n.hoverPoints;n.pointCount--,o&&(t.setState(),d(o,t),o.length||(n.hoverPoints=null)),t===n.hoverPoint&&t.onMouseOut(),(t.graphic||t.dataLabel)&&(mi(t),t.destroyElements()),t.legendItem&&n.legend.destroyItem(t);for(e in t)t[e]=null},destroyElements:function(){for(var e,t=this,i=["graphic","dataLabel","dataLabelUpper","group","connector","shadowGroup"],n=6;n--;)e=i[n],t[e]&&(t[e]=t[e].destroy())},getLabelConfig:function(){var e=this;return{x:e.category,y:e.y,key:e.name||e.category,series:e.series,point:e,percentage:e.percentage,total:e.total||e.stackTotal}},tooltipFormatter:function(e){var t=this.series,i=t.tooltipOptions,n=m(i.valueDecimals,""),o=i.valuePrefix||"",s=i.valueSuffix||"";return ci(t.pointArrayMap||["y"],function(t){t="{point."+t,(o||s)&&(e=e.replace(t+"}",o+t+"}"+s)),e=e.replace(t+"}",t+":,."+n+"f}")}),S(e,{point:this,series:this.series})},firePointEvent:function(e,t,i){var n=this,o=this.series,s=o.options;(s.point.events[e]||n.options&&n.options.events&&n.options.events[e])&&this.importEvents(),"click"===e&&s.allowPointSelect&&(i=function(e){n.select(null,e.ctrlKey||e.metaKey||e.shiftKey)}),fi(this,e,t,i)}};var zi=function(){};zi.prototype={isCartesian:!0,type:"line",pointClass:ji,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(e,i){var n,o,s=this,r=e.series,a=function(e,t){return m(e.options.index,e._i)-m(t.options.index,t._i)};s.chart=e,s.options=i=s.setOptions(i),s.linkedSeries=[],s.bindAxes(),t(s,{name:i.name,state:Zt,pointAttr:{},visible:i.visible!==!1,selected:i.selected===!0}),Rt&&(i.animation=!1),o=i.events;for(n in o)pi(s,n,o[n]);(o&&o.click||i.point&&i.point.events&&i.point.events.click||i.allowPointSelect)&&(e.runTrackerClick=!0),s.getColor(),s.getSymbol(),ci(s.parallelArrays,function(e){s[e+"Data"]=[]}),s.setData(i.data,!1),s.isCartesian&&(e.hasCartesianSeries=!0),r.push(s),s._i=r.length-1,E(r,a),this.yAxis&&E(this.yAxis.series,a),ci(r,function(e,t){e.index=t,e.name=e.name||"Series "+(t+1)})},bindAxes:function(){var e,t=this,i=t.options,n=t.chart;ci(t.axisTypes||[],function(o){ci(n[o],function(n){e=n.options,(i[o]===e.index||i[o]!==V&&i[o]===e.id||i[o]===V&&0===e.index)&&(n.series.push(t),t[o]=n,n.isDirty=!0)}),t[o]||t.optionalAxis===o||X(18,!0)})},updateParallelArrays:function(e,t){var i=e.series,n=arguments,o="number"==typeof t?function(n){var o="y"===n&&i.toYData?i.toYData(e):e[n];i[n+"Data"][t]=o}:function(e){Array.prototype[t].apply(i[e+"Data"],Array.prototype.slice.call(n,2))};ci(i.parallelArrays,o)},autoIncrement:function(){var e=this,t=e.options,i=e.xIncrement;return i=m(i,t.pointStart,0),e.pointInterval=m(e.pointInterval,t.pointInterval,1),e.xIncrement=i+e.pointInterval,i},getSegments:function(){var e,t=this,i=-1,n=[],o=t.points,s=o.length;if(s)if(t.options.connectNulls){for(e=s;e--;)null===o[e].y&&o.splice(e,1);o.length&&(n=[o])}else ci(o,function(e,t){null===e.y?(t>i+1&&n.push(o.slice(i+1,t)),i=t):t===s-1&&n.push(o.slice(i+1,t+1))});t.segments=n},setOptions:function(e){var t,n=this.chart,o=n.options,s=o.plotOptions,r=n.userOptions||{},a=r.plotOptions||{},l=s[this.type];return this.userOptions=e,t=i(l,s.series,e),this.tooltipOptions=i(G.tooltip,G.plotOptions[this.type].tooltip,r.tooltip,a.series&&a.series.tooltip,a[this.type]&&a[this.type].tooltip,e.tooltip),null===l.marker&&delete t.marker,t},getCyclic:function(e,t,i){var n,o=this.userOptions,s="_"+e+"Index",r=e+"Counter";t||(u(o[s])?n=o[s]:(o[s]=n=this.chart[r]%i.length,this.chart[r]+=1),t=i[n]),this[e]=t},getColor:function(){this.options.colorByPoint||this.getCyclic("color",this.options.color||yi[this.type].color,this.chart.options.colors)},getSymbol:function(){var e=this.options.marker;this.getCyclic("symbol",e.symbol,this.chart.options.symbols),/^url/.test(this.symbol)&&(e.radius=0)},drawLegendSymbol:Vi.drawLineMarker,setData:function(e,t,i,n){var s,l,c,d=this,u=d.points,h=u&&u.length||0,p=d.options,f=d.chart,g=null,v=d.xAxis,_=v&&!!v.categories,b=d.tooltipPoints,y=p.turboThreshold,T=this.xData,S=this.yData,A=d.pointArrayMap,C=A&&A.length;if(e=e||[],s=e.length,t=m(t,!0),n===!1||!s||h!==s||d.cropped||d.hasGroupedData){if(d.xIncrement=null,d.pointRange=_?1:p.pointRange,d.colorCounter=0,ci(this.parallelArrays,function(e){d[e+"Data"].length=0}),y&&s>y){for(l=0;null===g&&s>l;)g=e[l],l++;if(a(g)){var E=m(p.pointStart,0),x=m(p.pointInterval,1);for(l=0;s>l;l++)T[l]=E,S[l]=e[l],E+=x;d.xIncrement=E}else if(r(g))if(C)for(l=0;s>l;l++)c=e[l],T[l]=c[0],S[l]=c.slice(1,C+1);else for(l=0;s>l;l++)c=e[l],T[l]=c[0],S[l]=c[1];else X(12)}else for(l=0;s>l;l++)e[l]!==V&&(c={series:d},d.pointClass.prototype.applyOptions.apply(c,[e[l]]),d.updateParallelArrays(c,l),_&&c.name&&(v.names[c.x]=c.name));for(o(S[0])&&X(14,!0),d.data=[],d.options.data=e,l=h;l--;)u[l]&&u[l].destroy&&u[l].destroy();b&&(b.length=0),v&&(v.minRange=v.userMinRange),d.isDirty=d.isDirtyData=f.isDirtyBox=!0,i=!1}else ci(e,function(e,t){u[t].update(e,!1)});t&&f.redraw(i)},processData:function(e){var t,i,n,o,s,r,a,l,c=this,d=c.xData,u=c.yData,h=d.length,p=0,m=c.xAxis,f=c.options,g=f.cropThreshold,v=0,_=c.isCartesian;if(_&&!c.isDirty&&!m.isDirty&&!c.yAxis.isDirty&&!e)return!1;for(_&&c.sorted&&(!g||h>g||c.forceCrop)&&(r=m.getExtremes(),a=r.min,l=r.max,d[h-1]<a||d[0]>l?(d=[],u=[]):(d[0]<a||d[h-1]>l)&&(t=this.cropData(c.xData,c.yData,a,l),d=t.xData,u=t.yData,p=t.start,i=!0,v=d.length)),s=d.length-1;s>=0;s--)n=d[s]-d[s-1],!i&&d[s]>a&&d[s]<l&&v++,n>0&&(o===V||o>n)?o=n:0>n&&c.requireSorting&&X(15);c.cropped=i,c.cropStart=p,c.processedXData=d,c.processedYData=u,c.activePointCount=v,null===f.pointRange&&(c.pointRange=o||1),c.closestPointRange=o},cropData:function(e,t,i,n){var o,s=e.length,r=0,a=s,l=m(this.cropShoulder,1);for(o=0;s>o;o++)if(e[o]>=i){r=vt(0,o-l);break}for(;s>o;o++)if(e[o]>n){a=o+l;break}return{xData:e.slice(r,a),yData:t.slice(r,a),start:r,end:a}},generatePoints:function(){var e,t,i,n,o=this,s=o.options,r=s.data,a=o.data,l=o.processedXData,c=o.processedYData,d=o.pointClass,u=l.length,h=o.cropStart||0,m=o.hasGroupedData,f=[];if(!a&&!m){var g=[];g.length=r.length,a=o.data=g}for(n=0;u>n;n++)t=h+n,m?f[n]=(new d).init(o,[l[n]].concat(p(c[n]))):(a[t]?i=a[t]:r[t]!==V&&(a[t]=i=(new d).init(o,r[t],l[n])),f[n]=i);if(a&&(u!==(e=a.length)||m))for(n=0;e>n;n++)n!==h||m||(n+=u),a[n]&&(a[n].destroyElements(),a[n].plotX=V);o.data=a,o.points=f},getExtremes:function(e){var t,i,n,o,s,r,a,l,c,d=this.xAxis,u=this.yAxis,h=this.processedXData,p=[],f=0,g=d.getExtremes(),v=g.min,_=g.max;for(e=e||this.stackedYData||this.processedYData,t=e.length,l=0;t>l;l++)if(r=h[l],a=e[l],i=null!==a&&a!==V&&(!u.isLog||a.length||a>0),n=this.getExtremesFromAll||this.cropped||(h[l+1]||r)>=v&&(h[l-1]||r)<=_,i&&n)if(c=a.length)for(;c--;)null!==a[c]&&(p[f++]=a[c]);else p[f++]=a;this.dataMin=m(o,x(p)),this.dataMax=m(s,M(p))},translate:function(){this.processedXData||this.processData(),this.generatePoints();var e,t=this,i=t.options,n=i.stacking,o=t.xAxis,s=o.categories,r=t.yAxis,l=t.points,c=l.length,d=!!t.modifyValue,h=i.pointPlacement,p="between"===h||a(h),f=i.threshold;for(e=0;c>e;e++){var g,v,_=l[e],b=_.x,y=_.y,T=_.low,S=n&&r.stacks[(t.negStacks&&f>y?"-":"")+t.stackKey];r.isLog&&0>=y&&(_.y=y=null),_.plotX=o.translate(b,0,0,0,1,h,"flags"===this.type),n&&t.visible&&S&&S[b]&&(g=S[b],v=g.points[t.index+","+e],T=v[0],y=v[1],0===T&&(T=m(f,r.min)),r.isLog&&0>=T&&(T=null),_.total=_.stackTotal=g.total,_.percentage=g.total&&_.y/g.total*100,_.stackY=y,g.setOffset(t.pointXOffset||0,t.barW||0)),_.yBottom=u(T)?r.translate(T,0,1,0,1):null,d&&(y=t.modifyValue(y,_)),_.plotY="number"==typeof y&&1/0!==y?r.translate(y,0,1,0,1):V,_.clientX=p?o.translate(b,0,0,0,1):_.plotX,_.negative=_.y<(f||0),_.category=s&&s[_.x]!==V?s[_.x]:_.x}t.getSegments()},animate:function(e){var i,n,o,r=this,a=r.chart,l=a.renderer,c=r.options.animation,d=r.clipBox||a.clipBox,u=a.inverted;c&&!s(c)&&(c=yi[r.type].animation),o=["_sharedClip",c.duration,c.easing,d.height].join(","),e?(i=a[o],n=a[o+"m"],i||(a[o]=i=l.clipRect(t(d,{width:0})),a[o+"m"]=n=l.clipRect(-99,u?-a.plotLeft:-a.plotTop,99,u?a.chartWidth:a.chartHeight)),r.group.clip(i),r.markerGroup.clip(n),r.sharedClipKey=o):(i=a[o],i&&i.animate({width:a.plotSizeX},c),a[o+"m"]&&a[o+"m"].animate({width:a.plotSizeX+99},c),r.animate=null)},afterAnimate:function(){var e=this.chart,t=this.sharedClipKey,i=this.group,n=this.clipBox;i&&this.options.clip!==!1&&(t&&n||i.clip(n?e.renderer.clipRect(n):e.clipRect),this.markerGroup.clip()),fi(this,"afterAnimate"),setTimeout(function(){t&&e[t]&&(n||(e[t]=e[t].destroy()),e[t+"m"]&&(e[t+"m"]=e[t+"m"].destroy()))},100)},drawPoints:function(){var e,i,n,o,s,r,a,l,c,d,u,h,p=this,f=p.points,g=p.chart,v=p.options,_=v.marker,b=p.pointAttr[""],y=p.markerGroup,T=m(_.enabled,p.activePointCount<.5*p.xAxis.len/_.radius);if(_.enabled!==!1||p._hasPointMarkers)for(o=f.length;o--;)s=f[o],i=ft(s.plotX),n=s.plotY,c=s.graphic,d=s.marker||{},u=T&&d.enabled===V||d.enabled,h=g.isInsidePlot(mt(i),n,g.inverted),u&&n!==V&&!isNaN(n)&&null!==s.y?(e=s.pointAttr[s.selected?ti:Zt]||b,r=e.r,a=m(d.symbol,p.symbol),l=0===a.indexOf("url"),c?c[h?"show":"hide"](!0).animate(t({x:i-r,y:n-r},c.symbolName?{width:2*r,height:2*r}:{})):h&&(r>0||l)&&(s.graphic=c=g.renderer.symbol(a,i-r,n-r,2*r,2*r).attr(e).add(y))):c&&(s.graphic=c.destroy())},convertAttribs:function(e,t,i,n){var o,s,r=this.pointAttrToOptions,a={};e=e||{},t=t||{},i=i||{},n=n||{};for(o in r)s=r[o],a[o]=m(e[s],t[o],i[o],n[o]);return a},getAttribs:function(){var e,i,n,o,s,r,a=this,l=a.options,c=yi[a.type].marker?l.marker:l,d=c.states,h=d[ei],p=a.color,m={stroke:p,fill:p},f=a.points||[],g=[],v=a.pointAttrToOptions,_=a.hasPointSpecificOptions,b=l.negativeColor,y=c.lineColor,T=c.fillColor,S=l.turboThreshold;if(l.marker?(h.radius=h.radius||c.radius+h.radiusPlus,h.lineWidth=h.lineWidth||c.lineWidth+h.lineWidthPlus):h.color=h.color||Ei(h.color||p).brighten(h.brightness).get(),g[Zt]=a.convertAttribs(c,m),ci([ei,ti],function(e){g[e]=a.convertAttribs(d[e],g[Zt])}),a.pointAttr=g,i=f.length,!S||S>i||_)for(;i--;){if(n=f[i],c=n.options&&n.options.marker||n.options,c&&c.enabled===!1&&(c.radius=0),n.negative&&b&&(n.color=n.fillColor=b),_=l.colorByPoint||n.color,n.options)for(r in v)u(c[v[r]])&&(_=!0);_?(c=c||{},o=[],d=c.states||{},e=d[ei]=d[ei]||{},l.marker||(e.color=e.color||!n.options.color&&h.color||Ei(n.color).brighten(e.brightness||h.brightness).get()),s={color:n.color},T||(s.fillColor=n.color),y||(s.lineColor=n.color),o[Zt]=a.convertAttribs(t(s,c),g[Zt]),o[ei]=a.convertAttribs(d[ei],g[ei],o[Zt]),o[ti]=a.convertAttribs(d[ti],g[ti],o[Zt])):o=g,n.pointAttr=o}},destroy:function(){var e,t,i,n,o,s=this,r=s.chart,a=/AppleWebKit\/533/.test(Ct),l=s.data||[];for(fi(s,"destroy"),mi(s),ci(s.axisTypes||[],function(e){o=s[e],o&&(d(o.series,s),o.isDirty=o.forceRedraw=!0)}),s.legendItem&&s.chart.legend.destroyItem(s),t=l.length;t--;)i=l[t],i&&i.destroy&&i.destroy();s.points=null,clearTimeout(s.animationTimeout),ci(["area","graph","dataLabelsGroup","group","markerGroup","tracker","graphNeg","areaNeg","posClip","negClip"],function(t){s[t]&&(e=a&&"group"===t?"hide":"destroy",s[t][e]())}),r.hoverSeries===s&&(r.hoverSeries=null),d(r.series,s);for(n in s)delete s[n]},getSegmentPath:function(e){var t=this,i=[],n=t.options.step;return ci(e,function(o,s){var r,a=o.plotX,l=o.plotY;t.getPointSpline?i.push.apply(i,t.getPointSpline(e,o,s)):(i.push(s?Qt:Kt),n&&s&&(r=e[s-1],"right"===n?i.push(r.plotX,l):"center"===n?i.push((r.plotX+a)/2,r.plotY,(r.plotX+a)/2,l):i.push(a,r.plotY)),i.push(o.plotX,o.plotY))
}),i},getGraphPath:function(){var e,t=this,i=[],n=[];return ci(t.segments,function(o){e=t.getSegmentPath(o),o.length>1?i=i.concat(e):n.push(o[0])}),t.singlePoints=n,t.graphPath=i,i},drawGraph:function(){var e=this,t=this.options,i=[["graph",t.lineColor||this.color]],n=t.lineWidth,o=t.dashStyle,s="square"!==t.linecap,r=this.getGraphPath(),a=t.negativeColor;a&&i.push(["graphNeg",a]),ci(i,function(i,a){var l,c=i[0],d=e[c];d?(_i(d),d.animate({d:r})):n&&r.length&&(l={stroke:i[1],"stroke-width":n,fill:Xt,zIndex:1},o?l.dashstyle=o:s&&(l["stroke-linecap"]=l["stroke-linejoin"]="round"),e[c]=e.chart.renderer.path(r).attr(l).add(e.group).shadow(!a&&t.shadow))})},clipNeg:function(){var e,t,i,n,o,s=this.options,r=this.chart,a=r.renderer,l=s.negativeColor||s.negativeFillColor,c=this.graph,d=this.area,u=this.posClip,h=this.negClip,p=r.chartWidth,m=r.chartHeight,f=vt(p,m),g=this.yAxis;l&&(c||d)&&(e=mt(g.toPixels(s.threshold||0,!0)),0>e&&(f-=e),n={x:0,y:0,width:f,height:e},o={x:0,y:e,width:f,height:f},r.inverted&&(n.height=o.y=r.plotWidth-e,a.isVML&&(n={x:r.plotWidth-e-r.plotLeft,y:0,width:p,height:m},o={x:e+r.plotLeft-p,y:0,width:r.plotLeft+e,height:p})),g.reversed?(t=o,i=n):(t=n,i=o),u?(u.animate(t),h.animate(i)):(this.posClip=u=a.clipRect(t),this.negClip=h=a.clipRect(i),c&&this.graphNeg&&(c.clip(u),this.graphNeg.clip(h)),d&&(d.clip(u),this.areaNeg.clip(h))))},invertGroups:function(){function e(){var e={width:t.yAxis.len,height:t.xAxis.len};ci(["group","markerGroup"],function(i){t[i]&&t[i].attr(e).invert()})}var t=this,i=t.chart;t.xAxis&&(pi(i,"resize",e),pi(t,"destroy",function(){mi(i,"resize",e)}),e(),t.invertGroups=e)},plotGroup:function(e,t,i,n,o){var s=this[e],r=!s;return r&&(this[e]=s=this.chart.renderer.g(t).attr({visibility:i,zIndex:n||.1}).add(o)),s[r?"attr":"animate"](this.getPlotBox()),s},getPlotBox:function(){var e=this.chart,t=this.xAxis,i=this.yAxis;return e.inverted&&(t=i,i=this.xAxis),{translateX:t?t.left:e.plotLeft,translateY:i?i.top:e.plotTop,scaleX:1,scaleY:1}},render:function(){var e,t=this,i=t.chart,n=t.options,o=n.animation,s=o&&!!t.animate&&i.renderer.isSVG&&m(o.duration,500)||0,r=t.visible?qt:Wt,a=n.zIndex,l=t.hasRendered,c=i.seriesGroup;e=t.plotGroup("group","series",r,a,c),t.markerGroup=t.plotGroup("markerGroup","markers",r,a,c),s&&t.animate(!0),t.getAttribs(),e.inverted=t.isCartesian?i.inverted:!1,t.drawGraph&&(t.drawGraph(),t.clipNeg()),t.drawDataLabels&&t.drawDataLabels(),t.visible&&t.drawPoints(),t.drawTracker&&t.options.enableMouseTracking!==!1&&t.drawTracker(),i.inverted&&t.invertGroups(),n.clip===!1||t.sharedClipKey||l||e.clip(i.clipRect),s&&t.animate(),l||(s?t.animationTimeout=setTimeout(function(){t.afterAnimate()},s):t.afterAnimate()),t.isDirty=t.isDirtyData=!1,t.hasRendered=!0},redraw:function(){var e=this,t=e.chart,i=e.isDirtyData,n=e.group,o=e.xAxis,s=e.yAxis;n&&(t.inverted&&n.attr({width:t.plotWidth,height:t.plotHeight}),n.animate({translateX:m(o&&o.left,t.plotLeft),translateY:m(s&&s.top,t.plotTop)})),e.translate(),e.setTooltipPoints&&e.setTooltipPoints(!0),e.render(),i&&fi(e,"updatedData")}},B.prototype={destroy:function(){w(this,this.axis)},render:function(e){var t=this.options,i=t.format,n=i?S(i,this):t.formatter.call(this);this.label?this.label.attr({text:n,visibility:Wt}):this.label=this.axis.chart.renderer.text(n,null,null,t.useHTML).css(t.style).attr({align:this.textAlign,rotation:t.rotation,visibility:Wt}).add(e)},setOffset:function(e,t){var i,n=this,o=n.axis,s=o.chart,r=s.inverted,a=this.isNegative,l=o.translate(o.usePercentage?100:this.total,0,0,0,1),c=o.translate(0),d=bt(l-c),u=s.xAxis[0].translate(this.x)+e,h=s.plotHeight,p={x:r?a?l:l-d:u,y:r?h-u-t:a?h-l-d:h-l,width:r?d:t,height:r?t:d},m=this.label;m&&(m.align(this.alignOptions,null,p),i=m.alignAttr,m[this.options.crop===!1||s.isInsidePlot(i.x,i.y)?"show":"hide"](!0))}},F.prototype.buildStacks=function(){var e=this.series,t=m(this.options.reversedStacks,!0),i=e.length;if(!this.isXAxis){for(this.usePercentage=!1;i--;)e[t?i:e.length-i-1].setStackedPoints();if(this.usePercentage)for(i=0;i<e.length;i++)e[i].setPercentStacks()}},F.prototype.renderStackTotals=function(){var e,t,i,n=this,o=n.chart,s=o.renderer,r=n.stacks,a=n.stackTotalGroup;a||(n.stackTotalGroup=a=s.g("stack-labels").attr({visibility:qt,zIndex:6}).add()),a.translate(o.plotLeft,o.plotTop);for(e in r){t=r[e];for(i in t)t[i].render(a)}},zi.prototype.setStackedPoints=function(){if(this.options.stacking&&(this.visible===!0||this.chart.options.chart.ignoreHiddenSeries===!1)){var e,t,i,n,o,s,r,a,l=this,c=l.processedXData,d=l.processedYData,u=[],h=d.length,p=l.options,m=p.threshold,f=p.stack,g=p.stacking,v=l.stackKey,_="-"+v,b=l.negStacks,y=l.yAxis,T=y.stacks,S=y.oldStacks;for(s=0;h>s;s++)r=c[s],a=d[s],o=l.index+","+s,e=b&&m>a,n=e?_:v,T[n]||(T[n]={}),T[n][r]||(S[n]&&S[n][r]?(T[n][r]=S[n][r],T[n][r].total=null):T[n][r]=new B(y,y.options.stackLabels,e,r,f)),t=T[n][r],t.points[o]=[t.cum||0],"percent"===g?(i=e?v:_,b&&T[i]&&T[i][r]?(i=T[i][r],t.total=i.total=vt(i.total,t.total)+bt(a)||0):t.total=I(t.total+(bt(a)||0))):t.total=I(t.total+(a||0)),t.cum=(t.cum||0)+(a||0),t.points[o].push(t.cum),u[s]=t.cum;"percent"===g&&(y.usePercentage=!0),this.stackedYData=u,y.oldStacks={}}},zi.prototype.setPercentStacks=function(){var e=this,t=e.stackKey,i=e.yAxis.stacks,n=e.processedXData;ci([t,"-"+t],function(t){for(var o,s,r,a,l=n.length;l--;)o=n[l],s=i[t]&&i[t][o],r=s&&s.points[e.index+","+l],r&&(a=s.total?100/s.total:0,r[0]=I(r[0]*a),r[1]=I(r[1]*a),e.stackedYData[l]=r[1])})},t(H.prototype,{addSeries:function(e,t,i){var n,o=this;return e&&(t=m(t,!0),fi(o,"addSeries",{options:e},function(){n=o.initSeries(e),o.isDirtyLegend=!0,o.linkSeries(),t&&o.redraw(i)})),n},addAxis:function(e,t,n,o){var s,r=t?"xAxis":"yAxis",a=this.options;s=new F(this,i(e,{index:this[r].length,isX:t})),a[r]=p(a[r]||{}),a[r].push(e),m(n,!0)&&this.redraw(o)},showLoading:function(e){var i=this,n=i.options,o=i.loadingDiv,s=n.loading,r=function(){o&&f(o,{left:i.plotLeft+Yt,top:i.plotTop+Yt,width:i.plotWidth+Yt,height:i.plotHeight+Yt})};o||(i.loadingDiv=o=g(jt,{className:$t+"loading"},t(s.style,{zIndex:10,display:Xt}),i.container),i.loadingSpan=g("span",null,s.labelStyle,o),pi(i,"redraw",r)),i.loadingSpan.innerHTML=e||n.lang.loading,i.loadingShown||(f(o,{opacity:0,display:""}),vi(o,{opacity:s.style.opacity},{duration:s.showDuration||0}),i.loadingShown=!0),r()},hideLoading:function(){var e=this.options,t=this.loadingDiv;t&&vi(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){f(t,{display:Xt})}}),this.loadingShown=!1}}),t(ji.prototype,{update:function(e,t,i){var n,o=this,r=o.series,a=o.graphic,l=r.data,c=r.chart,d=r.options;t=m(t,!0),o.firePointEvent("update",{options:e},function(){o.applyOptions(e),s(e)&&(r.getAttribs(),a&&(e&&e.marker&&e.marker.symbol?o.graphic=a.destroy():a.attr(o.pointAttr[o.state||""])),e&&e.dataLabels&&o.dataLabel&&(o.dataLabel=o.dataLabel.destroy())),n=li(o,l),r.updateParallelArrays(o,n),d.data[n]=o.options,r.isDirty=r.isDirtyData=!0,!r.fixedBox&&r.hasCartesianSeries&&(c.isDirtyBox=!0),"point"===d.legendType&&c.legend.destroyItem(o),t&&c.redraw(i)})},remove:function(e,t){var i,n=this,o=n.series,s=o.points,r=o.chart,a=o.data;O(t,r),e=m(e,!0),n.firePointEvent("remove",null,function(){i=li(n,a),a.length===s.length&&s.splice(i,1),a.splice(i,1),o.options.data.splice(i,1),o.updateParallelArrays(n,"splice",i,1),n.destroy(),o.isDirty=!0,o.isDirtyData=!0,e&&r.redraw()})}}),t(zi.prototype,{addPoint:function(e,t,i,n){var o,s,r,a,l=this,c=l.options,d=l.data,u=l.graph,h=l.area,p=l.chart,f=l.xAxis&&l.xAxis.names,g=u&&u.shift||0,v=c.data,_=l.xData;if(O(n,p),i&&ci([u,h,l.graphNeg,l.areaNeg],function(e){e&&(e.shift=g+1)}),h&&(h.isArea=!0),t=m(t,!0),o={series:l},l.pointClass.prototype.applyOptions.apply(o,[e]),r=o.x,a=_.length,l.requireSorting&&r<_[a-1])for(s=!0;a&&_[a-1]>r;)a--;l.updateParallelArrays(o,"splice",a,0,0),l.updateParallelArrays(o,a),f&&(f[r]=o.name),v.splice(a,0,e),s&&(l.data.splice(a,0,null),l.processData()),"point"===c.legendType&&l.generatePoints(),i&&(d[0]&&d[0].remove?d[0].remove(!1):(d.shift(),l.updateParallelArrays(o,"shift"),v.shift())),l.isDirty=!0,l.isDirtyData=!0,t&&(l.getAttribs(),p.redraw())},remove:function(e,t){var i=this,n=i.chart;e=m(e,!0),i.isRemoving||(i.isRemoving=!0,fi(i,"remove",null,function(){i.destroy(),n.isDirtyLegend=n.isDirtyBox=!0,n.linkSeries(),e&&n.redraw(t)})),i.isRemoving=!1},update:function(e,n){var o,s=this,r=this.chart,a=this.userOptions,l=this.type,c=ni[l].prototype,d=["group","markerGroup","dataLabelsGroup"];ci(d,function(e){d[e]=s[e],delete s[e]}),e=i(a,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},e),this.remove(!1);for(o in c)c.hasOwnProperty(o)&&(this[o]=V);t(this,ni[e.type||l].prototype),ci(d,function(e){s[e]=d[e]}),this.init(r,e),r.linkSeries(),m(n,!0)&&r.redraw(!1)}}),t(F.prototype,{update:function(e,n){var o=this.chart;e=o.options[this.coll][this.options.index]=i(this.userOptions,e),this.destroy(!0),this._addedPlotLB=V,this.init(o,t(e,{events:V})),o.isDirtyBox=!0,m(n,!0)&&o.redraw()},remove:function(e){for(var t=this.chart,i=this.coll,n=this.series,o=n.length;o--;)n[o]&&n[o].remove(!1);d(t.axes,this),d(t[i],this),t.options[i].splice(this.options.index,1),ci(t[i],function(e,t){e.options.index=t}),this.destroy(),t.isDirtyBox=!0,m(e,!0)&&t.redraw()},setTitle:function(e,t){this.update({title:e},t)},setCategories:function(e,t){this.update({categories:e},t)}});var Gi=v(zi);ni.line=Gi,yi.area=i(Ti,{threshold:0});var Wi=v(zi,{type:"area",getSegments:function(){var e,t,i,n,o=this,s=[],r=[],a=[],l=this.xAxis,c=this.yAxis,d=c.stacks[this.stackKey],u={},h=this.points,p=this.options.connectNulls;if(this.options.stacking&&!this.cropped){for(i=0;i<h.length;i++)u[h[i].x]=h[i];for(n in d)null!==d[n].total&&a.push(+n);a.sort(function(e,t){return e-t}),ci(a,function(n){var s,a=0;if(!p||u[n]&&null!==u[n].y)if(u[n])r.push(u[n]);else{for(i=o.index;i<=c.series.length;i++)if(s=d[n].points[i+","+n]){a=s[1];break}e=l.translate(n),t=c.toPixels(a,!0),r.push({y:null,plotX:e,clientX:e,plotY:t,yBottom:t,onMouseOver:Ft})}}),r.length&&s.push(r)}else zi.prototype.getSegments.call(this),s=this.segments;this.segments=s},getSegmentPath:function(e){var t,i,n=zi.prototype.getSegmentPath.call(this,e),o=[].concat(n),s=this.options,r=n.length,a=this.yAxis.getThreshold(s.threshold);if(3===r&&o.push(Qt,n[1],n[2]),s.stacking&&!this.closedStacks)for(t=e.length-1;t>=0;t--)i=m(e[t].yBottom,a),t<e.length-1&&s.step&&o.push(e[t+1].plotX,i),o.push(e[t].plotX,i);else this.closeSegment(o,e,a);return this.areaPath=this.areaPath.concat(o),n},closeSegment:function(e,t,i){e.push(Qt,t[t.length-1].plotX,i,Qt,t[0].plotX,i)},drawGraph:function(){this.areaPath=[],zi.prototype.drawGraph.apply(this);var e=this,t=this.areaPath,i=this.options,n=i.negativeColor,o=i.negativeFillColor,s=[["area",this.color,i.fillColor]];(n||o)&&s.push(["areaNeg",n,o]),ci(s,function(n){var o=n[0],s=e[o];s?s.animate({d:t}):e[o]=e.chart.renderer.path(t).attr({fill:m(n[2],Ei(n[1]).setOpacity(m(i.fillOpacity,.75)).get()),zIndex:0}).add(e.group)})},drawLegendSymbol:Vi.drawRectangle});ni.area=Wi,yi.spline=i(Ti);var $i=v(zi,{type:"spline",getPointSpline:function(e,t,i){var n,o,s,r,a,l=1.5,c=l+1,d=t.plotX,u=t.plotY,h=e[i-1],p=e[i+1];if(h&&p){var m,f=h.plotX,g=h.plotY,v=p.plotX,_=p.plotY;n=(l*d+f)/c,o=(l*u+g)/c,s=(l*d+v)/c,r=(l*u+_)/c,m=(r-o)*(s-d)/(s-n)+u-r,o+=m,r+=m,o>g&&o>u?(o=vt(g,u),r=2*u-o):g>o&&u>o&&(o=_t(g,u),r=2*u-o),r>_&&r>u?(r=vt(_,u),o=2*u-r):_>r&&u>r&&(r=_t(_,u),o=2*u-r),t.rightContX=s,t.rightContY=r}return i?(a=["C",h.rightContX||h.plotX,h.rightContY||h.plotY,n||d,o||u,d,u],h.rightContX=h.rightContY=null):a=[Kt,d,u],a}});ni.spline=$i,yi.areaspline=i(yi.area);var qi=Wi.prototype,Yi=v($i,{type:"areaspline",closedStacks:!0,getSegmentPath:qi.getSegmentPath,closeSegment:qi.closeSegment,drawGraph:qi.drawGraph,drawLegendSymbol:Vi.drawRectangle});ni.areaspline=Yi,yi.column=i(Ti,{borderColor:"#FFFFFF",borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1,halo:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,tooltip:{distance:6},threshold:0});var Xi=v(zi,{type:"column",pointAttrToOptions:{stroke:"borderColor",fill:"color",r:"borderRadius"},cropShoulder:0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){zi.prototype.init.apply(this,arguments);var e=this,t=e.chart;t.hasRendered&&ci(t.series,function(t){t.type===e.type&&(t.isDirty=!0)})},getColumnMetrics:function(){var e,t,i=this,n=i.options,o=i.xAxis,s=i.yAxis,r=o.reversed,a={},l=0;n.grouping===!1?l=1:ci(i.chart.series,function(n){var o=n.options,r=n.yAxis;n.type===i.type&&n.visible&&s.len===r.len&&s.pos===r.pos&&(o.stacking?(e=n.stackKey,a[e]===V&&(a[e]=l++),t=a[e]):o.grouping!==!1&&(t=l++),n.columnIndex=t)});var c=_t(bt(o.transA)*(o.ordinalSlope||n.pointRange||o.closestPointRange||o.tickInterval||1),o.len),d=c*n.groupPadding,h=c-2*d,p=h/l,f=n.pointWidth,g=u(f)?(p-f)/2:p*n.pointPadding,v=m(f,p-2*g),_=(r?l-(i.columnIndex||0):i.columnIndex)||0,b=g+(d+_*p-c/2)*(r?-1:1);return i.columnMetrics={width:v,offset:b}},translate:function(){var e=this,t=e.chart,i=e.options,n=e.borderWidth=m(i.borderWidth,e.activePointCount>.5*e.xAxis.len?0:1),o=e.yAxis,s=i.threshold,r=e.translatedThreshold=o.getThreshold(s),a=m(i.minPointLength,5),l=e.getColumnMetrics(),c=l.width,d=e.barW=vt(c,1+2*n),u=e.pointXOffset=l.offset,h=-(n%2?.5:0),p=n%2?.5:1;t.renderer.isVML&&t.inverted&&(p+=1),i.pointPadding&&(d=gt(d)),zi.prototype.translate.apply(e),ci(e.points,function(i){var n,s,l,f=m(i.yBottom,r),g=_t(vt(-999-f,i.plotY),o.len+999+f),v=i.plotX+u,_=d,b=_t(g,f),y=vt(g,f)-b;bt(y)<a&&a&&(y=a,b=mt(bt(b-r)>a?f-a:r-(o.translate(i.y,0,1,0,1)<=r?a:0))),i.barX=v,i.pointWidth=c,i.tooltipPos=t.inverted?[o.len-g,e.xAxis.len-v-_/2]:[v+_/2,g],n=mt(v+_)+h,v=mt(v)+h,_=n-v,l=bt(b)<.5,s=mt(b+y)+p,b=mt(b)+p,y=s-b,l&&(b-=1,y+=1),i.shapeType="rect",i.shapeArgs={x:v,y:b,width:_,height:y}})},getSymbol:Ft,drawLegendSymbol:Vi.drawRectangle,drawGraph:Ft,drawPoints:function(){var e,t,n=this,o=this.chart,s=n.options,r=o.renderer,a=s.animationLimit||250;ci(n.points,function(l){var c,d=l.plotY,h=l.graphic;d===V||isNaN(d)||null===l.y?h&&(l.graphic=h.destroy()):(e=l.shapeArgs,c=u(n.borderWidth)?{"stroke-width":n.borderWidth}:{},t=l.pointAttr[l.selected?ti:Zt]||n.pointAttr[Zt],h?(_i(h),h.attr(c)[o.pointCount<a?"animate":"attr"](i(e))):l.graphic=h=r[l.shapeType](e).attr(t).attr(c).add(n.group).shadow(s.shadow,null,s.stacking&&!s.borderRadius))})},animate:function(e){var t,i=this,n=this.yAxis,o=i.options,s=this.chart.inverted,r={};Lt&&(e?(r.scaleY=.001,t=_t(n.pos+n.len,vt(n.pos,n.toPixels(o.threshold))),s?r.translateX=t-n.len:r.translateY=t,i.group.attr(r)):(r.scaleY=1,r[s?"translateX":"translateY"]=n.pos,i.group.animate(r,i.options.animation),i.animate=null))},remove:function(){var e=this,t=e.chart;t.hasRendered&&ci(t.series,function(t){t.type===e.type&&(t.isDirty=!0)}),zi.prototype.remove.apply(e,arguments)}});ni.column=Xi,yi.bar=i(yi.column);var Ki=v(Xi,{type:"bar",inverted:!0});ni.bar=Ki,yi.scatter=i(Ti,{lineWidth:0,tooltip:{headerFormat:'<span style="color:{series.color}">●</span> <span style="font-size: 10px;"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"},stickyTracking:!1});var Qi=v(zi,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,singularTooltips:!0,drawGraph:function(){this.options.lineWidth&&zi.prototype.drawGraph.call(this)}});ni.scatter=Qi,yi.pie=i(Ti,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});var Ji=v(ji,{init:function(){ji.prototype.init.apply(this,arguments);var e,i=this;return i.y<0&&(i.y=null),t(i,{visible:i.visible!==!1,name:m(i.name,"Slice")}),e=function(e){i.slice("select"===e.type)},pi(i,"select",e),pi(i,"unselect",e),i},setVisible:function(e){var t=this,i=t.series,n=i.chart;t.visible=t.options.visible=e=e===V?!t.visible:e,i.options.data[li(t,i.data)]=t.options,ci(["graphic","dataLabel","connector","shadowGroup"],function(i){t[i]&&t[i][e?"show":"hide"](!0)}),t.legendItem&&n.legend.colorizeItem(t,e),!i.isDirty&&i.options.ignoreHiddenPoint&&(i.isDirty=!0,n.redraw())},slice:function(e,t,i){var n,o=this,s=o.series,r=s.chart;O(i,r),t=m(t,!0),o.sliced=o.options.sliced=e=u(e)?e:!o.sliced,s.options.data[li(o,s.data)]=o.options,n=e?o.slicedTranslation:{translateX:0,translateY:0},o.graphic.animate(n),o.shadowGroup&&o.shadowGroup.animate(n)},haloPath:function(e){var t=this.shapeArgs,i=this.series.chart;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(i.plotLeft+t.x,i.plotTop+t.y,t.r+e,t.r+e,{innerR:this.shapeArgs.r,start:t.start,end:t.end})}}),Zi={type:"pie",isCartesian:!1,pointClass:Ji,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},singularTooltips:!0,getColor:Ft,animate:function(e){var t=this,i=t.points,n=t.startAngleRad;e||(ci(i,function(e){var i=e.graphic,o=e.shapeArgs;i&&(i.attr({r:t.center[3]/2,start:n,end:n}),i.animate({r:o.r,start:o.start,end:o.end},t.options.animation))}),t.animate=null)},setData:function(e,t,i,n){zi.prototype.setData.call(this,e,!1,i,n),this.processData(),this.generatePoints(),m(t,!0)&&this.chart.redraw(i)},generatePoints:function(){var e,t,i,n,o=0,s=this.options.ignoreHiddenPoint;for(zi.prototype.generatePoints.call(this),t=this.points,i=t.length,e=0;i>e;e++)n=t[e],o+=s&&!n.visible?0:n.y;for(this.total=o,e=0;i>e;e++)n=t[e],n.percentage=o>0?n.y/o*100:0,n.total=o},translate:function(e){this.generatePoints();var t,i,n,o,s,r,a,l=this,c=0,d=1e3,u=l.options,h=u.slicedOffset,p=h+u.borderWidth,f=u.startAngle||0,g=l.startAngleRad=St/180*(f-90),v=l.endAngleRad=St/180*(m(u.endAngle,f+360)-90),_=v-g,b=l.points,y=u.dataLabels.distance,T=u.ignoreHiddenPoint,S=b.length;for(e||(l.center=e=l.getCenter()),l.getX=function(t,i){return n=pt.asin(_t((t-e[1])/(e[2]/2+y),1)),e[0]+(i?-1:1)*yt(n)*(e[2]/2+y)},r=0;S>r;r++)a=b[r],t=g+c*_,(!T||a.visible)&&(c+=a.percentage/100),i=g+c*_,a.shapeType="arc",a.shapeArgs={x:e[0],y:e[1],r:e[2]/2,innerR:e[3]/2,start:mt(t*d)/d,end:mt(i*d)/d},n=(i+t)/2,n>1.5*St?n-=2*St:-St/2>n&&(n+=2*St),a.slicedTranslation={translateX:mt(yt(n)*h),translateY:mt(Tt(n)*h)},o=yt(n)*e[2]/2,s=Tt(n)*e[2]/2,a.tooltipPos=[e[0]+.7*o,e[1]+.7*s],a.half=-St/2>n||n>St/2?1:0,a.angle=n,p=_t(p,y/2),a.labelPos=[e[0]+o+yt(n)*y,e[1]+s+Tt(n)*y,e[0]+o+yt(n)*p,e[1]+s+Tt(n)*p,e[0]+o,e[1]+s,0>y?"center":a.half?"right":"left",n]},drawGraph:null,drawPoints:function(){var e,i,n,o,s=this,r=s.chart,a=r.renderer,l=s.options.shadow;l&&!s.shadowGroup&&(s.shadowGroup=a.g("shadow").add(s.group)),ci(s.points,function(r){i=r.graphic,o=r.shapeArgs,n=r.shadowGroup,l&&!n&&(n=r.shadowGroup=a.g("shadow").add(s.shadowGroup)),e=r.sliced?r.slicedTranslation:{translateX:0,translateY:0},n&&n.attr(e),i?i.animate(t(o,e)):r.graphic=i=a[r.shapeType](o).setRadialReference(s.center).attr(r.pointAttr[r.selected?ti:Zt]).attr({"stroke-linejoin":"round"}).attr(e).add(s.group).shadow(l,n),void 0!==r.visible&&r.setVisible(r.visible)})},sortByAngle:function(e,t){e.sort(function(e,i){return void 0!==e.angle&&(i.angle-e.angle)*t})},drawLegendSymbol:Vi.drawRectangle,getCenter:Ui.getCenter,getSymbol:Ft};Zi=v(zi,Zi),ni.pie=Zi,zi.prototype.drawDataLabels=function(){var e,n,o,s,r=this,a=r.options,l=a.cursor,c=a.dataLabels,d=r.points;(c.enabled||r._hasPointLabels)&&(r.dlProcessOptions&&r.dlProcessOptions(c),s=r.plotGroup("dataLabelsGroup","data-labels",c.defer?Wt:qt,c.zIndex||6),!r.hasRendered&&m(c.defer,!0)&&(s.attr({opacity:0}),pi(r,"afterAnimate",function(){r.visible&&s.show(),s[a.animation?"animate":"attr"]({opacity:1},{duration:200})})),n=c,ci(d,function(a){var d,h,p,f,g,v=a.dataLabel,_=a.connector,b=!0;if(e=a.options&&a.options.dataLabels,d=m(e&&e.enabled,n.enabled),v&&!d)a.dataLabel=v.destroy();else if(d){if(c=i(n,e),g=c.rotation,h=a.getLabelConfig(),o=c.format?S(c.format,h):c.formatter.call(h,c),c.style.color=m(c.color,c.style.color,r.color,"black"),v)u(o)?(v.attr({text:o}),b=!1):(a.dataLabel=v=v.destroy(),_&&(a.connector=_.destroy()));else if(u(o)){p={fill:c.backgroundColor,stroke:c.borderColor,"stroke-width":c.borderWidth,r:c.borderRadius||0,rotation:g,padding:c.padding,zIndex:1};for(f in p)p[f]===V&&delete p[f];v=a.dataLabel=r.chart.renderer[g?"text":"label"](o,0,-999,null,null,null,c.useHTML).attr(p).css(t(c.style,l&&{cursor:l})).add(s).shadow(c.shadow)}v&&r.alignDataLabel(a,v,c,null,b)}}))},zi.prototype.alignDataLabel=function(e,i,n,o,s){var r,a=this.chart,l=a.inverted,c=m(e.plotX,-999),d=m(e.plotY,-999),u=i.getBBox(),h=this.visible&&(e.series.forceDL||a.isInsidePlot(c,mt(d),l)||o&&a.isInsidePlot(c,l?o.x+1:o.y+o.height-1,l));h&&(o=t({x:l?a.plotWidth-d:c,y:mt(l?a.plotHeight-c:d),width:0,height:0},o),t(n,{width:u.width,height:u.height}),n.rotation?i[s?"attr":"animate"]({x:o.x+n.x+o.width/2,y:o.y+n.y+o.height/2}).attr({align:n.align}):(i.align(n,null,o),r=i.alignAttr,"justify"===m(n.overflow,"justify")?this.justifyDataLabel(i,n,r,u,o,s):m(n.crop,!0)&&(h=a.isInsidePlot(r.x,r.y)&&a.isInsidePlot(r.x+u.width,r.y+u.height)))),h||(i.attr({y:-999}),i.placed=!1)},zi.prototype.justifyDataLabel=function(e,t,i,n,o,s){var r,a,l=this.chart,c=t.align,d=t.verticalAlign;r=i.x,0>r&&("right"===c?t.align="left":t.x=-r,a=!0),r=i.x+n.width,r>l.plotWidth&&("left"===c?t.align="right":t.x=l.plotWidth-r,a=!0),r=i.y,0>r&&("bottom"===d?t.verticalAlign="top":t.y=-r,a=!0),r=i.y+n.height,r>l.plotHeight&&("top"===d?t.verticalAlign="bottom":t.y=l.plotHeight-r,a=!0),a&&(e.placed=!s,e.align(t,null,o))},ni.pie&&(ni.pie.prototype.drawDataLabels=function(){var e,t,i,n,o,s,r,a,l,c,d,u,h,p=this,f=p.data,g=p.chart,v=p.options.dataLabels,_=m(v.connectorPadding,10),b=m(v.connectorWidth,1),y=g.plotWidth,T=g.plotHeight,S=m(v.softConnector,!0),A=v.distance,C=p.center,E=C[2]/2,x=C[1],w=A>0,D=[[],[]],I=[0,0,0,0],O=function(e,t){return t.y-e.y};if(p.visible&&(v.enabled||p._hasPointLabels)){for(zi.prototype.drawDataLabels.apply(p),ci(f,function(e){e.dataLabel&&e.visible&&D[e.half].push(e)}),u=2;u--;){var L,N,R,k,P=[],F=[],H=D[u],B=H.length;if(B){for(p.sortByAngle(H,u-.5),h=r=0;!r&&H[h];)r=H[h]&&H[h].dataLabel&&(H[h].dataLabel.getBBox().height||21),h++;if(A>0){for(R=_t(x+E+A,g.plotHeight),N=vt(0,x-E-A);R>=N;N+=r)P.push(N);if(L=P.length,B>L){for(d=[].concat(H),d.sort(O),h=B;h--;)d[h].rank=h;for(h=B;h--;)H[h].rank>=L&&H.splice(h,1);B=H.length}for(h=0;B>h;h++){e=H[h],s=e.labelPos;var V,U,j=9999;for(U=0;L>U;U++)V=bt(P[U]-s[1]),j>V&&(j=V,k=U);if(h>k&&null!==P[h])k=h;else if(B-h+k>L&&null!==P[h])for(k=L-B+h;null===P[k];)k++;else for(;null===P[k];)k++;F.push({i:k,y:P[k]}),P[k]=null}F.sort(O)}for(h=0;B>h;h++){var z,G;e=H[h],s=e.labelPos,n=e.dataLabel,c=e.visible===!1?Wt:qt,G=s[1],A>0?(z=F.pop(),k=z.i,l=z.y,(G>l&&null!==P[k+1]||l>G&&null!==P[k-1])&&(l=_t(vt(0,G),g.plotHeight))):l=G,a=v.justify?C[0]+(u?-1:1)*(E+A):p.getX(l===x-E-A||l===x+E+A?G:l,u),n._attr={visibility:c,align:s[6]},n._pos={x:a+v.x+({left:_,right:-_}[s[6]]||0),y:l+v.y-10},n.connX=a,n.connY=l,null===this.options.size&&(o=n.width,_>a-o?I[3]=vt(mt(o-a+_),I[3]):a+o>y-_&&(I[1]=vt(mt(a+o-y+_),I[1])),0>l-r/2?I[0]=vt(mt(-l+r/2),I[0]):l+r/2>T&&(I[2]=vt(mt(l+r/2-T),I[2])))}}}(0===M(I)||this.verifyDataLabelOverflow(I))&&(this.placeDataLabels(),w&&b&&ci(this.points,function(e){t=e.connector,s=e.labelPos,n=e.dataLabel,n&&n._pos?(c=n._attr.visibility,a=n.connX,l=n.connY,i=S?[Kt,a+("left"===s[6]?5:-5),l,"C",a,l,2*s[2]-s[4],2*s[3]-s[5],s[2],s[3],Qt,s[4],s[5]]:[Kt,a+("left"===s[6]?5:-5),l,Qt,s[2],s[3],Qt,s[4],s[5]],t?(t.animate({d:i}),t.attr("visibility",c)):e.connector=t=p.chart.renderer.path(i).attr({"stroke-width":b,stroke:v.connectorColor||e.color||"#606060",visibility:c}).add(p.dataLabelsGroup)):t&&(e.connector=t.destroy())}))}},ni.pie.prototype.placeDataLabels=function(){ci(this.points,function(e){var t,i=e.dataLabel;i&&(t=i._pos,t?(i.attr(i._attr),i[i.moved?"animate":"attr"](t),i.moved=!0):i&&i.attr({y:-999}))})},ni.pie.prototype.alignDataLabel=Ft,ni.pie.prototype.verifyDataLabelOverflow=function(e){var t,i=this.center,n=this.options,o=n.center,s=n.minSize||80,r=s;return null!==o[0]?r=vt(i[2]-vt(e[1],e[3]),s):(r=vt(i[2]-e[1]-e[3],s),i[0]+=(e[3]-e[1])/2),null!==o[1]?r=vt(_t(r,i[2]-vt(e[0],e[2])),s):(r=vt(_t(r,i[2]-e[0]-e[2]),s),i[1]+=(e[0]-e[2])/2),r<i[2]?(i[2]=r,this.translate(i),ci(this.points,function(e){e.dataLabel&&(e.dataLabel._pos=null)}),this.drawDataLabels&&this.drawDataLabels()):t=!0,t}),ni.column&&(ni.column.prototype.alignDataLabel=function(e,t,n,o,s){var r=this.chart,a=r.inverted,l=e.dlBox||e.shapeArgs,c=e.below||e.plotY>m(this.translatedThreshold,r.plotSizeY),d=m(n.inside,!!this.options.stacking);l&&(o=i(l),a&&(o={x:r.plotWidth-o.y-o.height,y:r.plotHeight-o.x-o.width,width:o.height,height:o.width}),d||(a?(o.x+=c?0:o.width,o.width=0):(o.y+=c?o.height:0,o.height=0))),n.align=m(n.align,!a||d?"center":c?"right":"left"),n.verticalAlign=m(n.verticalAlign,a||d?"middle":c?"top":"bottom"),zi.prototype.alignDataLabel.call(this,e,t,n,o,s)});var en=dt.TrackerMixin={drawTrackerPoint:function(){var e=this,t=e.chart,i=t.pointer,n=e.options.cursor,o=n&&{cursor:n},s=function(i){var n,o=i.target;for(t.hoverSeries!==e&&e.onMouseOver();o&&!n;)n=o.point,o=o.parentNode;n!==V&&n!==t.hoverPoint&&n.onMouseOver(i)};ci(e.points,function(e){e.graphic&&(e.graphic.element.point=e),e.dataLabel&&(e.dataLabel.element.point=e)}),e._hasTracking||(ci(e.trackerGroups,function(t){e[t]&&(e[t].addClass($t+"tracker").on("mouseover",s).on("mouseout",function(e){i.onTrackerMouseOut(e)}).css(o),j&&e[t].on("touchstart",s))}),e._hasTracking=!0)},drawTrackerGraph:function(){var e,t,i=this,n=i.options,o=n.trackByArea,s=[].concat(o?i.areaPath:i.graphPath),r=s.length,a=i.chart,l=a.pointer,c=a.renderer,d=a.options.tooltip.snap,u=i.tracker,h=n.cursor,p=h&&{cursor:h},m=i.singlePoints,f=function(){a.hoverSeries!==i&&i.onMouseOver()},g="rgba(192,192,192,"+(Lt?1e-4:.002)+")";if(r&&!o)for(t=r+1;t--;)s[t]===Kt&&s.splice(t+1,0,s[t+1]-d,s[t+2],Qt),(t&&s[t]===Kt||t===r)&&s.splice(t,0,Qt,s[t-2]+d,s[t-1]);for(t=0;t<m.length;t++)e=m[t],s.push(Kt,e.plotX-d,e.plotY,Qt,e.plotX+d,e.plotY);u?u.attr({d:s}):(i.tracker=c.path(s).attr({"stroke-linejoin":"round",visibility:i.visible?qt:Wt,stroke:g,fill:o?g:Xt,"stroke-width":n.lineWidth+(o?0:2*d),zIndex:2}).add(i.group),ci([i.tracker,i.markerGroup],function(e){e.addClass($t+"tracker").on("mouseover",f).on("mouseout",function(e){l.onTrackerMouseOut(e)}).css(p),j&&e.on("touchstart",f)}))}};return ni.column&&(Xi.prototype.drawTracker=en.drawTrackerPoint),ni.pie&&(ni.pie.prototype.drawTracker=en.drawTrackerPoint),ni.scatter&&(Qi.prototype.drawTracker=en.drawTrackerPoint),t(Bi.prototype,{setItemEvents:function(e,t,i,n,o){var s=this;(i?t:e.legendGroup).on("mouseover",function(){e.setState(ei),t.css(s.options.itemHoverStyle)}).on("mouseout",function(){t.css(e.visible?n:o),e.setState()}).on("click",function(t){var i="legendItemClick",n=function(){e.setVisible()};t={browserEvent:t},e.firePointEvent?e.firePointEvent(i,t,n):fi(e,i,t,n)})},createCheckboxForItem:function(e){var t=this;e.checkbox=g("input",{type:"checkbox",checked:e.selected,defaultChecked:e.selected},t.options.itemCheckboxStyle,t.chart.container),pi(e.checkbox,"click",function(t){var i=t.target;fi(e,"checkboxClick",{checked:i.checked},function(){e.select()})})}}),G.legend.itemStyle.cursor="pointer",t(H.prototype,{showResetZoom:function(){var e=this,t=G.lang,i=e.options.chart.resetZoomButton,n=i.theme,o=n.states,s="chart"===i.relativeTo?null:"plotBox";this.resetZoomButton=e.renderer.button(t.resetZoom,null,null,function(){e.zoomOut()},n,o&&o.hover,V,V,V,e.options.chart.isHeatMapTimeSeriesChart).attr({align:i.position.align,title:t.resetZoomTitle}).add().align(i.position,!1,s),e.options.chart.isHeatMapTimeSeriesChart&&this.resetZoomButton.text.on("click",function(){e.zoomOut()})},zoomOut:function(){var e=this;fi(e,"selection",{resetSelection:!0},function(){e.zoom()})},zoom:function(e){var t,i,n=this,o=n.pointer,r=!1;!e||e.resetSelection?ci(n.axes,function(e){t=e.zoom()}):ci(e.xAxis.concat(e.yAxis),function(e){var i=e.axis,n=i.isXAxis;i.chart.options.chart.isHeatMapTimeSeriesChart&&(e.min=Math.round(e.min/i.pointRange)*i.pointRange,e.max=Math.round(e.max/i.pointRange)*i.pointRange),(o[n?"zoomX":"zoomY"]||o[n?"pinchX":"pinchY"])&&(t=i.zoom(e.min,e.max),i.displayBtn&&(r=!0))}),i=n.resetZoomButton,r&&!i?n.showResetZoom():!r&&s(i)&&(n.resetZoomButton=i.destroy()),t&&n.redraw(m(n.options.chart.animation,e&&e.animation,n.pointCount<100))},pan:function(e,t){var i,n=this,o=n.hoverPoints;o&&ci(o,function(e){e.setState()}),ci("xy"===t?[1,0]:[1],function(t){var o=e[t?"chartX":"chartY"],s=n[t?"xAxis":"yAxis"][0],r=n[t?"mouseDownX":"mouseDownY"],a=(s.pointRange||0)/2,l=s.getExtremes(),c=s.toValue(r-o,!0)+a,d=s.toValue(r+n[t?"plotWidth":"plotHeight"]-o,!0)-a;s.series.length&&c>_t(l.dataMin,l.min)&&d<vt(l.dataMax,l.max)&&(s.setExtremes(c,d,!1,!1,{trigger:"pan"}),i=!0),n[t?"mouseDownX":"mouseDownY"]=o}),i&&n.redraw(!1),f(n.container,{cursor:"move"})}}),t(ji.prototype,{select:function(e,t){var i=this,n=i.series,o=n.chart;e=m(e,!i.selected),i.firePointEvent(e?"select":"unselect",{accumulate:t},function(){i.selected=i.options.selected=e,n.options.data[li(i,n.data)]=i.options,i.setState(e&&ti),t||ci(o.getSelectedPoints(),function(e){e.selected&&e!==i&&(e.selected=e.options.selected=!1,n.options.data[li(e,n.data)]=e.options,e.setState(Zt),e.firePointEvent("unselect"))})})},onMouseOver:function(e){var t=this,i=t.series,n=i.chart,o=n.tooltip,s=n.hoverPoint;s&&s!==t&&s.onMouseOut(),t.firePointEvent("mouseOver"),!o||o.shared&&!i.noSharedTooltip||o.refresh(t,e),t.setState(ei),n.hoverPoint=t},onMouseOut:function(){var e=this.series.chart,t=e.hoverPoints;this.firePointEvent("mouseOut"),t&&-1!==li(this,t)||(this.setState(),e.hoverPoint=null)},importEvents:function(){if(!this.hasImportedEvents){var e,t=this,n=i(t.series.options.point,t.options),o=n.events;t.events=o;for(e in o)pi(t,e,o[e]);this.hasImportedEvents=!0}},setState:function(e,n){var o,s,r,a,l=this,c=l.plotX,d=l.plotY,u=l.series,h=u.options.states,p=yi[u.type].marker&&u.options.marker,m=p&&!p.enabled,f=p&&p.states[e],g=f&&f.enabled===!1,v=u.stateMarkerGraphic,_=l.marker||{},b=u.chart,y=u.halo;e=e||Zt,a=l.pointAttr[e]||u.pointAttr[e],e===l.state&&!n||l.selected&&e!==ti||h[e]&&h[e].enabled===!1||e&&(g||m&&f.enabled===!1)||e&&_.states&&_.states[e]&&_.states[e].enabled===!1||(l.graphic?(o=p&&l.graphic.symbolName&&a.r,l.graphic.attr(i(a,o?{x:c-o,y:d-o,width:2*o,height:2*o}:{})),v&&v.hide()):(e&&f&&(o=f.radius,r=_.symbol||u.symbol,v&&v.currentSymbol!==r&&(v=v.destroy()),v?v[n?"animate":"attr"]({x:c-o,y:d-o}):r&&(u.stateMarkerGraphic=v=b.renderer.symbol(r,c-o,d-o,2*o,2*o).attr(a).add(u.markerGroup),v.currentSymbol=r)),v&&v[e&&b.isInsidePlot(c,d,b.inverted)?"show":"hide"]()),s=h[e]&&h[e].halo,s&&s.size?(y||(u.halo=y=b.renderer.path().add(u.seriesGroup)),y.attr(t({fill:Ei(l.color||u.color).setOpacity(s.opacity).get()},s.attributes))[n?"animate":"attr"]({d:l.haloPath(s.size)})):y&&y.attr({d:[]}),l.state=e)},haloPath:function(e){var t=this.series,i=t.chart,n=t.getPlotBox(),o=i.inverted;return i.renderer.symbols.circle(n.translateX+(o?t.yAxis.len-this.plotY:this.plotX)-e,n.translateY+(o?t.xAxis.len-this.plotX:this.plotY)-e,2*e,2*e)}}),t(zi.prototype,{onMouseOver:function(){var e=this,t=e.chart,i=t.hoverSeries;i&&i!==e&&i.onMouseOut(),e.options.events.mouseOver&&fi(e,"mouseOver"),e.setState(ei),t.hoverSeries=e},onMouseOut:function(){var e=this,t=e.options,i=e.chart,n=i.tooltip,o=i.hoverPoint;
o&&o.onMouseOut(),e&&t.events.mouseOut&&fi(e,"mouseOut"),!n||t.stickyTracking||n.shared&&!e.noSharedTooltip||n.hide(),e.setState(),i.hoverSeries=null},setState:function(e){var t,i=this,n=i.options,o=i.graph,s=i.graphNeg,r=n.states,a=n.lineWidth;if(e=e||Zt,i.state!==e){if(i.state=e,r[e]&&r[e].enabled===!1)return;e&&(a=r[e].lineWidth||a+(r[e].lineWidthPlus||0)),o&&!o.dashstyle&&(t={"stroke-width":a},o.attr(t),s&&s.attr(t))}},setVisible:function(e,t){var i,n=this,o=n.chart,s=n.legendItem,r=o.options.chart.ignoreHiddenSeries,a=n.visible;n.visible=e=n.userOptions.visible=e===V?!a:e,i=e?"show":"hide",ci(["group","dataLabelsGroup","markerGroup","tracker"],function(e){n[e]&&n[e][i]()}),o.hoverSeries===n&&n.onMouseOut(),s&&o.legend.colorizeItem(n,e),n.isDirty=!0,n.options.stacking&&ci(o.series,function(e){e.options.stacking&&e.visible&&(e.isDirty=!0)}),ci(n.linkedSeries,function(t){t.setVisible(e,!1)}),r&&(o.isDirtyBox=!0),t!==!1&&o.redraw(),fi(n,i)},setTooltipPoints:function(e){var t,i,n,o,s,r,a,l=this,c=[],d=l.xAxis,u=d&&d.getExtremes(),h=d?d.tooltipLen||d.len:l.chart.plotSizeX,p=[];if(l.options.enableMouseTracking!==!1&&!l.singularTooltips){for(e&&(l.tooltipPoints=null),ci(l.segments||l.points,function(e){c=c.concat(e)}),d&&d.reversed&&(c=c.reverse()),l.orderTooltipPoints&&l.orderTooltipPoints(c),t=c.length,a=0;t>a;a++)if(o=c[a],s=o.x,s>=u.min&&s<=u.max)for(r=c[a+1],i=n===V?0:n+1,n=c[a+1]?_t(vt(0,ft((o.clientX+(r?r.wrappedClientX||r.clientX:h))/2)),h):h;i>=0&&n>=i;)p[i++]=o;l.tooltipPoints=p}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(e){var t=this;t.selected=e=e===V?!t.selected:e,t.checkbox&&(t.checkbox.checked=e),fi(t,e?"select":"unselect")},drawTracker:en.drawTrackerGraph}),t(dt,{Axis:F,Chart:H,Color:Ei,Point:ji,Tick:P,Renderer:U,Series:zi,SVGElement:k,SVGRenderer:xi,arrayMin:x,arrayMax:M,charts:Ht,dateFormat:W,format:S,pathAnim:q,getOptions:R,hasBidiBug:Nt,isTouchDevice:It,numberFormat:_,seriesTypes:ni,setOptions:N,addEvent:pi,removeEvent:mi,createElement:g,discardElement:D,css:f,each:ci,extend:t,map:hi,merge:i,pick:m,splat:p,extendClass:v,pInt:n,wrap:y,svg:Lt,canvas:Rt,vml:!Lt&&!Rt,product:Vt,version:Ut}),dt},this),function(e,t){"function"==typeof define&&define.amd?define("grouped-categories",["highcharts"],e):e(t.Highcharts)}(function(e){function t(e,t){return this.name=e.name||e,this.parent=t,this}function i(e){return parseInt(e,10)-.5}function n(e){for(var t=e.length,i=0;t--;)i+=e[t];return i}function o(e,t,i,n,r){var a,l=e.length;for(r||(r=0),i.depth||(i.depth=0);l--;)a=e[l],n&&(a.parent=n),a.categories?o(a.categories,t,i,a,r+1):s(t,a,n);i.depth=h(i.depth,r)}function s(e,i,n){for(e.unshift(new t(i,n));n;)n.leaves++||(n.leaves=1),n=n.parent}function r(e,t){e.push("M",i(t[0]),i(t[1]),"L",i(t[2]),i(t[3]))}function a(e,t){return e.getPosition(e.axis.horiz,t,e.axis.tickmarkOffset)}function l(e,t,i){for(var n,o=e.length;o--;)n=e[o][t],n&&l(n,t,i),i(e[o])}function c(e){function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return"[object String]"===Object.prototype.toString.call(e)}var n,o;n=t(e)?[]:{};for(o in e)e.hasOwnProperty(o)&&(n[o]=i(e[o])?e[o]:c(e[o]));return n}var d=void 0,u=(Math.round,Math.min),h=Math.max,p=e.Axis.prototype,m=e.Tick.prototype,f=p.init,g=p.render,v=p.setCategories,_=m.getLabelSize,b=m.addLabel,y=m.destroy,T=m.render;return t.prototype.toString=function(){for(var e=[],t=this;t;)e.push(t.name),t=t.parent;return e.join(", ")},p.init=function(e,t){f.call(this,e,t),"object"==typeof t&&t.categories&&this.setupGroups(t)},p.setupGroups=function(e){var t,i=[],n={};t=c(e.categories),o(t,i,n),this.categoriesTree=t,this.categories=i,this.isGrouped=0!==n.depth,this.labelsDepth=n.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=e.tickLength||this.tickLength||null,this.directionFactor=[-1,1,1,-1][this.side],this.options.lineWidth="undefined"==typeof e.lineWidth?1:e.lineWidth},p.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===d&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,g.call(this),!this.isGrouped)return void(this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}));var e,t=this,i=t.options,n=t.top,o=t.left,s=o+t.width,a=n+t.height,c=t.hasVisibleSeries,u=t.labelsDepth,h=t.labelsGrid,p=t.horiz,m=t.labelsGridPath,f=i.drawHorizontalBorders===!1?u+1:0,v=t.opposite?p?n:s:p?a:o;for(t.userTickLength&&(u-=1),h||(h=t.labelsGrid=t.chart.renderer.path().attr({"stroke-width":i.lineWidth,stroke:i.lineColor}).add(t.axisGroup));u>=f;)v+=t.groupSize(f),e=p?[o,v,s,v]:[v,n,v,a],r(m,e),f++;h.attr({d:m,visibility:c?"visible":"hidden"}),t.labelGroup.attr({visibility:c?"visible":"hidden"}),l(t.categoriesTree,"categories",function(e){var i=e.tick;i&&(i.startAt+i.leaves-1<t.min||i.startAt>t.max?(i.label.hide(),i.destroyed=0):i.label.show())})},p.setCategories=function(e,t){this.categories&&this.cleanGroups(),this.setupGroups({categories:e}),this.categories=this.userOptions.categories=e,v.call(this,this.categories,t)},p.cleanGroups=function(){var e,t=this.ticks;for(e in t)t[e].parent;delete t[e].parent,l(this.categoriesTree,"categories",function(e){var t,i=e.tick;if(i){i.label.destroy();for(t in i)delete i[t];delete e.tick}}),this.labelsGrid=null},p.groupSize=function(e,t){var i=this.labelsSizes,o=this.directionFactor;return t!==d&&(i[e]=h(i[e]||0,t+10)),e===!0?n(i)*o:i[e]?i[e]*o:0},m.addLabel=function(){var e;b.call(this),this.axis.categories&&(e=this.axis.categories[this.pos])&&(e.name&&this.label&&this.label.attr("text",e.name),this.axis.isGrouped&&this.addGroupedLabels(e))},m.addGroupedLabels=function(e){for(var t,i=this,n=this.axis,o=n.chart,s=n.options.labels,r=s.useHTML,a=s.style,l={align:"center"},c=n.horiz?"height":"width",d=0;i;){if(d>0&&!e.tick){this.value=e.name;var u=s.formatter?s.formatter.call(this,e):e.name;t=o.renderer.text(u,0,0,r).attr(l).css(a).add(n.labelGroup),i.startAt=this.pos,i.childCount=e.categories.length,i.leaves=e.leaves,i.visible=this.childCount,i.label=t,e.tick=i}n.groupSize(d,i.label.getBBox()[c]),e=e.parent,i=e?i.parent=e.tick||{}:null,d++}},m.render=function(e,t,i){if(T.call(this,e,!1,i),this.axis.isGrouped&&this.axis.categories[this.pos]&&!(this.pos>this.axis.max)){var n,o,s,l,c=this,d=c,p=c.axis,m=c.pos,f=c.isFirst,g=p.max,v=p.min,_=p.horiz,b=(p.categories[m],p.labelsGridPath),y=p.groupSize(0),S=(p.tickLength||y,p.directionFactor,a(c,m)),A=_?S.y:S.x,C=p.chart.renderer.fontMetrics(p.options.labels.style.fontSize).b,E=1;for(f&&(n=_?[p.left,S.y,p.left,S.y+p.groupSize(!0)]:p.isXAxis?[S.x,p.top,S.x+p.groupSize(!0),p.top]:[S.x,p.top+p.len,S.x+p.groupSize(!0),p.top+p.len],r(b,n)),n=_?[S.x,S.y,S.x,S.y+y]:[S.x,S.y,S.x+y,S.y],r(b,n),y=A+y;d=d.parent;){var x=a(c,h(d.startAt-1,v-1)),M=a(c,u(d.startAt+d.leaves-1,g));l=d.label.getBBox(),o=p.groupSize(E),s=_?{x:(x.x+M.x)/2,y:y+o/2+C-l.height/2-4}:{x:y+o/2,y:(x.y+M.y-l.height)/2+C},d.label.attr(s),b&&(n=_?[M.x,y,M.x,y+o]:[y,M.y,y+o,M.y],r(b,n)),y+=o,E++}}},m.destroy=function(){for(var e=this;e=e.parent;)e.destroyed++||(e.destroyed=1);y.call(this)},m.getLabelSize=function(){return this.axis.isGrouped===!0?n(this.axis.labelsSizes):_.call(this)},e},this),function(e){"function"==typeof define&&define.amd?define("adhoc/chart/ext/multiplePieTitlesExt",["highcharts"],e):e(Highcharts)}(function(e){return e.wrap(e.seriesTypes.pie.prototype,"render",function(e){var t,i=this.chart,n=this.center||this.yAxis&&this.yAxis.center,o=this.options.title;e.call(this),n&&o&&(t={x:i.plotLeft+n[0]-.5*n[2],y:i.plotTop+n[1]-.5*n[2],width:n[2],height:n[2]},this.title?this.title.align(o,null,t):this.title=this.chart.renderer.label(o.text).css(o.style).add().align(o,null,t))}),e}),function(e,t){"function"==typeof define&&define.amd?define("highcharts-more",["highcharts"],e):e(t.Highcharts)}(function(e,t){function i(e,t,i){this.init.call(this,e,t,i)}var n=e.arrayMin,o=e.arrayMax,s=e.each,r=e.extend,a=e.merge,l=e.map,c=e.pick,d=e.pInt,u=e.getOptions().plotOptions,h=e.seriesTypes,p=e.extendClass,m=e.splat,f=e.wrap,g=e.Axis,v=e.Tick,_=e.Point,b=e.Pointer,y=e.CenteredSeriesMixin,T=e.TrackerMixin,S=e.Series,A=Math,C=A.round,E=A.floor,x=A.max,M=e.Color,w=function(){};r(i.prototype,{init:function(e,t,i){var n,o=this,r=o.defaultOptions;o.chart=t,t.angular&&(r.background={}),o.options=e=a(r,e),n=e.background,n&&s([].concat(m(n)).reverse(),function(e){var t=e.backgroundColor;e=a(o.defaultBackgroundOptions,e),t&&(e.backgroundColor=t),e.color=e.backgroundColor,i.options.plotBands.unshift(e)})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",borderWidth:1,borderColor:"silver",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#DDD"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"}});var D=g.prototype,I=v.prototype,O={getOffset:w,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:w,setCategories:w,setTitle:w},L={isRadial:!0,defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(e){var t=this.options=a(this.defaultOptions,this.defaultRadialOptions,e);t.plotBands||(t.plotBands=[])},getOffset:function(){D.getOffset.call(this),this.chart.axisOffset[this.side]=0,this.center=this.pane.center=y.getCenter.call(this.pane)},getLinePath:function(e,t){var i=this.center;return t=c(t,i[2]/2-this.offset),this.chart.renderer.symbols.arc(this.left+i[0],this.top+i[1],t,t,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0})},setAxisTranslation:function(){D.setAxisTranslation.call(this),this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)},beforeSetTickPositions:function(){this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){D.setAxisSize.call(this),this.isRadial&&(this.center=this.pane.center=e.CenteredSeriesMixin.getCenter.call(this.pane),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*c(this.sector,1)/2)},getPosition:function(e,t){return this.postTranslate(this.isCircular?this.translate(e):0,c(this.isCircular?t:this.translate(e),this.center[2]/2)-this.offset)},postTranslate:function(e,t){var i=this.chart,n=this.center;return e=this.startAngleRad+e,{x:i.plotLeft+n[0]+Math.cos(e)*t,y:i.plotTop+n[1]+Math.sin(e)*t}},getPlotBandPath:function(e,t,i){var n,o,s,r,a=this.center,u=this.startAngleRad,h=a[2]/2,p=[c(i.outerRadius,"100%"),i.innerRadius,c(i.thickness,10)],m=/%$/,f=this.isCircular;return"polygon"===this.options.gridLineInterpolation?r=this.getPlotLinePath(e).concat(this.getPlotLinePath(t,!0)):(f||(p[0]=this.translate(e),p[1]=this.translate(t)),p=l(p,function(e){return m.test(e)&&(e=d(e,10)*h/100),e}),"circle"!==i.shape&&f?(n=u+this.translate(e),o=u+this.translate(t)):(n=-Math.PI/2,o=1.5*Math.PI,s=!0),r=this.chart.renderer.symbols.arc(this.left+a[0],this.top+a[1],p[0],p[0],{start:n,end:o,innerR:c(p[1],p[0]-p[2]),open:s})),r},getPlotLinePath:function(e,t){var i,n,o,r,a=this,l=a.center,c=a.chart,d=a.getPosition(e);return a.isCircular?r=["M",l[0]+c.plotLeft,l[1]+c.plotTop,"L",d.x,d.y]:"circle"===a.options.gridLineInterpolation?(e=a.translate(e),e&&(r=a.getLinePath(0,e))):(s(c.xAxis,function(e){e.pane===a.pane&&(i=e)}),r=[],e=a.translate(e),o=i.tickPositions,i.autoConnect&&(o=o.concat([o[0]])),t&&(o=[].concat(o).reverse()),s(o,function(t,o){n=i.getPosition(t,e),r.push(o?"L":"M",n.x,n.y)})),r},getTitlePosition:function(){var e=this.center,t=this.chart,i=this.options.title;return{x:t.plotLeft+e[0]+(i.x||0),y:t.plotTop+e[1]-{high:.5,middle:.25,low:0}[i.align]*e[2]+(i.y||0)}}};f(D,"init",function(e,n,o){var s,l,d,u,h,p,f=this,g=n.angular,v=n.polar,_=o.isX,b=g&&_,y=n.options,T=o.pane||0;g?(r(this,b?O:L),s=!_,s&&(this.defaultRadialOptions=this.defaultRadialGaugeOptions)):v&&(r(this,L),s=_,this.defaultRadialOptions=_?this.defaultRadialXOptions:a(this.defaultYAxisOptions,this.defaultRadialYOptions)),e.call(this,n,o),b||!g&&!v||(u=this.options,n.panes||(n.panes=[]),this.pane=h=n.panes[T]=n.panes[T]||new i(m(y.pane)[T],n,f),p=h.options,n.inverted=!1,y.chart.zoomType=null,this.startAngleRad=l=(p.startAngle-90)*Math.PI/180,this.endAngleRad=d=(c(p.endAngle,p.startAngle+360)-90)*Math.PI/180,this.offset=u.offset||0,this.isCircular=s,s&&o.max===t&&d-l===2*Math.PI&&(this.autoConnect=!0))}),f(I,"getPosition",function(e,t,i,n,o){var s=this.axis;return s.getPosition?s.getPosition(i):e.call(this,t,i,n,o)}),f(I,"getLabelPosition",function(e,t,i,n,o,s,r,a,l){var d,u=this.axis,h=s.y,p=s.align,m=(u.translate(this.pos)+u.startAngleRad+Math.PI/2)/Math.PI*180%360;return u.isRadial?(d=u.getPosition(this.pos,u.center[2]/2+c(s.distance,-25)),"auto"===s.rotation?n.attr({rotation:m}):null===h&&(h=u.chart.renderer.fontMetrics(n.styles.fontSize).b-n.getBBox().height/2),null===p&&(p=u.isCircular?m>20&&160>m?"left":m>200&&340>m?"right":"center":"center",n.attr({align:p})),d.x+=s.x,d.y+=h):d=e.call(this,t,i,n,o,s,r,a,l),d}),f(I,"getMarkPath",function(e,t,i,n,o,s,r){var a,l,c=this.axis;return c.isRadial?(a=c.getPosition(this.pos,c.center[2]/2+n),l=["M",t,i,"L",a.x,a.y]):l=e.call(this,t,i,n,o,s,r),l}),u.arearange=a(u.area,{lineWidth:1,marker:null,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0},states:{hover:{halo:!1}}}),h.arearange=p(h.area,{type:"arearange",pointArrayMap:["low","high"],toYData:function(e){return[e.low,e.high]},pointValKey:"low",getSegments:function(){var e=this;s(e.points,function(t){e.options.connectNulls||null!==t.low&&null!==t.high?null===t.low&&null!==t.high&&(t.y=t.high):t.y=null}),S.prototype.getSegments.call(this)},translate:function(){var e=this,t=e.yAxis;h.area.prototype.translate.apply(e),s(e.points,function(e){var i=e.low,n=e.high,o=e.plotY;null===n&&null===i?e.y=null:null===i?(e.plotLow=e.plotY=null,e.plotHigh=t.translate(n,0,1,0,1)):null===n?(e.plotLow=o,e.plotHigh=null):(e.plotLow=o,e.plotHigh=t.translate(n,0,1,0,1))})},getSegmentPath:function(t){var i,n,o,s,r,a=[],l=t.length,c=S.prototype.getSegmentPath,d=this.options,u=d.step;for(i=e.__HighchartsAdapter__.grep(t,function(e){return null!==e.plotLow});l--;)n=t[l],null!==n.plotHigh&&a.push({plotX:n.plotX,plotY:n.plotHigh});return s=c.call(this,i),u&&(u===!0&&(u="left"),d.step={left:"right",center:"center",right:"left"}[u]),r=c.call(this,a),d.step=u,o=[].concat(s,r),r[0]="L",this.areaPath=this.areaPath.concat(s,r),o},drawDataLabels:function(){var e,t,i=this.data,n=i.length,o=[],s=S.prototype,r=this.options.dataLabels,a=r.align,l=this.chart.inverted;if(r.enabled||this._hasPointLabels){for(e=n;e--;)t=i[e],t.y=t.high,t._plotY=t.plotY,t.plotY=t.plotHigh,o[e]=t.dataLabel,t.dataLabel=t.dataLabelUpper,t.below=!1,l?(a||(r.align="left"),r.x=r.xHigh):r.y=r.yHigh;for(s.drawDataLabels&&s.drawDataLabels.apply(this,arguments),e=n;e--;)t=i[e],t.dataLabelUpper=t.dataLabel,t.dataLabel=o[e],t.y=t.low,t.plotY=t._plotY,t.below=!0,l?(a||(r.align="right"),r.x=r.xLow):r.y=r.yLow;s.drawDataLabels&&s.drawDataLabels.apply(this,arguments)}r.align=a},alignDataLabel:function(){h.column.prototype.alignDataLabel.apply(this,arguments)},getSymbol:w,drawPoints:w}),u.areasplinerange=a(u.arearange),h.areasplinerange=p(h.arearange,{type:"areasplinerange",getPointSpline:h.spline.prototype.getPointSpline}),function(){var e=h.column.prototype;u.columnrange=a(u.column,u.arearange,{lineWidth:1,pointRange:null}),h.columnrange=p(h.arearange,{type:"columnrange",translate:function(){var t,i=this,n=i.yAxis;e.translate.apply(i),s(i.points,function(e){var o,s,r,a=e.shapeArgs,l=i.options.minPointLength;e.tooltipPos=null,e.plotHigh=t=n.translate(e.high,0,1,0,1),e.plotLow=e.plotY,r=t,s=e.plotY-t,l>s&&(o=l-s,s+=o,r-=o/2),a.height=s,a.y=r})},trackerGroups:["group","dataLabelsGroup"],drawGraph:w,pointAttrToOptions:e.pointAttrToOptions,drawPoints:e.drawPoints,drawTracker:e.drawTracker,animate:e.animate,getColumnMetrics:e.getColumnMetrics})}(),u.gauge=a(u.line,{dataLabels:{enabled:!0,defer:!1,y:15,borderWidth:1,borderColor:"silver",borderRadius:3,crop:!1,style:{fontWeight:"bold"},verticalAlign:"top",zIndex:2},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1});var N=p(_,{setState:function(e){this.state=e}}),R={type:"gauge",pointClass:N,angular:!0,drawGraph:w,fixedBox:!0,forceDL:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var e=this,t=e.yAxis,i=e.options,n=t.center;e.generatePoints(),s(e.points,function(e){var o=a(i.dial,e.dial),s=d(c(o.radius,80))*n[2]/200,r=d(c(o.baseLength,70))*s/100,l=d(c(o.rearLength,10))*s/100,u=o.baseWidth||3,h=o.topWidth||1,p=i.overshoot,m=t.startAngleRad+t.translate(e.y,null,null,null,!0);p&&"number"==typeof p?(p=p/180*Math.PI,m=Math.max(t.startAngleRad-p,Math.min(t.endAngleRad+p,m))):i.wrap===!1&&(m=Math.max(t.startAngleRad,Math.min(t.endAngleRad,m))),m=180*m/Math.PI,e.shapeType="path",e.shapeArgs={d:o.path||["M",-l,-u/2,"L",r,-u/2,s,-h/2,s,h/2,r,u/2,-l,u/2,"z"],translateX:n[0],translateY:n[1],rotation:m},e.plotX=n[0],e.plotY=n[1]})},drawPoints:function(){var e=this,t=e.yAxis.center,i=e.pivot,n=e.options,o=n.pivot,r=e.chart.renderer;s(e.points,function(t){var i=t.graphic,o=t.shapeArgs,s=o.d,l=a(n.dial,t.dial);i?(i.animate(o),o.d=s):t.graphic=r[t.shapeType](o).attr({stroke:l.borderColor||"none","stroke-width":l.borderWidth||0,fill:l.backgroundColor||"black",rotation:o.rotation}).add(e.group)}),i?i.animate({translateX:t[0],translateY:t[1]}):e.pivot=r.circle(0,0,c(o.radius,5)).attr({"stroke-width":o.borderWidth||0,stroke:o.borderColor||"silver",fill:o.backgroundColor||"black"}).translate(t[0],t[1]).add(e.group)},animate:function(e){var t=this;e||(s(t.points,function(e){var i=e.graphic;i&&(i.attr({rotation:180*t.yAxis.startAngleRad/Math.PI}),i.animate({rotation:e.shapeArgs.rotation},t.options.animation))}),t.animate=null)},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",this.options.zIndex,this.chart.seriesGroup),S.prototype.render.call(this),this.group.clip(this.chart.clipRect)},setData:function(e,t){S.prototype.setData.call(this,e,!1),this.processData(),this.generatePoints(),c(t,!0)&&this.chart.redraw()},drawTracker:T&&T.drawTrackerPoint};h.gauge=p(h.line,R),u.boxplot=a(u.column,{fillColor:"#FFFFFF",lineWidth:1,medianWidth:2,states:{hover:{brightness:-.3}},threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">●</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",whiskerWidth:2}),h.boxplot=p(h.column,{type:"boxplot",pointArrayMap:["low","q1","median","q3","high"],toYData:function(e){return[e.low,e.q1,e.median,e.q3,e.high]},pointValKey:"high",pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth"},drawDataLabels:w,translate:function(){var e=this,t=e.yAxis,i=e.pointArrayMap;h.column.prototype.translate.apply(e),s(e.points,function(e){s(i,function(i){null!==e[i]&&(e[i+"Plot"]=t.translate(e[i],0,1,0,1))})})},drawPoints:function(){var e,i,n,o,r,a,l,d,u,h,p,m,f,g,v,_,b,y,T,S,A,x,M=this,w=M.points,D=M.options,I=M.chart,O=I.renderer,L=M.doQuartiles!==!1,N=parseInt(M.options.whiskerLength,10)/100;s(w,function(s){u=s.graphic,A=s.shapeArgs,p={},g={},_={},x=s.color||M.color,s.plotY!==t&&(e=s.pointAttr[s.selected?"selected":""],b=A.width,y=E(A.x),T=y+b,S=C(b/2),i=E(L?s.q1Plot:s.lowPlot),n=E(L?s.q3Plot:s.lowPlot),o=E(s.highPlot),r=E(s.lowPlot),p.stroke=s.stemColor||D.stemColor||x,p["stroke-width"]=c(s.stemWidth,D.stemWidth,D.lineWidth),p.dashstyle=s.stemDashStyle||D.stemDashStyle,g.stroke=s.whiskerColor||D.whiskerColor||x,g["stroke-width"]=c(s.whiskerWidth,D.whiskerWidth,D.lineWidth),_.stroke=s.medianColor||D.medianColor||x,_["stroke-width"]=c(s.medianWidth,D.medianWidth,D.lineWidth),_["stroke-linecap"]="round",l=p["stroke-width"]%2/2,d=y+S+l,h=["M",d,n,"L",d,o,"M",d,i,"L",d,r],L&&(l=e["stroke-width"]%2/2,d=E(d)+l,i=E(i)+l,n=E(n)+l,y+=l,T+=l,m=["M",y,n,"L",y,i,"L",T,i,"L",T,n,"L",y,n,"z"]),N&&(l=g["stroke-width"]%2/2,o+=l,r+=l,f=["M",d-S*N,o,"L",d+S*N,o,"M",d-S*N,r,"L",d+S*N,r]),l=_["stroke-width"]%2/2,a=C(s.medianPlot)+l,v=["M",y,a,"L",T,a],u?(s.stem.animate({d:h}),N&&s.whiskers.animate({d:f}),L&&s.box.animate({d:m}),s.medianShape.animate({d:v})):(s.graphic=u=O.g().add(M.group),s.stem=O.path(h).attr(p).add(u),N&&(s.whiskers=O.path(f).attr(g).add(u)),L&&(s.box=O.path(m).attr(e).add(u)),s.medianShape=O.path(v).attr(_).add(u)))})}}),u.errorbar=a(u.boxplot,{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null}),h.errorbar=p(h.boxplot,{type:"errorbar",pointArrayMap:["low","high"],toYData:function(e){return[e.low,e.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:h.arearange?h.arearange.prototype.drawDataLabels:w,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||h.column.prototype.getColumnMetrics.call(this)}}),u.waterfall=a(u.column,{lineWidth:1,lineColor:"#333",dashStyle:"dot",borderColor:"#333",states:{hover:{lineWidthPlus:0}}}),h.waterfall=p(h.column,{type:"waterfall",upColorProp:"fill",pointArrayMap:["low","y"],pointValKey:"y",init:function(e,t){t.stacking=!0,h.column.prototype.init.call(this,e,t)},translate:function(){var e,t,i,n,o,s,r,a,l,c,d,u=this,p=u.options,m=u.yAxis,f=p.threshold;for(h.column.prototype.translate.apply(this),a=l=f,i=u.points,t=0,e=i.length;e>t;t++)n=i[t],o=n.shapeArgs,s=u.getStack(t),c=s.points[u.index+","+t],isNaN(n.y)&&(n.y=u.yData[t]),r=x(a,a+n.y)+c[0],o.y=m.translate(r,0,1),n.isSum?(o.y=m.translate(c[1],0,1),o.height=m.translate(c[0],0,1)-o.y):n.isIntermediateSum?(o.y=m.translate(c[1],0,1),o.height=m.translate(l,0,1)-o.y,l=c[1]):a+=s.total,o.height<0&&(o.y+=o.height,o.height*=-1),n.plotY=o.y=C(o.y)-u.borderWidth%2/2,o.height=x(C(o.height),.001),n.yBottom=o.y+o.height,d=n.plotY+(n.negative?o.height:0),u.chart.inverted?n.tooltipPos[0]=m.len-d:n.tooltipPos[1]=d},processData:function(e){var t,i,n,o,s,r,a,l=this,c=l.options,d=l.yData,u=l.points,h=d.length,p=c.threshold||0;for(n=i=o=s=p,a=0;h>a;a++)r=d[a],t=u&&u[a]?u[a]:{},"sum"===r||t.isSum?d[a]=n:"intermediateSum"===r||t.isIntermediateSum?d[a]=i:(n+=r,i+=r),o=Math.min(n,o),s=Math.max(n,s);S.prototype.processData.call(this,e),l.dataMin=o,l.dataMax=s},toYData:function(e){return e.isSum?"sum":e.isIntermediateSum?"intermediateSum":e.y},getAttribs:function(){h.column.prototype.getAttribs.apply(this,arguments);var t=this,i=t.options,n=i.states,o=i.upColor||t.color,r=e.Color(o).brighten(.1).get(),l=a(t.pointAttr),c=t.upColorProp;l[""][c]=o,l.hover[c]=n.hover.upColor||r,l.select[c]=n.select.upColor||o,s(t.points,function(e){e.y>0&&!e.color&&(e.pointAttr=l,e.color=o)})},getGraphPath:function(){var e,t,i,n,o=this.data,s=o.length,r=this.options.lineWidth+this.borderWidth,a=C(r)%2/2,l=[],c="M",d="L";for(i=1;s>i;i++)t=o[i].shapeArgs,e=o[i-1].shapeArgs,n=[c,e.x+e.width,e.y+a,d,t.x,e.y+a],o[i-1].y<0&&(n[2]+=e.height,n[5]+=e.height),l=l.concat(n);return l},getExtremes:w,getStack:function(e){var t=this.yAxis,i=t.stacks,n=this.stackKey;return this.processedYData[e]<this.options.threshold&&(n="-"+n),i[n][e]},drawGraph:S.prototype.drawGraph}),u.bubble=a(u.scatter,{dataLabels:{formatter:function(){return this.point.z},inside:!0,style:{color:"white",textShadow:"0px 0px 3px black"},verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1},minSize:8,maxSize:"20%",states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0});var k=p(_,{haloPath:function(){return _.prototype.haloPath.call(this,this.shapeArgs.r+this.series.options.states.hover.halo.size)}});return h.bubble=p(h.scatter,{type:"bubble",pointClass:k,pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],bubblePadding:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor"},applyOpacity:function(e){var t=this.options.marker,i=c(t.fillOpacity,.5);return e=e||t.fillColor||this.color,1!==i&&(e=M(e).setOpacity(i).get("rgba")),e},convertAttribs:function(){var e=S.prototype.convertAttribs.apply(this,arguments);return e.fill=this.applyOpacity(e.fill),e},getRadii:function(e,t,i,n){var o,s,r,a,l=this.zData,c=[],d="width"!==this.options.sizeBy;for(s=0,o=l.length;o>s;s++)a=t-e,r=a>0?(l[s]-e)/(t-e):.5,d&&r>=0&&(r=Math.sqrt(r)),c.push(A.ceil(i+r*(n-i))/2);this.radii=c},animate:function(e){var t=this.options.animation;e||(s(this.points,function(e){var i=e.graphic,n=e.shapeArgs;i&&n&&(i.attr("r",1),i.animate({r:n.r},t))}),this.animate=null)},translate:function(){var e,i,n,o=this.data,s=this.radii;for(h.scatter.prototype.translate.call(this),e=o.length;e--;)i=o[e],n=s?s[e]:0,i.negative=i.z<(this.options.zThreshold||0),n>=this.minPxSize/2?(i.shapeType="circle",i.shapeArgs={x:i.plotX,y:i.plotY,r:n},i.dlBox={x:i.plotX-n,y:i.plotY-n,width:2*n,height:2*n}):i.shapeArgs=i.plotY=i.dlBox=t},drawLegendSymbol:function(e,t){var i=d(this.chart.renderer.fontMetrics(e.itemStyle.fontSize,t.legendItem).f)/2;t.legendSymbol=this.chart.renderer.circle(i,e.baseline-i+1,i).attr({zIndex:3}).add(t.legendGroup),t.legendSymbol.isMarker=!0},drawPoints:h.column.prototype.drawPoints,alignDataLabel:h.column.prototype.alignDataLabel}),g.prototype.beforePadding=function(){var e=this,i=this.len,r=this.chart,a=0,l=i,u=this.isXAxis,h=u?"xData":"yData",p=this.min,m={},f=A.min(r.plotWidth,r.plotHeight),g=Number.MAX_VALUE,v=-Number.MAX_VALUE,_=this.max-p,b=i/_,y=[];this.tickPositions&&(s(this.series,function(t){var i,a=t.options;!t.bubblePadding||!t.visible&&r.options.chart.ignoreHiddenSeries||(e.allowZoomOutside=!0,y.push(t),u&&(s(["minSize","maxSize"],function(e){var t=a[e],i=/%$/.test(t);t=d(t),m[e]=i?f*t/100:t}),t.minPxSize=m.minSize,i=t.zData,i.length&&(g=c(a.zMin,A.min(g,A.max(n(i),a.displayNegative===!1?a.zThreshold:-Number.MAX_VALUE))),v=c(a.zMax,A.max(v,o(i))))))}),s(y,function(e){var t,i=e[h],n=i.length;if(u&&e.getRadii(g,v,m.minSize,m.maxSize),_>0)for(;n--;)"number"==typeof i[n]&&(t=e.radii[n],a=Math.min((i[n]-p)*b-t,a),l=Math.max((i[n]-p)*b+t,l))}),y.length&&_>0&&c(this.options.min,this.userMin)===t&&c(this.options.max,this.userMax)===t&&(l-=i,b*=(i+a-l)/i,this.min+=a/b,this.max+=l/b))},function(){function e(e,t,i){e.call(this,t,i),this.chart.polar&&(this.closeSegment=function(e){var t=this.xAxis.center;e.push("L",t[0],t[1])},this.closedStacks=!0)}function t(e,t){var i,n=this.chart,o=this.options.animation,s=this.group,r=this.markerGroup,a=this.xAxis.center,l=n.plotLeft,c=n.plotTop;n.polar?n.renderer.isSVG&&(o===!0&&(o={}),t?(i={translateX:a[0]+l,translateY:a[1]+c,scaleX:.001,scaleY:.001},s.attr(i),r&&r.attr(i)):(i={translateX:l,translateY:c,scaleX:1,scaleY:1},s.animate(i,o),r&&r.animate(i,o),this.animate=null)):e.call(this,t)}var i,n=S.prototype,o=b.prototype;n.toXY=function(e){var t,i,n=this.chart,o=e.plotX,s=e.plotY;e.rectPlotX=o,e.rectPlotY=s,i=(o/Math.PI*180+this.xAxis.pane.options.startAngle)%360,0>i&&(i+=360),e.clientX=i,t=this.xAxis.postTranslate(e.plotX,this.yAxis.len-s),e.plotX=e.polarPlotX=t.x-n.plotLeft,e.plotY=e.polarPlotY=t.y-n.plotTop},n.orderTooltipPoints=function(e){this.chart.polar&&(e.sort(function(e,t){return e.clientX-t.clientX}),e[0]&&(e[0].wrappedClientX=e[0].clientX+360,e.push(e[0])))},h.area&&f(h.area.prototype,"init",e),h.areaspline&&f(h.areaspline.prototype,"init",e),h.spline&&f(h.spline.prototype,"getPointSpline",function(e,t,i,n){var o,s,r,a,l,c,d,u,h,p,m,f,g,v,_,b,y,T,S=1.5,A=S+1;return this.chart.polar?(s=i.plotX,r=i.plotY,a=t[n-1],l=t[n+1],this.connectEnds&&(a||(a=t[t.length-2]),l||(l=t[1])),a&&l&&(c=a.plotX,d=a.plotY,u=l.plotX,h=l.plotY,p=(S*s+c)/A,m=(S*r+d)/A,f=(S*s+u)/A,g=(S*r+h)/A,v=Math.sqrt(Math.pow(p-s,2)+Math.pow(m-r,2)),_=Math.sqrt(Math.pow(f-s,2)+Math.pow(g-r,2)),b=Math.atan2(m-r,p-s),y=Math.atan2(g-r,f-s),T=Math.PI/2+(b+y)/2,Math.abs(b-T)>Math.PI/2&&(T-=Math.PI),p=s+Math.cos(T)*v,m=r+Math.sin(T)*v,f=s+Math.cos(Math.PI+T)*_,g=r+Math.sin(Math.PI+T)*_,i.rightContX=f,i.rightContY=g),n?(o=["C",a.rightContX||a.plotX,a.rightContY||a.plotY,p||s,m||r,s,r],a.rightContX=a.rightContY=null):o=["M",s,r]):o=e.call(this,t,i,n),o}),f(n,"translate",function(e){if(e.call(this),this.chart.polar&&!this.preventPostTranslate)for(var t=this.points,i=t.length;i--;)this.toXY(t[i])}),f(n,"getSegmentPath",function(e,t){var i=this.points;return this.chart.polar&&this.options.connectEnds!==!1&&t[t.length-1]===i[i.length-1]&&null!==i[0].y&&(this.connectEnds=!0,t=[].concat(t,[i[0]])),e.call(this,t)}),f(n,"animate",t),f(n,"setTooltipPoints",function(e,t){return this.chart.polar&&r(this.xAxis,{tooltipLen:360}),e.call(this,t)}),h.column&&(i=h.column.prototype,f(i,"animate",t),f(i,"translate",function(e){var t,i,n,o,s=this.xAxis,r=this.yAxis.len,a=s.center,l=s.startAngleRad,d=this.chart.renderer;if(this.preventPostTranslate=!0,e.call(this),s.isRadial)for(i=this.points,o=i.length;o--;)n=i[o],t=n.barX+l,n.shapeType="path",n.shapeArgs={d:d.symbols.arc(a[0],a[1],r-n.plotY,null,{start:t,end:t+n.pointWidth,innerR:r-c(n.yBottom,r)})},this.toXY(n),n.tooltipPos=[n.plotX,n.plotY],n.ttBelow=n.plotY>a[1]}),f(i,"alignDataLabel",function(e,t,i,o,s,r){if(this.chart.polar){var a,l,c=t.rectPlotX/Math.PI*180;null===o.align&&(a=c>20&&160>c?"left":c>200&&340>c?"right":"center",o.align=a),null===o.verticalAlign&&(l=45>c||c>315?"bottom":c>135&&225>c?"top":"middle",o.verticalAlign=l),n.alignDataLabel.call(this,t,i,o,s,r)}else e.call(this,t,i,o,s,r)})),f(o,"getIndex",function(e,t){var i,n,o,s,r=this.chart;return r.polar?(n=r.xAxis[0].center,o=t.chartX-n[0]-r.plotLeft,s=t.chartY-n[1]-r.plotTop,i=180-Math.round(Math.atan2(o,s)/Math.PI*180)):i=e.call(this,t),i}),f(o,"getCoordinates",function(e,t){var i=this.chart,n={xAxis:[],yAxis:[]};return i.polar?s(i.axes,function(e){var o=e.isXAxis,s=e.center,r=t.chartX-s[0]-i.plotLeft,a=t.chartY-s[1]-i.plotTop;n[o?"xAxis":"yAxis"].push({axis:e,value:e.translate(o?Math.PI-Math.atan2(r,a):Math.sqrt(Math.pow(r,2)+Math.pow(a,2)),!0)})}):n=e.call(this,t),n})}(),e},this),function(e,t){"function"==typeof define&&define.amd?define("heatmap",["highcharts"],e):e(t.Highcharts)}(function(e,t){function i(e,t){var n,o,s=e&&e.length;return s?(n=["plotX","plotY"][t%2],e.sort(function(e,t){return e[n]-t[n]}),o=Math.floor(s/2),{point:e[o],left:i(e.slice(0,o),t+1),right:i(e.slice(o+1),t+1)}):void 0}function n(e,t,i){var o,s,r,a,l,c=t.point,d=["plotX","plotY"][i%2],u=c;return c.dist=Math.pow(e.plotX-c.plotX,2)+Math.pow(e.plotY-c.plotY,2),o=e[d]-c[d],s=0>o?"left":"right",t[s]&&(a=n(e,t[s],i+1),u=a.dist<u.dist?a:c,r=0>o?"right":"left",t[r]&&Math.abs(o)<u.dist&&(l=n(e,t[r],i+1),u=l.dist<u.dist?l:u)),u}var t,o=e.Axis,s=e.Chart,r=e.Color,a=e.Legend,l=e.LegendSymbolMixin,c=e.Series,d=e.SVGRenderer,u=e.getOptions(),h=e.each,p=e.extend,m=e.extendClass,f=e.merge,g=e.pick,v=e.numberFormat,_=e.seriesTypes,b=e.wrap,y=function(){},T=e.ColorAxis=function(){this.isColorAxis=!0,this.init.apply(this,arguments)};p(T.prototype,o.prototype),p(T.prototype,{defaultColorAxisOptions:{lineWidth:0,gridLineWidth:1,tickPixelInterval:72,startOnTick:!0,endOnTick:!0,offset:0,marker:{animation:{duration:50},color:"gray",width:.01},labels:{overflow:"justify"},minColor:"#EFEFFF",maxColor:"#003875",tickLength:5},init:function(e,t){var i,n="vertical"!==e.options.legend.layout;
i=f(this.defaultColorAxisOptions,{side:n?2:1,reversed:!n},t,{isX:n,opposite:!n,showEmpty:!1,title:null,isColor:!0}),o.prototype.init.call(this,e,i),t.dataClasses&&this.initDataClasses(t),this.initStops(t),this.isXAxis=!0,this.horiz=n,this.zoomEnabled=!1},tweenColors:function(e,t,i){var n=1!==t.rgba[3]||1!==e.rgba[3];return(n?"rgba(":"rgb(")+Math.round(t.rgba[0]+(e.rgba[0]-t.rgba[0])*(1-i))+","+Math.round(t.rgba[1]+(e.rgba[1]-t.rgba[1])*(1-i))+","+Math.round(t.rgba[2]+(e.rgba[2]-t.rgba[2])*(1-i))+(n?","+(t.rgba[3]+(e.rgba[3]-t.rgba[3])*(1-i)):"")+")"},initDataClasses:function(e){var t,i=this,n=this.chart,o=0,s=this.options;this.dataClasses=t=[],this.legendItems=[],h(e.dataClasses,function(a,l){var c;a=f(a),t.push(a),a.color||("category"===s.dataClassColor?(c=n.options.colors,a.color=c[o++],o===c.length&&(o=0)):a.color=i.tweenColors(r(s.minColor),r(s.maxColor),l/(e.dataClasses.length-1)))})},initStops:function(e){this.stops=e.stops||[[0,this.options.minColor],[1,this.options.maxColor]],h(this.stops,function(e){e.color=r(e[1])})},setOptions:function(e){o.prototype.setOptions.call(this,e),this.options.crosshair=this.options.marker,this.coll="colorAxis"},setAxisSize:function(){var e,t,i,n,o=this.legendSymbol,s=this.chart;o&&(this.left=e=o.attr("x"),this.top=t=o.attr("y"),this.width=i=o.attr("width"),this.height=n=o.attr("height"),this.right=s.chartWidth-e-i,this.bottom=s.chartHeight-t-n,this.len=this.horiz?i:n,this.pos=this.horiz?e:t)},toColor:function(e,i){var n,o,s,r,a,l,c=this.stops,d=this.dataClasses;if(d){for(l=d.length;l--;)if(a=d[l],o=a.from,s=a.to,(o===t||e>=o)&&(s===t||s>=e)){r=a.color,i&&(i.dataClass=l);break}}else{for(this.isLog&&(e=this.val2lin(e)),n=1-(this.max-e)/(this.max-this.min||1),l=c.length;l--&&!(n>c[l][0]););o=c[l]||c[l+1],s=c[l+1]||o,n=1-(s[0]-n)/(s[0]-o[0]||1),r=this.tweenColors(o.color,s.color,n)}return r},getOffset:function(){var e=this.legendGroup,t=this.chart.axisOffset[this.side];e&&(o.prototype.getOffset.call(this),this.axisGroup.parentGroup||(this.axisGroup.add(e),this.gridGroup.add(e),this.labelGroup.add(e),this.added=!0),this.chart.axisOffset[this.side]=t)},setLegendColor:function(){var e,t=this.horiz,i=this.options;e=t?[0,0,1,0]:[0,0,0,1],this.legendColor={linearGradient:{x1:e[0],y1:e[1],x2:e[2],y2:e[3]},stops:i.stops||[[0,i.minColor],[1,i.maxColor]]}},drawLegendSymbol:function(e,t){var i,n=e.padding,o=e.options,s=this.horiz,r=g(o.symbolWidth,s?200:12),a=g(o.symbolHeight,s?12:200),l=g(o.labelPadding,s?16:30),c=g(o.itemDistance,10);this.setLegendColor(),t.legendSymbol=this.chart.renderer.rect(0,e.baseline-11,r,a).attr({zIndex:1}).add(t.legendGroup),i=t.legendSymbol.getBBox(),this.legendItemWidth=r+n+(s?c:l),this.legendItemHeight=a+n+(s?l:0)},setState:y,visible:!0,setVisible:y,getSeriesExtremes:function(){var e;this.series.length&&(e=this.series[0],this.dataMin=e.valueMin,this.dataMax=e.valueMax)},drawCrosshair:function(e,t){var i,n=!this.cross,s=t&&t.plotX,r=t&&t.plotY,a=this.pos,l=this.len;t&&(i=this.toPixels(t.value),a>i?i=a-2:i>a+l&&(i=a+l+2),t.plotX=i,t.plotY=this.len-i,o.prototype.drawCrosshair.call(this,e,t),t.plotX=s,t.plotY=r,!n&&this.cross&&this.cross.attr({fill:this.crosshair.color}).add(this.labelGroup))},getPlotLinePath:function(e,t,i,n,s){return s?this.horiz?["M",s-4,this.top-6,"L",s+4,this.top-6,s,this.top,"Z"]:["M",this.left,s,"L",this.left-6,s+6,this.left-6,s-6,"Z"]:o.prototype.getPlotLinePath.call(this,e,t,i,n)},update:function(e,t){h(this.series,function(e){e.isDirtyData=!0}),o.prototype.update.call(this,e,t),this.legendItem&&(this.setLegendColor(),this.chart.legend.colorizeItem(this,!0))},getDataClassLegendSymbols:function(){var e,i=this,n=this.chart,o=this.legendItems,s=n.options.legend,r=s.valueDecimals,a=s.valueSuffix||"";return o.length||h(this.dataClasses,function(s,c){var d=!0,u=s.from,m=s.to;e="",u===t?e="< ":m===t&&(e="> "),u!==t&&(e+=v(u,r)+a),u!==t&&m!==t&&(e+=" - "),m!==t&&(e+=v(m,r)+a),o.push(p({chart:n,name:e,options:{},drawLegendSymbol:l.drawRectangle,visible:!0,setState:y,setVisible:function(){d=this.visible=!d,h(i.series,function(e){h(e.points,function(e){e.dataClass===c&&e.setVisible(d)})}),n.legend.colorizeItem(this,d)}},s))}),o},name:""}),b(s.prototype,"getAxes",function(e){var t=this.options,i=t.colorAxis;e.call(this),this.colorAxis=[],i&&(e=new T(this,i))}),b(a.prototype,"getAllItems",function(e){var t=[],i=this.chart.colorAxis[0];return i&&(i.options.dataClasses?t=t.concat(i.getDataClassLegendSymbols()):t.push(i),h(i.series,function(e){e.options.showInLegend=!1})),t.concat(e.call(this))});var S={pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",dashstyle:"dashStyle"},pointArrayMap:["value"],axisTypes:["xAxis","yAxis","colorAxis"],optionalAxis:"colorAxis",trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:y,parallelArrays:["x","y","value"],colorKey:"value",translateColors:function(){var e=this,t=this.options.nullColor,i=this.colorAxis,n=this.colorKey;h(this.data,function(o){var s,r=o[n];s=null===r?t:i&&void 0!==r?i.toColor(r,o):o.color||e.color,s&&(o.color=s)})}};return b(d.prototype,"buildText",function(e,t){var i=t.styles&&t.styles.HcTextStroke;e.call(this,t),i&&t.applyTextStroke&&t.applyTextStroke(i)}),d.prototype.Element.prototype.applyTextStroke=function(e){var t,i,n=this.element;e=e.split(" "),t=n.getElementsByTagName("tspan"),i=n.firstChild,this.ySetter=this.xSetter,h([].slice.call(t),function(t,o){var s;0===o&&(t.setAttribute("x",n.getAttribute("x")),null!==(o=n.getAttribute("y"))&&t.setAttribute("y",o)),s=t.cloneNode(1),s.setAttribute("stroke",e[1]),s.setAttribute("stroke-width",e[0]),s.setAttribute("stroke-linejoin","round"),n.insertBefore(s,i)})},u.plotOptions.heatmap=f(u.plotOptions.scatter,{animation:!1,borderWidth:0,nullColor:"#F8F8F8",dataLabels:{formatter:function(){return this.point.value},verticalAlign:"middle",crop:!1,overflow:!1,style:{color:"white",fontWeight:"bold",HcTextStroke:"1px rgba(0,0,0,0.5)"}},marker:null,tooltip:{pointFormat:"{point.x}, {point.y}: {point.value}<br/>"},states:{normal:{animation:!0},hover:{brightness:.2}}}),_.heatmap=m(_.scatter,f(S,{type:"heatmap",pointArrayMap:["y","value"],hasPointSpecificOptions:!0,supportsDrilldown:!0,getExtremesFromAll:!0,init:function(){_.scatter.prototype.init.apply(this,arguments),this.pointRange=this.options.colsize||1,this.yAxis.axisPointRange=this.options.rowsize||1,this.checkTooltipStyleElement()},checkTooltipStyleElement:function(){var e=jQuery(this.chart.container),t=e.find("#jasper_highcharts_css");this.chart.options.chart.isHeatMapTimeSeriesChart?t.length||this.addTooltipStyleElement():t.length&&t.remove()},addTooltipStyleElement:function(){var e=jQuery(this.chart.container),t=jQuery("<style type='text/css'>.highcharts-tooltip>span {background: rgba(255,255,255,0.85);border: 1px solid silver;border-radius: 3px;box-shadow: 1px 1px 2px #888;padding: 8px;z-index: 2;}.highcharts-button>span {background: rgba(255,255,255,0.85);border: 1px solid silver;border-radius: 3px;padding: 5px;z-index: 2;cursor: pointer;}.highcharts-button>span:hover {background: -moz-linear-gradient(top, #ffffff 0%, #aaccff 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#aaccff));background: -webkit-linear-gradient(top, #ffffff 0%,#aaccff 100%);background: -o-linear-gradient(top, #ffffff 0%,#aaccff 100%);background: -ms-linear-gradient(top, #ffffff 0%,#aaccff 100%);background: linear-gradient(to bottom, #ffffff 0%,#aaccff 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#aaccff',GradientType=0 );}</style>");t.id="jasper_highcharts_css",e.append(t)},translate:function(){var e=this,t=e.options,i=e.xAxis,n=e.yAxis;e.generatePoints(),h(e.points,function(e){var o=(t.colsize||1)/2,s=(t.rowsize||1)/2,r=Math.round(i.len-i.translate(e.x-o,0,1,0,1)),a=Math.round(i.len-i.translate(e.x+o,0,1,0,1)),l=Math.round(n.translate(e.y-s,0,1,0,1)),c=Math.round(n.translate(e.y+s,0,1,0,1));e.plotX=(r+a)/2,e.plotY=(l+c)/2,e.shapeType="rect",e.shapeArgs={x:Math.min(r,a),y:Math.min(l,c),width:Math.abs(a-r),height:Math.abs(c-l)}}),e.translateColors()},drawPoints:function(){var t;this.chart.renderer.forExport||!this.chart.options.chart.isHeatMapTimeSeriesChart?_.column.prototype.drawPoints.call(this):(t=this.getContext())?(t.canvas.height=this.chart.renderer.plotBox.height,t.canvas.width=this.chart.renderer.plotBox.width,e.each(this.points,function(e){var i,n=e.plotY;void 0===n||isNaN(n)||null===e.y||(i=e.shapeArgs,t.fillStyle=e.pointAttr[""].fill,t.fillRect(i.x,i.y,i.width,i.height))})):this.chart.showLoading("Your browser doesn't support HTML5 canvas, <br>please use a modern browser")},animate:y,getBox:y,drawLegendSymbol:l.drawRectangle,getExtremes:function(){c.prototype.getExtremes.call(this,this.valueData),this.valueMin=this.dataMin,this.valueMax=this.dataMax,c.prototype.getExtremes.call(this)},getContext:function(){var e;return this.ctx||(e=document.createElement("canvas"),e.setAttribute("width",this.chart.plotWidth),e.setAttribute("height",this.chart.plotHeight),e.style.position="absolute",e.style.left=this.group.translateX+"px",e.style.top=this.group.translateY+"px",e.style.zIndex=0,e.style.cursor="crosshair",this.chart.container.appendChild(e),e.getContext&&(this.ctx=e.getContext("2d"))),this.ctx},setTooltipPoints:function(){var e=this;this.tree=null,setTimeout(function(){e.tree=i(e.points,0)})},getNearest:function(e){return this.tree?n(e,this.tree,0):void 0}})),e.wrap(e.Pointer.prototype,"runPointActions",function(t,i){var n=this.chart;t.call(this,i),this.chart.options.chart.isHeatMapTimeSeriesChart&&e.each(n.series,function(e){var t;e.getNearest&&(t=e.getNearest({plotX:i.chartX-n.plotLeft,plotY:i.chartY-n.plotTop}),t&&t.onMouseOver(i))})}),e},this),function(e){"function"==typeof define&&define.amd?define("adhoc/chart/Highcharts",["highcharts","grouped-categories","adhoc/chart/ext/multiplePieTitlesExt","highcharts-more","heatmap"],e):e(Highcharts)}(function(e){return e}),function(e,t){"function"==typeof define&&define.amd?define("adhoc/chart/adhocDataProcessor",["underscore"],e):t.AdhocDataProcessor=e(_)}(function(e){var t={debug:!1,fn:{getMessage:function(e){return this.messages?this.messages[e]:e},load:function(e){var i=t;i.data=e.data,i.metadata=e.metadata,i.treeNodeAxes=e.treeNodes,i.fn.load_common(),t.debug&&(console.info("Data Processor State:"),console.info(i))},load_common:function(){var e=t;if(e.measureAxis=e.metadata.measureAxis,e.nonMeasureAxis=0==e.measureAxis?1:0,e.metadata.axes.length&&(e.measureLevelNumber=e.fn.getMeasureLevelNumber.call(e),e.metadata.isOLAP&&(e.measureDimensionNumber=0,e.dimensionMappings=[],e.dimensionAllMappings=new Array(2),e.dimensionLevels=new Array(2),e.rowDimensionMapping=e.fn.dimensionMapping(0),e.dimensionMappings.push(e.rowDimensionMapping),e.colDimensionMapping=e.fn.dimensionMapping(1),e.dimensionMappings.push(e.colDimensionMapping)),e.lastRowNonMeasureLevel=0,e.lastColumnNonMeasureLevel=0,e.rowSliderLevelCount=e.metadata.axes[0].length+1-(0==e.metadata.measureAxis?1:0),e.colSliderLevelCount=e.metadata.axes[1].length+1-(1==e.metadata.measureAxis?1:0),e.rowGroupMapping=e.fn.groupMapping.call(e,0),e.colGroupMapping=e.fn.groupMapping.call(e,1)),e.treeNodeAxes.length&&(e.fn.createTreeNodeStructure.call(e,e.treeNodeAxes[0]),e.fn.createTreeNodeStructure.call(e,e.treeNodeAxes[1])),e.data.length){if("undefined"==typeof e.measureAxis)throw"AdhocDataProcessor.load_common  missing measureAxis metadata !";if(e.measureAxis>1)throw"AdhocDataProcessor.load_common  measureAxis > 1 !";if(e.measureAxis<0)throw"AdhocDataProcessor.load_common  measureAxis < 0 !";if("undefined"==typeof e.measureLevelNumber)throw"AdhocDataProcessor.load_common  measureLevelNumber undetermined !";if(e.measureLevelNumber<=0)throw"AdhocDataProcessor.load_common  measureLevelNumber <= 0 !"}},getOLAPDimensionInfo:function(){for(var e=t,i=new Array(2),n=0;2>n;n++){var o=[],s=e.dimensionMappings[n],r=e.measureAxis===n;if(s.length<=0);else for(var a=e.dimensionAllMappings[n],l=0;l<s.length;l++){var c=s[l];if(!(r&&c.length>0&&"Measures"===c[0].dimension)){var d=!1;a[l]===!0&&(d=!0);var u={};u.levels=[];var h=0;d&&u.levels.push({label:"(All)",levelName:"(All)",levelNumber:h}),h=1;for(var p=0;p<c.length;p++){var m=c[p];u.dimension=m.dimension,m.name&&"(All)"===m.name||(u.levels.push({label:m.label,levelName:m.name,levelNumber:h}),h++)}o.push(u)}}i[n]=o}return t.debug&&(console.log("AdhocDataProcessor.getOLAPDimensionInfo: 4098h  olapAxes"),console.log(i)),i},getMeasureLevelNumber:function(){for(var e=this.metadata.axes[this.metadata.measureAxis],t=0;t<e.length;t++)if("Measures"==e[t].label)return t+1},groupMapping:function(e){var i,n=t,o=[0],s=1,r=n.metadata.axes[e];for(i=0;i<r.length;i++)"Measures"!=r[i].label&&(o[s++]=i+1);return o},dimensionMapping:function(e){var i=t;if(!i.metadata.isOLAP)return null;var n=i.metadata.axes[e],o=1,s=[],r=[];if(i.metadata.axes[e].length<=0)return s;var a=0,l=!1,c=n[0].dimension,d=c;c||alert("dataprocessor.js  ERROR ! 0983jhrn   null dimension in axis "+e);for(var u=[],h=[],p=[],m=o,f=0;f<n.length;f++)if(d=n[f].dimension,"Measures"===d&&(i.measureDimensionNumber=a,i.measureLevelNumber=o),d!==c&&(r.push(l?!0:!1),p.push({dimension:c,startLevel:m,endLevel:o-1}),s.push(u),a++,u=[],l=!1,c=d,m=o),"(All)"!==n[f].label&&"(ALL)"!==n[f].label||(l=!0,!(f<n.length-1&&d===n[f+1].dimension))){var g={dimension:n[f].dimension,label:n[f].label,name:n[f].name,levelNumber:o};u.push(g),h.push(g),o++}return r.push(l?!0:!1),s.push(u),p.push({dimension:d,startLevel:m,endLevel:o-1}),i.metadata.axes[e]=h,i.dimensionAllMappings[e]=r,i.dimensionLevels[e]=p,t.debug&&(console.log("AdhocDataProcessor.dimensionMapping:49e8h  dimensions for axis "+e),console.log(s)),s},createTreeNodeStructure:function(e){var t=e;t.parent=null,t.children?this.fn.connectParentNode.call(this,t,t.children):t.children=[]},connectParentNode:function(e,t){var i,n;for(i=0;i<t.length;i++)if(n=t[i],n.parent=e,n.children){var o=n.children;o.length&&this.fn.connectParentNode.call(this,n,o)}else n.children=[]},getDataStyle:function(){var e=t;return 0==e.metadata.axes[e.nonMeasureAxis].length?0:e.metadata.axes[e.nonMeasureAxis].length>0&&e.metadata.axes[e.measureAxis].length>1?2:1},getNodeListForSliderLevel:function(e,i){var n=t,o=n.metadata.axes[e].length,s=[];s.push({startLevel:0,endLevel:i,leafLevel:o});var r=n.fn.getNodeListForDimLevels(e,s);return t.debug&&(console.log("AdhocDataProcessor.getNodeListForSliderLevel: 4088h  nodeList for axisIndex="+e+" sliderLevel="+i),console.log(r)),r},getNodeListForDimLevelRadio:function(e,i){var n=t;if(!n.metadata.isOLAP)throw"dataprocessor.getNodeListForDimLevelRadio called RadioButton method for non-OLAP query !";if(null===i)throw"dataprocessor.getNodeListForDimLevelRadio.js  y5g59i8y  NULL radioLevel input !";var o=n.dimensionMappings[e];if(!o)throw"dataprocessor.getNodeListForDimLevelRadio.js 0oi098  no dimensionMappings for axis "+e;if(o.length<=0)return n.fn.getEmptyAxisResult();if(i.length>o.length)throw"dataprocessor.getNodeListForDimLevelRadio.js  98hu for axis: "+e+", number of input dimensionss from radio buttons: "+i.length+", exceeds the number of dimensions in the chart data: "+o.length;if(i.length+(e==n.metadata.measureAxis?1:0)<o.length){t.debug&&console.log("AdhocDataProcessor.getNodeListForDimLevelRadio.js need to add  Radio Dimensions padding");for(var s=i.length,r=s;r<o.length;r++){var a=o[r];"Measures"!==a.dimension&&i.push({level:a.length})}}var l=[],c=(n.metadata.axes[e],o.length,0),d=0,u=!1,h=o[0],p="Measures"===h[0].dimension,m=0;if(p&&(m=1),p&&0==i.length)l.push({startLevel:0,endLevel:1,leafLevel:1});else for(var f=0;f<i.length;f++){var a=o[f+m];if(null===a)throw"dataprocessor.getNodeListForDimLevelRadio.js 98hn8 metadata  no dimension for number "+f;if(c++,n.metadata.measureAxis===e&&0>=m){if(f+2>o.length)throw"dataprocessor.getNodeListForDimLevelRadio.js  43098h  we were expecting dimensions to be at least "+(f+2)+" in length, instead it is "+o.length;var g=o[f+1];"Measures"===g[0].dimension&&(u=!0,m=1)}var v=a.length,_=d,b=d+i[f].level,y=d+v;(p||u)&&((b===y||p)&&b++,y++,p=!1,u=!1),l.push({startLevel:_,endLevel:b,leafLevel:y}),d=y}var T=n.fn.getNodeListForDimLevels(e,l);return t.debug&&(console.log("AdhocDataProcessor.getNodeListForDimLevelRadio: 39uh  nodeList for axis="+e+" radioDims, dimLevels "),console.log(i),console.log(l),console.log(T)),T},getNodeListForDimLevels:function(e,i){var n=t;if(0==n.metadata.axes[0].length&&0==n.metadata.axes[1].length)return null;var o=n.metadata.axes[e].length;if(o>0){var s=n.fn.getNodeListForDimensionLevelsMeasure(e,i);return s}return n.fn.getEmptyAxisResult()},getNodeListForSliderLevelGroupMeasure:function(e,i){var n=t,o=n.metadata.axes[e].length;if(o>0){var s=[];return s.push({startLevel:0,endLevel:i,leafLevel:o}),n.fn.getNodeListForDimensionLevelsMeasure(e,s)}return n.fn.getEmptyAxisResult()},getEmptyAxisResult:function(){var e=t;if(!e.emptyAxisResult){var i={isAll:!1,label:"(empty axis)",level:0,axisCoordinate:0};e.emptyAxisResult=[],e.emptyAxisResult.push(i)}return e.emptyAxisResult},getNodeListForDimensionLevelsMeasure:function(e,i){var n=t,o=!1;e===n.metadata.measureAxis&&(o=!0);var s=0==e?n.rowGroupMapping:n.colGroupMapping,r=n.treeNodeAxes[e],a=[];a.push(r);for(var l=0;l<i.length;l++){var c=i[l].startLevel,d=i[l].endLevel,u=i[l].leafLevel;t.debug&&console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure: 93287h  begin qualifying nodes for dim="+l+" startlevel="+c+", endLevel="+d+"localLeafLevel="+u);var h=!1;n.metadata.isOLAP?d===u&&(h=!0):l>=i.length-1&&(0==e?d>=n.rowSliderLevelCount-1&&(h=!0):d>=n.colSliderLevelCount-1&&(h=!0));var p=[];if(h){var m=u;n.metadata.isOLAP||l===i.length-1&&(m=n.metadata.axes[e].length),n.fn.getNodeListForActualLevel(e,a,m,p),t.debug&&(console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure: we9iuhf  LeafLevel nodeList for targetLevel="+m),console.log(p));var f=[],g=0;n.metadata.isOLAP&&(g=c);for(var v=0;v<p.length;v++){var _=p[v];if(_.isAll!==!0)for(var b=_.parent;null!=b;){if(b.level<=g){f.push(_);break}if(b.isAll===!0)break;b=b.parent}}a=f,t.debug&&(console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure:  er83   qualifiedChildren"),console.log(a))}else{var m=s[d+1];n.metadata.isOLAP&&(m=d+1),1==i.length&&0==m?p.push(r):a&&n.fn.getNodeListForActualLevel(e,a,m,p);for(var y=[],v=0;v<p.length;v++){var _=p[v],T=!1;if(_.level<=0)throw"dataprocessor.getNodeListForDimensionLevelsMeasure  leaf  node.level is unexpectedly less or equal to zero !";if(0!=_.level&&_.isAll===!0&&(T=!0),T){if(!_.parent)throw"AdhocDataProcessor.getNodeListForDimensionLevelsMeasure Unexpected missing node.parent in axis "+e;var S=_.parent;if(o&&_.parent.level==n.measureLevelNumber&&n.measureLevelNumber>1){if(!_.parent.parent)throw"AdhocDataProcessor.getNodeListForDimensionLevelsMeasure Unexpected missing node.parent.parent in axis "+e;S=_.parent.parent}S.level>c&&S.isAll===!0&&(T=!1)}T&&(_.level===u?y.push(_):n.fn.chaseAllNodesToLeafToList(_.parent,_,u,y))}a=y,t.debug&&(console.log("AdhocDataProcessor.getNodeListForDimensionLevelsMeasure: 3w948h  non-LeafLevel qualified children    X"),console.log(a))}}return a},getNodeListForActualLevel:function(e,i,n,o){for(var s=t,r=0;r<i.length;r++){var a=i[r];a.level==n?o.push(a):a.children&&s.fn.getNodeListForActualLevel(e,a.children,n,o)}},chaseAllNodesToLeafToList:function(e,i,n,o){var s=t;if(i.level<n&&"children"in i&&i.children.length>0)for(var r=0;r<i.children.length;r++){var a=i.children[r],l=!1;if(a.isAll===!1?a.level==s.measureLevelNumber&&(l=!0):l=!0,l){var c=s.fn.chaseAllNodesToLeafToList(e,a,n,o);c.level===n&&o.push(c)}}return i},recurseLeafArrayFromSimpleNode:function(e,i){var n=t;if(e.children.length>0)for(var o=e.children,s=0;s<o.length;s++)n.fn.recurseLeafArrayFromSimpleNode(o[s],i);else i.push(e)},getDataFromRowColumn:function(e,i){if(!e)throw"dataprocessor.getDataFromRowColumn   NULL row object !";if(e.axisCoordinate<0)throw"dataprocessor.getDataFromRowColumn   row Coordinate < 0 !";if(!i)throw"dataprocessor.getDataFromRowColumn   NULL column object !";if(i.axisCoordinate<0)throw"dataprocessor.getDataFromRowColumn   column Coordinate < 0 !";return t.data[e.axisCoordinate][i.axisCoordinate]},getLabelNameArray:function(e,i){var n=t,o=[];if(null===i)return o;var s=i;if(n.metadata.isOLAP){var r=(i.level,n.dimensionLevels[e]),a=0;if(r)for(var l=0;l<r.length;l++)if(a=l,s.level>=r[l].startLevel&&s.level<=r[l].endLevel){for(;s.parent;){if(!s.isAll){o.push(s.label);break}if(!s.parent)break;if(s=s.parent,s.level<r[l].startLevel)break}break}for(var l=a-1;l>=0;l--){var c=r[l].startLevel,d=r[l].endLevel;for(s=i;s.parent;)if(s=s.parent,s.level<=d&&s.level>=c&&s.level>0&&!s.isAll){o.push(s.label);break}}}else{for(;null!=s.parent;)s.isAll!==!0&&o.push(s.label),s=s.parent;s.level>0&&o.push(s.label)}return o.length<=0&&o.push(this.getMessage("totalsLabelForChart")),o},isOLAP:function(){var e=t;return e.metadata.isOLAP},isMeasuresLastOnAxis:function(e){var i=t;if(e!==i.measureAxis)return!1;if(i.fn.isOLAP()){var n=i.dimensionMappings[e];if(n.length<=0)return!1;var o=n[n.length-1],s=o[0];return"Measures"===s.dimension?!0:!1}var r=i.metadata.axes[e];return"Measures"===r[r.length-1].label?!0:!1},doPathsMatch:function(e,t){for(;e.parent;){if(0===e.parent.level)return 0===t.parent.level?!0:!1;if(!t.parent)return!1;if(e=e.parent,t=t.parent,e.level!==t.level)return!1;if(e.label!==t.label)return!1}return t.parent?!1:!0},getLevelsWithoutMeasures:function(t){return e.filter(t,function(e){return"Measures"!=e.dimension})},getLevelIndex:function(e,t){for(var i=0;i<e.length;i++)if(e[i].name===t.name)return i;throw"Specified level was not found."},levelsToLevelNumbers:function(e,i){var n=t.fn,o=[];if(n.isOLAP()){var s=n.getOLAPDimensionInfo();o=n._getOlapLevelNumbers(e,s[i])}else o=n._getNonOlapDataProcessorLevelNumber(e,t.metadata.axes[i]);return o},_getOlapLevelNumbers:function(i,n){var o=t.fn;return e.map(i,function(t){var i=e.find(n,function(e){return e.dimension===t.dimension});return{level:o._getOlapDataProcessorLevelNumber(t,i)}})},_getOlapDataProcessorLevelNumber:function(e,t){for(var i=0;i<t.levels.length;i++)if(t.levels[i].levelName===e.name)return t.levels[i].levelNumber;throw"No olap info found for specified level = "+e.name},_getNonOlapDataProcessorLevelNumber:function(e,i){var n=t.fn;if(0==e.length)return 0;var o=n.getLevelsWithoutMeasures(i);return n.getLevelIndex(o,e[0])+1}}};return{messages:{},getMessage:t.fn.getMessage,load:t.fn.load,levelsToLevelNumbers:t.fn.levelsToLevelNumbers,getLevelIndex:t.fn.getLevelIndex,getLevelsWithoutMeasures:t.fn.getLevelsWithoutMeasures,getOLAPDimensionInfo:t.fn.getOLAPDimensionInfo,getDataFromRowColumn:t.fn.getDataFromRowColumn,getLabelNameArray:t.fn.getLabelNameArray,isMeasuresLastOnAxis:t.fn.isMeasuresLastOnAxis,getDataStyle:t.fn.getDataStyle,getNodeListForDimLevelRadio:t.fn.getNodeListForDimLevelRadio,getNodeListForSliderLevel:t.fn.getNodeListForSliderLevel,getColumnSliderLevelCount:function(){return t.colSliderLevelCount},getRowSliderLevelCount:function(){return t.rowSliderLevelCount}}},this),function(e,t){"function"==typeof define&&define.amd?define("adhoc/chart/palette/defaultPalette",e):t.hcDefaultPalette=e()}(function(){return{colors:["#0d233a","#2f7ed8","#910000","#8bbc21","#492970","#ff7f27","#ffc90e","#1aadce","#c42525","#158349","#77a1e5","#c40062","#dbaa00","#4572a7","#aa4643","#89a54e","#80699b","#74462e","#c03c03","#b58c00"],rgbColors:[[13,35,58],[47,126,216],[145,0,0],[139,188,33],[73,41,112],[255,127,39],[255,201,14],[26,173,206],[196,37,37],[21,131,73],[119,161,229],[196,0,98],[219,170,0],[69,114,167],[170,70,67],[137,165,78],[128,105,155],[61,150,174],[219,132,61],[146,168,205],[164,125,124],[181,202,146]],colorAxis:{stops:[[.1,"#F6365F"],[.5,"#FFD961"],[.9,"#50C463"]]}}},this),function(e,t){"function"==typeof define&&define.amd?define("adhoc/chart/enum/dateTimeFormats",e):t.hcDateTimeFormats=e()}(function(){return{dateTimeLabelFormatsMap:{day:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%b %e, %Y",week:"%b %e, %Y",month:"%b %e, %Y",year:"%b %e, %Y"},hour_by_day:{millisecond:"%b %e, %Y %H:%M:%S.%L",second:"%b %e, %Y %H:%M:%S",minute:"%b %e, %Y %H:%M",hour:"%b %e, %Y %H:%M",day:"%b %e, %Y %H:%M",week:"%b %e, %Y %H:%M",month:"%b %e, %Y %H:%M",year:"%b %e, %Y %H:%M"},minute_by_day:{millisecond:"%b %e, %Y %H:%M:%S.%L",second:"%b %e, %Y %H:%M:%S",minute:"%b %e, %Y %H:%M",hour:"%b %e, %Y %H:%M",day:"%b %e, %Y %H:%M",week:"%b %e, %Y %H:%M",month:"%b %e, %Y %H:%M",year:"%b %e, %Y %H:%M"},second_by_day:{millisecond:"%b %e, %Y %H:%M:%S.%L",second:"%b %e, %Y %H:%M:%S",minute:"%b %e, %Y %H:%M:%S",hour:"%b %e, %Y %H:%M:%S",day:"%b %e, %Y %H:%M:%S",week:"%b %e, %Y %H:%M:%S",month:"%b %e, %Y %H:%M:%S",year:"%b %e, %Y %H:%M:%S"},millisecond_by_day:{millisecond:"%b %e, %Y %H:%M:%S.%L",second:"%b %e, %Y %H:%M:%S.%L",minute:"%b %e, %Y %H:%M:%S.%L",hour:"%b %e, %Y %H:%M:%S.%L",day:"%b %e, %Y %H:%M:%S.%L",week:"%b %e, %Y %H:%M:%S.%L",month:"%b %e, %Y %H:%M:%S.%L",year:"%b %e, %Y %H:%M:%S.%L"},hour:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%H:%M",week:"%b %e, %Y",month:"%b %e, %Y",year:"%b %e, %Y"},minute:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%H:%M",week:"%b %e, %Y",month:"%b %e, %Y",year:"%b %e, %Y"},second:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M:%S",hour:"%H:%M:%S",day:"%H:%M:%S",week:"%b %e, %Y",month:"%b %e, %Y",year:"%b %e, %Y"},millisecond:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S.%L",minute:"%H:%M:%S.%L",hour:"%H:%M:%S.%L",day:"%H:%M:%S.%L",week:"%b %e, %Y",month:"%b %e, %Y",year:"%b %e, %Y"}},dateTimeTooltipFormatsMap:{day:"%b %e, %Y",hour_by_day:"%b %e, %Y %H:%M",minute_by_day:"%b %e, %Y %H:%M",second_by_day:"%b %e, %Y %H:%M:%S",millisecond_by_day:"%b %e, %Y %H:%M:%S.%L",hour:"%H:%M",minute:"%H:%M",second:"%H:%M:%S",millisecond:"%H:%M:%S.%L"}}},this),function(e,t){"function"==typeof define&&define.amd?define("adhoc/chart/enum/adhocToHighchartsTypes",e):t.adhocToHighchartsTypes=e()}(function(){return{column:"column",stacked_column:"column",percent_column:"column",bar:"bar",stacked_bar:"bar",percent_bar:"bar",spider_column:"column",line:"line",spline:"spline",spline_area:"areaspline",area:"area",stacked_area:"area",percent_area:"area",spider_line:"line",spider_area:"area",pie:"pie",dual_level_pie:"pie",line_time_series:"line",spline_time_series:"spline",area_time_series:"area",spline_area_time_series:"areaspline",column_line:"",column_spline:"",stacked_column_line:"",stacked_column_spline:"",multi_axis_line:"",multi_axis_spline:"",multi_axis_column:"",scatter:"scatter",bubble:"bubble",heat_map:"heatmap",heat_map_time_series:"heatmap"}},this),function(e,t){"function"==typeof define&&define.amd?define("adhoc/chart/highchartsDataMapper",["underscore","adhoc/chart/adhocDataProcessor","adhoc/chart/palette/defaultPalette","adhoc/chart/enum/dateTimeFormats","adhoc/chart/enum/adhocToHighchartsTypes","highcharts"],e):t.highchartsDataMapper=e(_,AdhocDataProcessor,hcDefaultPalette,hcDateTimeFormats,adhocToHighchartsTypes,Highcharts)}(function(e,t,i,n,o,s){var r=e.chain({}).extend(i).extend(n).value();return e.extend(r,{SeriesType:{COMMON:0,PIE:1,DUAL_LEVEL_PIE:2,HEAT_MAP:3,HEAT_MAP_TIME_SERIES:4},chartType:null,fullGroupHierarchyNames:!0,defaultPiesPerRow:8,maxPieRows:4,HEATMAP_LEGEND_TICK_INTERVAL:150,categories:[],categoryNames:{},groupedCategories:!1,highchartsCategories:[],measureMin:null,measureMax:null,getSeriesByType:function(e,i,n,o){var s,a;o.metadata.isOLAP?(s=t.getNodeListForDimLevelRadio(0,i),a=t.getNodeListForDimLevelRadio(1,n)):(s=t.getNodeListForSliderLevel(0,i),a=t.getNodeListForSliderLevel(1,n));var l;switch(e){case r.SeriesType.COMMON:l=r.getCommonSeries(s,a,o);break;case r.SeriesType.PIE:l=r.getPieSeries(s,a,i,n,o);break;case r.SeriesType.DUAL_LEVEL_PIE:l=r.getDualLevelPieSeries(s,a,i,n,o);break;case r.SeriesType.HEAT_MAP:l=r.getHeatMapOptions(s,a,o);break;case r.SeriesType.HEAT_MAP_TIME_SERIES:l=r.getHeatMapTimeSeriesOptions(s,a,o);break;default:throw"Unknown series type!"}return l},getColor:function(e){return r.colors[e%r.colors.length]},getColorWithAlpha:function(e,t){var i=r.rgbColors[e%r.colors.length];return"rgba("+i[0]+", "+i[1]+", "+i[2]+", "+t+")"},generateXAxisLabelsOptions:function(t){var i={step:t.step,maxStaggerLines:1,style:{fontSize:"1em"}};return 0!=t.rotation&&(e.extend(i,{rotation:t.rotation}),t.adjustPosition&&90===t.rotation?i.x=-4:270===t.rotation&&(i.x=4)),i},doAxisSwap:function(e){return-1!=e.indexOf("bar")},getLegendOptions:function(e){var t={borderWidth:e.chartState.legendBorder?1:0,itemStyle:{fontWeight:"normal",fontSize:"1em"}};switch(t.enabled="none"===e.chartState.legend?!1:r.isScatterOrBubbleChart(e.chartState.chartType)?!r.isTotalSelectedOnly(e,1):!0,e.chartState.legend){case"top":t.align="center",t.verticalAlign="top";break;case"left":case"right":t.align=e.chartState.legend,t.verticalAlign="middle",t.layout="vertical"}return t},getGeneralOptions:function(e){return{chart:{renderTo:"chartContainer",zoomType:"xy",type:r.adHocToHighchartsChartTypeMap[e.chartState.chartType],polar:r.isSpiderChart(e.chartState.chartType),style:{fontSize:"1em"}},credits:{enabled:!1},title:{text:null},tooltip:{valueDecimals:2,useHTML:!0,style:{fontSize:"1em"}}}},getCommonSeriesGeneralOptions:function(t){var i=r.doAxisSwap(t.chartState.chartType),n=e.extend(r.getGeneralOptions(t),{xAxis:r.getXAxisOptions(i,t),yAxis:r.isDualOrMultiAxisChart(t.chartState.chartType)?[]:r.getYAxisOptions(i,t),plotOptions:{series:{marker:{enabled:t.chartState.showDataPoints},tooltip:{dateTimeLabelFormats:t.isTimeSeries?r.getDateTimeLabelFormats(t.chartState.timeSeriesCategorizerName):void 0,xDateFormat:t.isTimeSeries?r.getDateTimeTooltipFormats(t.chartState.timeSeriesCategorizerName):void 0}}},series:[],legend:r.getLegendOptions(t)});return r._isTooltipFollowPointerEnabled(t.chartState.chartType)&&(n.tooltip.followPointer=!0),n.tooltip.shared=r.isDualOrMultiAxisChart(t.chartState.chartType)||r.isSpiderChart(t.chartState.chartType)?!0:!1,n},isTotalSelectedOnly:function(t,i){var n=0==i?t.chartState.rowsSelectedLevels:t.chartState.columnsSelectedLevels,o=!0;return t.metadata.isOLAP?e.each(n,function(e){"(All)"!=e.name&&(o=!1)}):o=0==n.length,o},getXAxisOptions:function(e,t){var i={categories:[],title:{text:r.isScatterOrBubbleChart(t.chartState.chartType)?t.metadata.measures[0]:""}};return r.isSpiderChart(t.chartState.chartType)&&(i.tickmarkPlacement="on",i.lineWidth=0),i.labels=r.generateXAxisLabelsOptions({rotation:e?t.chartState.yAxisRotation:t.chartState.xAxisRotation,adjustPosition:!e,step:e?t.chartState.yAxisStep:t.chartState.xAxisStep}),e&&Math.abs(t.chartState.xAxisRotation)>=75&&(i.labels.align="right"),i.offset=Math.abs(t.chartState.xAxisRotation)>60?5:0,t.isTimeSeries&&(i.dateTimeLabelFormats=r.getDateTimeLabelFormats(t.chartState.timeSeriesCategorizerName),i.type="datetime"),i},getYAxisOptions:function(e,t){var i={title:{text:" "},labels:{rotation:e?t.chartState.xAxisRotation:t.chartState.yAxisRotation,step:e?t.chartState.xAxisStep:t.chartState.yAxisStep,style:{fontSize:"1em"}}};return r.isScatterOrBubbleChart(t.chartState.chartType)?i.title.text=t.metadata.measures[1]:t.chartState.showMeasureOnValueAxis&&1==t.metadata.measures.length&&(i.title.text=t.metadata.measures[0]),r.isSpiderChart(t.chartState.chartType)&&(i.gridLineInterpolation="polygon",i.lineWidth=0,i.min=0,i.labels.rotation>0&&(i.labels.x=-(i.labels.rotation/90*10))),i},getDateTimeLabelFormats:function(e){return r.dateTimeLabelFormatsMap[e]},getDateTimeTooltipFormats:function(e){return r.dateTimeTooltipFormatsMap[e]},getCommonSeries:function(e,t,i){var n=i.isTimeSeries,o=i.chartState.chartType;r.groupedCategories=!1,r.highchartsCategories=[],r.measureMin=null,r.measureMax=null;var s=this.getCommonSeriesGeneralOptions(i);return r.setupOptionsSeries(t,s,o,i),r.setupOptionsYAxis(t,s,o,i),r.populateOptionsDataAndCategories(e,t,s,o,n,i),r.setCategories(s,n||r.isScatterOrBubbleChart(o),o),s
},setupOptionsSeries:function(e,t,i,n){for(var o=r.isScatterOrBubbleChart(i),s=n.metadata.measures.length,a=o?e.length/s:e.length,l=0;a>l;l++){var c,d=o&&!r._isMeasureFirst(n.metadata)?e[l*s]:e[l],u=r.assembleFullGroupLinearName(1,d,n),h=l==a-1;if(r.isScatterOrBubbleChart(i)){var p=(n.chartState.columnsSelectedLevels.length>0,n.chartState.rowsSelectedLevels.length>0);c={headerFormat:p?"{point.key}<br/>":"",pointFormat:r.constructTooltipPointFormat(i,n),followPointer:!0}}t.series.push({name:u,data:[],color:o?r.getColorWithAlpha(l,.75):r.getColor(l),type:r.isDualOrMultiAxisChart(i)?r.getDualOrMultiAxisHighchartsType(i,h):void 0,yAxis:r.isMultiAxisChart(i)?l:0,tooltip:c})}},constructTooltipPointFormat:function(e,t){var i=t.chartState.columnsSelectedLevels.length>0,n=r.isTotalSelectedOnly(t,1),o="";return i&&!n&&(o+='<span style="color:{series.color}">{series.name}</span> <br/>'),o+=t.metadata.measures[0]+" : <b>{point.x:,.2f}</b><br/>"+t.metadata.measures[1]+" : <b>{point.y:,.2f}</b>"+(r.isBubbleChart(e)?"<br/>"+t.metadata.measures[2]+" : <b>{point.z:,.2f}</b> ":"")},setupOptionsYAxis:function(e,t,i,n){if(r.isDualAxisChart(i)){t.series[e.length-1].yAxis=1;var o=n.chartState.showMeasureOnValueAxis&&2==t.series.length?t.series[0].name:"";t.yAxis.push(r.getYAxisForDualOrMultiAxisChart(n,0,o)),t.yAxis.push(r.getYAxisForDualOrMultiAxisChart(n,e.length-1,t.series[e.length-1].name))}else if(r.isMultiAxisChart(i))for(var s=0;s<e.length;s++)t.yAxis.push(r.getYAxisForDualOrMultiAxisChart(n,s,t.series[s].name))},populateOptionsDataAndCategories:function(t,i,n,o,s,a){for(var l=r.isScatterOrBubbleChart(o),c=a.metadata.measures.length,d=l?i.length/c:i.length,u=0;u<t.length;u++){for(var h=t[u],p=0;d>p;p++){var m=n.series[p];if(l){var f=[];if(r._isMeasureFirst(a.metadata))for(var g=0;c>g;g++){var v=r.getDataValue(h,i[p+g*d],!0);f.push(v)}else for(var _=0;c>_;_++)f.push(r.getDataValue(h,i[p*c+_],!0));var b=e.every(f,function(e){return null==e});if(!b){f=e.map(f,function(e){return null==e?0:e}),r.measureMinMax(f[0]),r.measureMinMax(f[1]);var y;if(r.isScatterChart(o))y={x:f[0],y:f[1],name:r.assembleFullGroupHierarchyName(0,h,a)};else{if(!r.isBubbleChart(o))throw"Unexpected chart type";y={x:f[0],y:f[1],z:f[2],name:r.assembleFullGroupHierarchyName(0,h,a)}}m.data.push(y)}}else{var T=r.getDataValue(h,i[p],s);s?null!=T.value&&null!=T.timestamp&&(r.measureMinMax(T.value),m.data.push([T.timestamp,T.value])):(r.measureMinMax(T),m.data.push(T))}}if(!s&&!l){var S=r.assembleFullGroupHierarchyName(0,h,a);n.xAxis.categories.push(S)}}if(r.isScatterOrBubbleChart(o)){var A=1e3;e.each(n.series,function(e){A=Math.max(A,e.data.length)}),n.plotOptions.series.turboThreshold=A}r.isBubbleChart(o)&&1===d&&(n.xAxis.startOnTick=!0,n.xAxis.endOnTick=!0)},getYAxisForDualOrMultiAxisChart:function(e,t,i){var n=r.getYAxisOptions(r.doAxisSwap(e.chartState.chartType),e);return n.opposite=0!=t,n.labels.style={color:r.getColor(t),fontSize:"1em"},n.title={text:i,style:{color:r.getColor(t)}},n.opposite===!1&&(n.offset=Math.abs(e.chartState.yAxisRotation)>60?5:0),n},setCategories:function(e,t,i){t?e.xAxis.categories=void 0:r.groupedCategories&&this.areCategoriesSupported(i)&&(e.xAxis.categories=r.highchartsCategories)},areCategoriesSupported:function(e){return-1==e.indexOf("spider")&&(e.indexOf("column")>=0||e.indexOf("area")>=0||e.indexOf("line")>=0||e.indexOf("spline")>=0)},getPieSeries:function(i,n,o,s,a){r.measureMin=null,r.measureMax=null;var l,c=(e.isArray(s)?s.length:s)+a.metadata.measureAxis,d=15,u=10,h=d*c+u,p=a.width,m=a.height,f=t.getDataStyle(),g=e.extend(r.getGeneralOptions(a),{xAxis:{categories:[]},plotOptions:{pie:{slicedOffset:0,point:{events:{legendItemClick:r._getLegendItemClickHandler}}}},series:[],labels:{items:[]},legend:r.getLegendOptions(a)});if(0==f)if(a.metadata.axes[0].length>0){var v=n[0],_=1,b=_+1,y=100/b,T=y,S=50,A=[],C=T+"%",E=S+"%";A.push(C),A.push(E);var x=t.getMessage("totalsLabelForChart");a.metadata.measures[0].name&&(x=a.metadata.measures[0].name),g.series.push({type:"pie",name:x,data:[],center:A,size:2*y+"%",showInLegend:!0,dataLabels:{enabled:!1}});for(var M=0;M<i.length;M++){var w=i[M],D=r.getDataValue(w,v);r.measureMinMax(D),l=r.assembleFullGroupLinearName(0,w,a),g.series[0].data.push([l,D])}}else{var I=i[0],O=a.metadata.axes[1].length<=1?!0:!1,L=t.isMeasuresLastOnAxis(1),N=a.metadata.measures.length,_=1;O||(_=L?n.length/N:n.length);for(var R=r.getSquareSideLength(_,p,m),k=0;_>k;k++){var P=r.computePieParams(k+1,R,p,m,h,_),F=k;if(l=t.getMessage("allLabelForChart"),!O)if(L){F=k*N;var H=n[F];l=H.parent.label}else l=n[k].label;var A=[],C=P.xAxisPositionPercent+"%",E=P.yAxisPositionPercent+"%";A.push(C),A.push(E);var F=k;L&&(O||(F=k*N));var B=k>0?!1:!0;g.series.push({type:"pie",name:n[F].label,data:[],center:A,size:P.pieSizePercent+"%",showInLegend:B,dataLabels:{enabled:!1},title:{text:l,verticalAlign:"top",y:-h}})}if(O)for(var M=0;M<n.length;M++){var V=n[M],D=r.getDataValue(I,V);r.measureMinMax(D),l=r.assembleFullGroupLinearName(1,V,a),g.series[0].data.push([l,D])}else if(L)for(var U=(n[0].label,0),j=0,M=0;M<n.length;M++){var V=n[M];if(j++,j>N){if(U++,U>=_)throw"highchart.datamapper getPieSeries: exceeded numberOfPies="+numberOfPies;j=1}var D=r.getDataValue(I,V);r.measureMinMax(D),l=V.label,g.series[U].data.push([l,D])}else for(var M=0;M<n.length;M++){var V=n[M],D=r.getDataValue(I,V);r.measureMinMax(D),l=r.assembleFullGroupHierarchyName(1,V,a),g.series[M].data.push([l,D])}}if(2==f||1==f){for(var R=r.getSquareSideLength(n.length,p,m),k=0;k<n.length;k++){var P=r.computePieParams(k+1,R,p,m,h,n.length),z=n[k].label,l=r.assembleFullGroupHierarchyName(1,n[k],a),G=z,A=[],C=P.xAxisPositionPercent+"%",E=P.yAxisPositionPercent+"%";A.push(C),A.push(E);var B=k>0?!1:!0;g.series.push({type:"pie",name:G,data:[],center:A,size:P.pieSizePercent+"%",showInLegend:B,dataLabels:{enabled:!1},title:{text:l,verticalAlign:"top",y:-h}})}for(var M=0;M<n.length;M++)for(var V=n[M],W=0;W<i.length;W++){var w=i[W],D=r.getDataValue(w,V);r.measureMinMax(D),l=r.assembleFullGroupLinearName(0,w,a),g.series[M].data.push([l,D])}}return g},getDualLevelPieSeries:function(i,n,o,a,l){r.measureMin=null,r.measureMax=null;var c,d,u,h,p,m=[],f=n[0],g="(empty axis)"===f.label?"Value":f.label,v=r.colors,_=v.length,b=0,y=-1,T=1e3;l.metadata.isOLAP?"(All)"!==l.metadata.axes[0][0].name&&(o[0].level-=1,m=t.getNodeListForDimLevelRadio(0,o)):r._isMeasureFirst(l.metadata)&&(m=t.getNodeListForSliderLevel(0,o-1));var S=e.extend(r.getGeneralOptions(l),{xAxis:{categories:[]},plotOptions:{pie:{slicedOffset:0,point:{events:{legendItemClick:r._getLegendItemClickHandlerDisabled}}}},series:[],labels:{items:[]},legend:r.getLegendOptions(l)});S.series.push({name:g,data:[],center:["50%","50%"],size:"60%",showInLegend:!1,dataLabels:{color:"white",distance:-30,style:{fontSize:"1em"}}});for(var A=0;A<m.length;A++)h=m[A],d=r.getDataValue(h,n[0]),c=r.assembleFullGroupLinearName(0,h,l),h.parent.color=v[A%_],S.series[0].data.push({name:c,y:d,color:v[A%_]});if(0===S.series[0].data.length)var C=!0;S.series.push({name:g,data:[],center:["50%","50%"],size:"90%",innerSize:"60%",showInLegend:!0,dataLabels:{enabled:!1,style:{fontSize:"1em"}}});for(var A=0;A<i.length;A++)u=i[A],u===u.parent.children[0]||l.metadata.isOLAP&&u===u.parent.children[0].children[0]?(b=0,y++,C&&(S.series[0].data.push({name:r.assembleFullGroupLinearName(0,u.parent,l),y:0,color:v[y%_]}),u.parent.color=v[y%_])):b++,d=r.getDataValue(u,f),c=r.assembleFullGroupLinearName(0,u,l),p=.2-b/u.parent.children.length/5,S.series[1].data.push({name:c,y:d,color:s.Color(u.parent.color||v[0]).brighten(p).get()}),C&&(S.series[0].data[y].y+=d);return i.length||(S.series[0].data=[]),e.each(S.series,function(e){T=Math.max(T,e.data.length)}),S.plotOptions.pie.turboThreshold=T,S},getCommonHeatMapOptions:function(t,i,n,o){{var a=r.getCommonSeriesGeneralOptions(n);e.include(["bottom","top"],n.chartState.legend)}return a=e.extend(a,{colorAxis:e.extend(e.clone(r.colorAxis),{labels:{style:{fontSize:"1em"}},tickPixelInterval:r.HEATMAP_LEGEND_TICK_INTERVAL}),series:[{borderWidth:1,data:[],dataLabels:{enabled:!1}}],tooltip:{valueDecimals:2,formatter:function(){return this.series.yAxis.categories[this.point.y]+", "+this.series.xAxis.categories[this.point.x]+"<br/>"+i[0].label+": <b>"+(o&&null===this.point.value?null:s.numberFormat(this.point.value,2))+"</b>"},useHTML:!0,style:{fontSize:"1em"}}}),a.yAxis.title=null,a.xAxis.gridLineWidth=a.yAxis.gridLineWidth=o?0:1,a},getHeatMapOptions:function(e,t,i){var n=!0;r.measureMin=null,r.measureMax=null;var o=r.getCommonHeatMapOptions(e,t,i,n),s=r.computeHeatMapMatrixData(e,t,n);return o.series[0].data=s.data,o.xAxis.categories=s.xCategories,o.yAxis.categories=s.yCategories,1!==s.xCategories.length&&(o.xAxis.minRange=1),1!==s.yCategories.length&&(o.yAxis.minRange=1),o.colorAxis.min=r.measureMin,o.colorAxis.max=r.measureMax,o.plotOptions.series.turboThreshold=Math.max(o.series[0].data.length,1e3),o},computeHeatMapMatrixData:function(t,i,n){var o,s,a=!1,l={data:[],xCategories:[],yCategories:[]};return e.each(i,function(i,c){s=i.parent,l.xCategories.push(s.label),e.each(t,function(e,t){a||l.yCategories.push(e.label),o=r.getDataValue(e,s.children[0],!0),(null!==o||n)&&(r.measureMinMax(o),l.data.push([c,t,o]))}),a=!0}),l},getHeatMapTimeSeriesOptions:function(t,i,n){var o=!0,a=r.getCommonHeatMapOptions(t,i,n,o);if(!t.length)return a;var l,c,d,u,h={},p=new Date,m={},f=864e5,g=r.getDataValue(t[0],i[0]);r.measureMin=r.measureMax=g.value,l=c=g.timestamp,e.each(t,function(e){var t=r.getDataValue(e,i[0],!0),n=t.value;h[t.timestamp]=n,l=Math.min(l,t.timestamp),c=Math.max(c,t.timestamp),r.measureMinMax(n)});var v=new Date(c);p.setTime(l);do{if(h.hasOwnProperty(p.getTime()))d=h[p.getTime()];else{if(!o){p.setUTCHours(p.getUTCHours()+1);continue}d=null}u=p.getUTCHours(),m[u]=!0,p.setUTCHours(0),a.series[0].data.push([p.getTime(),u,d]),p.setUTCHours(u+1)}while(v>=p);a.colorAxis.min=r.measureMin,a.colorAxis.max=r.measureMax,m=e.map(m,function(e,t){return parseInt(t,10)}),a.yAxis=e.extend(a.yAxis,{startOnTick:!1,endOnTick:!1,reversed:!0,tickPositioner:function(e,t){return m.slice(Math.round(e),Math.round(t)+1)},minRange:8,labels:e.extend(a.yAxis.labels,{format:"{value}:00"})}),a.series[0].name=i[0].label,a.series[0].colsize=f,a.series[0].borderWidth=0,p.setTime(l),p.setUTCHours(0),a.xAxis.min=p.getTime(),p.setTime(c),p.setUTCHours(0),a.xAxis.max=p.getTime(),a.xAxis.minRange=30*f,a.xAxis.type="datetime",a.xAxis.categories=null,a.xAxis.endOnTick=!1,a.xAxis.labels=e.extend(a.xAxis.labels,{format:"{value:%B}"}),a.xAxis.tickPositions=[],p.setTime(l);do a.xAxis.tickPositions.push(p.getTime()),1!==p.getUTCDate()&&p.setUTCDate(1),p.setUTCMonth(p.getUTCMonth()+1);while(p.getTime()<=c);return a.tooltip=e.extend(a.tooltip,{backgroundColor:null,borderWidth:0,shadow:!1,useHTML:!0,style:{padding:0,color:"black",fontSize:"1em"},formatter:function(){return'<span style="color:{series.color}">●</span> '+i[0].label+"<br/>"+s.dateFormat("%e %b %Y",this.point.x)+" "+this.point.y+":00 <b>"+(o&&null===this.point.value?null:s.numberFormat(this.point.value,2))+"</b>"}}),a.plotOptions.series.turboThreshold=Math.max(a.series[0].data.length,1e3),a.chart.isHeatMapTimeSeriesChart=!0,a},_getLegendItemClickHandler:function(t){t.preventDefault();var i=e.flatten(e.pluck(this.series.chart.series,"data")),n=this;e.each(i,function(e){e.name==n.name&&e.setVisible(!e.visible)})},_getLegendItemClickHandlerDisabled:function(e){e.preventDefault()},getSquareSideLength:function(e,t,i){if(e>t*i)return 0;var n=i/t,o=Math.sqrt(e/n),s=o*n,r=Math.max(1,Math.floor(o)),a=Math.max(1,Math.floor(s)),l=Math.floor(t/r),c=Math.floor(i/a),d=Math.min(l,c);if(r=Math.floor(t/d),a=Math.floor(i/d),e>r*a)if(e>(r+1)*a&&e>r*(a+1))l=Math.floor(t/(r+1)),c=Math.floor(i/(a+1)),d=Math.min(l,c);else{var u=Math.ceil(e/a),h=Math.ceil(e/r);l=Math.min(Math.floor(t/u),Math.floor(i/a)),c=Math.min(Math.floor(t/r),Math.floor(i/h)),d=Math.max(l,c)}return d},computePieParams:function(e,t,i,n,o,s){var r=10,a=5,l=Math.min(Math.floor(i/t),s),c=Math.min(Math.floor(n/t),s),d=(i-t*l)/l,u=(n-t*c)/c,h=e%l==0?l:e%l,p=Math.floor(e/l)+(e%l==0?0:1),m=t*h-t/2+d*h/2,f=t*p-t/2+u*p/2,g=o+r;return{xAxisPositionPercent:100*(m-g/2)/i,yAxisPositionPercent:100*(f+g/2+a)/n,pieSizePercent:100*(t-g)/i}},measureMinMax:function(e){null!==e&&(null===r.measureMin?(r.measureMin=e,r.measureMax=e):(r.measureMin=Math.min(e,r.measureMin),r.measureMax=Math.max(e,r.measureMax)))},yAxisTickAdjust:function(t){if(!(r.measureMin<0)&&t.yAxis){var i=e.isArray(t.yAxis)?t.yAxis:[t.yAxis];0!=r.measureMin&&r.measureMin--,e.each(i,function(e){e.min||(e.min=r.measureMin,e.startOnTick=!0)})}},assembleFullGroupName:function(e,i,n,o){var s=o.chartState.chartType,a="",l=t.getLabelNameArray(e,i);if(1==e&&r.isScatterOrBubbleChart(s)&&(r._isMeasureFirst(o.metadata)?l.pop():l.shift()),!o.chartState.showSingleMeasuresLabels&&1===o.metadata.measures.length&&o.metadata.measureAxis===e){l=l.reverse();for(var c=0,d=o.metadata.axes[o.metadata.measureAxis].length;d>c;c++)"Measures"===o.metadata.axes[o.metadata.measureAxis][c].dimension&&(c<l.length?l.splice(c,1):l.pop());l=l.reverse(),l.length||l.push(" ")}var u="<br>";r.isBarChart(s)?(l=l.reverse(),u=", "):r.isScatterOrBubbleChart(s)&&(u=", ");for(var h=l.length,p=0;h>p;p++)a+=l[p],h-1>p&&(a+=n?u:", ");return 0==e&&h>1&&(r.groupedCategories=!0,r.addLeaf2HighchartsCategory(l)),a},assembleFullGroupHierarchyName:function(e,t,i){return r.assembleFullGroupName(e,t,!0,i)},assembleFullGroupLinearName:function(e,t,i){return r.assembleFullGroupName(e,t,!1,i)},addLeaf2HighchartsCategory:function(e){if(null==r.highchartsCategories&&(r.highchartsCategories=[]),e.length<=1)return void r.highchartsCategories.push(e[0]);for(var t=r.highchartsCategories,i=e.length-1;i>=0;i--){var n=e[i];if(0==i)return void t.push(n);for(var o=null,s=0;s<t.length;s++)t[s].name===e[i]&&(o=t[s]);null==o&&(o={name:e[i],categories:[]},t.push(o)),t=o.categories}},getDataValue:function(e,i,n){var o=t.getDataFromRowColumn(e,i);return n?o:null==o?0:o}}),e.extend(r,{_isTooltipFollowPointerEnabled:function(t){return!e.contains(["line","spline","area","stacked_area","percent_area","spline_area","line_time_series","spline_time_series","area_time_series","spline_area_time_series","pie","dual_level_pie","heat_map","heat_map_time_series"],t)},_isMeasureFirst:function(e){var t=e.axes[e.measureAxis];return t.length>0&&"Measures"==t[0].dimension}}),e.extend(r,{isDualOrMultiAxisChart:function(e){return r.isDualAxisChart(e)||r.isMultiAxisChart(e)},isDualLevelPieChart:function(e){return"dual_level_pie"===e},isSpiderChart:function(t){return e.contains(["spider_column","spider_line","spider_area"],t)},isDualAxisChart:function(t){return e.contains(["column_line","column_spline","stacked_column_line","stacked_column_spline"],t)},isMultiAxisChart:function(t){return e.contains(["multi_axis_line","multi_axis_spline","multi_axis_column"],t)},isScatterChart:function(t){return e.contains(["scatter"],t)},isBubbleChart:function(t){return e.contains(["bubble"],t)},isScatterOrBubbleChart:function(e){return r.isScatterChart(e)||r.isBubbleChart(e)},isBarChart:function(e){return-1!=e.indexOf("bar")},isHeatMapChart:function(e){return"heat_map"===e},isHeatMapTimeSeriesChart:function(e){return"heat_map_time_series"===e}}),e.extend(r,{getHighchartsOptions:function(t,i,n,o){var s=r.typeToOptionsMap[t](i,n,o);r.defaultPlotShadow(s,!r.isDualLevelPieChart(t)&&!r.isHeatMapChart(t)&&!r.isBubbleChart(t));var a=function(i){var n=r.isSpiderChart(t)||r.isBarChart(t)?150:29;if(i.length>0)if(e.isObject(i[0]))e.each(i,function(e){e.name=e.name.substring(0,n),e.categories&&a(e.categories)});else for(var o=0;o<i.length;o++)i[o]=i[o].substring(0,n)};return e.each(["xAxis","yAxis"],function(t){var i=e.isArray(s[t])?s[t]:[s[t]];e.each(i,function(e){e&&e.categories&&a(e.categories)})}),r.isSpiderChart(t)&&(s.chart.spacingTop=1.8*(s.xAxis.categories[0].split("<br>").length-1),s.chart.spacingTop*=8*(1+Math.abs(Math.sin((s.xAxis.labels.rotation||0)*Math.PI/180)))),s.colors=r.colors,s},defaultPlotShadow:function(t,i){var n=t.plotOptions,o=t.chart?t.chart.type:void 0,s=o?[o]:[];0==s.length&&(s=e.pluck(t.series,"type")),n||(n={}),e.each(s,function(e){n[e]||(n[e]={}),n[e].shadow=i})},typeToOptionsMap:{column:function(e,t,i){return r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},stacked_column:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="normal",n},percent_column:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="percent",n},bar:function(e,t,i){return r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},stacked_bar:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="normal",n},percent_bar:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="percent",n},spider_column:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.pointPlacement="on",n},line:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},area:function(e,t,i){return r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},spline_area:function(e,t,i){return r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},stacked_area:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="normal",n},percent_area:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="percent",n},spider_line:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.pointPlacement="on",n},spider_area:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.pointPlacement="on",n},pie:function(e,t,i){return r.getSeriesByType(r.SeriesType.PIE,e,t,i)},dual_level_pie:function(e,t,i){return r.getSeriesByType(r.SeriesType.DUAL_LEVEL_PIE,e,t,i)},spline:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},line_time_series:function(e,t,i){i.isTimeSeries=!0;var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},spline_time_series:function(e,t,i){i.isTimeSeries=!0;var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},area_time_series:function(e,t,i){return i.isTimeSeries=!0,r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},spline_area_time_series:function(e,t,i){return i.isTimeSeries=!0,r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},column_line:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},column_spline:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},stacked_column_line:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="normal",r.yAxisTickAdjust(n),n},stacked_column_spline:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return n.plotOptions.series.stacking="normal",r.yAxisTickAdjust(n),n},multi_axis_line:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},multi_axis_spline:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},multi_axis_column:function(e,t,i){return r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},scatter:function(e,t,i){var n=r.getSeriesByType(r.SeriesType.COMMON,e,t,i);return r.yAxisTickAdjust(n),n},bubble:function(e,t,i){return r.getSeriesByType(r.SeriesType.COMMON,e,t,i)},heat_map:function(e,t,i){return r.getSeriesByType(r.SeriesType.HEAT_MAP,e,t,i)},heat_map_time_series:function(e,t,i){return r.getSeriesByType(r.SeriesType.HEAT_MAP_TIME_SERIES,e,t,i)}},adHocToHighchartsChartTypeMap:o,getDualOrMultiAxisHighchartsType:function(e,t){var i,n={column_line:"column",column_spline:"column",stacked_column_line:"column",stacked_column_spline:"column"},o={column_line:"line",column_spline:"spline",stacked_column_line:"line",stacked_column_spline:"spline"},s={multi_axis_line:"line",multi_axis_spline:"spline",multi_axis_column:"column"};if(r.isDualAxisChart(e))i=t?o[e]:n[e];else{if(!r.isMultiAxisChart(e))throw"Unsupported chart type [chartType="+e+"]";i=s[e]}return i}}),{getHighchartsOptions:r.getHighchartsOptions,isDualOrMultiAxisChart:r.isDualOrMultiAxisChart,isDualAxisChart:r.isDualAxisChart,isMultiAxisChart:r.isMultiAxisChart,isScatterChart:r.isScatterChart,isBubbleChart:r.isBubbleChart,isScatterOrBubbleChart:r.isScatterOrBubbleChart,isBarChart:r.isBarChart,isSpiderChart:r.isSpiderChart,isDualLevelPieChart:r.isDualLevelPieChart,isHeatMapChart:r.isHeatMapChart,isHeatMapTimeSeriesChart:r.isHeatMapTimeSeriesChart,_getLegendItemClickHandler:r._getLegendItemClickHandler,_getLegendItemClickHandlerDisabled:r._getLegendItemClickHandlerDisabled,_HDM:r}},this),function(e,t){"function"==typeof define&&define.amd?define("adhoc/chart/adhocToHighchartsAdapter",["underscore","adhoc/chart/Highcharts","adhoc/chart/highchartsDataMapper","adhoc/chart/adhocDataProcessor"],e):t.AdhocHighchartsAdapter=e(_,Highcharts,highchartsDataMapper,AdhocDataProcessor)}(function(e,t,i,n){var o={generateOptions:function(o,s,r){s=e.cloneDeep(s),o=e.cloneDeep(o),n.load(o),n.messages=r.messages,t.setOptions({lang:{shortMonths:s.shortMonths}});var a=n.levelsToLevelNumbers(s.rowsSelectedLevels,0),l=n.levelsToLevelNumbers(s.columnsSelectedLevels,1);return r.chartState=s,r.metadata=o.metadata,i.getHighchartsOptions(s.chartType,a,l,r)}};return o},this),function(e){"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone.validation.original",["backbone","underscore"],e)}(function(e,t){return e.Validation=function(t){var i={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(e,t){return c[i.labelFormatter](e,t)},format:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.replace(/\{(\d+)\}/g,function(t,i){return"undefined"!=typeof e[i]?e[i]:t})}},o=function(i,n,s){return n=n||{},s=s||"",t.each(i,function(t,r){i.hasOwnProperty(r)&&(t&&"object"==typeof t&&!(t instanceof Array||t instanceof Date||t instanceof RegExp||t instanceof e.Model||t instanceof e.Collection)?o(t,n,s+r+"."):n[s+r]=t)}),n},s=function(){var e=function(e){return t.reduce(t.keys(t.result(e,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},s=function(e,i){var n=e.validation?t.result(e,"validation")[i]||{}:{};return(t.isFunction(n)||t.isString(n))&&(n={fn:n}),t.isArray(n)||(n=[n]),t.reduce(n,function(e,i){return t.each(t.without(t.keys(i),"msg"),function(t){e.push({fn:d[t],val:i[t],msg:i.msg})}),e},[])},a=function(e,i,o,r){return t.reduce(s(e,i),function(s,a){var l=t.extend({},n,d),c=a.fn.call(l,o,i,a.val,e,r);return c===!1||s===!1?!1:c&&!s?t.result(a,"msg")||c:s},"")},l=function(e,i){var n,s={},r=!0,l=t.clone(i),c=o(i);return t.each(c,function(t,i){n=a(e,i,t,l),n&&(s[i]=n,r=!1)}),{invalidAttrs:s,isValid:r}},c=function(i,n){return{preValidate:function(e,i){var n,o=this,s={};return t.isObject(e)?(t.each(e,function(e,t){n=o.preValidate(t,e),n&&(s[t]=n)}),t.isEmpty(s)?void 0:s):a(this,e,i,t.extend({},this.attributes))},isValid:function(e){var i=o(this.attributes);return t.isString(e)?!a(this,e,i[e],t.extend({},this.attributes)):t.isArray(e)?t.reduce(e,function(e,n){return e&&!a(this,n,i[n],t.extend({},this.attributes))},!0,this):(e===!0&&this.validate(),this.validation?this._isValid:!0)},validate:function(s,r){var a=this,c=!s,d=t.extend({},n,r),u=e(a),h=t.extend({},u,a.attributes,s),p=o(s||h),m=l(a,h);return a._isValid=m.isValid,t.each(u,function(e,t){var n=m.invalidAttrs.hasOwnProperty(t);n||d.valid(i,t,d.selector)}),t.each(u,function(e,t){var n=m.invalidAttrs.hasOwnProperty(t),o=p.hasOwnProperty(t);n&&(o||c)&&d.invalid(i,t,m.invalidAttrs[t],d.selector)}),t.defer(function(){a.trigger("validated",a._isValid,a,m.invalidAttrs),a.trigger("validated:"+(a._isValid?"valid":"invalid"),a,m.invalidAttrs)}),!d.forceUpdate&&t.intersection(t.keys(m.invalidAttrs),t.keys(p)).length>0?m.invalidAttrs:void 0}}},u=function(e,i,n){t.extend(i,c(e,n))},h=function(e){delete e.validate,delete e.preValidate,delete e.isValid},p=function(e){u(this.view,e,this.options)},m=function(e){h(e)};return{version:"0.9.1",configure:function(e){t.extend(i,e)},bind:function(e,n){n=t.extend({},i,r,n);var o=n.model||e.model,s=n.collection||e.collection;if("undefined"==typeof o&&"undefined"==typeof s)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";o?u(e,o,n):s&&(s.each(function(t){u(e,t,n)}),s.bind("add",p,{view:e,options:n}),s.bind("remove",m))},unbind:function(e,i){i=t.extend({},i);var n=i.model||e.model,o=i.collection||e.collection;n?h(n):o&&(o.each(function(e){h(e)}),o.unbind("add",p),o.unbind("remove",m))},mixin:c(null,i)}}(),r=s.callbacks={valid:function(e,t,i){e.$("["+i+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,i,n){e.$("["+n+'~="'+t+'"]').addClass("invalid").attr("data-error",i)}},a=s.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},l=s.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},c=s.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace(/_/g," ")},label:function(e,t){return t.labels&&t.labels[e]||c.sentenceCase(e,t)}},d=s.validators=function(){var e=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,i=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(i,"")},i=function(e){return t.isNumber(e)||t.isString(e)&&e.match(a.number)},n=function(i){return!(t.isNull(i)||t.isUndefined(i)||t.isString(i)&&""===e(i)||t.isArray(i)&&t.isEmpty(i))};return{fn:function(e,i,n,o,s){return t.isString(n)&&(n=o[n]),n.call(o,e,i,s)},required:function(e,i,o,s,r){var a=t.isFunction(o)?o.call(s,e,i,r):o;return a||n(e)?a&&!n(e)?this.format(l.required,this.formatLabel(i,s)):void 0:!1},acceptance:function(e,i,n,o){return"true"===e||t.isBoolean(e)&&e!==!1?void 0:this.format(l.acceptance,this.formatLabel(i,o))},min:function(e,t,n,o){return!i(e)||n>e?this.format(l.min,this.formatLabel(t,o),n):void 0},max:function(e,t,n,o){return!i(e)||e>n?this.format(l.max,this.formatLabel(t,o),n):void 0},range:function(e,t,n,o){return!i(e)||e<n[0]||e>n[1]?this.format(l.range,this.formatLabel(t,o),n[0],n[1]):void 0},length:function(e,i,n,o){return t.isString(e)&&e.length===n?void 0:this.format(l.length,this.formatLabel(i,o),n)},minLength:function(e,i,n,o){return!t.isString(e)||e.length<n?this.format(l.minLength,this.formatLabel(i,o),n):void 0},maxLength:function(e,i,n,o){return!t.isString(e)||e.length>n?this.format(l.maxLength,this.formatLabel(i,o),n):void 0},rangeLength:function(e,i,n,o){return!t.isString(e)||e.length<n[0]||e.length>n[1]?this.format(l.rangeLength,this.formatLabel(i,o),n[0],n[1]):void 0},oneOf:function(e,i,n,o){return t.include(n,e)?void 0:this.format(l.oneOf,this.formatLabel(i,o),n.join(", "))},equalTo:function(e,t,i,n,o){return e!==o[i]?this.format(l.equalTo,this.formatLabel(t,n),this.formatLabel(i,n)):void 0},pattern:function(e,t,i,o){return n(e)&&e.toString().match(a[i]||i)?void 0:this.format(l[i]||l.inlinePattern,this.formatLabel(t,o),i)}}}();return t.each(d,function(e,i){d[i]=t.bind(d[i],t.extend({},n,d))}),s}(t),e.Validation}),define("common/util/parse/number",["require","underscore","settings!decimalFormatSymbols"],function(e){function t(e){return"."===e?e="\\.":" "===e&&(e="\\s"),e}function i(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):0,r="undefined"==typeof n?",":n,a="undefined"==typeof i?".":i,l="",c=function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)};return l=(s?c(o,s):""+Math.round(o)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(l[1]||"").length<s&&(l[1]=l[1]||"",l[1]+=new Array(s-l[1].length+1).join("0")),l.join(a)}function n(e){return o(e)||s(e)}function o(e){return d.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&(e===+e&&e===(0|e)||e%1===0)}function s(e){return d.isString(e)&&v.test(e)}function r(e){return n(e)&&l(e)>=_&&l(e)<=b}function a(e){return d.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY||d.isString(e)&&g.test(e)}function l(e){if(d.isNumber(e))return e;if(d.isString(e)&&g.test(e)){e=e.replace(new RegExp(f,"g"),"").replace(new RegExp(m,"g"),".");var t=1*e;return t>y||T>t?(window.console&&window.console.warn(e+" is out of the ["+T+", "+y+"] bounds. Parsing results may be corrupted. Use string representation instead. For more details see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number."),!1):t}return void 0}function c(e){var t=e.toString().split(".")[1];try{return i(e,t?t.length:0,h,p)}catch(n){return e.toString()}}var d=e("underscore"),u=e("settings!decimalFormatSymbols"),h=u?u.decimalSeparator||".":".",p=u?u.groupingSeparator||",":",",m=t(h),f=t(p),g=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+f+"[0-9]{3})*("+m+"[0-9]+)?|[1-9]{1}[0-9]{0,}("+m+"[0-9]+)?|0("+m+"[0-9]+)?)$"),v=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+f+"[0-9]{3})*|[1-9]{1}[0-9]{0,}|0)$"),_=-2147483648,b=2147483647,y=9007199254740992,T=-9007199254740992;
return{isInt:n,isNumberInt:o,isStringInt:s,isInt32:r,isDecimal:a,parseNumber:l,formatNumber:c}}),define("backbone.validation",["require","backbone.validation.original","underscore","common/util/parse/number"],function(e){var t=e("backbone.validation.original"),i=e("underscore"),n=e("common/util/parse/number"),o=t.mixin.validate;return t.mixin.validate=function(e,t){t||(t={});var n=this;return o.call(this,e,i.extend({valid:function(e,t){n.trigger("validate:"+t,n,t)},invalid:function(e,t,i){n.trigger("validate:"+t,n,t,i)}},t))},i.extend(t.validators,{doesNotContainSymbols:function(e,t,i){return new RegExp("["+i+"]","g").test(e)?"Attribute '"+t+"' contains forbidden symbols":void 0},integerNumber:function(e){return n.isNumberInt(e)?void 0:"Value is not a valid integer number"},url:function(e){return/(http|https):\/\/.*\..*./.test(e)?void 0:"Value is not a valid url"},hexColor:function(e){return/^#[0-9a-f]{3,6}$/i.test(e)?void 0:"Value is not a valid hex color"},xRegExpPattern:function(e,t,i){return i.test(e)?void 0:"Value does not match pattern"},startsWithLetter:function(e){return e.substr(0,1).match(/[A-Za-z]/)?void 0:"Value should start with letter"},containsOnlyWordCharacters:function(e){return e.search(/\W/)>=0?"Value should contain only word characters (letters, digits and underscore)":void 0},arrayMinLength:function(e,t,n){return i.isArray(e)&&e.length<n?"Array length is less than "+n:void 0}}),t}),define("adhoc/chart/formattingDialog/model/FormattingDialogModel",["require","underscore","backbone","backbone.validation"],function(e){var t=e("underscore"),i=e("backbone"),n=e("backbone.validation"),o=i.Model.extend({validation:{xAxisStep:{xRegExpPattern:/^[0-9]+$/,min:1,msg:"Please enter correct values"},yAxisStep:{xRegExpPattern:/^[0-9]+$/,min:1,msg:"Please enter correct values"},xAxisRotation:{xRegExpPattern:/^[-0-9]+$/,range:[-90,90],msg:"Please enter correct values"},yAxisRotation:{xRegExpPattern:/^[-0-9]+$/,range:[-90,90],msg:"Please enter correct values"},legend:{oneOf:["bottom","left","right","top","none"],msg:"Please enter correct values"}},formattingOptions:["xAxisStep","yAxisStep","xAxisRotation","yAxisRotation","legend","legendBorder","showDataPoints","showSingleMeasuresLabels","showMeasureOnValueAxis","autoScaleFonts"],parse:function(e){var i={};return t.each(this.formattingOptions,function(t){i[t]=e[t]}),i},initialize:function(e,t){this._savedAttributes=e,this.callUpdateState=t.updateState,this.on("invalid",function(){}),this.on("change",function(){this.modelChanged=!0})},applyModel:function(){this.modelChanged&&(this.callUpdateState(this.attributes),this._savedAttributes=this.attributes,this.modelChanged=!1)}});return t.extend(o.prototype,n.mixin),o}),define("requirejs.plugin.text",["module"],function(e){var t,i,n,o,s,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),u=c&&location.hostname,h=c&&(location.port||void 0),p={},m=e.config&&e.config()||{};return t={version:"2.0.9",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=r[t];try{e=new ActiveXObject(i)}catch(n){}if(e){r=[i];break}}return e},parseName:function(e){var t,i,n,o=!1,s=e.indexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==s&&(!r||s>1)?(t=e.substring(0,s),i=e.substring(s+1,e.length)):t=e,n=i||t,s=n.indexOf("!"),-1!==s&&(o="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:t=n),{moduleName:t,ext:i,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,o){var s,r,a,l=t.xdRegExp.exec(e);return l?(s=l[2],r=l[3],r=r.split(":"),a=r[1],r=r[0],!(s&&s!==i||r&&r.toLowerCase()!==n.toLowerCase()||(a||r)&&a!==o)):!0},finishLoad:function(e,i,n,o){n=i?t.strip(n):n,m.isBuild&&(p[e]=n),o(n)},load:function(e,i,n,o){if(o.isBuild&&!o.inlineText)return void n();m.isBuild=o.isBuild;var s=t.parseName(e),r=s.moduleName+(s.ext?"."+s.ext:""),a=i.toUrl(r),l=m.useXhr||t.useXhr;!c||l(a,d,u,h)?t.get(a,function(i){t.finishLoad(e,s.strip,i,n)},function(e){n.error&&n.error(e)}):i([r],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,n)})},write:function(e,i,n){if(p.hasOwnProperty(i)){var o=t.jsEscape(p[i]);n.asModule(e+"!"+i,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,i,n,o,s){var r=t.parseName(i),a=r.ext?"."+r.ext:"",l=r.moduleName+a,c=n.toUrl(r.moduleName+a)+".js";t.load(l,n,function(){var i=function(e){return o(c,e)};i.asModule=function(e,t){return o.asModule(e,c,t)},t.write(e,l,i,s)},s)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var o=i.readFileSync(e,"utf8");0===o.indexOf("﻿")&&(o=o.substring(1)),t(o)}catch(s){n(s)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,i,n,o){var s,r=t.createXhr();if(r.open("GET",e,!0),o)for(s in o)o.hasOwnProperty(s)&&r.setRequestHeader(s.toLowerCase(),o[s]);m.onXhr&&m.onXhr(r,e),r.onreadystatechange=function(){var t,o;4===r.readyState&&(t=r.status,t>399&&600>t?(o=new Error(e+" HTTP status: "+t),o.xhr=r,n(o)):i(r.responseText),m.onXhrComplete&&m.onXhrComplete(r,e))},r.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,o="utf-8",s=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),o)),l="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(r),i.append(n);l=String(i.toString())}finally{a.close()}t(l)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,o=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,r,a,l={};s&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),i.init(a,1,0,!1),r=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),r.init(i,"utf-8",i.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(i.available(),l),r.close(),i.close(),t(l.value)}catch(c){throw new Error((a&&a.path||"")+": "+c)}}),t}),define("text",["require","requirejs.plugin.text","underscore","common/transport/request"],function(e){var t=e("requirejs.plugin.text"),i=e("underscore"),n=e("common/transport/request"),o=t.createXhr,s=t.load;return i.extend(t,{useXhr:function(){return!0},createXhr:function(){var e=o.apply(t,arguments),s={},r={response:void 0,responseBody:void 0,responseText:void 0,responseType:void 0,responseXML:void 0,status:void 0,statusText:void 0};for(var a in e)-1==a.indexOf("response")&&-1==a.indexOf("status")&&(r[a]=e[a]);return i.extend(r,{open:function(e,t){s.url=t,r.status=1},send:function(){n(s).done(function(e,t,i){r.readyState=i.readyState,r.status=i.status,r.responseText=i.responseText,r.onreadystatechange()}).fail(function(e){r.onerror(e)})}})},load:function(e,t,n,o){return o.isBuild&&o.excludeText&&i.indexOf(o.excludeText,e)>=0?void n():s(e,t,n,o)}})}),define("text!adhoc/chart/formattingDialog/template/FormattingDialogTemplate.htm",[],function(){return'<div class="content hasFooter ">\r\n\r\n    <div class="header mover">\r\n        <div class="title">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_TITLE }}\r\n        </div>\r\n    </div>\r\n\r\n    <div class="body">\r\n        <div class="content tabbed">\r\n\r\n            <div class="header">\r\n                <ul class="control tabSet reverse buttons horizontal ">\r\n                    <li tabid="" class="tab first selected" id="axisTab">\r\n                        <a class="button">\r\n                            <span class="wrap">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_AXIS_OPTIONS }}</span>\r\n                        </a>\r\n                    </li>\r\n                    <li tabid="" class="tab" id="labelsTab">\r\n                        <a class="button">\r\n                            <span class="wrap">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LABELS_OPTIONS }}</span>\r\n                        </a>\r\n                    </li>\r\n                    <li tabid="" class="tab" id="dataTab">\r\n                        <a class="button">\r\n                            <span class="wrap">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_DATA_OPTIONS }}</span>\r\n                        </a>\r\n                    </li>\r\n                    <!--\r\n                    <li tabid="" class="tab" id="rangesTab">\r\n                        <a class="button">\r\n                            <span class="wrap">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_RANGES_OPTIONS }}</span>\r\n                        </a>\r\n                    </li>-->\r\n                </ul>\r\n            </div>\r\n\r\n            <div class="body section noTitle" id="axisSection"></div>\r\n            <div class="body section noTitle hidden" id="labelsSection"></div>\r\n            <div class="body section noTitle hidden" id="dataSection"></div>\r\n            <!--\r\n            <div class="body section noTitle hidden" id="rangesSection"></div>\r\n            -->\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <div class="footer ">\r\n        <button class="button action primary up applyButton">\r\n            <span class="wrap">\r\n                {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_BUTTON_APPLY }}\r\n                <span class="icon"></span>\r\n            </span>\r\n        </button>\r\n        <button class="button action up okButton">\r\n            <span class="wrap">\r\n                {{= i18n.ADH_016_BUTTON_OK }}\r\n                <span class="icon"></span>\r\n            </span>\r\n        </button>\r\n        <button class="button action up cancelButton">\r\n            <span class="wrap">\r\n                {{= i18n.ADH_010_BUTTON_CANCEL }}\r\n                <span class="icon"></span>\r\n            </span>\r\n        </button>\r\n    </div>\r\n\r\n</div>'}),define("text!adhoc/chart/formattingDialog/template/AxisSectionTemplate.htm",[],function(){return'<div class="group">\r\n    <div class="groupName">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_GROUP_X_AXIS }}</div>\r\n    <!--<div class="control checkBox">\r\n        <input id="showXAxisLabels" name="showXAxisLabels" type="checkbox" value="true"/>\r\n        <label for="showXAxisLabels">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_X_AXIS_LABEL }}</label>\r\n    </div>-->\r\n    <div class="control">\r\n        <label for="xAxisStep">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_INTERVAL_BETWEEN_X_AXIS_LABELS }}\r\n            <input id="xAxisStep" name="xAxisStep" type="text"/>\r\n        </label>\r\n    </div>\r\n    <div class="control">\r\n        <label for="xAxisRotation">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_ROTATION_OF_X_AXIS_LABELS }}\r\n            <input id="xAxisRotation" name="xAxisRotation" type="text"/>\r\n        </label>\r\n    </div>\r\n</div>\r\n    <!--<div class="control checkBox">\r\n        <label for="rotateAllLevels">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_ROTATE_ALL_LEVELS }}\r\n            <input id="rotateAllLevels" name="rotateAllLevels" type="checkbox"/>\r\n        </label>\r\n    </div>\r\n    <div class="control checkBox">\r\n        <input id="showYAxisLabels" name="showYAxisLabels" type="checkbox" value="true"/>\r\n        <label for="showYAxisLabels">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_Y_AXIS_LABEL }}</label>\r\n    </div>-->\r\n<div class="group">\r\n    <div class="groupName">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_GROUP_Y_AXIS }}</div>\r\n    <div class="control">\r\n        <label for="yAxisStep">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_INTERVAL_BETWEEN_Y_AXIS_LABELS }}\r\n            <input id="yAxisStep" name="yAxisStep" type="text"/>\r\n        </label>\r\n    </div>\r\n    <div class="control">\r\n        <label for="yAxisRotation">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_ROTATION_OF_Y_AXIS_LABELS }}\r\n            <input id="yAxisRotation" name="yAxisRotation" type="text"/>\r\n        </label>\r\n    </div>\r\n    <!--<div class="control">\r\n        <label for="labelOffset">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LABEL_OFFSET }}\r\n            <input id="labelOffset" name="labelOffset" type="text"/>\r\n        </label>\r\n    </div>\r\n    <div class="control">\r\n        <label for="thousandSeparator">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_THOUSAND_SEPARATOR }}\r\n            <select id="thousandSeparator" name="thousandSeparator">\r\n                <option value="None">None</option>\r\n                <option value="," selected>,(Comma)</option>\r\n                <option value=".">.(Point)</option>\r\n            </select>\r\n        </label>\r\n    </div>\r\n    <div class="control">\r\n        <label for="decimalPoint">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_DECIMAL_POINT }}\r\n            <select id="decimalPoint" name="decimalPoint">\r\n                <option value=",">,(Comma)</option>\r\n                <option value="." selected>.(Point)</option>\r\n            </select>\r\n        </label>\r\n    </div>\r\n    <div class="control checkBox">\r\n        <label for="invertedAxis">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_INVERTED_AXIS }}\r\n            <input id="invertedAxis" name="invertedAxis" type="checkbox"/>\r\n        </label>\r\n    </div>-->\r\n</div>'}),define("text!adhoc/chart/formattingDialog/template/LabelsSectionTemplate.htm",[],function(){return'<div class="group">\r\n    <!--Is not needed in Amber release. Uncomment if needed-->\r\n    <!--\r\n    <div class="control checkBox">\r\n        <label for="singleAxisComboChart">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SINGLE_AXIS_COMBO_CHART\r\n            }}</label>\r\n        <input id="singleAxisComboChart" name="singleAxisComboChart" type="checkbox"/>\r\n    </div>\r\n    <div class="control">\r\n        <label for="donnutInnerSize">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_DONNUT_INNER_SIZE }}\r\n            <input id="donnutInnerSize" name="donnutInnerSize" type="text"/>\r\n        </label>\r\n    </div>\r\n    -->\r\n    <div class="groupName">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_GROUP_LEGEND }}</div>\r\n    <div class="control">\r\n        <label for="legend">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LEGEND_POSITION }}\r\n            <select id="legend" name="legend">\r\n                <option value="bottom" selected>{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LEGEND_POSITION_BOTTOM }}</option>\r\n                <option value="top">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LEGEND_POSITION_TOP }}</option>\r\n                <option value="right">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LEGEND_POSITION_RIGHT }}</option>\r\n                <option value="left">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LEGEND_POSITION_LEFT }}</option>\r\n                <option value="none">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_LEGEND_POSITION_NONE }}</option>\r\n            </select>\r\n        </label>\r\n    </div>\r\n    <div class="control checkBox">\r\n        <label for="legendBorder">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_LEGEND_BORDER }}</label>\r\n        <input id="legendBorder" name="legendBorder" type="checkbox" value="true"/>\r\n    </div>\r\n</div>\r\n<div class="group">\r\n    <div class="groupName">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_GROUP_MEASURES }}</div>\r\n    <div class="control checkBox">\r\n        <label for="showSingleMeasuresLabels">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_SINGLE_MEASURE_LABELS\r\n            }}</label>\r\n        <input id="showSingleMeasuresLabels" name="showSingleMeasuresLabels" type="checkbox"/>\r\n    </div>\r\n    <div class="control checkBox child">\r\n        <input id="showMeasureOnValueAxis" name="showMeasureOnValueAxis" type="checkbox" value="true"/>\r\n        <label for="showMeasureOnValueAxis">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_MEASURE_NAME }}</label>\r\n    </div>\r\n    </div>\r\n<div class="group">\r\n    <div class="groupName">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_GROUP_GENERAL }}</div>\r\n    <div class="control checkBox">\r\n        <label for="autoScaleFonts"> {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_AUTO_SCALE_LABEL_FONT_SIZE }}</label>\r\n        <input id="autoScaleFonts" name="autoScaleFonts" type="checkbox" value="true"/>\r\n    </div>\r\n</div>'}),define("text!adhoc/chart/formattingDialog/template/DataSectionTemplate.htm",[],function(){return'<div class="group">\r\n    <div class="control checkBox">\r\n        <label for="showDataPoints">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_DATA_POINTS }}</label>\r\n        <input id="showDataPoints" name="showDataPoints" type="checkbox" value="true"/>\r\n    </div>\r\n<!--\r\n    <div class="control checkBox">\r\n        <label for="showLabels">{{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_SHOW_LABELS }}</label>\r\n        <input id="showLabels" name="showLabels" type="checkbox"/>\r\n    </div>\r\n    <div class="control">\r\n        <label for="rotation">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_ROTATION }}\r\n            <input id="rotation" name="rotation" type="text"/>\r\n        </label>\r\n    </div>\r\n    <div class="control">\r\n        <label for="alignment">\r\n            {{= i18n.ADH_1214_ICHARTS_CHART_FORMAT_DIALOG_ALIGNMENT }}\r\n            <select id="alignment" name="alignment">\r\n                <option value="bottom" selected>Bottom</option>\r\n                <option value="top">Top</option>\r\n                <option value="right">Right</option>\r\n                <option value="left">Left</option>\r\n                <option value="none">None</option>\r\n            </select>\r\n        </label>\r\n    </div>\r\n    -->\r\n</div>'}),define("adhoc/chart/formattingDialog/view/FormattingDialogView",["require","underscore","jquery","backbone","bundle!adhoc_messages","adhoc/chart/formattingDialog/model/FormattingDialogModel","text!adhoc/chart/formattingDialog/template/FormattingDialogTemplate.htm","text!adhoc/chart/formattingDialog/template/AxisSectionTemplate.htm","text!adhoc/chart/formattingDialog/template/LabelsSectionTemplate.htm","text!adhoc/chart/formattingDialog/template/DataSectionTemplate.htm"],function(e){var t=e("underscore"),i=e("jquery"),n=e("backbone"),o=e("bundle!adhoc_messages"),s=(e("adhoc/chart/formattingDialog/model/FormattingDialogModel"),e("text!adhoc/chart/formattingDialog/template/FormattingDialogTemplate.htm")),r=e("text!adhoc/chart/formattingDialog/template/AxisSectionTemplate.htm"),a=e("text!adhoc/chart/formattingDialog/template/LabelsSectionTemplate.htm"),l=e("text!adhoc/chart/formattingDialog/template/DataSectionTemplate.htm");return n.View.extend({template:t.template(s),el:"#chartFormatDialog",initialize:function(){this.render(),this.model.on("change",this._renderFields,this)},events:{"click .applyButton":"_apply","click .okButton":"_ok","click .cancelButton":"_cancel","click ul.tabSet .tab":"_switchTab","change select#legend":"_disableLegendBorderControl","change input#showSingleMeasuresLabels":"_disableMeasureNamesControl"},render:function(){return this.$el.empty(),this.$el.html(this.template({i18n:o})),this.$el.find("#axisSection").html(t.template(r)({i18n:o})),this.$el.find("#labelsSection").html(t.template(a)({i18n:o})),this.$el.find("#dataSection").html(t.template(l)({i18n:o})),this._renderFields(),this},_renderFields:function(){this.inputFields={},t.each(this.model.attributes,function(e,t){var i=this.$el.find("#"+t);"checkbox"==i.attr("type")?(this.inputFields[t]=i.prop("checked",e),"showMeasureOnValueAxis"===t&&(this.model.get("showSingleMeasuresLabels")?this.inputFields[t].prop("disabled",!1).parent().removeClass("disabled"):this.inputFields[t].prop("disabled",!0).parent().addClass("disabled"))):this.inputFields[t]=i.val(e)},this)},_updateModel:function(){var e=this._extractData();return this.model.set(e,{validate:!0}),this.$el.find(".error").removeClass("error"),this.model.isValid()?!0:(t.each(this.model.validationError,function(e,t){this.$el.find("#"+t).val(this.model.get(t))},this),this._updateModel())},_apply:function(){this._updateModel(),this.model.applyModel()},_ok:function(){this._updateModel(),this.model.applyModel(),this._switchToFirstTab(),dialogs.popup.hide(this.el)},_cancel:function(){this.model.set(this.model._savedAttributes,{silent:!0}),this._renderFields(),this._switchToFirstTab(),dialogs.popup.hide(this.el)},_switchTab:function(e){if(this._updateModel()){var t=this.$el.find("ul.tabSet li.tab");t.removeClass("selected");var i=this.$el.find(e.currentTarget);i.addClass("selected"),i.children("a").removeClass("over");var n=i.attr("id"),o=n.substring(0,n.indexOf("Tab"));this.$el.find("div.body.section.noTitle").addClass("hidden"),this.$el.find("#"+o+"Section").removeClass("hidden")}},_switchToFirstTab:function(){var e=this.$el.find("ul.tabSet li.tab");e.removeClass("selected");var t=this.$el.find("ul.tabSet li.tab.first");t.addClass("selected");var i=t.attr("id"),n=i.substring(0,i.indexOf("Tab"));this.$el.find("div.body.section.noTitle").addClass("hidden"),this.$el.find("#"+n+"Section").removeClass("hidden")},_extractData:function(){var e={};return t.each(this.model.attributes,function(t,i){var n=this.inputFields[i];n.length&&(e[i]="checkbox"==n.attr("type")?n.prop("checked"):n.val())},this),e},_disableMeasureNamesControl:function(e){var t=this.$el.find("input#showMeasureOnValueAxis");i(e.currentTarget).is(":checked")?t.prop("checked",this._tmpPreviousStateShowMeasureOnValueAxis).prop("disabled",!1).parent().removeClass("disabled"):(this._tmpPreviousStateShowMeasureOnValueAxis=t.prop("checked"),t.prop("checked",!1).prop("disabled",!0).parent().addClass("disabled"))},_disableLegendBorderControl:function(e){var t=this.$el.find("input#legendBorder");"none"===i(e.currentTarget).val()?t.prop("disabled",!0).parent().addClass("disabled"):t.prop("disabled",!1).parent().removeClass("disabled")}})}),define("adhoc/chart/adhocIntelligentChart",["require","exports","module","jquery","underscore","highcharts","adhoc/chart/adhocToHighchartsAdapter","adhoc/chart/adhocDataProcessor","adhoc/chart/highchartsDataMapper","adhoc/chart/formattingDialog/model/FormattingDialogModel","adhoc/chart/formattingDialog/view/FormattingDialogView","logger","jquery.ui","prototype","utils.common","designer.base"],function(e,t,i){var n=e("jquery"),o=e("underscore"),s=e("highcharts"),r=e("adhoc/chart/adhocToHighchartsAdapter"),a=e("adhoc/chart/adhocDataProcessor"),l=e("adhoc/chart/highchartsDataMapper"),c=e("adhoc/chart/formattingDialog/model/FormattingDialogModel"),d=e("adhoc/chart/formattingDialog/view/FormattingDialogView"),u=e("logger").register(i);e("jquery.ui"),e("prototype"),e("utils.common"),e("designer.base");var h={},p=h;return o.extend(p,{debug:!1,mode:null,controller:"ich",state:{},cache:[],initd:!1,hasAllData:!1,groupLevel:{column:0,row:0},firstRendering:!0,chartContainerSelector:"#chartContainer",reset:function(){p.isDesignerInitialized=!1},setMode:function(e){this.mode=e},getMode:function(){return this.mode},flush:function(){this.hasAllData=!1,this.cache=[]},setUp:function(){},isOLAP:function(){return this.getMode()===designerBase.OLAP_ICHART},isOlapMode:function(){return this.getMode()===designerBase.OLAP_ICHART},isNonOlapMode:function(){return this.getMode()===designerBase.ICHART},update:function(e){try{p.setUp(),o.extend(this.state,e)}catch(t){p.debug&&console.log("AIC.update:   caught error "+t+" restore state to previous"),adhocDesigner.undo(),dialogs.systemConfirm.show("The previous request encountered an error '"+t+"' restoring chart to previous state")}return this},render:function(){var e=p.state.queryData.data.length>0;return n("#nothingToDisplayMessage").html(adhocDesigner.getMessage("ADH_1214_ICHARTS_NO_DATA")),adhocDesigner.setNothingToDisplayVisibility(!e),p.chart&&p.state.isRedrawRequired===!0&&(p.chart.destroy(),p.chart=void 0),p.ui.update(p.state),p.ui.render(),e=p.renderChart(e),p.isDesignerInitialized=!0,n("[action='chart-format']").removeClass("disabled"),e},renderChart:function(e){if(!p.firstRendering&&p.state.queryData.data.length)if(p.debug&&console.info(p.state),p.state.queryData.metadata.canRender===!1){var t,i=p.state.chartState.chartType;t=p._isTimeSeries()&&!l.isHeatMapTimeSeriesChart(i)?adhocDesigner.getMessage("ADH_1214_ICHARTS_NO_TIME_SERIES_DATA"):l.isDualOrMultiAxisChart(i)||l.isScatterChart(i)||l.isBubbleChart(i)?adhocDesigner.messages["ADH_1214_ICHARTS_NO_DATA_"+i.toUpperCase()]:l.isDualLevelPieChart(i)?adhocDesigner.messages.ADH_1214_ICHARTS_NO_DATA_DUAL_LEVEL_PIE:l.isHeatMapChart(i)&&!adhocDesigner.isOlapMode()?adhocDesigner.messages.ADH_1214_ICHARTS_NO_DATA_HEAT_MAP_NON_OLAP:l.isHeatMapChart(i)&&adhocDesigner.isOlapMode()?adhocDesigner.messages.ADH_1214_ICHARTS_NO_DATA_HEAT_MAP_OLAP:l.isHeatMapTimeSeriesChart(i)?adhocDesigner.messages.ADH_1214_ICHARTS_NO_DATA_TIME_SERIES_HEAT_MAP:l.isSpeedometerChart(i)?adhocDesigner.messages.ADH_1214_ICHARTS_NO_DATA_SPEEDOMETER:l.isArcGaugeChart(i)?adhocDesigner.messages.ADH_1214_ICHARTS_NO_DATA_GAUGE:"Unknown chart type group.",n("#nothingToDisplayMessage").html(t),adhocDesigner.setNothingToDisplayVisibility(!0),p.chart&&(p.chart.destroy(),p.chart=void 0)}else{var c=n(p.chartContainerSelector);p.ichWidth=c.width(),p.ichHeight=c.height();var d=r.generateOptions(p.state.queryData,p.state.chartState,{width:p.ichWidth,height:p.ichHeight,messages:adhocDesigner.messages});if(p._checkHasData(d)){if(e=!0,p.state.isRedrawRequired===!0||!p.chart){p._setAutoScaleFonts();try{p.chart=new s.Chart(d)}catch(h){u.error(h),t=/\#19/.test(h)?adhocDesigner.messages.ADH_1214_ICHARTS_ERROR_TOO_MANY_VALUES:adhocDesigner.messages.ADH_1214_ICHARTS_ERROR_UNCAUGHT,o.each(s.charts,function(e){e&&e.destroy()}),p.state.canSave=!1,adhocDesigner.enableRunAndSave(!1),n("#nothingToDisplayMessage").html(t),adhocDesigner.setNothingToDisplayVisibility(!0),p.chart&&(p.chart.destroy(),p.chart=void 0),e=!1}}}else e=!1,n("#nothingToDisplayMessage").html(adhocDesigner.getMessage("ADH_1214_ICHARTS_NO_CHART_DATA")),adhocDesigner.setNothingToDisplayVisibility(!e);p.isOLAP()&&(p.state.olapDimensionInfo=a.getOLAPDimensionInfo()),isDesignView&&p._renderDataLevelSelector()}return e},redraw:function(){var e=n(p.chartContainerSelector);if(p.ichWidth!=e.width()||p.ichHeight!=e.height()){var t=p.ichHeight==e.height();p.ichWidth=e.width(),p.ichHeight=e.height(),p._setAutoScaleFonts()?p.render():p.chart.setSize(p.ichWidth,p.ichHeight,t)}},_setAutoScaleFonts:function(){var e=n(p.chartContainerSelector);if(!p.state.chartState.autoScaleFonts)return"undefined"!=typeof p.autoScaleFontsSize&&e.css("font-size",p.autoScaleFontsSize),!1;"undefined"==typeof p.autoScaleFontsSize&&(p.autoScaleFontsSize=parseInt(e.css("font-size")));var t=1;return p.ichWidth<=100?t=.4:p.ichWidth>100&&p.ichWidth<=200?t=.5:p.ichWidth>200&&p.ichWidth<=300?t=.6:p.ichWidth>300&&p.ichWidth<=400?t=.7:p.ichWidth>400&&p.ichWidth<=500?t=.8:p.ichWidth>500&&p.ichWidth<=600&&(t=.9),parseInt(e.css("font-size"))!==Math.round(p.autoScaleFontsSize*t)?(e.css("font-size",p.autoScaleFontsSize*t),!0):!1},_isTimeSeries:function(){return-1!=p.state.chartState.chartType.indexOf("time_series")},_isTimeSeriesHeatMap:function(){return l.isHeatMapTimeSeriesChart(p.state.chartState.chartType)},cleanupOnSwitch:function(){p.ui.controls.chartTypeSelector.hide(),p.ui.dialogs.groupSelector.hide()},resize:function(){("pie"==p.state.chartState.chartType||l.isHeatMapTimeSeriesChart(p.state.chartState.chartType))&&p.render()},fixFirstRendering:function(){p.firstRendering&&(p.firstRendering=!1,p.renderChart())},initAll:function(){},_checkHasData:function(e){if(!e)return!1;if(!e.series)return!1;if(e.series.length<=0)return!1;for(var t=!1,i=0;i<e.series.length;i++)if(null!=e.series[i].data&&e.series[i].data.length>0){t=!0;break}return t},_isPivotAllowed:function(){var e=p;return e.getDimensions("row").length>0||e.isOLAP()&&e.getDimensions("column").length>0},_renderDataLevelSelector:function(){var e=p.ui.controls.dataLevelSelector;e.render(),p._isTimeSeries()&&e.hideRowsSlider()}}),o.extend(p,{serviceBus:{_listenersMap:{},_allEventsListeners:[],_incorrectEventTypeMsg:"Service bus supports only string events. Received event is not a string.",fireEvent:function(e){var t=p.serviceBus;if("string"!=typeof e)throw t._incorrectEventTypeMsg;var i=t._listenersMap,n=i[e];n&&o.each(n,function(t){t(e)}),o.each(t._allEventsListeners,function(t){t(e)})},registerListener:function(e,t){var i=p.serviceBus;if("string"!=typeof e)throw i._incorrectEventTypeMsg;var n=i._listenersMap,o=n[e];o||(o=[],n[e]=o),o.push(t)},registerAllEventsListener:function(e){p.serviceBus._allEventsListeners.push(e)}}}),o.extend(p,{mediator:{_isListenerRegistered:!1,eventToAction:{"chart:typeChanged":function(){p.state.chartState.chartType=p.ui.controls.chartTypeSelector.getType(),p.updateChartState()},"chart:levelChanged":function(){p.state.chartState.columnsSelectedLevels=p.ui.controls.dataLevelSelector.getColumnSelectedLevels(),p.state.chartState.rowsSelectedLevels=p.ui.controls.dataLevelSelector.getRowsSelectedLevels(),p.updateChartState()}},listener:function(e){if("string"!=typeof e)throw"Mediator supports only string events. Received event is not a string.";var t=p.mediator.eventToAction[e];t&&t()},register:function(){p.serviceBus._isListenerRegistered||(p.serviceBus.registerAllEventsListener(p.mediator.listener),p.serviceBus._isListenerRegistered=!0)}}}),o.extend(p,{ui:{controls:{dataLevelSelector:{_container:null,_column:null,_row:null,init:function(){var e=p.ui.controls.dataLevelSelector;e._container=n("#dataLevelSelector")},render:function(){if(l.isDualLevelPieChart(p.state.chartState.chartType))return void p.ui.controls.dataLevelSelector.hide();var e=p.ui.controls.dataLevelSelector;p.ui.selectorTables.column.show().find("td.select-header").parent().siblings().remove(),p.ui.selectorTables.row.show().find("td.select-header").parent().siblings().remove(),p.isOLAP()?e._renderOlapSlider():e._renderNonOlapSliders(),adhocDesigner.resetFilterPanelState()},_renderOlapSlider:function(){var e=p.ui.controls.dataLevelSelector;e._column=[],e._row=[],n.each(["row","column"],function(t,i){p.state.olapDimensionInfo[t].length?(n.each(p.state.olapDimensionInfo[t],function(t,n){var o=p.state.chartState[i+"sSelectedLevels"][t];e["_"+i].push(p.ui.create.slider(p.ui.selectorTables[i],n.levels,n.dimension,{max:n.levels.length-1,value:e._levelToLevelPosition(o,n),stop:function(){p.serviceBus.fireEvent("chart:levelChanged")}}))}),p.ui.selectorTables[i].show()):p.ui.selectorTables[i].hide()})},_renderNonOlapSliders:function(){var e=p.ui.controls.dataLevelSelector;e._row=e._renderNonOlapSlider(0),e._column=e._renderNonOlapSlider(1)},_renderNonOlapSlider:function(e){var t=p.ui.controls.dataLevelSelector,i=[];n.each(p.state.queryData.metadata.axes[e],function(e,t){"Measures"!=t.name&&i.push(t.label)
});var o=0==e?p.ui.selectorTables.row:p.ui.selectorTables.column,s=0==e?a.getRowSliderLevelCount():a.getColumnSliderLevelCount(),r=0==e?p.state.chartState.rowsSelectedLevels:p.state.chartState.columnsSelectedLevels;return o.find("td.select-header").parent().siblings().remove(),1==s?o.hide():o.show(),p.ui.create.slider(o,i,"",{max:s-1,value:t._getSliderPositionForNonOlap(r,e),stop:function(){p.serviceBus.fireEvent("chart:levelChanged")}})},hide:function(){p.ui.selectorTables.column.hide(),p.ui.selectorTables.row.hide()},hideRowsSlider:function(){p.ui.selectorTables.row.hide()},hideColumnsSlider:function(){p.ui.selectorTables.column.hide()},_levelToLevelPosition:function(e,t){for(var i=0;i<t.levels.length;i++)if(t.levels[i].levelName===e.name)return i;throw"No OLAP level info found for specified level = "+e},getRowsSelectedLevels:function(){var e=p.ui.controls.dataLevelSelector;return e._getSelectedLevels(e._row,e._row,0)},getColumnSelectedLevels:function(){var e=p.ui.controls.dataLevelSelector;return e._getSelectedLevels(e._column,e._column,1)},_getSelectedLevels:function(e,t,i){var n=p.ui.controls.dataLevelSelector;return p.isOLAP()?n._extractOlapSelectedLevels(t,i):n._extractNonOlapSelectedLevels(e,i)},_extractOlapSelectedLevels:function(e,t){var i=p.ui.controls.dataLevelSelector,o=[];return n(e).each(function(e){var s=i._extractSliderPosition(n(this)),r=p.state.olapDimensionInfo[t][e],a=r.levels[s];o.push({name:a.levelName,label:a.label,dimension:r.dimension})}),o},_extractNonOlapSelectedLevels:function(e,t){var i=p.ui.controls.dataLevelSelector,n=i._extractSliderPosition(e);if(0===n)return[];var o=a.getLevelsWithoutMeasures(p.state.queryData.metadata.axes[t]);return[o[n-1]]},_getSliderPositionForNonOlap:function(e,t){if(0==e)return 0;var i=a.getLevelsWithoutMeasures(p.state.queryData.metadata.axes[t]);return a.getLevelIndex(i,e[0])+1},_extractSliderPosition:function(e){return e.slider("option","value")},dock:function(){var e=p.ui.controls.dataLevelSelector;e._container.find("div.pod-body").eq(0).appendTo(n("#level-container")),dialogs.popup.hide(e._container[0])},undock:function(){var e=p.ui.controls.dataLevelSelector;n("#level-container").children("div.pod-body").eq(0).appendTo(e._container.find("div.body").eq(0)),dialogs.popup.show(e._container[0])}},chartTypeSelector:{_type:null,_container:null,_DISABLED_CLASS:"disabled",_patternsDisabledForOlap:["[name$='_time_series']"],init:function(){var e=p.ui.controls.chartTypeSelector;if(e._container=n("#chartTypeSelector"),e._container.on("click","div.cell",e._typeSelectedHandler),p.isOLAP())for(var t=0;t<e._patternsDisabledForOlap.length;t++)n(e._patternsDisabledForOlap[t]).addClass(e._DISABLED_CLASS)},update:function(e){var t=p.ui.controls.chartTypeSelector;t._type=e},render:function(){var e=p.ui.controls.chartTypeSelector;e._container.find("div.cell").removeClass("selected"),e._container.find('div.cell[name="'+e._type+'"]').eq(0).addClass("selected")},hide:function(){var e=p.ui.controls.chartTypeSelector;dialogs.popup.hide(e._container[0])},_typeSelectedHandler:function(){var e=p.ui.controls.chartTypeSelector;n(this).hasClass(e._DISABLED_CLASS)||(e._type=this.getAttribute("name"),e.render(),p.serviceBus.fireEvent("chart:typeChanged"))},getType:function(){var e=p.ui.controls.chartTypeSelector;return e._type}}},update:function(e){p.ui.controls.chartTypeSelector.update(e.chartState.chartType)},render:function(){var e=n("#titleCaption");p.state.titleBarShowing?e.show():e.hide(),e.html(p.state.title),adhocDesigner.enableXtabPivot(p._isPivotAllowed()),p.ui.controls.chartTypeSelector.render(),p.ui.dialogs.formatDialog.model.set(p.state.chartState),p.ui.controls.dataLevelSelector.hide()},create:{sliderTable:function(e){var t=n("#level-container").show().children(".pod-body").eq(0),i=Mustache.to_html(n("#levelSelectorTemplate").html(),{id:(e?"row":"column")+"LevelSelector",colspan:p.isOLAP()?2:1,name:e?layoutManagerLabels.row[p.mode]:layoutManagerLabels.column[p.mode]}),o=n(i).appendTo(t);return o.on("mouseover","div.tickOverlay",function(){var e=n(this).parent();p.dataLevelTooltip.html(e.attr("level-name")),p.dataLevelTooltip.show().position({of:e,at:"center top",my:"center bottom",offset:"0 -6",collision:"fit"}),"block"==p.ui.selectorTables.column.css("display")&&p.ui.selectorTables.column.hide().show(),"block"==p.ui.selectorTables.row.css("display")&&p.ui.selectorTables.row.hide().show()}),o.on("mouseover","a.ui-slider-handle",function(){var e=n(this).parent(),t=e.children("div.sliderTick").eq(e.slider("option","value"));p.dataLevelTooltip.html(t.attr("level-name")),p.dataLevelTooltip.show().position({of:t,at:"center top",my:"center bottom",offset:"0 -6",collision:"fit"}),"block"==p.ui.selectorTables.column.css("display")&&p.ui.selectorTables.column.hide().show(),"block"==p.ui.selectorTables.row.css("display")&&p.ui.selectorTables.row.hide().show()}),o.on("mouseout","a.ui-slider-handle, div.tickOverlay",function(){p.dataLevelTooltip.hide(),"block"==p.ui.selectorTables.column.css("display")&&p.ui.selectorTables.column.hide().show(),"block"==p.ui.selectorTables.row.css("display")&&p.ui.selectorTables.row.hide().show()}),o},slider:function(e,t,i,o){var s={label:p.isOLAP()?{name:i}:!1,marginLeft:p.isOLAP()?"24px":0};e.find("tbody").eq(0).append(Mustache.to_html(n("#dataLevelSelectorTemplate").html(),s));var r=e.find("div.jrs-slider").last();r.slider({value:o.value,min:0,max:o.max,step:1,range:"min",stop:o.stop,slide:function(e,t){var i=n(t.handle).parent().children("div.sliderTick").eq(t.value);p.dataLevelTooltip.html(i.attr("level-name")),p.dataLevelTooltip.show().position({of:i,at:"center top",my:"center bottom",offset:"0 -6",collision:"fit"}),"block"==p.ui.selectorTables.column.css("display")&&p.ui.selectorTables.column.hide().show(),"block"==p.ui.selectorTables.row.css("display")&&p.ui.selectorTables.row.hide().show()}});var a=o.max>0?100/o.max:0;p.isOLAP()||(t.unshift("All"),o.max++);for(var l=0;l<o.max+1;l++)if(t[l]){var s={label:t[l].label||t[l],width:l*a};"All"==s.label&&(s.label="Total");var c=Mustache.to_html(n("#sliderTickTemplate").html(),s);r.append(c)}return r}}},init:function(){if(p.mediator.register(),p.dataLevelTooltip=n("#dataLevelTooltip"),n("#chartOptions").appendTo(adhocDesigner.ui.canvas).show(),n("#chartMenu").appendTo(adhocDesigner.ui.canvas),n(Mustache.to_html(n("#titleCaptionTemplate").html()),{}).appendTo(adhocDesigner.ui.canvas).show(),n("#chartContainer").appendTo(adhocDesigner.ui.canvas).show(),!p.initd&&(n("#chartOptions").on("mouseenter",function(){n(this).addClass("over"),n("#chartMenu").show().position({of:n("#chartOptions"),at:"left bottom",my:"left top",offset:"0 -1"})}),n("#chartMenu").on("mouseleave",function(){n("#chartOptions").removeClass("over"),n("#chartMenu").hide()}),n("#chartMenu").on("mouseenter","p.wrap",function(){n(this).addClass("over")}),n("#chartMenu").on("mouseleave","p.wrap",function(){n(this).removeClass("over")}),n("#chartMenu").on("click","li",function(){if(n(this).is('[action="chart-types"]'))dialogs.popup.show(p.ui.dialogs.typeSelector[0]),p.ui.controls.chartTypeSelector.render();else if(n(this).is('[action="chart-format"]')){if(n(this).hasClass("disabled"))return;p.ui.dialogs.formatDialog.model.set(p.state.chartState),dialogs.popup.show(p.ui.dialogs.formatDialog.el),adhocDesigner.initEnableBrowserSelection($("designer"))}}),n("#chartTypeSelector .closeIcon").on(isIPad()?"touchstart":"click",function(){p.ui.dialogs.typeSelector.hide()}),n("#dataLevelSelector .closeIcon").on(isIPad()?"touchstart":"click",function(){p.ui.dialogs.groupSelector.hide()}),p.ui.dialogs={typeSelector:n("#chartTypeSelector"),groupSelector:n("#dataLevelSelector")},p.ui.selectorTables={column:p.ui.create.sliderTable(!1),row:p.ui.create.sliderTable(!0)},p.ui.controls.chartTypeSelector.init(),p.ui.controls.dataLevelSelector.init(),!p.ui.dialogs.formatDialog)){var e=new c(p.state.chartState,{parse:!0,updateState:o.bind(p.updateChartState,p)});p.ui.dialogs.formatDialog=new d({model:e})}p.ui.dialogs.typeSelector.hide(),p.ui.dialogs.groupSelector.hide(),n("#level-container").show(),p.initd=!0},hide:function(){n("#chartOptions").appendTo("#highChartsRepo").hide(),n("#chartMenu").appendTo("#highChartsRepo").hide(),n("#titleCaption").remove(),n("#chartContainer").appendTo("#highChartsRepo").hide()}}),o.extend(p,{mouseUpHandler:function(){},mouseDownHandler:function(){},mouseOverHandler:function(){},mouseOutHandler:function(){},mouseClickHandler:function(){},treeMenuHandler:function(e){var t,i=e.memo.node;"dimensionsTree"===i.treeId?t=i.isParent()?adhocDesigner.DIMENSION_TREE_DIMENSION_CONTEXT:adhocDesigner.DIMENSION_TREE_LEVEL_CONTEXT:"measuresTree"===i.treeId&&(t=i.isParent()?adhocDesigner.MEASURE_TREE_GROUP_CONTEXT:adhocDesigner.MEASURE_TREE_CONTEXT),adhocDesigner.showDynamicMenu(e.memo.targetEvent,t,null)},lmHandlersMap:{addItems:function(e,t,i){var n=o.map(e,function(e){return e.extra.dimensionId});p.insertDimensionInAxisWithChild({dim:e[0].extra.isMeasure?n.slice(0,1):n,axis:i,pos:t,child:o.pluck(e,"id"),hierarchyName:e[0].extra.hierarchyName})},measureReorder:function(e,t){p.moveMeasure(e,t)},column:{addItem:function(e,t,i,n,o,s,r){p.insertDimensionInAxisWithChild({dim:e,axis:"column",pos:t,child:i,measure_pos:n,isMeasure:o,uri:s,hierarchyName:r})},removeItem:function(e,t){e.isMeasure?p.removeMeasure(t):p.hideColumnLevel(e.dimensionId,e.level)},moveItem:function(e,t,i){p.moveDimension(e,"column",i)},switchItem:function(e,t,i){p.moveDimension(e,"column",i)},contextMenu:function(e,t){p.selectFromDisplayManager(t.targetEvent,t.extra,designerBase.COLUMN_GROUP_MENU_LEVEL),actionModel.setSelected([t.extra]),p.showMenu(t.targetEvent,"displayManagerColumn")}},row:{addItem:function(e,t,i,n,o,s,r){p.insertDimensionInAxisWithChild({dim:e,axis:"row",pos:t,child:i,measure_pos:n,isMeasure:o,uri:s,hierarchyName:r})},removeItem:function(e,t){e.isMeasure?p.removeMeasure(t):p.hideRowLevel(e.dimensionId,e.level)},moveItem:function(e,t,i){p.moveDimension(e,"row",i)},switchItem:function(e,t,i){p.moveDimension(e,"row",i)},contextMenu:function(e,t){p.selectFromDisplayManager(t.targetEvent,t.extra,designerBase.ROW_GROUP_MENU_LEVEL),actionModel.setSelected([t.extra]),p.showMenu(t.targetEvent,"displayManagerRow")}}}}),o.extend(p,{insertDimensionInAxisWithChild:function(e){p.flush(),designerBase.sendRequest("ich_insertDimensionInAxisWithChild",e,adhocDesigner.render,{bPost:!0})},removeMeasure:function(e){designerBase.sendRequest("ich_removeMeasure",new Array("i="+e),adhocDesigner.render,null)},moveDimension:function(e,t,i){designerBase.sendRequest("ich_moveDimension",new Array("dim="+encodeText(e),"axis="+t,"pos="+i),adhocDesigner.render,null)},hideRowLevel:function(e,t){designerBase.sendRequest("ich_hideRowLevel",new Array("f="+encodeText(e),"level="+encodeText(t)),adhocDesigner.render,null)},hideColumnLevel:function(e,t){var i=function(i){adhocDesigner.render(i);var n=p.getLevelObject(t,e,"column");n&&n.propertyMap&&"true"==n.propertyMap.lastFilteredLevel&&dialogs.systemConfirm.show(adhocDesigner.getMessage("ADH_CROSSTAB_LAST_FILTERED_LEVEL"),5e3)};designerBase.sendRequest("ich_hideColumnLevel",new Array("f="+encodeText(e),"level="+encodeText(t)),i,null)},expandAllLevels:function(){p.debug&&console.log("AIC.expandAllLevels:  sending expandAll query, this may take some time"),p.cache=[],p.hasAllData=!0,designerBase.sendRequest("ich_expandAllLevels",null,adhocDesigner.render,null)},switchToColumnGroup:function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=o.isNumber(e)?e:t.groupIndex;designerBase.sendRequest("ich_switchToColumnGroup",new Array("i="+i),adhocDesigner.render,null)},switchToRowGroup:function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=o.isNumber(e)?e:t.groupIndex;designerBase.sendRequest("ich_switchToRowGroup",new Array("i="+i),adhocDesigner.render,null)},moveRowGroup:function(e,t,i){var n=function(e){adhocDesigner.render(e),i&&i()};designerBase.sendRequest("ich_moveRowGroup",new Array("f="+e,"t="+t),n,null)},moveColumnGroup:function(e,t,i){var n=function(e){adhocDesigner.render(e),i&&i()};designerBase.sendRequest("ich_moveColumnGroup",new Array("f="+e,"t="+t),n,null)},moveMeasure:function(e,t){designerBase.sendRequest("ich_moveMeasureByName",["measure="+e,"to="+t],adhocDesigner.render,null)},updateChartState:function(e){n.extend(p.state.chartState,e);var t=function(e){if(!e)throw"No response received on save chart state request";adhocDesigner.render(e)};designerBase.sendRequest("ich_updateChartState",["chartState="+encodeURI(Object.toJSON(p.state.chartState))],t,null)},setCategoryForRowGroup:function(e,t){var i=function(e){adhocDesigner.render(e)};designerBase.sendRequest("ich_setRowGroupCategorizer",new Array("cat="+encodeText(e),"i="+t),i,null)},setCategoryForColumnGroup:function(e,t){var i=function(e){adhocDesigner.render(e)};designerBase.sendRequest("ich_setColumnGroupCategorizer",new Array("cat="+encodeText(e),"i="+t),i,null)},setSummaryFunction:function(e,t){designerBase.sendRequest("ich_setSummaryFunction",new Array("f="+e,"i="+t),p.standardIChartOpCallback,null)},setSummaryFunctionAndMask:function(e,t,i){designerBase.sendRequest("cr_setSummaryFunctionAndDataMask",new Array("f="+e,"m="+encodeText(t),"i="+i),p.standardIChartOpCallback,null)},setHideEmptyRows:function(){designerBase.sendRequest("ich_setProperty",new Array("name=hideEmptyRows","value=true"),p.standardIChartOpCallback,null)},setUnhideEmptyRows:function(){designerBase.sendRequest("ich_setProperty",new Array("name=hideEmptyRows","value=false"),p.standardIChartOpCallback,null)},updateViewCallback:function(e){localContext.standardIChartOpCallback(e)}}),o.extend(p,{canSaveReport:function(){return p.state.canSave},hideEmptyRowsEquals:function(e){return p.state.crosstabState.hideEmptyRows===e},canAddFilter:function(e,t){var i=localContext.isOlapMode()&&(isNotNullORUndefined(e.isMeasure)?e.isMeasure:e.param.extra&&e.param.extra.isMeasure),n=isNotNullORUndefined(e.param)?e.param.extra&&e.param.extra.id==localContext.ALL_LEVEL_NAME:e.level==localContext.ALL_LEVEL_NAME,o=localContext.isOlapMode()&&localContext._isAddingFilterDuplicate(e);return i?(t&&t.push(addFilterErrorMessageMeasureAdd),!1):n?(t&&t.push(addFilterErrorMessageAllLevelAdd),!1):e.isParent&&e.isParent()?(t&&t.push(addFilterErrorMessageGroupAdd),!1):adhocDesigner.isSpacerSelected(e)?(t&&t.push(addFilterErrorMessageSpacerAdd),!1):adhocDesigner.isPercentOfParentCalcSelected(e)?(t&&t.push(addFilterErrorMessagePercentOfParentCalcFieldAdd),!1):adhocDesigner.isConstantSelected(e)?(t&&t.push(addFilterErrorMessageConstantAdd),!1):o?(t&&t.push(addFilterErrorMessage),!1):!0},canAddSliceFilter:function(){var e=selObjects.find(function(e){return!e.isSliceable});return selObjects.first()&&!e},_isAddingFilterDuplicate:function(e){var t;return t=e.param?"["+e.param.extra.dimensionId+"].["+e.param.extra.id+"]":"["+e.dimensionId+"].["+e.level+"]",adhocDesigner.filtersController.hasFilterForField(t)},isDateType:function(){return p.isDateTimeType("date")},isTimestampType:function(){return p.isDateTimeType("timestamp")},isTimeType:function(){return p.isDateTimeType("time")},isDateTimeType:function(e){var t=adhocDesigner.getSelectedColumnOrGroup();if(t){var i=p.isGroupSelected(t),n=AdHocCrosstab.getSelectedGroup(t);if(n){var o=n.canReBucket===!0,s=n.type===e;return i&&o&&s}}return!1},isGroupSelected:function(e){return!e.isMeasure},isCurrentDateType:function(e){var t=AdHocCrosstab.getSelectedGroup(adhocDesigner.getSelectedColumnOrGroup());return t?t.categorizerName==e:!1},canMoveUpOrLeft:function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=p.getSelectedDimensionIndex(e);return t>0},canMoveDownOrRight:function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=p.getSelectedDimensionIndex(e);return t<p.getDimensions(e.axis).length-1},canAddSiblingLevels:function(){return!0},canSwitchToRow:function(){var e=adhocDesigner.getSelectedColumnOrGroup();return!p.isOLAP()||p.getDimensions(e.axis).length>1},canAddDimensionAsRowGroup:function(){var e=selObjects.first();if(e.hasChilds()||(e=e.parent),p.isOLAP()){if(0===p.getDimensions("column").length)return!1;var t=e.param.id,i=e.param.extra.isHierarchy&&e.param.extra.id,n=p.getLevelsFromDimension(t,"column"),s=p.getLevelsFromDimension(t,"row"),r=s.length>0&&s[0].indexOf("["+i+"]")>-1;return 0===n.length&&(e.param.extra.isHierarchy&&!r||s.length<e.getChildCount())}var a=dynamicTree.trees[e.getTreeId()],l=adhocDesigner.getAllLeaves(e,a),c=adhocDesigner.getAllLeaves(e,a).collect(function(e){return e.param.extra.id});if(l[0].param.extra.isMeasure){var d=p.getFilteredMeasureList("column");return 0===d.length}var u=o.pluck(p.getFilteredList(),"name");return o.difference(c,u).length>0},canAddDimensionAsColumnGroup:function(){var e=selObjects.first();if(e.hasChilds()||(e=e.parent),p.isOLAP()){var t=e.param.id,i=e.param.extra.isHierarchy&&e.param.extra.id,n=p.getLevelsFromDimension(t,"column"),s=p.getLevelsFromDimension(t,"row"),r=n.length>0&&n[0].indexOf("["+i+"]")>-1;return 0===s.length&&(e.param.extra.isHierarchy&&!r||n.length<e.getChildCount())}var a=dynamicTree.trees[e.getTreeId()],l=adhocDesigner.getAllLeaves(e,a),c=adhocDesigner.getAllLeaves(e,a).collect(function(e){return e.param.extra.id});if(l[0].param.extra.isMeasure){var d=p.getFilteredMeasureList("row");return 0===d.length}var u=o.pluck(p.getFilteredList(),"name");return o.difference(c,u).length>0},canAddLevelAsColumnGroup:function(){var e=selObjects.first(),t=p.isOLAP()?[e.param.extra.dimensionId]:adhocDesigner.getAllLeaves(e).map(function(e){return e.param.extra.dimensionId}),i=t.inject([],function(e,t){return e.concat(p.getLevelsFromDimension(t,"column")||[])}),n=t.inject([],function(e,t){return e.concat(p.getLevelsFromDimension(t,"row")||[])});return 0===n.length&&(0===i.length||!p.isOLAP()&&e.param.extra.isMeasure||!i.find(function(e){return o.contains(o.map(designerBase.getSelectedObjects(),function(e){return e.param.extra.id}),e)}))},canAddLevelAsRowGroup:function(){if(0===p.getDimensions("column").length&&p.isOLAP())return!1;var e=selObjects.first(),t=p.isOLAP()?[e.param.extra.dimensionId]:adhocDesigner.getAllLeaves(e).map(function(e){return e.param.extra.dimensionId}),i=t.inject([],function(e,t){return e.concat(p.getLevelsFromDimension(t,"column")||[])}),n=t.inject([],function(e,t){return e.concat(p.getLevelsFromDimension(t,"row")||[])});return 0===i.length&&(0===n.length||!p.isOLAP()&&e.param.extra.isMeasure||!n.find(function(t){return e.param.extra.id===t}))},isRowGroupSelected:function(e){return"row"===e.axis&&!e.isMeasure},isColumnGroupSelected:function(e){return"column"===e.axis&&!e.isMeasure},showAddHierarchyConfirm:function(e,t,i){return p.fromSiblingHierarchy(e,t)?(adhocDesigner.addConfirmDialog.show({ok:function(){return p.isFiltersApplied(t)?void dialogs.systemConfirm.show(adhocDesigner.getMessage("ADH_CROSSTAB_LAST_FILTERED_LEVEL"),5e3):void i()}}),!0):!1},isFiltersApplied:function(e,t){var i=o.pluck(p.getLevelObjectsFromDimension(e,t),"levelUniqueName"),n=o.pluck(p.state.existingFilters,"name");return!o.isEmpty(o.intersection(i,n))}}),o.extend(p,{removeLevelFromColumn:function(){var e=selObjects.first();n("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:removeItem",{axis:"column",index:e.index,item:{level:e.level,dimensionId:e.dimensionId,isMeasure:e.isMeasure}})},removeLevelFromRow:function(){var e=selObjects.first();n("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:removeItem",{axis:"row",index:e.index,item:{level:e.level,dimensionId:e.dimensionId,isMeasure:e.isMeasure}})},moveRowGroupLeft:function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=p.getSelectedDimensionIndex(t),n=i-1;p.moveRowGroup(i,n,e)},moveRowGroupRight:function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=p.getSelectedDimensionIndex(t),n=i+1;p.moveRowGroup(i,n,e)},moveColumnGroupLeft:function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=p.getSelectedDimensionIndex(t),n=i-1;p.moveColumnGroup(i,n,e)},moveColumnGroupRight:function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=p.getSelectedDimensionIndex(t),n=i+1;p.moveColumnGroup(i,n,e)},appendDimensionWithLevel:function(e,t){var i=e?p.getAvailableFieldsNodeBySelection(e.id,e.groupId):p.getAvailableFieldsNodeBySelection();i.axis=t,p.showAddHierarchyConfirm(i.hierarchyName,i.dimensionId,function(){n("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItem",i)})||n("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItem",i)},appendDimensionToRowAxisWithLevel:function(e){p.appendDimensionWithLevel(e,"row")},appendDimensionToColumnAxisWithLevel:function(e){p.appendDimensionWithLevel(e,"column")},appendMeasureToRow:function(e){var t=e?p.getAvailableFieldsNodesBySelection(e):p.getAvailableFieldsNodesBySelection();n("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItems",{axis:"row",levels:t,index:t[0].index})},appendMeasureToColumn:function(e){var t=e?p.getAvailableFieldsNodesBySelection(e):p.getAvailableFieldsNodesBySelection();n("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItems",{axis:"column",levels:t,index:t[0].index})},showMenu:function(e,t){var i,n=null;switch(t){case"displayManagerRow":i="displayManagerRow",n=p.generateAvailableSummaryCalculationsMenu;break;case"displayManagerColumn":i="displayManagerColumn",n=p.generateAvailableSummaryCalculationsMenu;break;case"groupMember":i=designerBase.MEMBER_GROUP_MENU_LEVEL,n=p.updateContextMenuWithSiblingLevels;break;case"measuresDimensionRow":i="measuresDimensionInRows";break;case"measuresDimensionColumn":i="measuresDimensionInColumns";break;case"rowGroup":i=designerBase.ROW_GROUP_MENU_LEVEL;break;case"columnGroup":i=designerBase.COLUMN_GROUP_MENU_LEVEL;break;case"measureRow":i="measureRow";break;case"measureColumn":i="measureColumn"}adhocDesigner.showDynamicMenu(e,i,null,n)},generateAvailableSummaryCalculationsMenu:function(e,t){if(!actionModel.selObjects[0].isMeasure)return t;var i=o.find(t,function(e){return"AdHocCrosstab.selectedMeasureShowsSummaryOptions"===e.clientTest});if(i){var n=actionModel.selObjects[0],s=o.findWhere(p.state.measures,{name:n.name});s&&adhocDesigner.generateAvailableSummaryCalculationsMenu(s.fieldName,i,{action:h.selectFunction,isSelectedTest:AdHocCrosstab.isSelectedSummaryFunction})}return t},setCatForColumnGroup:function(e){var t=adhocDesigner.getSelectedColumnOrGroup();t&&p.isColumnGroupSelected(t)&&p.setCategoryForColumnGroup(e,t.groupIndex)},setCatForRowGroup:function(e){var t=adhocDesigner.getSelectedColumnOrGroup();t&&p.isRowGroupSelected(t)&&p.setCategoryForRowGroup(e,t.groupIndex)},selectFunction:function(e){var t=AdHocCrosstab.getSelectedMeasure();if(t){var i=selObjects.first().index,n=adhocDesigner.getSuperType(t.type),o=AdHocCrosstab.getMeasureTypeByFunction(e);n!==o?p.setSummaryFunctionAndMask(e,defaultMasks[o],i):p.setSummaryFunction(e,i)}}}),o.extend(p,{getDimensions:function(e){var t=p.state.crosstabState;return e?t[e+"Groups"]:o.chain(t).filter(function(e,t){return t.search(/Groups$/)>=0}).flatten().value()},getLevelsFromDimension:function(e,t){return o.pluck(this.getLevelObjectsFromDimension(e,t),"name")},getLevelObjectsFromDimension:function(e,t){var i=this.getDimensions(t);return e=o.find(i,function(t){return t.name===e}),e?o.chain(e.levels).filter(function(e){return e.visible}).map(function(e){return o.isEmpty(e.members)?e:e.members}).flatten().filter(function(e){return!e.isSpacer}).value():[]},getLevelObject:function(e,t,i){function n(e,t){return o.find(e,function(e){return e.name==t})}var s=this.getDimensions(i),r=n(s,t);return r?n(r.levels,e):null},getFilteredList:function(e,t){var i=e||null,n=t||{};return 1===arguments.length&&o.isObject(e)&&(n=e,i=null),n.visible=!0,o.chain(p.getDimensions(i)).pluck("levels").flatten().map(function(e){return o.isEmpty(e.members)?e:e.members}).flatten().filter(function(e){return o.all(n,function(t,i){return void 0===e[i]||e[i]===t})}).value()},getFilteredMeasureList:function(e,t){var i=e||null,n=t||{};return 1===arguments.length&&o.isObject(e)&&(n=e,i=null),p.getFilteredList(i,o.extend(n,{measure:!0,measuresLevel:!0}))},fromSiblingHierarchy:function(e,t,i){if(!e)return!1;var n=this.getLevelsFromDimension(t,i);return n.length>0&&-1===n[0].indexOf("["+e+"]")},getHierarchy:function(e){var t=e.param.extra;return e.hasChilds()?(e.getFirstChild().hasChilds()&&(t=e.getFirstChild().param.extra),t&&t.isHierarchy?t.id:void 0):t.hierarchyName},getAvailableFieldsNodeBySelection:function(e,t,i){var n={};if(i||(i=selObjects.first()),selectionCategory.area==designerBase.AVAILABLE_FIELDS_AREA)i.hasChilds()?(n.isMeasure="measuresTree"===i.treeId,n.dimensionId=n.isMeasure?i.treeId:i.param.id,n.uri=localContext.isNonOlapMode()?i.param.uri:void 0,n.level=null):(n.isMeasure=!!i.param.extra.isMeasure,n.level=i.param.extra.dimensionId&&i.param.id,n.dimensionId=i.param.extra.dimensionId||i.param.extra.id),n.hierarchyName=this.getHierarchy(i),n.index=-1;else if(selectionCategory.area==designerBase.ROW_GROUP_MENU_LEVEL||selectionCategory.area==designerBase.COLUMN_GROUP_MENU_LEVEL)if(e||t){var o=/.*\[(.*)\]/.exec(e),s=o&&o[1];n.isMeasure=!t,n.level=e,n.dimensionId=n.isMeasure?adhocDesigner.MEASURES:t,n.index=-1,n.hierarchyName=s}else{if(!i.axis)return void alert("Need a way to get dimension name for clicked level from crosstab");n=i}return n},getAvailableFieldsNodesBySelection:function(e,t){for(var i=[],n=0;n<selObjects.length;n++)i.push(p.getAvailableFieldsNodeBySelection(e,t,selObjects[n])),i[n].extra=i[n],i[n].dimensionId=i[n].dimensionId,i[n].id=i[n].level;return i},updateContextMenuWithSiblingLevels:function(e,t){if(!adhocDesigner.ui.display_manager)return t;var i=t.find(function(e){return"AdHocCrosstab.canAddSiblingLevels"===e.clientTest});if(!i)return t;var n=null,s=null,r=null,a=selObjects[0],l=/.*\[(.*)\]/.exec(a.level),c=l&&l[1];if(selObjects.first().isMeasure)s=adhocDesigner.measuresTree.getRootNode(),r="row"===selObjects.first().axis?"AdHocCrosstab.appendMeasureToRow":"AdHocCrosstab.appendMeasureToColumn";else{if(!p.isOLAP())return selObjects.first().index=0,t;s=adhocDesigner.dimensionsTree.getRootNode().childs.find(function(e){return e.param.extra.id===selObjects.first().dimensionId}),s.childs[0].param.extra.isHierarchy&&(s=o.find(s.childs,function(e){return e.param.extra.id===c})),r="row"===selObjects.first().axis?"AdHocCrosstab.appendDimensionToRowAxisWithLevel":"AdHocCrosstab.appendDimensionToColumnAxisWithLevel"}if(void 0===selObjects.first().allLevels){var d=selObjects.first();d.allLevels=AdHocCrosstab.state.getLevelsFromDimension(selObjects.first().dimensionId,d.axis),d.index=d.allLevels.indexOf(d.level)}return selObjects.first().allLevels&&(n=p.isOLAP()?s.childs.findAll(function(e){return!selObjects.first().allLevels.include(e.param.extra.id)}):adhocDesigner.getAllLeaves(s,adhocDesigner.measuresTree).findAll(function(e){return!selObjects.first().allLevels.include(e.param.extra.id)})),n&&0!=n.length?(i.text=adhocDesigner.getMessage(selObjects.first().isMeasure?"addMeasures":"addLevels"),i.children=n.collect(function(e){return actionModel.createMenuElement("optionAction",{text:e.name,action:r,actionArgs:selObjects.first().isMeasure?[e.param.extra.id]:[{id:e.param.extra.id,groupId:e.param.extra.dimensionId,isMeasure:!1}]})}),t):t},getSelectedDimensionIndex:function(e){if(e){var t=e.isMeasure?adhocDesigner.MEASURES:e.dimensionId,i=-1;o.find(p.getDimensions(e.axis),function(e,n){return e.name===t?(i=n,!0):void 0})}return i}}),o.extend(p,{selectFromDisplayManager:function(e,t,i){designerBase.unSelectAll();var n=adhocDesigner.isMultiSelect(e,i);selectionCategory.area=i;var o=adhocDesigner.isAlreadySelected(t);adhocDesigner.addSelectedObject(e,t,n,o),Event.stop(e)},deselectAllSelectedOverlays:function(){}}),o.extend(p,{standardOpCallback:function(e){e?localContext.standardIChartOpCallback(e):window.console&&console.log("Internal server error occurred")},standardIChartOpCallback:function(e){adhocDesigner.render(e)}}),n(window).on("resizeEnd",function(){(localContext.getMode()==designerBase.ICHART||localContext.getMode()==designerBase.OLAP_ICHART)&&localContext.resize()}),n("#designer").bind({"rendering:done":function(){(localContext.getMode()==designerBase.ICHART||localContext.getMode()==designerBase.OLAP_ICHART)&&p.fixFirstRendering()}}),window.AdhocIntelligentChart=h,window.AIC=h,h});var AdHocCrosstab={DRILL_THROUGH_PATTERN:"tbody#detailRows tr td.value span",ROW_GROUP_MEMBER_PATTERN:"tbody#detailRows tr td.member",COLUMN_GROUP_MEMBER_PATTERN:"thead#headerAxis th.member",GROUP_LEVEL_PATTERN:"thead#headerAxis tr th.level",MEASURE_PATTERN:"table#canvasTable .measure",GROUP_MEMBER_DISCLOSURE_PATTERN:".olap span.button.disclosure",GROUP_LEVEL_DISCLOSURE_PATTERN:"th.level span.button.disclosure",SORT_ICON_PATTERN:".olap .icon.sort",MEASURE_LABEL_PATTERN:"#measureLabel.label.measure UL.measures LI.leaf a span.xm",XTAB_LABEL_PATTERN:"th.label.group",ROW_GROUP_OVERFLOW_PATTERN:"td.rowOverflow",COLGROUP_GROUP_OVERFLOW_PATTERN:"th.colOverflow",COLGROUP_PLACEHOLDER:"th#columnGroupsPlaceHolder",ROW_GROUP_PLACEHOLDER:"td#rowGroupsPlaceHolder",MEASURES_PLACEHOLDER:"td#measuresPlaceHolder",TREE_CONTEXT_MENU_PATTERN:["ul#dimensionsTree li.leaf .button","ul#dimensionsTree li.node .button","ul#measuresTree li.leaf .button","ul#measuresTree li.node .button"],SHOWING_DISPLAY_MANAGER_CLASS:"showingDisplayManager",OLAP_COLUMNS_ID:"olap_columns",OLAP_ROWS_ID:"olap_rows",DM_AXIS_LIST_PATTERN:"ul.tokens.sortable",NULL_DIMENSION:"NULL Dimension",DIMENSION_TREE_DIMENSION_CONTEXT:"dimensionsTree_dimension",DIMENSION_TREE_LEVEL_CONTEXT:"dimensionsTree_level",MEASURE_TREE_GROUP_CONTEXT:"measuresTree_group",MEASURE_TREE_CONTEXT:"measuresTree",DISPLAY_MANAGER_ROW_CONTEXT:"displayManagerRow",DISPLAY_MANAGER_COLUMN_CONTEXT:"displayManagerColumn",MEASURES_DIMENSION_ROW_MENU_CONTEXT:"measuresDimensionInRows",MEASURES_DIMENSION_COLUMN_MENU_CONTEXT:"measuresDimensionInColumns",MEASURE_ROW_MENU_CONTEXT:"measureRow",MEASURE_COLUMN_MENU_CONTEXT:"measureColumn",ENDS_WITH_A_NUMBER_REGEX:new RegExp("\\d+$"),ALL_LEVEL_NAME:"(All)",MEASURE:"measure",ROW_GROUP_MEMBER:"rgMember",COLUMN_GROUP_MEMBER:"cgMember",ROW_GROUP_PREFIX:"rowGroup",HACK_PADDING:1,VISUAL_CUE_HACK_PADDING:2,TRUNCATED_LABEL_LEN:100,requestsInProgress:0,DROP_TARGET_CLASS:"dropTarget",draggingMoveOverIndex:-1,currentlyDraggingIndex:-1,getMode:function(){return this.mode},setMode:function(e){this.mode=e},reset:function(){},render:function(){var e=this.state,t=e.crosstab,i="OK"===t.queryStatus,n=this[this.getMode()+"Template"](e);return isIE9()&&(n=removeWhitespacesFromTable(n)),adhocDesigner.ui.canvas.html(n),adhocDesigner.setNothingToDisplayVisibility(!i||e.isShowingNoData),adhocDesigner.enableXtabPivot(this.isPivotAllowed()),this.state.isShowingNoData?(jQuery("#nothingToDisplayMessage").html(adhocDesigner.getMessage("noDataMode")),jQuery("#canvasTable").css("border","none")):(jQuery("#nothingToDisplayMessage").html(adhocDesigner.getMessage(t.queryStatusMessagePrefix+t.queryStatus)),jQuery("#canvasTable").css("border-width","1px"),jQuery("#canvasTable").css("border-style","solid")),i},isPivotAllowed:function(){return this.state.getDimensionsCount("row")>0||(localContext.isNonOlapMode()?this.state.getDimensionsCount("column")>0:!1)},initAll:function(){new Truncator($$(AdHocCrosstab.MEASURE_LABEL_PATTERN),AdHocCrosstab.TRUNCATED_LABEL_LEN),new Truncator($$(AdHocCrosstab.XTAB_LABEL_PATTERN),AdHocCrosstab.TRUNCATED_LABEL_LEN)},isOlapMode:function(){return this.getMode()===designerBase.OLAP_CROSSTAB},isNonOlapMode:function(){return this.getMode()===designerBase.CROSSTAB},fromSiblingHierarchy:function(e,t,i){if(!e)return!1;var n=this.state.getLevelsFromDimension(t,i);return n.length>0&&-1===n[0].indexOf("["+e+"]")}};AdHocCrosstab.State={getDimensions:function(e){return e?this.crosstabState[e+"Groups"]:_.chain(this.crosstabState).filter(function(e,t){return t.search(/Groups$/)>=0}).flatten().value()},getDimension:function(e,t){return _.find(this.getDimensions(t),function(t){return t.name===e})},getDimensionsCount:function(e){return this.getDimensions(e).length
},getLevelsFromDimension:function(e,t){return _.pluck(this.getLevelObjectsFromDimension(e,t),"name")},getLevelObjectsFromDimension:function(e,t){var i=this.getDimensions(t);return e=_.find(i,function(t){return t.name===e}),e?_.chain(e.levels).filter(function(e){return e.visible}).map(function(e){return _.isEmpty(e.members)?e:e.members}).flatten().filter(function(e){return!e.isSpacer}).value():[]},getLevelObject:function(e,t,i){function n(e,t){return _.find(e,function(e){return e.name==t})}var o=this.getDimensions(i),s=n(o,t);return s?n(s.levels,e):null},getFilteredList:function(e,t){var i=e||null,n=t||{};return 1===arguments.length&&_.isObject(e)&&(n=e,i=null),n.visible=!0,_.chain(this.getDimensions(i)).pluck("levels").flatten().map(function(e){return _.isEmpty(e.members)?e:e.members}).flatten().filter(function(e){return _.all(n,function(t,i){return void 0===e[i]||e[i]===t})}).value()},getFilteredMeasureList:function(e,t){var i=e||null,n=t||{};return 1===arguments.length&&_.isObject(e)&&(n=e,i=null),this.getFilteredList(i,_.extend(n,{measure:!0,measuresLevel:!0}))}},define("adhoc/crosstab",["jquery","underscore","prototype","designer.base","utils.common","tools.truncator"],function(e){return function(){var t;return t||e.AdHocCrosstab}}(this)),AdHocCrosstab.showCrosstabMenu=function(e,t){adhocDesigner.showDynamicMenu(e,t,null,function(e,t){return e=AdHocCrosstab.updateContextMenuWithSiblingLevels(e,t),AdHocCrosstab.generateAvailableSummaryCalculationsMenu(e,t)})},AdHocCrosstab.addFieldToXtab=function(e,t,i){var n=i.element();if(n){var o=matchMeOrUp(n,localContext.DM_AXIS_LIST_PATTERN);if(o){var s=$(o).identify();s.startsWith(localContext.OLAP_COLUMNS_ID)?AdHocCrosstab.appendDimensionToColumnAxisWithLevel():s.startsWith(localContext.OLAP_ROWS_ID)&&AdHocCrosstab.appendDimensionToRowAxisWithLevel()}}},AdHocCrosstab.processFieldAsColumnGroup=function(e,t,i){var n=i,o=null,s=e.identify();if(s.startsWith("colGroupHeaderRow_")||s.startsWith("colGroupHeader_"))try{o=t.exec(s)[0],n=parseInt(o)+1}catch(r){}AdHocCrosstab.addFieldAsColumnGroup(n)},AdHocCrosstab.processFieldAsMeasure=function(e,t,i){var n=i,o=null,s=e.identify();if(s.startsWith("measureHeader_"))try{o=t.exec(s)[0],n=parseInt(o)+1}catch(r){}else("A"==e.nodeName||"LI"==e.nodeName)&&("A"==e.nodeName&&(e=e.up("li.leaf")),e&&(n=$(e).previousSiblings().length));addFieldAsMeasure(n,!0)},AdHocCrosstab.processFieldAsRowGroup=function(e,t,i){var n=i,o=null,s=e.identify();if(s.startsWith("rowGroup_")||s.startsWith("rowGroupHeader_"))try{o=t.exec(s)[0],n=parseInt(o)+1}catch(r){}AdHocCrosstab.addFieldAsRowGroup(n)},AdHocCrosstab.moveRowGroupLeft=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=AdHocCrosstab.getSelectedDimensionIndex(t),n=i-1;AdHocCrosstab.moveRowGroup(i,n,e)},AdHocCrosstab.moveRowGroupRight=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=AdHocCrosstab.getSelectedDimensionIndex(t),n=i+1;AdHocCrosstab.moveRowGroup(i,n,e)},AdHocCrosstab.moveColumnGroupLeft=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=AdHocCrosstab.getSelectedDimensionIndex(t),n=i-1;AdHocCrosstab.moveColumnGroup(i,n,e)},AdHocCrosstab.moveColumnGroupRight=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=AdHocCrosstab.getSelectedDimensionIndex(t),n=i+1;AdHocCrosstab.moveColumnGroup(i,n,e)},AdHocCrosstab.moveMeasureLeft=function(){var e=adhocDesigner.getSelectedColumnOrGroup();AdHocCrosstab.moveMeasure(e.level,e.index-1)},AdHocCrosstab.moveMeasureRight=function(){var e=adhocDesigner.getSelectedColumnOrGroup();AdHocCrosstab.moveMeasure(e.level,e.index+1)},AdHocCrosstab.moveRowGroupOnDrag=function(){draggingMoveOverIndex=parseInt(draggingMoveOverIndex),currentlyDraggingIndex=parseInt(currentlyDraggingIndex),currentlyDraggingIndex!=draggingMoveOverIndex&&(currentlyDraggingIndex>=0&&draggingMoveOverIndex>=0?AdHocCrosstab.moveRowGroup(currentlyDraggingIndex,draggingMoveOverIndex):-1==draggingMoveOverIndex&&AdHocCrosstab.removeRowGroup(currentlyDraggingIndex))},AdHocCrosstab.hideLevel=function(){var e=getDimensionWithLevelFromSelection();selectionCategory.area===designerBase.COLUMN_GROUP_MENU_LEVEL?AdHocCrosstab.hideColumnLevel(e.dimensionId,e.level):selectionCategory.area===designerBase.ROW_GROUP_MENU_LEVEL&&AdHocCrosstab.hideRowLevel(e.dimensionId,e.level)},AdHocCrosstab.showLevel=function(){var e=AdHocCrosstab.getDimensionWithLevelFromSelection();selectionCategory.area===designerBase.COLUMN_GROUP_MENU_LEVEL?AdHocCrosstab.showColumnLevel(e.dimensionId,e.level):selectionCategory.area===designerBase.ROW_GROUP_MENU_LEVEL&&AdHocCrosstab.showRowLevel(e.dimensionId,e.level)},AdHocCrosstab.moveColumnGroupDown=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=AdHocCrosstab.getSelectedDimensionIndex(t),n=i+1;AdHocCrosstab.moveColumnGroup(i,n,e)},AdHocCrosstab.moveColumnGroupUp=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=AdHocCrosstab.getSelectedDimensionIndex(t),n=i-1;AdHocCrosstab.moveColumnGroup(i,n,e)},AdHocCrosstab.moveColumnGroupOnDrag=function(){draggingMoveOverIndex=parseInt(draggingMoveOverIndex),currentlyDraggingIndex=parseInt(currentlyDraggingIndex),currentlyDraggingIndex!=draggingMoveOverIndex&&(currentlyDraggingIndex>=0&&draggingMoveOverIndex>=0?AdHocCrosstab.moveColumnGroup(currentlyDraggingIndex,draggingMoveOverIndex):-1==draggingMoveOverIndex&&AdHocCrosstab.removeColumnGroup(currentlyDraggingIndex))},AdHocCrosstab.moveMeasureOnDrag=function(){draggingMoveOverIndex=parseInt(draggingMoveOverIndex),currentlyDraggingIndex=parseInt(currentlyDraggingIndex),currentlyDraggingIndex!=draggingMoveOverIndex&&(currentlyDraggingIndex>=0&&draggingMoveOverIndex>=0?AdHocCrosstab.moveMeasure(currentlyDraggingIndex,draggingMoveOverIndex):-1==draggingMoveOverIndex&&AdHocCrosstab.removeMeasure(currentlyDraggingIndex))},AdHocCrosstab.retrieveOverflowRowGroups=function(){var e=confirm(adhocDesigner.getMessage("overflowConfirmMessage"));e&&AdHocCrosstab.getOverflowRowGroups()},AdHocCrosstab.retrieveOverflowColumnGroups=function(){var e=confirm(adhocDesigner.getMessage("overflowConfirmMessage"));e&&AdHocCrosstab.getOverflowColumnGroups()},AdHocCrosstab.selectMeasureMask=function(e){var t=AdHocCrosstab.getSelectedMeasure();if(t){var i=selObjects.first().index;AdHocCrosstab.setMask(e,i)}},AdHocCrosstab.selectFunction=function(e){var t=AdHocCrosstab.getSelectedMeasure(),i=selObjects.first();if(t){var n=adhocDesigner.getSuperType(t.type),o=AdHocCrosstab.getMeasureTypeByFunction(e);n!==o?AdHocCrosstab.setSummaryFunctionAndMask(e,defaultMasks[o],i.index):AdHocCrosstab.setSummaryFunction(e,i.index)}},AdHocCrosstab.selectedMeasureShowsSummaryOptions=function(){return!!AdHocCrosstab.getSelectedMeasure()},AdHocCrosstab.selectedMeasureShowsNumericSummaryOptions=function(){return localContext.selectedMeasureShowsSummaryOptions()&&localContext.isSelectedMeasureNumeric()},AdHocCrosstab.setCatForColumnGroup=function(e){var t=adhocDesigner.getSelectedColumnOrGroup();t&&AdHocCrosstab.isColumnGroupSelected(t)&&AdHocCrosstab.setCategoryForColumnGroup(e,t.groupIndex)},AdHocCrosstab.setCatForRowGroup=function(e){var t=adhocDesigner.getSelectedColumnOrGroup();t&&AdHocCrosstab.isRowGroupSelected(t)&&AdHocCrosstab.setCategoryForRowGroup(e,t.groupIndex)},AdHocCrosstab.appendDimensionWithLevel=function(e,t){var i=e?localContext.getAvailableFieldsNodeBySelection(e.id,e.groupId):localContext.getAvailableFieldsNodeBySelection();i.axis=t,AdHocCrosstab.showAddHierarchyConfirm(i.hierarchyName,i.dimensionId,function(){jQuery("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItem",i)})||jQuery("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItem",i)},AdHocCrosstab.appendDimensionToRowAxisWithLevel=function(e){AdHocCrosstab.appendDimensionWithLevel(e,"row")},AdHocCrosstab.appendDimensionToColumnAxisWithLevel=function(e){AdHocCrosstab.appendDimensionWithLevel(e,"column")},AdHocCrosstab.appendMeasureToRow=function(e){var t=e?localContext.getAvailableFieldsNodesBySelection(e):localContext.getAvailableFieldsNodesBySelection();jQuery("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItems",{axis:"row",levels:t,index:t[0].index})},AdHocCrosstab.appendMeasureToColumn=function(e){var t=e?localContext.getAvailableFieldsNodesBySelection(e):localContext.getAvailableFieldsNodesBySelection();jQuery("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:addItems",{axis:"column",levels:t,index:t[0].index})},AdHocCrosstab.removeLevelFromRow=function(){var e=localContext.getSelectedObject();jQuery("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:removeItem",{axis:"row",index:e.index,item:{level:e.level,dimensionId:e.dimensionId,isMeasure:e.isMeasure}})},AdHocCrosstab.removeLevelFromColumn=function(){var e=localContext.getSelectedObject();jQuery("#"+adhocDesigner.DISPLAY_MANAGER_ID).trigger("lm:removeItem",{axis:"column",index:e.index,item:{level:e.level,dimensionId:e.dimensionId,isMeasure:e.isMeasure}})},AdHocCrosstab.selectedGroupCanShowSummary=function(){var e=AdHocCrosstab.getSelectedGroup(adhocDesigner.getSelectedColumnOrGroup()),t=AdHocCrosstab.getGroupParent(e);return t?t.expanded===!0&&!AdHocCrosstab.selectedGroupHasSummary():!AdHocCrosstab.selectedGroupHasSummary()},AdHocCrosstab.selectedColumnGroupCanHideSummary=function(){var e=AdHocCrosstab.canHideSummariesForColumnGroup(),t=AdHocCrosstab.getSelectedGroup(adhocDesigner.getSelectedColumnOrGroup()),i=AdHocCrosstab.getGroupParent(t);return e?i?i.expanded===!0&&AdHocCrosstab.selectedGroupHasSummary():AdHocCrosstab.selectedGroupHasSummary():!1},AdHocCrosstab.selectedRowGroupCanHideSummary=function(){var e=AdHocCrosstab.canHideSummariesForRowGroup();return e?AdHocCrosstab.selectedGroupHasSummary():!1},AdHocCrosstab.getGroupParent=function(e){var t,i=-1;return localContext.state.columnGroups.detect(function(t,n){return t.name===e.name?i=n-1:void 0}),i>=0&&(t=localContext.state.columnGroups[i]),t},AdHocCrosstab.selectedGroupHasSummary=function(){var e=AdHocCrosstab.getSelectedGroup(adhocDesigner.getSelectedColumnOrGroup());return e?e.isShowingSummary===!0:!1},AdHocCrosstab.selectedRowGroupIsCollapsible=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e&&e.expandable},AdHocCrosstab.selectedColumnGroupIsCollapsible=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e&&e.expandable},define("adhoc/crosstab.actions",["adhoc/crosstab"],function(e){return function(){var t;return t||e.AdHocCrosstab}}(this)),AdHocCrosstab.insertDimensionInAxisWithChild=function(e){designerBase.sendRequest("cr_insertDimensionInAxisWithChild",e,localContext.standardCrosstabOpCallback,{bPost:!0})},AdHocCrosstab.insertDimensionInRowAxisWithLevel=function(e,t,i,n){AdHocCrosstab.insertDimensionInAxisWithChild({dim:e,axis:"row",pos:i,child:t,measure_pos:n})},AdHocCrosstab.insertDimensionInColumnAxisWithLevel=function(e,t,i,n){AdHocCrosstab.insertDimensionInAxisWithChild({dim:e,axis:"column",pos:i,child:t,measure_pos:n})},AdHocCrosstab.insertDimensionInRowAxisWithAllLevels=function(e,t){AdHocCrosstab.insertDimensionInAxisWithChild({dim:e,axis:"row",pos:t})},AdHocCrosstab.insertDimensionInColumnAxisWithAllLevels=function(e,t){AdHocCrosstab.insertDimensionInAxisWithChild({dim:e,axis:"column",pos:t})},AdHocCrosstab.moveDimension=function(e,t,i){var n=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_moveDimension",new Array("dim="+encodeText(e),"axis="+t,"pos="+i),n,null)},AdHocCrosstab.removeDimension=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_removeDimension",new Array("axis="+e,"pos="+t),i,null)},AdHocCrosstab.showRowLevel=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_showRowLevel",new Array("f="+encodeText(e),"level="+encodeText(t)),i,null)},AdHocCrosstab.hideRowLevel=function(e,t){var i=function(i){localContext.standardCrosstabOpCallback(i);var n=localContext.state.getLevelObject(t,e,"row");n&&n.propertyMap&&"true"==n.propertyMap.lastFilteredLevel&&dialogs.systemConfirm.show(adhocDesigner.getMessage("ADH_CROSSTAB_LAST_FILTERED_LEVEL"),5e3)};designerBase.sendRequest("cr_hideRowLevel",new Array("f="+encodeText(e),"level="+encodeText(t)),i,null)},AdHocCrosstab.showColumnLevel=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_showColumnLevel",new Array("f="+encodeText(e),"level="+encodeText(t)),i,null)},AdHocCrosstab.hideColumnLevel=function(e,t){var i=function(i){localContext.standardCrosstabOpCallback(i);var n=localContext.state.getLevelObject(t,e,"column");n&&n.propertyMap&&"true"==n.propertyMap.lastFilteredLevel&&dialogs.systemConfirm.show(adhocDesigner.getMessage("ADH_CROSSTAB_LAST_FILTERED_LEVEL"),5e3)};designerBase.sendRequest("cr_hideColumnLevel",new Array("f="+encodeText(e),"level="+encodeText(t)),i,null)},AdHocCrosstab.pivot=function(){designerBase.sendRequest("cr_pivot",[],localContext.standardCrosstabOpCallback,null)},AdHocCrosstab.insertMeasure=function(e,t,i){var n=function(e){localContext.standardCrosstabOpCallback(e)},o=_.reject({measure:e,pos:t,axis:i},_.isUndefined);designerBase.sendRequest("cr_insertMeasure",o,n,null)},AdHocCrosstab.moveMeasure=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_moveMeasureByName",["measure="+e,"to="+t],i,null)},AdHocCrosstab.removeMeasure=function(e){if(!Object.isNumber(e)){var t=adhocDesigner.getSelectedColumnOrGroup();e=t.index}var i=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_removeMeasure",new Array("i="+e),i,null)},AdHocCrosstab.expandLevel=function(e,t,i){if(!e||!t){var n=adhocDesigner.getSelectedColumnOrGroup();e=n.dimensionId,t=n.level}var o=new Array("f="+encodeText(e),"level="+encodeText(t),"isRow="+i);designerBase.sendRequest("cr_expandLevel",o,localContext.standardCrosstabOpCallback,null)},AdHocCrosstab.collapseLevel=function(e,t,i){if(!e||!t){var n=adhocDesigner.getSelectedColumnOrGroup();e=n.dimensionId,t=n.level}var o=new Array("f="+encodeText(e),"level="+encodeText(t),"isRow="+i);designerBase.sendRequest("cr_collapseLevel",o,localContext.standardCrosstabOpCallback,null)},AdHocCrosstab.insertColumnGroup=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};canAddAsGroup()&&designerBase.sendRequest("cr_insertColumnGroup",new Array("f="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.insertRowGroup=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};canAddAsGroup()&&designerBase.sendRequest("cr_insertRowGroup",new Array("f="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.removeColumnGroup=function(e){if(!e){var t=adhocDesigner.getSelectedColumnOrGroup();e=AdHocCrosstab.getSelectedDimensionIndex(t)}var i=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_removeColumnGroup",new Array("i="+e),i,null)},AdHocCrosstab.removeRowGroup=function(e){if(!e){var t=adhocDesigner.getSelectedColumnOrGroup();e=AdHocCrosstab.getSelectedDimensionIndex(t)}var i=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_removeRowGroup",new Array("i="+e),i,null)},AdHocCrosstab.moveRowGroup=function(e,t,i){var n=function(e){localContext.standardCrosstabOpCallback(e),i&&i(),designerBase.unSelectAll()};designerBase.sendRequest("cr_moveRowGroup",new Array("f="+e,"t="+t),n,null)},AdHocCrosstab.moveColumnGroup=function(e,t,i){var n=function(e){localContext.standardCrosstabOpCallback(e),i&&i(),designerBase.unSelectAll()};designerBase.sendRequest("cr_moveColumnGroup",new Array("f="+e,"t="+t),n,null)},AdHocCrosstab.toggleExpandCollapseForColumn=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_toggleExpandCollapseForColumn",new Array("nodePath="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.toggleExpandCollapseForRow=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_toggleExpandCollapseForRow",new Array("nodePath="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.switchToRowGroup=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=_.isNumber(e)?e:t.groupIndex;designerBase.sendRequest("cr_switchToRowGroup",new Array("i="+i),localContext.standardCrosstabOpCallback,null)},AdHocCrosstab.switchToColumnGroup=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=_.isNumber(e)?e:t.groupIndex;designerBase.sendRequest("cr_switchToColumnGroup",new Array("i="+i),localContext.standardCrosstabOpCallback,null)},AdHocCrosstab.deleteRowGroupSummary=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=AdHocCrosstab.getSelectedDimensionIndex(e),i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setIncludeAllOnRows",new Array("pos="+t,"value=false"),i,null)},AdHocCrosstab.addRowGroupSummary=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=AdHocCrosstab.getSelectedDimensionIndex(e),i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setIncludeAllOnRows",new Array("pos="+t,"value=true"),i,null)},AdHocCrosstab.deleteColumnGroupSummary=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=AdHocCrosstab.getSelectedDimensionIndex(e),i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setIncludeAllOnColumns",new Array("pos="+t,"value=false"),i,null)},AdHocCrosstab.addColumnGroupSummary=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=AdHocCrosstab.getSelectedDimensionIndex(e),i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setIncludeAllOnColumns",new Array("pos="+t,"value=true"),i,null)},AdHocCrosstab.sortControlClicked=function(e){if(AdHocCrosstab.requestsInProgress<1){AdHocCrosstab.requestsInProgress++;var t=function(e){AdHocCrosstab.requestsInProgress--,localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_sortControlClicked",new Array("i="+e),t,null)}},AdHocCrosstab.sortingChosen=function(e,t){var i=designerBase.getSelectedObject();i.type=e;var n=function(e){localContext.standardCrosstabOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("cr_"+t,["axis="+i.axis,"dimension="+i.dimensionId||"","level="+i.level||"","path="+encodeURIComponent(i.path||""),"sortType="+e],n,null)},AdHocCrosstab.updateViewCallback=function(e){localContext.standardCrosstabOpCallback(e)},AdHocCrosstab.setCategoryForRowGroup=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setRowGroupCategorizer",new Array("cat="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.setCategoryForColumnGroup=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setColumnGroupCategorizer",new Array("cat="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.setMask=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setDataMask",new Array("m="+encodeText(e),"i="+t),i,null)},AdHocCrosstab.setSummaryFunction=function(e,t){var i=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setSummaryFunction",new Array("f="+e,"i="+t),i,null)},AdHocCrosstab.setSummaryFunctionAndMask=function(e,t,i){var n=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setSummaryFunctionAndDataMask",new Array("f="+e,"m="+encodeText(t),"i="+i),n,null)},AdHocCrosstab.getOverflowRowGroups=function(){var e=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_showInUnsafeRowMode",[],e,null)},AdHocCrosstab.getOverflowColumnGroups=function(){var e=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_showInUnsafeColumnMode",[],e,null)},AdHocCrosstab.getDrillUrl=function(){var e=removeTrailingPound(document.location.href),t=e.toQueryParams();return t=_.pick(t,"realm","_flowExecutionKey","_eventId"),_.extend(t,{_flowId:"adhocFlow",reportType:"table",usePreparedState:"true",clientKey:Math.floor(9999999999999*Math.random())}),"flow.html?"+jQuery.param(t)},AdHocCrosstab.createJSONDrillThrough=function(e,t){return JSON.stringify({type:"path_expression",pathList:[encodeURIComponent(e),encodeURIComponent(t)]})},AdHocCrosstab.drill=function(e,t){if(AdHocCrosstab.allowDrill!==!1){AdHocCrosstab.allowDrill=!1,isIPad()&&(JRS.vars.win=window.open());var i=function(e){if(AdHocCrosstab.allowDrill=!0,e.success){var t=function(){if(isIPad())JRS.vars.win.location=AdHocCrosstab.getDrillUrl();else{var e="width=1000,left=200,top=100,height="+Math.round(.8*jQuery(window).height());window.name="",runPopup=window.open(AdHocCrosstab.getDrillUrl(),"drillTable",e),runPopup.focus()}};setTimeout(t,0)}},n=function(){AdHocCrosstab.allowDrill=!0},o=AdHocCrosstab.createJSONDrillThrough(localContext.state.rowNodeList[e],localContext.state.columnNodeList[t]);if(!isIPad()||!JRS.vars.element_scrolled){var s=["drillThroughAdhocFilter="+o];window.isEmbeddedDesigner&&s.push("embeddedDesigner=true"),designerBase.sendRequest("cr_prepareDrillTableState",s,i,null,n)}return!1}},AdHocCrosstab.getDrillOlapUrl=function(e){return"flow.html?_flowId=viewAdhocReportFlow&clientKey="+clientKey+"&reportUnit="+e+"&noReturn=true"},AdHocCrosstab.drillOLAP=function(e,t){if(AdHocCrosstab.allowDrill!==!1){AdHocCrosstab.allowDrill=!1;var i=function(e){if(AdHocCrosstab.allowDrill=!0,e.tempARUName)if(localContext.tempARUName=e.tempARUName,isIPad());else{var t="width=1000,left=200,top=100,height="+Math.round(.8*jQuery(window).height());windowPopUp=window.open("","jr",t),windowPopUp.location=localContext.getDrillOlapUrl(e.tempARUName)}},n=function(){AdHocCrosstab.allowDrill=!0},o=AdHocCrosstab.createJSONDrillThrough(localContext.state.rowNodeList[e],localContext.state.columnNodeList[t]);if(!isIPad()||!JRS.vars.element_scrolled){var s=["drillThroughAdhocFilter="+o];window.isEmbeddedDesigner&&s.push("embeddedDesigner=true"),designerBase.sendRequest("cr_prepareDrillTableStateOLAP",s,i,null,n)}return!1}},AdHocCrosstab.getIsHideEmptyRows=function(){return AdHocCrosstab.state.crosstabState.hideEmptyRows},AdHocCrosstab.hideEmptyRowsEquals=function(e){return localContext.getIsHideEmptyRows()===e},AdHocCrosstab.setHideEmptyRows=function(){var e=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setProperty",new Array("name=hideEmptyRows","value=true"),e,null)},AdHocCrosstab.setUnhideEmptyRows=function(){var e=function(e){localContext.standardCrosstabOpCallback(e)};designerBase.sendRequest("cr_setProperty",new Array("name=hideEmptyRows","value=false"),e,null)},AdHocCrosstab.standardOpCallback=function(e){e?localContext.standardCrosstabOpCallback(e):window.console&&console.log("Internal server error occurred")},AdHocCrosstab.getCallbacksForPivot=function(){localContext.standardOpCallback()},AdHocCrosstab.undoAndRedoCallback=function(){adhocDesigner.undoAndRedoCallback(),localContext.standardCrosstabOpCallback()},AdHocCrosstab.updateCustomFieldCallback=function(){this.standardCrosstabOpCallback()},AdHocCrosstab.reInitOverlayCallback=function(){},AdHocCrosstab.standardCrosstabOpCallback=function(e){adhocDesigner.render(e)},define("adhoc/crosstab.ajax",["adhoc/crosstab"],function(e){return function(){var t;return t||e.AdHocCrosstab}}(this)),AdHocCrosstab.deselectAllSelectedOverlays=function(){},AdHocCrosstab.deselectAllColumnGroupOverlays=function(){},AdHocCrosstab.deselectAllRowGroupOverlays=function(){},AdHocCrosstab.deselectAllMeasureOverlays=function(){},AdHocCrosstab.removeFromSelectObjects=function(e){var t=null;selObjects.each(function(i){i.id==e&&(t=i)}),selObjects=selObjects.without(t)},AdHocCrosstab.getSelectedDimensionIndex=function(e){var t,i=-1;return e?_.isNumber(e.groupIndex)?e.groupIndex:(t=e.isMeasure?adhocDesigner.MEASURES:e.dimensionId,_.find(localContext.state.getDimensions(e.axis),function(e,n){return e.name===t?(i=n,!0):void 0}),i):i},AdHocCrosstab.getSelectedMeasure=function(){if(selObjects&&selObjects.length>0){var e=selObjects[0];if(e.isMeasure){var t=AdHocCrosstab.getRefinedMeasuresFromState();return t[e.index]}}return null},AdHocCrosstab.getRefinedMeasuresFromState=function(){return _.filter(localContext.state.measures,function(e){return!e.isSpacer})},AdHocCrosstab.getSelectedGroup=function(e){return e?"row"===e.axis?localContext.state.rowGroups[e.groupIndex]:localContext.state.columnGroups[e.groupIndex]:null},AdHocCrosstab.getMeasureTypeByFunction=function(e){var t=AdHocCrosstab.getSelectedMeasure();if(t){var i=adhocDesigner.getSuperType(t.type);return"Average"===e?"dec":"Count"===e||"DistinctCount"===e?"int":i}return null},AdHocCrosstab.updateContextMenuWithSiblingLevels=function(e,t){if(!adhocDesigner.ui.display_manager)return t;var i=t.find(function(e){return"AdHocCrosstab.canAddSiblingLevels"===e.clientTest});if(!i)return t;var n=null,o=null,s=null,r=selObjects[0],a=/.*\[(.*)\]/.exec(r.level),l=a&&a[1];if(r.isMeasure)o=adhocDesigner.measuresTree.getRootNode(),s="row"===r.axis?"AdHocCrosstab.appendMeasureToRow":"AdHocCrosstab.appendMeasureToColumn";else{if(!localContext.isOlapMode())return r.index=0,t;o=adhocDesigner.dimensionsTree.getRootNode().childs.find(function(e){return e.param.extra.id===r.dimensionId}),o.childs[0].param.extra.isHierarchy&&(o=_.find(o.childs,function(e){return e.param.extra.id===l})),s="row"===r.axis?"AdHocCrosstab.appendDimensionToRowAxisWithLevel":"AdHocCrosstab.appendDimensionToColumnAxisWithLevel"}if(void 0===r.allLevels){var c=r;c.allLevels=AdHocCrosstab.state.getLevelsFromDimension(r.dimensionId,c.axis),c.index=c.allLevels.indexOf(c.level)}return r.allLevels&&(n=localContext.isOlapMode()?o.childs.findAll(function(e){return!r.allLevels.include(e.param.extra.id)}):adhocDesigner.getAllLeaves(o,adhocDesigner.measuresTree).findAll(function(e){return!r.allLevels.include(e.param.extra.id)})),n&&0!=n.length?(i.text=adhocDesigner.getMessage(r.isMeasure?"addMeasures":"addLevels"),i.children=n.collect(function(e){return actionModel.createMenuElement("optionAction",{text:e.name,action:s,actionArgs:r.isMeasure?[e.param.extra.id]:[{id:e.param.extra.id,groupId:e.param.extra.dimensionId,isMeasure:!1}]})}),t):t},AdHocCrosstab.generateAvailableSummaryCalculationsMenu=function(e,t){var i=_.find(t,function(e){return"AdHocCrosstab.selectedMeasureShowsSummaryOptions"===e.clientTest});if(i){var n=actionModel.selObjects[0],o=_.findWhere(localContext.state.measures,{name:n.name});o&&adhocDesigner.generateAvailableSummaryCalculationsMenu(o.fieldName,i,{action:AdHocCrosstab.selectFunction,isSelectedTest:AdHocCrosstab.isSelectedSummaryFunction})}return t},define("adhoc/crosstab.helpers",["adhoc/crosstab"],function(e){return function(){var t;return t||e.AdHocCrosstab}}(this)),AdHocCrosstab.mouseDownHandler=function(){},AdHocCrosstab.mouseUpHandler=function(e){var t,i,n,o=e.element(),s=(new RegExp("\\d+$"),null);if(Draggables.dragging!=designerBase.AVAILABLE_FIELDS_AREA){if(matchAny(o,[localContext.GROUP_LEVEL_DISCLOSURE_PATTERN],!1)){var r=o.up();if(r){var a=r.readAttribute("data-dimension"),l=r.readAttribute("data-level"),c=o.hasClassName("closed");n=r.identify().startsWith("rowGroup"),c?AdHocCrosstab.expandLevel(a,l,n):AdHocCrosstab.collapseLevel(a,l,n)}return}if(matchAny(o,[localContext.GROUP_MEMBER_DISCLOSURE_PATTERN],!1)){if(r=o.up(),$(r)){t=r.identify(),n=t.startsWith("rowGroup_");var d=new RegExp(/\B\d+\B/);i=d.exec(t)[0];var u=$(r).readAttribute("data-path");n?localContext.toggleExpandCollapseForRow(u,i):localContext.toggleExpandCollapseForColumn(u,i)}return}if(s=matchAny(o,[localContext.COLUMN_GROUP_MEMBER_PATTERN,localContext.ROW_GROUP_MEMBER_PATTERN],!0),s&&!isRightClick(e)&&(AdHocCrosstab.deselectAllSelectedOverlays(),crossTabMultiSelect.selectXtabGroupMember(s,e)),s=matchAny(o,[localContext.ROW_GROUP_OVERFLOW_PATTERN,localContext.COLGROUP_GROUP_OVERFLOW_PATTERN],!0))if($(s).hasClassName("colOverflow")){var h=$(s).readAttribute("data-canShowMore");"true"===h&&AdHocCrosstab.retrieveOverflowColumnGroups()}else AdHocCrosstab.retrieveOverflowRowGroups()}},AdHocCrosstab.mouseOverHandler=function(){},AdHocCrosstab.mouseOutHandler=function(){},AdHocCrosstab.mouseClickHandler=function(e){var t=null,i=e.element(),n=new RegExp("\\d+","g");if(i.match(AdHocCrosstab.DRILL_THROUGH_PATTERN)&&(crossTabMultiSelect.deselectAllGroupMembers(),i=i.parentNode,$(i)&&(t=i.identify(),localContext.state.inDesignView))){if(t.startsWith("measureBucketDrill_")){var o=n.exec(t)[0],s=n.exec(t)[0];return void(AdHocCrosstab.isOlapMode()?AdHocCrosstab.drillOLAP(o,s):AdHocCrosstab.drill(o,s))}t.startsWith("measureBucketNoDrillParentChild_")&&dialogs.systemConfirm.show(adhocDesigner.getMessage("ADH_1213_DRILLTHROUGH_NOT_SUPPORTED_PARENT_CHILD",15e3))}},AdHocCrosstab.contextMenuHandler=function(e){var t,i,n,o=e.element(),s=o.identify();if(matchAny(o,[AdHocCrosstab.COLUMN_GROUP_MEMBER_PATTERN,AdHocCrosstab.ROW_GROUP_MEMBER_PATTERN],!0))o&&(designerBase.isObjectInSelection({id:s},"id")||crossTabMultiSelect.selectXtabGroupMember(o,e),adhocDesigner.showDynamicMenu(e,designerBase.MEMBER_GROUP_MENU_LEVEL));else if(matchAny(o,[AdHocCrosstab.GROUP_LEVEL_PATTERN],!1)){for(;$(o).hasClassName("dummy");)o=o.nextSiblings()[0];s=o.identify(),n=s.startsWith("rowGroup"),t=parseInt(AdHocCrosstab.ENDS_WITH_A_NUMBER_REGEX.exec(s)[0]);var r=localContext.state,a=n?"row":"column",l=o.readAttribute("data-dimension"),c=_.indexOf(r.getDimensions(a),r.getDimension(l,a));$(o)&&(i={id:(n?"rowGroup_":"colGroup_")+t,name:o.readAttribute("data-level"),level:o.readAttribute("data-level"),dimensionId:l,expandable:"true"===o.readAttribute("data-expanable"),axis:a,isMeasure:l===adhocDesigner.MEASURES,groupIndex:AdHocCrosstab.isOlapMode()?c:t,index:t,sorting:o.readAttribute("data-sorting")},i.dimensionId!==AdHocCrosstab.NULL_DIMENSION&&(crossTabMultiSelect.selectXtabGroupLabel(i),i.isMeasure?AdHocCrosstab.showCrosstabMenu(e,localContext[n?"MEASURES_DIMENSION_ROW_MENU_CONTEXT":"MEASURES_DIMENSION_COLUMN_MENU_CONTEXT"]):AdHocCrosstab.showCrosstabMenu(e,designerBase[n?"ROW_GROUP_MENU_LEVEL":"COLUMN_GROUP_MENU_LEVEL"])))}else if(matchAny(o,[AdHocCrosstab.MEASURE_PATTERN],!1)){for(;$(o).hasClassName("dummy");)o=o.nextSiblings()[0];t=parseInt(AdHocCrosstab.ENDS_WITH_A_NUMBER_REGEX.exec(s)[0]),n=s.startsWith("rowGroup");var d=AdHocCrosstab.getRefinedMeasuresFromState(),u=d.length,h=t%u,p=d[h].fieldName;$(o)&&(i={id:(n?"rowGroup_":"colGroup_")+t,name:p,level:p,dimensionId:adhocDesigner.MEASURES,expandable:"true"===o.readAttribute("data-expanable"),axis:n?"row":"column",isMeasure:!0,index:h,path:o.readAttribute("data-path"),isInner:o.hasClassName("inner"),sorting:o.readAttribute("data-sorting")},crossTabMultiSelect.selectXtabGroupLabel(i),AdHocCrosstab.showCrosstabMenu(e,localContext[n?"MEASURE_ROW_MENU_CONTEXT":"MEASURE_COLUMN_MENU_CONTEXT"]))}},AdHocCrosstab.lmHandlersMap={addItems:function(e,t,i){var n=_.map(e,function(e){return e.extra.dimensionId});AdHocCrosstab.insertDimensionInAxisWithChild({dim:e[0].extra.isMeasure?n.slice(0,1):n,axis:i,pos:t,child:_.pluck(e,"id"),hierarchyName:e[0].extra.hierarchyName})},measureReorder:function(e,t){AdHocCrosstab.moveMeasure(e,t)},column:{addItem:function(e,t,i,n,o,s,r){AdHocCrosstab.insertDimensionInAxisWithChild({dim:e,axis:"column",pos:t,child:i,measure_pos:n,isMeasure:o,uri:s,hierarchyName:r})},removeItem:function(e,t){e.isMeasure?AdHocCrosstab.removeMeasure(t):AdHocCrosstab.hideColumnLevel(e.dimensionId,e.level)},moveItem:function(e,t,i){AdHocCrosstab.moveDimension(e,"column",i)},switchItem:function(e,t,i){AdHocCrosstab.moveDimension(e,"column",i)},contextMenu:function(e,t){AdHocCrosstab.selectFromDisplayManager(t.targetEvent,t.extra,designerBase.COLUMN_GROUP_MENU_LEVEL),AdHocCrosstab.showCrosstabMenu(t.targetEvent,localContext.DISPLAY_MANAGER_COLUMN_CONTEXT)
}},row:{addItem:function(e,t,i,n,o,s,r){AdHocCrosstab.insertDimensionInAxisWithChild({dim:e,axis:"row",pos:t,child:i,measure_pos:n,isMeasure:o,uri:s,hierarchyName:r})},removeItem:function(e,t){e.isMeasure?AdHocCrosstab.removeMeasure(t):AdHocCrosstab.hideRowLevel(e.dimensionId,e.level)},moveItem:function(e,t,i){AdHocCrosstab.moveDimension(e,"row",i)},switchItem:function(e,t,i){AdHocCrosstab.moveDimension(e,"row",i)},contextMenu:function(e,t){AdHocCrosstab.selectFromDisplayManager(t.targetEvent,t.extra,designerBase.ROW_GROUP_MENU_LEVEL),AdHocCrosstab.showCrosstabMenu(t.targetEvent,localContext.DISPLAY_MANAGER_ROW_CONTEXT)}}},AdHocCrosstab.treeMenuHandler=function(e){var t,i=e.memo.node;"dimensionsTree"===i.treeId?t=i.isParent()?adhocDesigner.DIMENSION_TREE_DIMENSION_CONTEXT:adhocDesigner.DIMENSION_TREE_LEVEL_CONTEXT:"measuresTree"===i.treeId&&(t=i.isParent()?adhocDesigner.MEASURE_TREE_GROUP_CONTEXT:adhocDesigner.MEASURE_TREE_CONTEXT),adhocDesigner.showDynamicMenu(e.memo.targetEvent,t,null)},AdHocCrosstab.selectFromDisplayManager=function(e,t,i){designerBase.unSelectAll();var n=adhocDesigner.isMultiSelect(e,i);selectionCategory.area=i;var o=adhocDesigner.isAlreadySelected(t);actionModel.setSelected([t]),adhocDesigner.addSelectedObject(e,t,n,o),Event.stop(e)},define("adhoc/crosstab.observers",["adhoc/crosstab"],function(e){return function(){var t;return t||e.AdHocCrosstab}}(this)),AdHocCrosstab.canMoveToDimensions=function(){var e=selObjects.find(function(e){return localContext.isInUse(e.param.extra.id,e.param.extra.isMeasure)});return!e},AdHocCrosstab.canMoveToMeasures=function(){return AdHocCrosstab.canMoveToDimensions()},AdHocCrosstab.canSaveReport=function(){return localContext.isNonOlapMode()?localContext.state.hasMeasures:localContext.state.hasMeasures&&localContext.state.columnGroups.first()&&localContext.state.columnGroups.first().dimensionName!==localContext.NULL_DIMENSION},AdHocCrosstab.isGroupSelected=function(e){return!e.isMeasure},AdHocCrosstab.isRowGroupSelected=function(e){return"row"===e.axis&&!e.isMeasure},AdHocCrosstab.isColumnGroupSelected=function(e){return"column"===e.axis&&!e.isMeasure},AdHocCrosstab.isCurrentDateType=function(e){var t=AdHocCrosstab.getSelectedGroup(adhocDesigner.getSelectedColumnOrGroup());return t?t.categorizerName==e:!1},AdHocCrosstab.isSelectedMeasureNumeric=function(){var e=AdHocCrosstab.getSelectedMeasure();if(e){var t=adhocDesigner.getSuperType(e.type);return"int"==t||"dec"==t}return!1},AdHocCrosstab.isDateType=function(){return AdHocCrosstab.isDateTimeType("date")},AdHocCrosstab.isTimestampType=function(){return AdHocCrosstab.isDateTimeType("timestamp")},AdHocCrosstab.isTimeType=function(){return AdHocCrosstab.isDateTimeType("time")},AdHocCrosstab.isDateTimeType=function(e){var t=adhocDesigner.getSelectedColumnOrGroup();if(t){var i=AdHocCrosstab.isGroupSelected(t),n=AdHocCrosstab.getSelectedGroup(t);if(n){var o=n.canReBucket===!0,s=n.type===e;return i&&o&&s}}return!1},AdHocCrosstab.isSelectedMeasureItemType=function(e){var t=AdHocCrosstab.getSelectedMeasure();if(t){var i=adhocDesigner.getSuperType(t.type);return i===e}return!1},AdHocCrosstab.isSelectedMeasureMask=function(e){var t=AdHocCrosstab.getSelectedMeasure();return t?t.functionMaskOrDefault===e||!t.functionMaskOrDefault&&e===defaultMasks[adhocDesigner.INTEGER_TYPE_DISPLAY]:!1},AdHocCrosstab.isSelectedSummaryFunction=function(e){var t=AdHocCrosstab.getSelectedMeasure();return t?t.functionOrDefault===e:!1},AdHocCrosstab.canSwitchToRow=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return localContext.isNonOlapMode()||AdHocCrosstab.state.getDimensionsCount(e.axis)>1},AdHocCrosstab.canAddSliceFilter=function(){var e=selObjects.find(function(e){return!e.isSliceable});return selObjects.first()&&!e},AdHocCrosstab.canMoveUpOrLeft=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=AdHocCrosstab.getSelectedDimensionIndex(e);return t>0},AdHocCrosstab.canMoveDownOrRight=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=AdHocCrosstab.getSelectedDimensionIndex(e);return t<AdHocCrosstab.state.getDimensionsCount(e.axis)-1},AdHocCrosstab.canMoveMeasureUpOrLeft=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e.index>0},AdHocCrosstab.canMoveMeasureDownOrRight=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=e.isMeasure?adhocDesigner.MEASURES:e.dimensionId,i=AdHocCrosstab.state.getLevelsFromDimension(t,e.axis).length;return e.index<i-1},AdHocCrosstab.canAddDimensionAsRowGroup=function(){var e=localContext.getSelectedObject();if(e.hasChilds()||(e=e.parent),localContext.isOlapMode()){var t=e.param.id,i=localContext.state.getDimensionsCount("column"),n=e.param.extra.isHierarchy,o=AdHocCrosstab.state.getLevelsFromDimension(t,"column"),s=n&&1===i&&!_.isEmpty(o);if(0===i||s)return!1;var r=n&&e.param.extra.id,a=AdHocCrosstab.state.getLevelsFromDimension(t,"row"),l=_.isEmpty(o),c=!_.isEmpty(a)&&a[0].indexOf("["+r+"]")>-1;return(n||l)&&(n&&!c||a.length<e.getChildCount())}var d=dynamicTree.trees[e.getTreeId()],u=adhocDesigner.getAllLeaves(e,d),h=adhocDesigner.getAllLeaves(e,d).collect(function(e){return e.param.extra.id});if(u[0].param.extra.isMeasure){var p=localContext.state.getFilteredMeasureList("column");return 0===p.length}var m=_.pluck(localContext.state.getFilteredList(),"name");return _.difference(h,m).length>0},AdHocCrosstab.canAddDimensionAsColumnGroup=function(){var e=localContext.getSelectedObject();if(e.hasChilds()||(e=e.parent),localContext.isOlapMode()){var t=e.param.id,i=e.param.extra.isHierarchy,n=i&&e.param.extra.id,o=AdHocCrosstab.state.getLevelsFromDimension(t,"column"),s=AdHocCrosstab.state.getLevelsFromDimension(t,"row"),r=0===s.length,a=o.length>0&&o[0].indexOf("["+n+"]")>-1;return(i||r)&&(i&&!a||o.length<e.getChildCount())}var l=dynamicTree.trees[e.getTreeId()],c=adhocDesigner.getAllLeaves(e,l),d=adhocDesigner.getAllLeaves(e,l).collect(function(e){return e.param.extra.id});if(c[0].param.extra.isMeasure){var u=localContext.state.getFilteredMeasureList("row");return 0===u.length}var h=_.pluck(localContext.state.getFilteredList(),"name");return _.difference(d,h).length>0},AdHocCrosstab.canAddLevelAsRowGroup=function(){if(0===localContext.state.getDimensionsCount("column")&&localContext.isOlapMode())return!1;var e=localContext.getSelectedObject(),t=e.param.extra,i=localContext.isOlapMode()?[t.dimensionId]:adhocDesigner.getAllLeaves(e).map(function(e){return e.param.extra.dimensionId}),n=i.inject([],function(e,t){return e.concat(AdHocCrosstab.state.getLevelsFromDimension(t,"column")||[])}),o=i.inject([],function(e,t){return e.concat(AdHocCrosstab.state.getLevelsFromDimension(t,"row")||[])});return 0===n.length&&(0===o.length||localContext.isNonOlapMode()&&t.isMeasure||!_.contains(o,t.name))},AdHocCrosstab.canAddLevelAsColumnGroup=function(){var e=localContext.getSelectedObject(),t=e.param.extra,i=localContext.isOlapMode()?[t.dimensionId]:adhocDesigner.getAllLeaves(e).map(function(e){return e.param.extra.dimensionId}),n=i.inject([],function(e,t){return e.concat(AdHocCrosstab.state.getLevelsFromDimension(t,"column")||[])}),o=i.inject([],function(e,t){return e.concat(AdHocCrosstab.state.getLevelsFromDimension(t,"row")||[])});return 0===o.length&&(0===n.length||localContext.isNonOlapMode()&&t.isMeasure||!n.find(function(e){return _.contains(_.map(designerBase.getSelectedObjects(),function(e){return e.param.extra.id}),e)}))},AdHocCrosstab.showAddHierarchyConfirm=function(e,t,i){return localContext.fromSiblingHierarchy(e,t)?(adhocDesigner.addConfirmDialog.show({ok:function(){return AdHocCrosstab.isFiltersApplied(t)?void dialogs.systemConfirm.show(adhocDesigner.getMessage("ADH_CROSSTAB_LAST_FILTERED_LEVEL"),5e3):void i()}}),!0):!1},AdHocCrosstab.isFiltersApplied=function(e,t){var i=_.pluck(localContext.state.getLevelObjectsFromDimension(e,t),"levelUniqueName"),n=_.pluck(localContext.state.existingFilters,"name");return!_.isEmpty(_.intersection(i,n))},AdHocCrosstab.canAddSiblingLevels=function(){return!0},AdHocCrosstab.canHideLevel=function(){return!0},AdHocCrosstab.canShowLevel=function(){return!0},AdHocCrosstab.canHideSummariesForColumnGroup=function(){return AdHocCrosstab.canHideSummariesForGroup(!1)},AdHocCrosstab.canHideSummariesForRowGroup=function(){return AdHocCrosstab.canHideSummariesForGroup(!0)},AdHocCrosstab.canHideSummariesForGroup=function(){return!0},AdHocCrosstab.canAddFilter=function(e,t){var i=localContext.isOlapMode()&&(isNotNullORUndefined(e.isMeasure)?e.isMeasure:e.param.extra&&e.param.extra.isMeasure),n=isNotNullORUndefined(e.param)?e.param.extra&&e.param.extra.id==localContext.ALL_LEVEL_NAME:e.level==localContext.ALL_LEVEL_NAME,o=localContext.isOlapMode()&&localContext._isAddingFilterDuplicate(e);return i?(t&&t.push(addFilterErrorMessageMeasureAdd),!1):n?(t&&t.push(addFilterErrorMessageAllLevelAdd),!1):e.isParent&&e.isParent()?(t&&t.push(addFilterErrorMessageGroupAdd),!1):adhocDesigner.isSpacerSelected(e)?(t&&t.push(addFilterErrorMessageSpacerAdd),!1):adhocDesigner.isPercentOfParentCalcSelected(e)?(t&&t.push(addFilterErrorMessagePercentOfParentCalcFieldAdd),!1):adhocDesigner.isConstantSelected(e)?(t&&t.push(addFilterErrorMessageConstantAdd),!1):o?(t&&t.push(addFilterErrorMessage),!1):!0},AdHocCrosstab._isAddingFilterDuplicate=function(e){var t;return t=e.param?"["+e.param.extra.dimensionId+"].["+e.param.extra.id+"]":"["+e.dimensionId+"].["+e.level+"]",adhocDesigner.filtersController.hasFilterForField(t)},AdHocCrosstab.getSelectedObject=function(){return selObjects.first()},AdHocCrosstab.getHierarchy=function(e){var t=e.param.extra;return e.hasChilds()?(e.getFirstChild().hasChilds()&&(t=e.getFirstChild().param.extra),t&&t.isHierarchy?t.id:void 0):t.hierarchyName},AdHocCrosstab._getAvailableFieldsNodeBySelection=function(e,t,i){var n={};if(selectionCategory.area==designerBase.AVAILABLE_FIELDS_AREA)i.hasChilds()?(n.isMeasure="measuresTree"===i.treeId,n.dimensionId=n.isMeasure?i.treeId:i.param.id,n.uri=localContext.isNonOlapMode()?i.param.uri:void 0,n.level=null):(n.isMeasure=!!i.param.extra.isMeasure,n.level=i.param.extra.dimensionId&&i.param.id,n.dimensionId=i.param.extra.dimensionId||i.param.extra.id),n.hierarchyName=AdHocCrosstab.getHierarchy(i),n.index=-1;else if(selectionCategory.area==designerBase.ROW_GROUP_MENU_LEVEL||selectionCategory.area==designerBase.COLUMN_GROUP_MENU_LEVEL)if(e||t){var o=/.*\[(.*)\]/.exec(e),s=o&&o[1];n.isMeasure=!t,n.level=e,n.dimensionId=n.isMeasure?adhocDesigner.MEASURES:t,n.index=-1,n.hierarchyName=s}else{if(!i.axis)return void alert("Need a way to get dimension name for clicked level from crosstab");n=i}return n},AdHocCrosstab.getAvailableFieldsNodeBySelection=function(e,t){return AdHocCrosstab._getAvailableFieldsNodeBySelection(e,t,selObjects.first())},AdHocCrosstab.getAvailableFieldsNodesBySelection=function(e,t){for(var i=[],n=0;n<selObjects.length;n++)i.push(AdHocCrosstab._getAvailableFieldsNodeBySelection(e,t,selObjects[n])),i[n].extra=i[n],i[n].dimensionId=i[n].dimensionId,i[n].id=i[n].level;return i},AdHocCrosstab.canShowSortOptions=function(){return selObjects.length>1?!1:("column"===selObjects[0].axis||selObjects[0].isMeasure)&&selObjects[0].isInner},AdHocCrosstab.isSortOptionSelected=function(e){return selObjects[0].sorting===e},define("adhoc/crosstab.tests",["adhoc/crosstab","adhoc/crosstab.actions","adhoc/crosstab.ajax","adhoc/crosstab.helpers","adhoc/crosstab.observers"],function(e){return function(){var t;return t||e.AdHocCrosstab}}(this));var AdHocChart={CHART_ID:"chart",CHART_IMAGE_ID:"chart-image",BAR_CHART:"1_bar",PIE_CHART:"2_pie",LINE_CHART:"3_line",AREA_CHART:"4_area",SCATTER_CHART:"5_scatter",TIME_SERIES_CHART:"6_timeSeries",CHART_CANVAS_PATTERN:"table#canvasTable tbody td#chart",DRAGGABLE_PAPER_SIZE:"content",CONTENT_PAGE_SIZE:"content",CHART_DRAGGER_PATTERN:"div#dragger.sizer",MAX_DRAGGABLE_LEGEND_DELTA:25,MIN_CHART_WIDTH:50,MIN_CHART_HEIGHT:50,ZOOM_FACTOR:15,getMode:function(){return designerBase.CHART},reset:function(){},render:function(){return adhocDesigner.ui.canvas.html(this.chartTemplate(this.state)),adhocDesigner.setNothingToDisplayVisibility(!1),!0},initAll:function(){this.currentlyDragging=!1,this.currentlyDraggingLegend=!1,this.dragginInLegendArea=!1,this.containerMovePosition={x:0,y:0},this.draggableLegend=null,this.currentLegendIndex=null,this.documentEventSet=null,this.hoverLegendIndex=null,this.groupTarget=null,this.legendOverlays=[],this.draggableChart=null,adhocDesigner.overlayParent=$("chartBorder"),adhocDesigner.enableXtabPivot(!1),$("chartBorder")&&(designerBase.clearOverlaySet(AdHocChart.legendOverlays),localContext.state.displayLegend&&localContext.state.legendItems&&localContext.state.legendItems.each(function(e,t){var i=designerBase.createDomObject("DIV","overlay legend button");i.setStyle({left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px"});var n=localContext.state.measureNames[t];i.writeAttribute("id","legendOverlay_"+t),i.writeAttribute("data-legendName",n),i.writeAttribute("data-defaultName",e.defaultName),i.writeAttribute("data-userName",e.userName),i.writeAttribute("data-index",t),AdHocChart.legendOverlays.push(i),adhocDesigner.overlayParent.appendChild(i)}.bind(this))),document.getElementById("dragger").style.height="50px",document.getElementById("dragger").style.width="50px"}};define("adhoc/chart.init",["designer.base"],function(e){return function(){var t;return t||e.AdHocChart}}(this)),AdHocChart.canSaveReport=function(){return localContext.state.canSave},AdHocChart.canSetMask=function(){return"NaN"!=localContext.state.dataTypes[AdHocChart.getCurrentMeasure()]},AdHocChart.draggerListener=function(e){e.preventDefault(),localContext.currentlyDragging=!0;var t={x:e.pointerX()-localContext.containerMovePosition.x,y:e.pointerY()-localContext.containerMovePosition.y};localContext.containerMovePosition={x:e.pointerX(),y:e.pointerY()};var i=parseInt($("chartBorder").getStyle("width")),n=parseInt($("chartBorder").getStyle("height")),o=Math.abs(i+t.x),s=Math.abs(n+t.y);$("chartBorder").setStyle({width:o+"px",height:s+"px"})},AdHocChart.canMoveMeasureUp=function(){var e=!1;return selObjects[0]&&selObjects[0].index<localContext.state.measureNames.length-1&&(e=!0),e},AdHocChart.canMoveMeasureDown=function(){var e=!1;return selObjects[0]&&selObjects[0].index&&selObjects[0].index>0&&(e=!0),e},AdHocChart.supportsSeries=function(){return localContext.state.type!=AdHocChart.PIE_CHART},AdHocChart.isPie=function(){return localContext.state.type==AdHocChart.PIE_CHART},AdHocChart.isBar=function(){return localContext.state.type==AdHocChart.BAR_CHART},AdHocChart.isArea=function(){return localContext.state.type==AdHocChart.AREA_CHART},AdHocChart.isLine=function(){return localContext.state.type==AdHocChart.LINE_CHART},AdHocChart.isType=function(e){return localContext.state.type==e},AdHocChart.isMeasureNumeric=function(e){var t=0===arguments.length?AdHocChart.getCurrentMeasure():e;return localContext.state.isNumeric[t]},AdHocChart.isSelectedMeasureNumeric=function(){return isMeasureNumeric()},AdHocChart.isDataType=function(e,t){var i=arguments.length<2?AdHocChart.getCurrentMeasure():t;return localContext.state.dataTypes[i]==e},AdHocChart.isMask=function(e,t){var i=arguments.length<2?AdHocChart.getCurrentMeasure():t;return localContext.state.masks[i]==e},AdHocChart.isFunctionSelected=function(e,t){return t=t?t:AdHocChart.getCurrentMeasure(),localContext.state.summaryFunctions[t]==e},AdHocChart.isContentPageSize=function(){return localContext.state.paperSize==AdHocChart.CONTENT_PAGE_SIZE},AdHocChart.isInLegendArea=function(e,t){var i=20,n=$("chartBorder").cumulativeOffset(),o=$("chartBorder").cumulativeScrollOffset(),s={left:n[0]+o[0],top:n[1]+o[1]},r={left:s.left+localContext.state.legendLeft,top:s.top+localContext.state.legendTop};return e<r.left+localContext.state.legendWidth+i&&e>=r.left-i&&t<r.top+localContext.state.legendHeight+i&&t>=r.top-i},AdHocChart.getChartWidth=function(){return $("chartBorder").getWidth()},AdHocChart.getChartHeight=function(){return $("chartBorder").getHeight()},AdHocChart.getHasMargins=function(){return localContext.state.hasMargins},AdHocChart.getTitleHeight=function(){var e=0,t=$("titleCaption");return t?t.getHeight():e},AdHocChart.getTitleBottom=function(){var e=getTitleHeight();if(0==e)return e;var t=$("titleCaption").positionedOffset();return e+t[1]},AdHocChart.canAddAsMeasure=function(){var e=selObjects.length>1;return!localContext.state.hasMeasures&&!e||localContext.state.seriesEnabled&&AdHocChart.supportsSeries()},AdHocChart.selectedMeasureShowsSummaryOptions=function(){return!!localContext.state.measureNames[AdHocChart.getCurrentMeasure()]},AdHocChart.canReplaceMeasure=function(){if(1==selObjects.length){var e,t=designerBase.getSelectedObject();return t?(e=t.isParent(),!(!localContext.state.hasMeasures||localContext.state.seriesEnabled&&AdHocChart.supportsSeries()||e)):!1}return!1},AdHocChart.canAddAsGroup=function(e){if(selObjects[0]&&"measuresTree"==selObjects[0].parent.treeId)return!1;if(1==selObjects.length){var t,i=designerBase.getSelectedObject();return i?(t=i.isParent(),!(!e&&localContext.state.hasGroup||t||adhocDesigner.isPercentOfParentCalcSelected(i))):!1}return!1},AdHocChart.canReplaceGroup=function(){if(selObjects[0]&&"measuresTree"==selObjects[0].parent.treeId)return!1;if(1==selObjects.length){var e,t=designerBase.getSelectedObject();return t?(e=t.isParent(),localContext.state.hasGroup&&!e&&!adhocDesigner.isPercentOfParentCalcSelected(t)):!1}return!1},define("adhoc/chart.helpers",["adhoc/chart.init"],function(e){return function(){var t;return t||e.AdHocChart}}(this)),_.extend(AdHocChart,{addAsMeasure:function(e,t){designerBase.sendRequest("ch_insertMeasure",{fs:e,i:t})},addAsLastMeasure:function(e){designerBase.sendRequest("ch_insertMeasureLast",{fs:e})},replaceMeasure:function(e){designerBase.sendRequest("ch_replaceMeasures",{f:e})},moveMeasure:function(e,t){designerBase.sendRequest("ch_moveMeasure",["f="+e,"t="+t])},moveMeasureUp:function(){var e=parseInt(selObjects[0].index);designerBase.sendRequest("ch_moveMeasure",["f="+e,"t="+(e+1)])},moveMeasureDown:function(){var e=parseInt(selObjects[0].index);designerBase.sendRequest("ch_moveMeasure",["f="+e,"t="+(e-1)])},switchToMeasure:function(e,t,i){designerBase.sendRequest("ch_switchToMeasure",{fs:e,to:i})},setGroup:function(e){designerBase.sendRequest("ch_setGroup",["g="+encodeText(e)])},removeMeasure:function(e){e||0==e||(e=AdHocChart.getCurrentMeasure()),designerBase.sendRequest("ch_removeMeasure",["i="+e])},removeGroup:function(){designerBase.sendRequest("ch_removeGroup",[])},switchToGroup:function(e,t){designerBase.sendRequest("ch_switchToGroup",["fs="+encodeText(e),"from="+t])},changeChartType:function(e){designerBase.sendRequest("ch_changeType",["t="+e])},toggle3D:function(){designerBase.sendRequest("ch_toggle3D",[])},toggleStack:function(){designerBase.sendRequest("ch_toggleStack",[])},toggleOrientation:function(){designerBase.sendRequest("ch_toggleChartOrientation",[])},togglePoints:function(){designerBase.sendRequest("ch_togglePoints",[])},toggleLines:function(){designerBase.sendRequest("ch_toggleLines",[])},toggleGradient:function(){designerBase.sendRequest("ch_toggleGradient",[])},toggleBackground:function(){designerBase.sendRequest("ch_toggleBackground",[])},toggleLegend:function(){designerBase.sendRequest("ch_toggleLegend",[])},toggleXAxisLabel:function(){designerBase.sendRequest("ch_toggleXAxisLabel",[])},toggleYAxisLabel:function(){designerBase.sendRequest("ch_toggleYAxisLabel",[])},updateLegendLabel:function(e,t){e.blank()&&(e=" "),designerBase.sendRequest("ch_setLegendLabel",["l="+encodeText(e),"i="+t])},setSummaryFunction:function(e,t){designerBase.sendRequest("ch_setSummaryFunction",["f="+e,"i="+t])},setSummaryFunctionAndMask:function(e,t,i){designerBase.sendRequest("ch_setSummaryFunctionAndMeasureMask",["f="+e,"m="+encodeText(t),"i="+i])},setMask:function(e,t){designerBase.sendRequest("ch_setMeasureMask",["m="+encodeText(e),"i="+t])},moveChart:function(e,t){designerBase.sendRequest("ch_moveChart",["x="+e,"y="+t])},resizeChart:function(e,t){var i=AdHocChart.computeDimensions(e,t);i&&designerBase.sendRequest("ch_resizeChart",["w="+i[0],"h="+i[1]])}}),AdHocChart.updateViewCallback=function(e){adhocDesigner.render(e)},AdHocChart.standardOpCallback=function(e){localContext.standardChartOpCallback(e)},AdHocChart.standardChartOpCallback=function(e){adhocDesigner.render(e)},define("adhoc/chart.ajax",["underscore","adhoc/chart.init"],function(e){return function(){var t;return t||e.AdHocChart}}(this)),AdHocChart.showChartMenu=function(e,t){isIPad()?adhocDesigner.showDynamicMenu(e,t,{menuLeft:e.changedTouches[0].clientX,menuTop:e.changedTouches[0].clientY-100}):adhocDesigner.showDynamicMenu(e,t,{menuLeft:e.clientX,menuTop:e.clientY-100})},AdHocChart.getCurrentMeasure=function(){if(1==localContext.state.numberOfMeasures||AdHocChart.isPie())return 0;var e=designerBase.getSelectedObject(),t=e.index;return isNaN(t)?-1:parseInt(t)},AdHocChart.addFieldAsMeasure=function(e,t){var i="";if(_.isNumber(t)||(t=AdHocChart.hoverLegendIndex),selObjects.length>0){var n=adhocDesigner.getSelectedTreeNodes();i=adhocDesigner.collectFields(n,e),AdHocChart.supportsSeries()?_.isNumber(t)&&t>-1?AdHocChart.addAsMeasure(i,t):AdHocChart.addAsLastMeasure(i):AdHocChart.replaceMeasure(i)}},AdHocChart.addFieldAsGroup=function(){var e=designerBase.getSelectedObject();if(e){var t=adhocDesigner.getNameForSelected(e);AdHocChart.setGroup(t)}},AdHocChart.functionSelected=function(e,t){t||(t=AdHocChart.getCurrentMeasure());var i=AdHocChart.getUpdatedMeasureType(e);i?AdHocChart.setSummaryFunctionAndMask(e,defaultMasks[i],t):AdHocChart.setSummaryFunction(e,t)},AdHocChart.getUpdatedMeasureType=function(e){var t=localContext.getMeasureType(e);return t!=localContext.state.dataTypes[AdHocChart.getCurrentMeasure()]?t:null},AdHocChart.getMeasureType=function(e){return"Count"==e||"DistinctCount"==e?"int":localContext.state.dataTypes[AdHocChart.getCurrentMeasure()]},AdHocChart.maskSelected=function(e,t){t||(t=AdHocChart.getCurrentMeasure()),AdHocChart.setMask(e,t)},AdHocChart.deselectAllSelectedOverlays=function(){var e=$$(adhocDesigner.LEGEND_OVERLAY_PATTERN);e.each(function(e){$(e)&&(buttonManager.unSelect($(e)),isIPad()&&($(e).removeClassName(layoutModule.HOVERED_CLASS),$(e).removeClassName(layoutModule.PRESSED_CLASS)))})},AdHocChart.getNewChartPositionAndMove=function(){var e=$("chartBorder"),t=null,i=null,n=null,o=null,s=!1;if(e){if(n=e.positionedOffset(),o=e.cumulativeScrollOffset(),AdHocChart.isContentPageSize())t=n[0]+o[0],i=n[1]+o[1],0>t&&(t=0),i<getTitleBottom()&&(i=getTitleBottom());else{var r=n[0]+getChartWidth(),a=n[1]+getChartHeight();r>localContext.state.availableChartWidth?(t=localContext.state.availableChartWidth-getChartWidth(),t+=o[0],s=!0):t=n[0]+o[0],a>localContext.state.availableChartHeight?(i=localContext.state.availableChartHeight-getChartHeight(),i+=o[1],s=!0):i=n[1]<0?getTitleBottom():n[1]+o[1],0>t&&(t=0),i<getTitleBottom()&&(i=getTitleBottom()),s&&moveTo(e,t,i,null)}moveChart(t,i)}},AdHocChart.computeDimensions=function(e,t){var i=null,n=null,o=$("chartBorder"),s=null;return o&&(i=isNaN(e)?parseInt(o.getStyle("width")):e,n=isNaN(t)?parseInt(o.getStyle("height")):t,AdHocChart.isContentPageSize()||(i>AdHocChart.state.availableChartWidth-AdHocChart.state.chartX&&(i=AdHocChart.state.availableChartWidth-AdHocChart.state.chartX),n>AdHocChart.state.availableChartHeight-AdHocChart.state.chartY&&(n=AdHocChart.state.availableChartHeight-AdHocChart.state.chartY)),i=i<AdHocChart.MIN_CHART_WIDTH?AdHocChart.MIN_CHART_WIDTH:i,n=n<AdHocChart.MIN_CHART_HEIGHT?AdHocChart.MIN_CHART_HEIGHT:n,s=[i,n]),s},define("adhoc/chart.actions",["adhoc/chart.init"],function(e){return function(){var t;return t||e.AdHocChart}}(this)),AdHocChart.mouseDownHandler=function(e){var t=e.element(),i=null;if(isIPad()&&(i=matchAny(t,["div#chartBorder"],!0),i&&$("dragger").removeClassName("hidden"),e.preventDefault()),"dragger"==t.identify()&&(this.containerMovePosition={x:e.pointerX(),y:e.pointerY()},Event.observe(document.body,isSupportsTouch()?"touchmove":"mousemove",this.draggerListener)),i=matchAny(t,[adhocDesigner.LEGEND_OVERLAY_PATTERN],!0),i&&!isRightClick(e)){var n=null;if(i.hasClassName("legend")){var o=i.readAttribute("data-legendName");"data-legendName"!==o&&(n={id:i.identify(),legendName:o,index:i.readAttribute("data-index"),defaultName:i.readAttribute("data-defaultName"),userName:i.readAttribute("data-userName")},selectionCategory.area=designerBase.LEGEND_MENU_LEVEL,localContext.draggableLegend&&localContext.draggableLegend.destroy(),designerBase.unSelectAll(),AdHocChart.deselectAllSelectedOverlays(),designerBase.addToSelected(n),buttonManager.select(i))}isIPad()&&$("dragger").addClassName("hidden")}isIPad()&&e.preventDefault()},AdHocChart.mouseUpHandler=function(e){var t=e.element(),i=null,n=null;if(this.currentlyDragging)Event.stopObserving(document.body,isSupportsTouch()?"touchmove":"mousemove",this.draggerListener),this.resizeChart(),this.currentlyDragging=!1;else{var o=$("dragger");isIPad()&&o&&!matchAny(t,["div#chartBorder"],!0)&&o.addClassName("hidden")}i=matchAny(t,[adhocDesigner.LEGEND_OVERLAY_PATTERN],!0),i?(Draggables.dragging==designerBase.AVAILABLE_FIELDS_AREA?(n=i.readAttribute("data-index"),AdHocChart.hoverLegendIndex=parseInt(n)):(AdHocChart.deselectAllSelectedOverlays(),$(i).addClassName("selected")),isIPad()&&(it.clickid==t.identify()&&e.timeStamp-it.clicktime<700&&document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:e,node:t}),it.clicktime=e.timeStamp,it.clickid=t.identify())):isIPad()&&AdHocChart.deselectAllSelectedOverlays()},AdHocChart.mouseOverHandler=function(e){var t=e.element(),i=null;if(i=matchAny(t,["div#chartBorder"],!0)){var n=$("dragger");n.removeClassName("hidden")}if(i=matchAny(t,[AdHocChart.CHART_DRAGGER_PATTERN,adhocDesigner.LEGEND_OVERLAY_PATTERN],!0),i&&(AdHocChart.draggableChart&&AdHocChart.draggableChart.destroy(),i.match(adhocDesigner.LEGEND_OVERLAY_PATTERN))){var o=$(i).readAttribute("data-index");localContext.currentlyDraggingLegend&&(localContext.currentLegendIndex=o),localContext.state.inDesignView&&(localContext.draggableLegend=new Draggable(i.identify(),{ghosting:!0,onStart:function(e){Draggables.dragging=designerBase.CHART_LEGEND_AREA,localContext.currentlyDraggingLegend=!0,localContext.currentLegendIndex=$(e.element).readAttribute("data-index"),$(e.element).update($(e.element).readAttribute("data-defaultname")),$(e.element).setStyle({color:"#000","white-space":"nowrap"}),AdHocChart.draggableChart&&AdHocChart.draggableChart.destroy()},onEnd:function(e){var t=null;t=$(e.element).readAttribute("data-index"),$(e.element).update(),localContext.currentlyDraggingLegend=!1,localContext.dragginInLegendArea?isNaN(t)||isNaN(localContext.currentLegendIndex)||null==t||null==localContext.currentLegendIndex||AdHocChart.moveMeasure(t,localContext.currentLegendIndex):AdHocChart.removeMeasure(t),localContext.currentLegendIndex=null,localContext.dragginInLegendArea=!1},onDrag:function(e,t){var i=Event.pointer(t);if(AdHocChart.isInLegendArea(i.x,i.y)){localContext.dragginInLegendArea=!0;var n=$$("#chartBorder .overlay");n.each(function(t){if(t!==e.element){var n=Element.cumulativeOffset(t)[0],o=+t.style.width.replace("px","")+n;n<=i.x&&i.x<=o?(localContext.currentLegendIndex=t.readAttribute("data-index"),buttonManager.over(t)):buttonManager.out(t)}}),$(e.element).removeClassName("outside")}else localContext.dragginInLegendArea=!1,$(e.element).addClassName("outside")}}))}},AdHocChart.mouseOutHandler=function(e){var t=e.element(),i=null;if(i=matchAny(t,["div#chartBorder"],!0)){var n=$("dragger");n.addClassName("hidden")}AdHocChart.draggableChart&&AdHocChart.draggableChart.destroy()},AdHocChart.mouseClickHandler=function(){},AdHocChart.contextMenuHandler=function(e){var t=e.element(),i=!0,n=matchAny(t,[AdHocChart.CHART_CANVAS_PATTERN,adhocDesigner.LEGEND_OVERLAY_PATTERN],!0);if(n){var o=null;if(n.hasClassName("legend")){var s=n.readAttribute("data-legendName");"data-legendName"!==s?(o={id:n.identify(),legendName:s,index:n.readAttribute("data-index"),defaultName:n.readAttribute("data-defaultName"),userName:n.readAttribute("data-userName")},selectionCategory.area=designerBase.LEGEND_MENU_LEVEL):i=!1}else selectionCategory.area=designerBase.CHART_LEVEL,o=n;i&&(localContext.draggableLegend&&localContext.draggableLegend.destroy(),designerBase.unSelectAll(),AdHocChart.deselectAllSelectedOverlays(),designerBase.addToSelected(o),buttonManager.select(n),AdHocChart.showChartMenu(e,selectionCategory.area)),Event.stop(e)}},AdHocChart.lmHandlersMap={addItems:function(e,t,i){this[i].addItems(e,t)},group:{addItem:function(e,t,i){AdHocChart.setGroup(i)},addItems:AdHocChart.addFieldAsGroup,removeItem:function(e,t){AdHocChart.removeGroup(t)},switchItem:function(e,t){AdHocChart.switchToGroup(e,t)},contextMenu:function(e,t){var i=t.extra.name,n={legendName:i,index:0};designerBase.unSelectAll(),localContext.deselectAllSelectedOverlays(),designerBase.addToSelected(n),selectionCategory.area=designerBase.LEGEND_MENU_LEVEL,actionModel.setSelected(t.extra),adhocDesigner.showDynamicMenu(t.targetEvent,"displayManagerRow",null,null)}},measures:{addItem:function(e,t){AdHocChart.addFieldAsMeasure(!0,t)},addItems:function(e,t){AdHocChart.addFieldAsMeasure(!0,t)},removeItem:function(e,t){AdHocChart.removeMeasure(t)},moveItem:function(e,t,i){AdHocChart.moveMeasure(t,i)},switchItem:function(e,t,i){AdHocChart.switchToMeasure(e,t,i)},contextMenu:function(e,t){var i=t.extra.index,n=t.extra.name,o=AdHocChart.state.legendItems[i],s={id:"legendOverlay_"+i,legendName:n,index:i,defaultName:o?o.defaultName:"",userName:o?o.userName:"",chartMeasureId:n};designerBase.unSelectAll(),AdHocChart.deselectAllSelectedOverlays(),designerBase.addToSelected(s),selectionCategory.area=designerBase.LEGEND_MENU_LEVEL,actionModel.setSelected(t.extra),adhocDesigner.showDynamicMenu(t.targetEvent,"displayManagerColumn")}}},define("adhoc/chart.observers",["adhoc/chart.init","adhoc/chart.helpers","adhoc/chart.ajax","adhoc/chart.actions"],function(e){return function(){var t;return t||e.AdHocChart}}(this));var AdHocTable={render_mode:"table",state:{},FETCH_MORE_ROWS:"fetchMoreRows",ALMOST_IN_VIEW_OFFSET:100,MINIMUM_COL_WIDTH:0,DEFAULT_GROUP_LABEL_OVERLAY_LEN:200,digitRegex:/\d+/,columnHeaderRow:null,theRows:null,theCols:null,lastRow:null,existingRowCount:null,hoverColumn:-1,reset:function(){this.groupOverlays=[],this.columnResizers={},this.columnOverlays={},this.summaryOverlays={},this.groupLabelOverlays=[],this.draggingColumnSizer=!1,this.draggingColumnOverlay=!1,this.draggingGroupOverlay=!1,this.fetchingRows=!1,this.draggingMoveOverColumnIndex=-1,this.draggingMoveOverGroupIndex=-1},setMode:function(e){this.mode=e},getMode:function(){return this.mode},init:function(){this.Rendering.infinitiveHorizontalScroll=_.bind(_.throttle(this.Rendering.infinitiveHorizontalScroll,250),this.Rendering)},initAll:function(){adhocDesigner.overlayParent=isSupportsTouch()?$("mainTableContainer").down():$("mainTableContainer"),adhocDesigner.enableXtabPivot(!1),AdHocTable.theRows=$("canvasTable").rows,AdHocTable.existingRowCount=AdHocTable.theRows.length,AdHocTable.columnHeaderRow=$("columnHeaderRow"),AdHocTable.state.endOfFile=!1,AdHocTable.shouldFetchMoreRows()&&AdHocTable.fetchMoreRows(),AdHocTable.initRowDependentDimensions(),AdHocTable.initOverlays(),AdHocTable.initKeyEvents(),jQuery("#mainTableContainer > #tableOptions").remove(),jQuery("#tableOptions").appendTo("#mainTableContainer").position({of:jQuery("#mainTableContainer .caption"),at:"left top",my:"left top",offset:"11 10"}).on("mouseover",function(e){var t=jQuery(this);t.addClass("over").css("z-index",1e5),actionModel.showDropDownMenu(e,this,this.id+AdHocTable.ACTION_MODEL_CONTEXT_SUFFIX,AdHocTable.GRID_SELECTOR_MENU_CLASS,localContext.state.actionmodel)}),jQuery("body").on("actionmodel-mouseout",function(){jQuery("#tableOptions").removeClass("over").css("z-index",9)})},Rendering:{me:!1,fullDataSet:!1,data:{containerLeftOffset:0,amountOfDisplayedCols:0,isFirstRender:0,forceShowNCols:!1},init:function(){this.data.isFirstRender=!0,this.data.containerLeftOffset=adhocDesigner.ui.canvas.scrollLeft()+adhocDesigner.ui.canvas.width()-1,this.data.amountOfDisplayedCols>0&&(this.data.forceShowNCols=this.data.amountOfDisplayedCols),this.data.amountOfDisplayedCols=0
},infinitiveHorizontalScroll:function(){var e=0,t=function(){console.log.apply(console,arguments)},i=adhocDesigner.ui.canvas.scrollLeft()+adhocDesigner.ui.canvas.width();if(this.data.containerLeftOffset==i)return void(e&&t("there was no change to horizontal scroll - skipping this round...."));var n=adhocDesigner.ui.canvas.find("table tr:first"),o=n.find("th:last");if(0!=o.length){var s,r=o.position().left,a=r-i,l=0;for(e&&t("gap is: ",a);800>a;){if(this.partialRender(),s=n.find("th:last").position().left-i,s==a){e&&t("gap was not changed...");break}if(l++>10){e&&t("something bad is going on...");break}a=s;break}this.data.containerLeftOffset=i}},addMoreDataToFullState:function(e){var t=0,i=function(){console.log.apply(console,arguments)},n=this;t&&i("data to add to full dataset: ",e);var o,s;for(s=e.table.flattenedData,o=0;o<s.length;o++)this.fullDataSet.table.flattenedData.push(s[o]);_.each(["endOfFile","hitMaxRows","inDesignView","isShowingFullData"],function(t){n.fullDataSet[t]=e[t]}),t&&i("compiled full dataset: ",this.fullDataSet)},getPartialDataFromFullState:function(e,t,i){var n=0,o=function(){console.log.apply(console,arguments)};n&&o("getPartialDataFromFullState: SOURCE: ",e),i=i||0;var s,r,a=t+i,l={columns:[],table:{hasColumns:e.table.hasColumns,hasSummaryRow:e.table.hasSummaryRow,showTableTotals:e.table.showTableTotals,showTableDetails:e.table.showTableDetails,columns:[],columnHeaderRow:{members:[]},summaryRow:{members:[]},flattenedData:[]}};for(n&&o("data getter: reading from: ",t," up to ",a),r=e.columns,s=t;a>s&&s<r.length;s++)l.columns.push(r[s]);for(r=e.table.columns,s=t;a>s&&s<r.length;s++)l.table.columns.push(r[s]);for(r=e.table.columnHeaderRow.members,s=t;a>s&&s<r.length;s++)l.table.columnHeaderRow.members.push(r[s]);if(e.table.summaryRow)for(r=e.table.summaryRow.members,s=t;a>s&&s<r.length;s++)l.table.summaryRow.members.push(r[s]);return _.each(e.table.flattenedData,function(e){var t={id:e.id,isRow:e.isRow,isFooter:e.isFooter,isGroupMember:e.isGroupMember,rowClass:e.rowClass,formattedValue:e.formattedValue,members:[]};e.groupSummaryRow&&(t.groupSummaryRow={members:[]}),e.group&&(t.group={mask:e.group&&e.group.mask||void 0,numericType:e.group&&e.group.numericType||void 0,defaultDisplayName:e.group&&e.group.defaultDisplayName||void 0,currentDisplayName:e.group&&e.group.currentDisplayName||void 0,name:e.group&&e.group.name||void 0}),l.table.flattenedData.push(t)}),_.each(e.table.flattenedData,function(e,i){for(e=e.members,s=t;a>s&&s<e.length;s++)l.table.flattenedData[i].members.push(e[s])}),_.each(e.table.flattenedData,function(e,i){if(e.groupSummaryRow)for(e=e.groupSummaryRow.members,s=t;a>s&&s<e.length;s++)l.table.flattenedData[i].groupSummaryRow.members.push(e[s])}),n&&o("RESULT: ",l),l},partialRender:function(){var e=0,t=function(){console.log.apply(console,arguments)},i=100;this.data.forceShowNCols&&(i=this.data.forceShowNCols,this.data.forceShowNCols=!1);var n=this.getPartialDataFromFullState(this.fullDataSet,this.data.amountOfDisplayedCols,i),o={columns:this.fullDataSet.columns,groups:this.fullDataSet.groups,partial:n,hasNoData:this.fullDataSet.hasNoData,endOfFile:this.fullDataSet.endOfFile,title:this.fullDataSet.title,titleBarShowing:this.fullDataSet.titleBarShowing};e&&t("dataForRender: ",o);var s=this.me.tableTemplate(o);isIE9()&&(s=removeWhitespacesFromTable(s));var r=!(0===o.partial.columns.length&&0===o.groups.length);if(this.data.isFirstRender)return e&&t("doing full display: ",i," records to display"),adhocDesigner.ui.canvas.html(s),this.data.isFirstRender=!1,this.data.amountOfDisplayedCols=i,r;e&&t("doing partial display: ",i," records to display");var a=jQuery(s),l=adhocDesigner.ui.canvas.find("table tr"),c=a.find("tr"),d=0;return _.each(l,function(e,t){if(c[t])for(var i=0,n=c[t].childNodes.length;n>i;i++)child=c[t].childNodes[0],child.parentNode.removeChild(child),child.hasAttribute&&child.hasAttribute("colspan")||"#text"!=child.nodeName.toLowerCase()&&(l[t].appendChild(child),0==t&&d++)}),e&&t("Added: ",d," columns"),this.data.amountOfDisplayedCols+=d,r},addMoreRows:function(e){var t=0,i=function(){console.log.apply(console,arguments)};adhocDesigner.registerTemplate(this.me,"tableRowsTemplate","tableRowsTemplate"),this.addMoreDataToFullState(e),t&&i("add more rows: moreRowsState: ",e);var n=this.getPartialDataFromFullState(e,0,this.data.amountOfDisplayedCols);t&&i("add more rows: partialData: ",n);var o={columns:this.fullDataSet.columns,groups:this.fullDataSet.groups,partial:n,hasNoData:this.fullDataSet.hasNoData,endOfFile:this.fullDataSet.endOfFile,title:this.fullDataSet.title,titleBarShowing:this.fullDataSet.titleBarShowing};t&&i("add more rows: dataForRender: ",o);var s=this.me.tableRowsTemplate(o).replace(/^[\s]*<tbody id="tableDetails" class="copyTo">/g,"").replace(/<\/tbody>[\s]*/g,"");isIE9()&&(s=removeWhitespacesFromTable(s)),jQuery("#canvasTable > tbody.copyTo").append(s),this.me.initNewRows()}},render:function(){this.Rendering.me=this,this.Rendering.init(),this.Rendering.fullDataSet=this.state;var e=this.Rendering.partialRender();this.Rendering.infinitiveHorizontalScroll();var t=jQuery("#titleCaption").children().eq(0),i=t.width(),n=jQuery("#titleCaption").width();return n>i&&t.width(n),adhocDesigner.setNothingToDisplayVisibility(!e||this.state.isShowingNoData),adhocDesigner.ui.canvas.unbind("scroll",this.Rendering.infinitiveHorizontalScroll).bind("scroll",this.Rendering.infinitiveHorizontalScroll),this.state.isShowingNoData?(jQuery("#nothingToDisplayMessage").html(adhocDesigner.getMessage("noDataMode")),jQuery("#columnHeaderRow").hide(),jQuery("#canvasTable").css("border","none")):(jQuery("#nothingToDisplayMessage").html(this.nothingToDisplayMessage),jQuery("#columnHeaderRow").show(),jQuery("#canvasTable").css("border-width","1px"),jQuery("#canvasTable").css("border-style","solid")),e||(jQuery("#columnHeaderRow").hide(),jQuery("#canvasTable").css("border","none")),e}};AdHocTable._getTableHeaders=function(){return $$("tr#columnHeaderRow.labels.column th.label")},AdHocTable.canSaveReport=function(){return $("canvasTableCols")&&(AdHocTable.theCols=$("canvasTableCols").getElementsByTagName("col"),AdHocTable.theCols)?AdHocTable.theCols.length>0:!1},AdHocTable.deselectAllSelectedOverlays=function(){AdHocTable.deselectAllTableColumns(),AdHocTable.deselectAllSummaryCells(),AdHocTable.deselectAllColumnGroupRows()},AdHocTable.removeFromSelectObjects=function(e){var t;selObjects.each(function(i){i.index==e&&(t=i)}),selObjects=selObjects.without(t)},define("adhoc/table",["jquery","jquery.ui","underscore","prototype","designer.base","utils.common"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),AdHocTable.GRID_SELECTOR_MENU_CLASS="menu vertical dropDown",AdHocTable.ACTION_MODEL_CONTEXT_SUFFIX="_mutton",AdHocTable.mouseDownHandler=function(){},AdHocTable.mouseUpHandler=function(e){if(Draggables.dragging!=designerBase.COLUMN_LEVEL&&Draggables.dragging!=designerBase.GROUP_LEVEL&&!TouchController.element_scrolled){var t=isSupportsTouch()?getTouchedElement(e):e.element(),i=null,n=null,o=null;if(("dimensionsTree"==Draggables.dragging||"measuresTree"==Draggables.dragging)&&(i=matchAny(t,[adhocDesigner.COLUMN_OVERLAY_PATTERN],!0),i&&(o=t.identify(),n=n?n:AdHocTable.digitRegex.exec(o)[0],isSupportsTouch()||(AdHocTable.hoverColumn=n),AdHocTable.deactivateVisualDropCue(e,n),AdHocTable.isHoverGreaterThan50Percent(e,n)&&AdHocTable.hoverColumn++),i=matchAny(t,[adhocDesigner.COLUMN_SIZER_PATTERN],!0),i&&(o=t.identify(),n=parseInt(AdHocTable.digitRegex.exec(o)[0]),AdHocTable.hoverColumn=n+1,AdHocTable.deactivateVisualDropCue(e,n))),!isSupportsTouch()||!TouchController.element_scrolled){if(i=matchAny(t,[adhocDesigner.COLUMN_OVERLAY_PATTERN],!0),i&&!isRightClick(e)){o=t.identify();var n=AdHocTable.digitRegex.exec(o)[0],s=localContext._getTableHeaders()[n],r={};r.header=s,r.index=n,r.model=localContext.state.table.columns[n],localContext.selectTableColumn(e,r)}if(t.match(adhocDesigner.GROUP_OVERLAY_PATTERN)&&!isRightClick(e)&&t){var a={id:t.identify(),fieldName:t.readAttribute("data-fieldName"),mask:t.readAttribute("data-mask"),dataType:t.readAttribute("data-dataType"),index:t.readAttribute("data-index"),label:t.readAttribute("data-label")};localContext.selectGroup(e,a)}t.match(adhocDesigner.SUMMARY_OVERLAY_PATTERN)&&!isRightClick(e)&&(o=t.identify(),localContext.selectGrandRowCell(e,AdHocTable.digitRegex.exec(o)[0]))}}},AdHocTable.mouseOutHandler=function(e){var t,i,n=e.targetElement?e.targetElement:e.element(),o=matchAny(n,[adhocDesigner.COLUMN_OVERLAY_PATTERN],!0);o&&(n.removeClassName("over"),Draggables.dragging&&!Draggables.activeDraggable.element.hasClassName("columnSizer")&&(t=n.identify(),i=parseInt(AdHocTable.digitRegex.exec(t)[0]),AdHocTable.deactivateVisualDropCue(e,i),AdHocTable.deactivateVisualDropCue(e,i-1))),o=matchAny(n,[adhocDesigner.SUMMARY_OVERLAY_PATTERN,adhocDesigner.GROUP_OVERLAY_PATTERN],!0),o&&n.removeClassName("over"),n.match("#designer .columnSizer")&&(theBody.style.cursor="default",adhocDesigner.overlayDraggedColumn&&adhocDesigner.overlayDraggedColumn.destroy())},AdHocTable.mouseOverHandler=function(e){var t=e.targetElement?e.targetElement:e.element(),i=Draggables.dragging==designerBase.GROUP_LEVEL;if(AdHocTable.updateColumnWhileDrag(e,t,function(t,i){AdHocTable.deactivateVisualDropCue(e,i?t-1:t),AdHocTable.activateVisualDropCue(e,i?t:t-1)}),Draggables.dragging!=designerBase.AVAILABLE_FIELDS_AREA&&!AdHocTable.draggingColumnSizer){if(matched=matchAny(t,[adhocDesigner.SUMMARY_OVERLAY_PATTERN,adhocDesigner.GROUP_OVERLAY_PATTERN,"th.label"],!0)){var n=jQuery(matched),o=n.attr("data-index");"th"==n.get(0).tagName.toLowerCase()&&o?jQuery("#columnOverlay_"+o).addClass("over"):matched.addClassName("over")}i&&(AdHocTable.draggingMoveOverGroupIndex=t.match(adhocDesigner.GROUP_OVERLAY_PATTERN)?t.getAttribute("data-index"):-1),AdHocTable.resizeColumnWhenSizerDrag(t)}},AdHocTable.mouseClickHandler=function(){},AdHocTable.contextMenuHandler=function(e){var t=e.element(),i=t.identify();if(matchAny(t,[adhocDesigner.COLUMN_OVERLAY_PATTERN],!0)){var n=AdHocTable.digitRegex.exec(i)[0],o=localContext._getTableHeaders()[n],s={};s.header=o,s.index=n,s.model=localContext.state.table.columns[n],designerBase.isInSelection(s)||localContext.selectTableColumn(e,s);var r=_.chain(selObjects).pluck("model").pluck("name").value();actionModel.setSelected(_.filter(localContext.state.columns,function(e){return _.contains(r,e.name)})),o.readAttribute("data-fieldname")!==designerBase.ARTIFICIAL_NAME&&adhocDesigner.showDynamicMenu(e,designerBase.COLUMN_LEVEL,null,AdHocTable.generateAvailableSummaryCalculationsMenu)}if(t.match(adhocDesigner.SUMMARY_OVERLAY_PATTERN)){n=AdHocTable.digitRegex.exec(i)[0];var a=$("grandSummaryRow").cells,l=a[n];designerBase.isInSelection(l)||localContext.selectGrandRowCell(e,n),actionModel.setSelected(_.map(selObjects,function(e){return e.model})),adhocDesigner.showDynamicMenu(e,designerBase.SUMMARY_LEVEL,null,AdHocTable.generateAvailableSummaryCalculationsMenu)}if(t.match(adhocDesigner.GROUP_OVERLAY_PATTERN)&&t){var c=t.readAttribute("data-index"),d={id:i,fieldName:t.readAttribute("data-fieldName"),mask:t.readAttribute("data-mask"),dataType:t.readAttribute("data-dataType"),index:c,label:t.readAttribute("data-label"),model:localContext.state.table.groups[c]};designerBase.isInSelection(d)||localContext.selectGroup(e,d),actionModel.setSelected(_.map(selObjects,function(e){return e.model})),adhocDesigner.showDynamicMenu(e,designerBase.GROUP_LEVEL)}},AdHocTable.treeMenuHandler=function(e){var t,i=e.memo.node;t=designerBase[i.isParent()||!adhocDesigner.isOnlyFieldsSelected()?"FIELDSET_MENU_LEVEL":"FIELD_MENU_LEVEL"],adhocDesigner.showDynamicMenu(e.memo.targetEvent,t,null)},AdHocTable.initKeyEvents=function(){function e(e){return null!=e.target.up(".dialog")}document.stopObserving("key:right"),document.observe("key:right",function(t){if(localContext.getMode()==designerBase.TABLE&&!e(t)){var i=Object.clone(t.memo.targetEvent),n=adhocDesigner.getSelectedColumnOrGroup();n&&designerBase.isInSelection(n)&&AdHocTable.canMoveColumnsRight()&&AdHocTable.moveColumnRight(function(){AdHocTable.updateSelectedIndexes(1),localContext.selectTableColumn(i,n)})}}),document.stopObserving("key:left"),document.observe("key:left",function(t){if(localContext.getMode()==designerBase.TABLE&&!e(t)){var i=Object.clone(t.memo.targetEvent),n=adhocDesigner.getSelectedColumnOrGroup();n&&designerBase.isInSelection(n)&&AdHocTable.canMoveColumnsLeft()&&AdHocTable.moveColumnLeft(function(){AdHocTable.updateSelectedIndexes(-1),localContext.selectTableColumn(i,n)})}})},AdHocTable.generateAvailableSummaryCalculationsMenu=function(e,t){var i=_.find(t,function(e){return"AdHocTable.selectedColumnShowsSummaryOptions"===e.clientTest});if(i){var n=actionModel.selObjects[0],o=_.findWhere(localContext.state.columns,{name:n.name});o&&adhocDesigner.generateAvailableSummaryCalculationsMenu(o.fieldName,i,{action:AdHocTable.functionSelected,isSelectedTest:AdHocTable.isSelectedSummaryFunction})}return t},AdHocTable.lmHandlersMap={addItems:function(e,t,i){this[i].addItems(_.pluck(e,"id"),t)},group:{addItem:function(e,t,i){AdHocTable.addFieldAsGroup(i,t)},addItems:function(e,t){AdHocTable.addFieldAsGroup(e,t)},removeItem:function(e,t){AdHocTable.removeGroup(t)},moveItem:function(e,t,i){AdHocTable.moveGroup(t,i)},switchItem:function(e,t,i){AdHocTable.switchToGroup(e,t,i)},contextMenu:function(e,t){var i=t.extra.name,n=_.find(localContext.state.groups,function(e){return e.name===i});localContext.selectGroup(t.targetEvent,{id:"group"+n.level+"HeaderRow0",fieldName:n.name,mask:n.mask,dataType:n.numericType,index:n.level,label:n.currentDisplayName}),actionModel.setSelected([n]),adhocDesigner.showDynamicMenu(t.targetEvent,"displayManagerRow",null,null)}},column:{addItem:function(e,t,i){AdHocTable.addFieldAsColumnAtPosition(i,t)},addItems:function(e,t){AdHocTable.addFieldAsColumnAtPosition(e,t)},removeItem:function(e,t){AdHocTable.removeColumn(t)},moveItem:function(e,t,i){AdHocTable.moveColumn(t,i,null,!0)},switchItem:function(e,t,i){AdHocTable.switchToColumn(e,t,i)},contextMenu:function(e,t){var i=t.extra,n=localContext._getTableHeaders()[i.index];localContext.selectTableColumn(t.targetEvent,{header:n,index:i.index,ftype:i.isMeasure?"measure":"dimension",model:localContext.state.table.columns[i.index]}),actionModel.setSelected([localContext.state.columns[i.index]]),adhocDesigner.showDynamicMenu(t.targetEvent,"displayManagerColumn",null,null)}}},define("adhoc/table.observers",["adhoc/table"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),AdHocTable.addFieldAsColumnAtPosition=function(e,t){if(AdHocTable.canAddFieldAsColumn(e)){var i=adhocDesigner.isNoDataToDisplay(),n=function(e){AdHocTable.hoverColumn=-1,localContext.standardTableOpCallback(e),i&&!adhocDesigner.isNoDataToDisplay()&&adhocDesigner.checkMaxRowsLimit()};designerBase.sendRequest("ta_insertColumn",{"f[]":e,i:t},n,{bPost:!0})}},AdHocTable.moveColumn=function(e,t,i,n){var o=n?e:_.pluck(selObjects,"index").join(","),s=t-e,r=function(e){localContext.standardTableOpCallback(e),i&&i(e)};designerBase.sendRequest("ta_moveColumn",["indexes="+o,"offset="+s],r)},AdHocTable.switchToColumn=function(e,t,i){!e&&selObjects.length>0&&(e=selObjects[0].fieldName,t=selObjects[0].index,i=-1),designerBase.sendRequest("ta_switchToColumn",["item="+encodeText(e),"from="+t,"to="+i],localContext.standardTableOpCallback)},AdHocTable.removeColumn=function(e,t){var i=_.isNumber(e)?e:_.pluck(selObjects,"index").join(","),n=t||localContext.standardTableOpCallback;designerBase.sendRequest("ta_removeColumn",["indexes="+i],n)},AdHocTable.tableColumnResize=function(e,t){var i=AdHocTable.getNewColumnWidth(e,t),n=function(e){localContext.standardTableOpCallback(e)};designerBase.sendRequest("ta_resizeColumn",["i="+t,"w="+i],n)},AdHocTable.setColumnHeaderToNull=function(e){var t=function(e){localContext.standardTableOpCallback(e)};designerBase.sendRequest("ta_setColumnHeader",["i="+e,"l=_null","w=-1"],t)},AdHocTable.updateColumnHeaderRequest=function(e,t,i){var n=function(e){localContext.standardTableOpCallback(e)};0===e.length?localContext.removeColumnHeaderRequest():designerBase.sendRequest("ta_setColumnHeader",["i="+t,"l="+encodeText(e),"w="+i],n)},AdHocTable.setMask=function(e,t){var i=function(e){localContext.standardTableOpCallback(e),designerBase.unSelectAll()};designerBase.sendRequest("ta_setColumnMask",["m="+encodeText(e),"i="+t],i)},AdHocTable.updateViewCallback=function(e){localContext.standardOpCallback(e)},AdHocTable.addFieldAsGroup=function(e,t){e||(t=-1,e=adhocDesigner.collectFields(adhocDesigner.getSelectedTreeNodes(),!0)),designerBase.sendRequest("ta_insertGroup",{"f[]":e,i:t},localContext.standardTableOpCallback)},AdHocTable.moveGroup=function(e,t,i){var n=function(e){localContext.standardTableOpCallback(e),i&&i()};designerBase.sendRequest("ta_moveGroup",["i1="+e,"i2="+t],n)},AdHocTable.switchToGroup=function(e,t,i){!e&&selObjects.length>0&&(e=jQuery(selObjects[0].header).attr("data-fieldname"),t=selObjects[0].index,i=-1),designerBase.sendRequest("ta_switchToGroup",["item="+encodeText(e),"from="+t,"to="+i],localContext.standardTableOpCallback)},AdHocTable.removeGroup=function(e,t){var i,n=parseInt(e),o=t||localContext.standardTableOpCallback;isNaN(n)&&(n=(i=adhocDesigner.getSelectedColumnOrGroup())&&i.index),designerBase.sendRequest("ta_removeGroup",["i="+n],o)},AdHocTable.updateGroupLabel=function(e,t){if(!e||e.blank())return void localContext.setGroupLabelToNull(t);var i=function(e){localContext.standardTableOpCallback(e)};designerBase.sendRequest("ta_setGroupLabel",["g="+t,"l="+encodeText(e)],i)},AdHocTable.setGroupLabelToNull=function(e){var t=function(e){localContext.standardTableOpCallback(e)};designerBase.sendRequest("ta_setGroupLabel",["g="+e,"l=_null"],t)},AdHocTable.setGroupMask=function(e,t){var i=function(e){localContext.standardTableOpCallback(e)};designerBase.sendRequest("ta_setGroupMask",["m="+encodeText(e),"i="+t],i)},AdHocTable.fetchMoreRows=function(){AdHocTable.fetchingRows=!0,designerBase.sendRequest("ta_"+AdHocTable.FETCH_MORE_ROWS,[],this.Rendering.addMoreRows.bind(this.Rendering),null)},AdHocTable.addDefaultColumnSummary=function(){var e=adhocDesigner.getSelectedColumnOrGroup();e&&designerBase.sendRequest("ta_updateSummaryVisibility",["visible=true","i="+e.index],localContext.standardTableOpCallback)},AdHocTable.removeColumnSummary=function(){var e=adhocDesigner.getSelectedColumnOrGroup();e&&designerBase.sendRequest("ta_updateSummaryVisibility",["visible=false","i="+e.index],localContext.standardTableOpCallback)},AdHocTable.setSummaryFunction=function(e,t){var i=function(e){localContext.standardTableOpCallback(e)};designerBase.sendRequest("ta_setColumnSummaryFunction",["f="+e,"i="+t],i)},AdHocTable.toggleGridMode=function(e){designerBase.sendRequest("ta_toggleGridMode",["mode="+e],localContext.standardTableOpCallback)},AdHocTable.updateCustomFieldCallback=function(){localContext.standardTableOpCallback(),localContext.state.inDesignView&&adhocDesigner.updateAllFieldLabels()},AdHocTable.getCallbacksForPivot=function(e){localContext.standardOpCallback(e)},AdHocTable.standardOpCallback=function(e){e?localContext.standardTableOpCallback(e,!0):window.console&&console.log("Internal server error occurred")},AdHocTable.standardTableOpCallback=function(e){adhocDesigner.render(e)},define("adhoc/table.ajax",["adhoc/table.observers"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),AdHocTable.addFieldAsColumn=function(e){var t=adhocDesigner.getSelectedTreeNodes(),i=adhocDesigner.collectFields(t,e,AdHocTable.canAddFieldAsColumn),n=AdHocTable.hoverColumn>-1?AdHocTable.hoverColumn:-1;AdHocTable.addFieldAsColumnAtPosition(i,n)},AdHocTable.addThisFieldAsColumn=function(e){var t=AdHocTable._getTableHeaders().length;AdHocTable.addFieldAsColumnAtPosition(e,t)},AdHocTable.moveColumnLeft=function(e){var t=localContext.getLeftMostPositionFromSelectedColumns(),i=t-1;localContext.moveColumn(t,i,e)},AdHocTable.moveColumnRight=function(e){var t=localContext.getLeftMostPositionFromSelectedColumns(),i=t+1;localContext.moveColumn(t,i,e)},AdHocTable.updateSelectedIndexes=function(e){for(var t=0;t<selObjects.length;t++)selObjects[t].index=(+selObjects[t].index+e).toString()},AdHocTable.resizeColumnWhenSizerDrag=function(e){if(e.match("#designer .columnSizer")){var t=e.readAttribute("id");theBody.style.cursor="col-resize";{designerBase.TABLE_SELECT_AREA}adhocDesigner.overlayDraggedColumn=new Draggable(t,{constraint:"horizontal",onStart:function(){AdHocTable.draggingColumnSizer=!0,AdHocTable.activateColumnSizer(t)},onEnd:function(e,i){var n=e.element,o=$(n).readAttribute("id");AdHocTable.deactivateColumnSizer(t),localContext.tableColumnResize(i.element(),AdHocTable.digitRegex.exec(o)[0]),AdHocTable.draggingColumnSizer=!1}})}},AdHocTable.selectTableColumn=function(e,t){AdHocTable.deselectAllSummaryCells(),AdHocTable.deselectAllColumnGroupRows();var i=adhocDesigner.isMultiSelect(e,designerBase.COLUMN_LEVEL),n=adhocDesigner.isAlreadySelected(t),o=t.index,s="columnOverlay_"+o;$(s)||AdHocTable.initOverlayById(o),n?i?$(s)&&($(s).removeClassName("selected").removeClassName("over"),AdHocTable.removeFromSelectObjects(o)):(!isIPad()&&AdHocTable.deselectAllTableColumns(),$(s).addClassName("selected"),adhocDesigner.addSelectedObject(e,t,i,n),selectionCategory.area=designerBase.COLUMN_LEVEL,!isIPad()&&AdHocTable.createDraggableColumn($(s).identify())):(i||_.each(AdHocTable.columnOverlays,function(e){$(e).removeClassName("selected").removeClassName("over")}),$(s)&&$(s).addClassName("selected"),adhocDesigner.addSelectedObject(e,t,i,n),selectionCategory.area=designerBase.COLUMN_LEVEL,!isIPad()&&isDesignView&&AdHocTable.createDraggableColumn($(s).identify()))},AdHocTable.deselectTableColumn=function(e,t){var i={},n="columnOverlay_"+t;$(n)&&($(n).removeClassName("selected"),$(n).removeClassName("over"),i.header=localContext._getTableHeaders()[t],i.index=t)},AdHocTable.deselectAllTableColumns=function(){for(var e=localContext._getTableHeaders(),t=e.length,i=0;t>i;i++)AdHocTable.deselectTableColumn(null,i),AdHocTable.removeFromSelectObjects(i)},AdHocTable.columnMaskSelected=function(e){var t=adhocDesigner.getSelectedColumnOrGroup();t&&localContext.setMask(e,t.index)},AdHocTable.removeColumnHeaderRequest=function(){var e=adhocDesigner.getSelectedColumnOrGroup();e&&localContext.setColumnHeaderToNull(e.index)},AdHocTable.launchSortingDialogForColumn=function(){var e=selObjects;if(!e&&adhocDesigner.getSelectedTreeNodes().length&&(e=adhocDesigner.getSelectedTreeNodes()),e){var t=[];jQuery(e).each(function(){t.push(adhocDesigner.getNameForSelected(this))}),adhocSort.launchDialog(t)}},AdHocTable.cleanupOnSwitch=function(){adhocSort.hideDialog()},AdHocTable.moveGroupUp=function(e){function t(){AdHocTable.updateSelectedIndexes(-1),e&&e()}var i=adhocDesigner.getSelectedColumnOrGroup();if(i){var n=parseInt(i.index),o=n-1;localContext.moveGroup(n,o,t)}},AdHocTable.moveGroupDown=function(e){function t(){AdHocTable.updateSelectedIndexes(1),e&&e()}var i=adhocDesigner.getSelectedColumnOrGroup();if(i){var n=parseInt(i.index),o=n+1;localContext.moveGroup(n,o,t)}},AdHocTable.selectGroup=function(e,t){var i=t.id,n=(t.index,adhocDesigner.isMultiSelect(e,designerBase.GROUP_LEVEL));selectionCategory.area=designerBase.GROUP_LEVEL;var o=adhocDesigner.isAlreadySelected(t);o?(AdHocTable.deselectAllColumnGroupRows(),$(i)&&$(i).addClassName("selected"),adhocDesigner.addSelectedObject(e,t,n,o)):(AdHocTable.deselectAllColumnGroupRows(),AdHocTable.deselectAllTableColumns(),AdHocTable.deselectAllSummaryCells(),$(i)&&($(i).addClassName("selected"),!isIPad()&&AdHocTable.createDraggableGroup(i)),adhocDesigner.addSelectedObject(e,t,n,o))},AdHocTable.deselectAllColumnGroupRows=function(){designerBase.deselectOverlaySet(AdHocTable.groupOverlays,"selected"),designerBase.deselectOverlaySet(AdHocTable.groupOverlays,"pressed")},AdHocTable.editGroupLabel=function(){adhocDesigner.getSelectedColumnOrGroup()&&adhocDesigner.editDataHeader(null,"tableGroup")},AdHocTable.removeGroupLabel=function(){var e=adhocDesigner.getSelectedColumnOrGroup();if(e){var t=e.index;localContext.setGroupLabelToNull(t)}},AdHocTable.groupMaskSelected=function(e){var t=adhocDesigner.getSelectedColumnOrGroup(),i=t.index;t&&localContext.setGroupMask(e,i)},AdHocTable.selectGrandRowCell=function(e,t){AdHocTable.deselectAllTableColumns(),AdHocTable.deselectAllColumnGroupRows(),selectionCategory.area=designerBase.SUMMARY_LEVEL;var i=$("grandSummaryRow").cells,n={element:i[t],index:t,model:localContext.state.table.columns[t]},o="grandSummaryOverlay_"+t,s=adhocDesigner.isAlreadySelected(n);s||(AdHocTable.deselectAllSummaryCells(),$(o)&&$(o).addClassName("selected"),adhocDesigner.addSelectedObject(e,n,!1,s))},AdHocTable.deselectAllSummaryCells=function(){designerBase.deselectOverlaySet(AdHocTable.summaryOverlays,"selected")},define("adhoc/table.actions",["adhoc/table"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),AdHocTable.canAddFieldAsColumn=function(){return!0},AdHocTable.isSpacer=function(e){return e==designerBase.SPACER_NAME},AdHocTable.canAddAsColumn=function(){return _.all(selObjects,function(e){return AdHocTable.canAddFieldAsColumn(e.param.id)})},AdHocTable.canMoveColumnsLeft=function(){return AdHocTable.getLeftMostPositionFromSelectedColumns()>0},AdHocTable.canMoveColumnsRight=function(){return AdHocTable.getRightMostPositionFromSelectedColumns()<AdHocTable._getTableHeaders().length-1},AdHocTable.canAddFilter=function(e,t){return adhocDesigner.isSpacerSelected(e)?(t&&t.push(addFilterErrorMessageSpacerAdd),!1):adhocDesigner.isPercentOfParentCalcSelected(e)?(t&&t.push(addFilterErrorMessagePercentOfParentCalcFieldAdd),!1):adhocDesigner.isConstantSelected(e)?(t&&t.push(addFilterErrorMessageConstantAdd),!1):adhocDesigner.isMeasureSelected(e)?(t&&t.push(addFilterErrorMessageMeasureAdd),!1):!0},AdHocTable.getLeftMostPositionFromSelectedColumns=function(){var e=selObjects.length;if(e>0){for(var t=adhocDesigner.getSelectedColumnOrGroup(),i=t.index,n=1;e>n;n++){var o=selObjects[n].index;i>o&&(i=o)}return parseInt(i)}return-1},AdHocTable.getRightMostPositionFromSelectedColumns=function(){var e=selObjects.length;if(e>0){for(var t=adhocDesigner.getSelectedColumnOrGroup(),i=t.index,n=1;e>n;n++){var o=selObjects[n].index;o>i&&(i=o)}return parseInt(i)}return-1},AdHocTable.getNewColumnWidth=function(e,t){var i=e,n=localContext._getTableHeaders()[t],o=$(i).cumulativeOffset()[0]+i.cumulativeScrollOffset()[0],s=$(n).cumulativeOffset()[0]+n.cumulativeScrollOffset()[0],r=o-s;return Math.max(r,AdHocTable.MINIMUM_COL_WIDTH)},AdHocTable.isSelectedColumnType=function(e){return localContext.getSelectedColumnType()==e},AdHocTable.getSelectedColumnType=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e?e.model.numericType:adhocDesigner.NaN},AdHocTable.hasColumns=function(){var e=!1;return AdHocTable.theCols=$("canvasTableCols").getElementsByTagName("col"),AdHocTable.theCols&&(e=AdHocTable.theCols.length>0),e},AdHocTable.hasGroups=function(){return localContext.state.groups.length>0},AdHocTable.isFetchingRows=function(){return AdHocTable.fetchingRows},AdHocTable.shouldFetchMoreRows=function(){return(AdHocTable.hasColumns()||AdHocTable.hasGroups())&&localContext.state.isShowingFullData&&!localContext.state.endOfFile&&AdHocTable.theRows.length<adhocDesigner.ROW_SIZE_TO_TRIGGER_SCROLLBAR},AdHocTable.tableScrolled=function(){if(localContext.getMode()===designerBase.TABLE&&localContext.state.isShowingFullData&&!localContext.state.endOfFile&&!AdHocTable.isFetchingRows()){var e=isIPad()?adhocDesigner._touchController.isBottom():isAlmostInView(AdHocTable.theRows[AdHocTable.lastRow],AdHocTable.ALMOST_IN_VIEW_OFFSET);e&&localContext.fetchMoreRows()}},AdHocTable.isTotalsOnly=function(){var e=localContext.state.table;return e.showTableTotals&&!e.showTableDetails},AdHocTable.selectedColumnCanAddSummary=function(){return!AdHocTable.isTotalsOnly()&&!adhocDesigner.hasSpacerInSelection()&&!AdHocTable.selectedColumnHasSummary()},AdHocTable.selectedColumnCanRemoveSummary=function(){return!AdHocTable.isTotalsOnly()&&AdHocTable.selectedColumnHasSummary()},AdHocTable.selectedColumnHasSummary=function(){if(1!==selObjects.length)return!1;var e=localContext.state.columns[designerBase.getSelectedObject().index];return e.showSummary},AdHocTable.selectedColumnShowsSummaryOptions=function(){return AdHocTable.selectedColumnHasSummary()&&AdHocTable.selectedMeasureShowsSummaryOptions()},AdHocTable.selectedMeasureShowsSummaryOptions=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e?!!localContext.state.columns[e.index]:!1},AdHocTable.isSelectedMeasureNumeric=function(){return AdHocTable.isSelectedColumnType("int")||AdHocTable.isSelectedColumnType("dec")},AdHocTable.isSelectedSummaryFunction=function(e){var t=actionModel.selObjects[0];return t&&t.summaryFunction===e},AdHocTable.functionSelected=function(e){if(selObjects.length>0){var t=designerBase.getSelectedObject().index;localContext.setSummaryFunction(e,t)}},AdHocTable.selectedFieldUsedForSorting=function(){var e=designerBase.getSelectedObject(),t=adhocDesigner.getNameForSelected(e);return AdHocTable.usedInSorting(t)},AdHocTable.selectedFieldCouldBeUsedForSorting=function(){return!(adhocDesigner.hasSpacerInSelection()||adhocDesigner.hasGroupInSelection()||AdHocTable.selectedFieldUsedForSorting()||designerBase.isSelectedNodeAFolder()||adhocDesigner.isAggregateSelected())},AdHocTable.selectedColumnUsedForSorting=function(){return localContext.state.inDesignView?selObjects.any(function(e){return AdHocTable.usedInSorting(e.model.name)}):!1},AdHocTable.selectedColumnCouldBeUsedForSorting=function(){return localContext.state.inDesignView?!AdHocTable.selectedColumnUsedForSorting()&&!adhocDesigner.hasSpacerInSelection()&&!adhocDesigner.isAggregateSelected():!1},AdHocTable.usedInSorting=function(e){if(null!=localContext.state.sortFields)for(var t=localContext.state.sortFields,i=0;i<t.length;i++)if(t[i].name==e)return!0;return!1},AdHocTable.canAddAsGroup=function(){return selObjects[0]&&"measuresTree"==selObjects[0].parent.treeId?!1:!(adhocDesigner.hasSpacerInSelection()||adhocDesigner.multiSelect||adhocDesigner.isSelectedTreeNodeAFolder()||adhocDesigner.isPercentOfParentCalcSelected())},AdHocTable.canSwitchToGroup=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e&&"dimension"===e.ftype},AdHocTable.canMoveGroupUp=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e&&e.index>0},AdHocTable.canMoveGroupDown=function(){var e=adhocDesigner.getSelectedColumnOrGroup(),t=localContext.state.groups.length;return e&&e.index<t-1},AdHocTable.isSelectedGroupType=function(e){return AdHocTable.getSelectedGroupType()===e},AdHocTable.getSelectedGroupType=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e?e.dataType:adhocDesigner.NaN},AdHocTable.canAddGroupLabelToSelected=function(){var e=adhocDesigner.getSelectedColumnOrGroup();if(e){var t=e.label;return t.blank()}return!1},AdHocTable.canGroupSetMask=function(){return AdHocTable.getSelectedGroupType()!=adhocDesigner.NaN},AdHocTable.isGroupMaskSelected=function(e){return AdHocTable.getMaskForSelectedGroup()==e.unescapeHTML()},AdHocTable.isSelectedGridMode=function(e){var t=localContext.state.table;switch(e){case"d":return t.showTableDetails&&!t.showTableTotals;case"t":return!t.showTableDetails&&t.showTableTotals;case"dt":return t.showTableDetails&&t.showTableTotals;default:throw"Unknown Grid Selector Mode: "+e}},AdHocTable.getMaskForSelectedGroup=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e&&e.mask},AdHocTable.canColumnSetMask=function(){return localContext.getSelectedColumnType()!=adhocDesigner.NaN},AdHocTable.isColumnMaskSelected=function(e){return AdHocTable.getMaskForSelectedColumn()===e.unescapeHTML()},AdHocTable.getMaskForSelectedColumn=function(){return adhocDesigner.getSelectedColumnOrGroup().header.getAttribute("data-mask")
},AdHocTable.canEditColumnHeaderForSelected=function(){return!AdHocTable.selectedHasNoColumnHeader()&&!adhocDesigner.hasSpacerInSelection()},AdHocTable.canAddColumnHeaderToSelected=function(){return AdHocTable.selectedHasNoColumnHeader()&&!adhocDesigner.hasSpacerInSelection()},AdHocTable.selectedHasNoColumnHeader=function(){var e=adhocDesigner.getSelectedColumnOrGroup();return e.header.hasClassName("deletedHeader")},AdHocTable.getTableTop=function(){var e=jQuery("#canvasTable"),t=e.find(".caption").height();return e.position().top+t+"px"},AdHocTable.getTableHeight=function(){var e=jQuery("#canvasTable"),t=e.find("tbody");return t.first().height()+t.last().height()+"px"},define("adhoc/table.helpers",["adhoc/table"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),AdHocTable.createDraggableColumn=function(e){return new Draggable(e,{mouseOffset:!0,scroll:"mainTableContainer",onStart:function(e){if(selObjects.length){Draggables.dragging=designerBase.COLUMN_LEVEL,$(e.element).addClassName(layoutModule.DRAGGING_CLASS),AdHocTable.draggingColumnOverlay=!0;var t=selObjects.length;$(e.element).update(t-1?t+" "+itemsSelectedSuffix:selObjects[0].header.getAttribute("data-label"))}},onEnd:function(e){Draggables.dragging=null,AdHocTable.draggingColumnOverlay=!1;var t=$(e.element).identify(),i=AdHocTable.digitRegex.exec(t)[0];if(-1==AdHocTable.draggingMoveOverColumnIndex)isDesignView&&AdHocTable.removeColumn();else if(i!=AdHocTable.draggingMoveOverColumnIndex){var n=i<AdHocTable.draggingMoveOverColumnIndex?[].max:[].min,o=n.call(selObjects,function(e){return e.index});localContext.moveColumn(o,AdHocTable.draggingMoveOverColumnIndex)}else AdHocTable.initOverlays();AdHocTable.draggingMoveOverColumnIndex=-1}})},AdHocTable.createDraggableGroup=function(e){return new Draggable(e,{constraint:"vertical",ghosting:!0,mouseOffset:!0,onStart:function(e){selObjects.length&&(Draggables.dragging=designerBase.GROUP_LEVEL,$(e.element).addClassName(layoutModule.DRAGGING_CLASS),AdHocTable.draggingGroupOverlay=!0,$(e.element).update(selObjects[0].label))},onEnd:function(){Draggables.dragging=null,AdHocTable.draggingGroupOverlay=!1;var e=selObjects[0].index;-1==AdHocTable.draggingMoveOverGroupIndex?isDesignView&&AdHocTable.removeGroup():e!=AdHocTable.draggingMoveOverGroupIndex?localContext.moveGroup(e,AdHocTable.draggingMoveOverGroupIndex):AdHocTable.initOverlays(),AdHocTable.draggingMoveOverGroupIndex=-1}})},AdHocTable.updateColumnWhileDrag=function(e,t,i){var n,o,s="dimensionsTree"==Draggables.dragging||"measuresTree"==Draggables.dragging||Draggables.dragging==designerBase.COLUMN_LEVEL,r=matchAny(t,[adhocDesigner.COLUMN_OVERLAY_PATTERN,adhocDesigner.COLUMN_SIZER_PATTERN]);if(r)if(s){n=t.identify(),o=AdHocTable.digitRegex.exec(n)[0],AdHocTable.draggingMoveOverColumnIndex=o;var a=!0;("dimensionsTree"==Draggables.dragging||"measuresTree"==Draggables.dragging)&&(a=AdHocTable.isHoverGreaterThan50Percent(e,o)),i(parseInt(o),a)}else!AdHocTable.draggingColumnSizer&&t.match(adhocDesigner.COLUMN_OVERLAY_PATTERN)&&t.addClassName("over");!s||r||t.match(adhocDesigner.COLUMN_SIZER_PATTERN)||(AdHocTable.draggingMoveOverColumnIndex=-1)},AdHocTable.isHoverGreaterThan50Percent=function(e,t){var i=AdHocTable.theCols[t];if(i){var n=0;if(isWebKitEngine()){var o=localContext._getTableHeaders()[t];n=o.getWidth(),i=o}else n=i.getWidth();var s=$(i).cumulativeOffset(),r=i.cumulativeScrollOffset(),a=s[0]+r[0],l=e.pointerX(),c=l-a;return c/n*100>=50}return!1},AdHocTable.activateVisualDropCue=function(e,t){var i=$("columnSizer_"+t);AdHocTable.activateColumnSizer(i)},AdHocTable.deactivateVisualDropCue=function(e,t){var i=$("columnSizer_"+t);AdHocTable.deactivateColumnSizer(i)},AdHocTable.activateColumnSizer=function(e){e&&$(e).addClassName("over")},AdHocTable.deactivateColumnSizer=function(e){e&&$(e).removeClassName("over")},define("adhoc/table.dnd",["adhoc/table"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),AdHocTable.initOverlays=function(){AdHocTable.columnLazyInitState={},designerBase.clearOverlaySet(AdHocTable.columnResizers),designerBase.clearOverlaySet(AdHocTable.columnOverlays),designerBase.clearOverlaySet(AdHocTable.summaryOverlays);var e=function(){var e=jQuery(this).index();AdHocTable.columnLazyInitState[e]!==!0&&(AdHocTable.columnLazyInitState[e]=!0,AdHocTable.initOverlayById(e))};jQuery(adhocDesigner.overlayParent).on("mouseover","td",e),jQuery(adhocDesigner.overlayParent).on("mouseover","th",e)},AdHocTable.initOverlayById=function(e){AdHocTable.initColumnOverlay(e),AdHocTable.initColumnResizer(e),AdHocTable.initSummaryOverlay(e)},AdHocTable.initRowDependentDimensions=function(){AdHocTable.lastRow=AdHocTable.theRows.length-1,"NoDataRow"==AdHocTable.theRows[AdHocTable.lastRow].id&&(AdHocTable.lastRow=AdHocTable.lastRow-1),AdHocTable.columnHeaderRow=$("columnHeaderRow")},AdHocTable.initNewRows=function(){return AdHocTable.state.endOfFile=$("endOfFileRow")||AdHocTable.existingRowCount==AdHocTable.theRows.length,AdHocTable.theRows=$("canvasTable").rows,window.status="total rows = "+AdHocTable.theRows.length,this.shouldFetchMoreRows()?(setTimeout("localContext.fetchMoreRows()",100),void setTimeout("localContext.fetchMoreRows()",100)):(AdHocTable.initRowDependentDimensions(),AdHocTable.initOverlays(),AdHocTable.existingRowCount=AdHocTable.theRows.length,void(AdHocTable.fetchingRows=!1))},AdHocTable.initColumnResizer=function(e){var t=3,i=AdHocTable.columnHeaderRow.cells;if(!(i.length<=e||jQuery("#columnSizer_"+e).length>0)){var n=this.getTableTop(),o=this.getTableHeight(),s=i[e],r=$(s).cumulativeOffset()[0]-$("mainTableContainer").cumulativeOffset()[0]-t,a=r+s.offsetWidth+"px",l=designerBase.createDomObject("DIV","columnSizer");l.writeAttribute("id","columnSizer_"+e),l.setStyle({left:a,top:n,height:o}),AdHocTable.columnResizers[e]=l,adhocDesigner.overlayParent.appendChild(l)}},AdHocTable.initColumnOverlay=function(e){var t=AdHocTable.columnHeaderRow.cells;if(!(t.length<=e||jQuery("#columnOverlay_"+e).length>0)){var i=this.getTableTop(),n=this.getTableHeight(),o=t[e];if($(o).hasClassName("label")){var s=$(o).cumulativeOffset()[0]-$("mainTableContainer").cumulativeOffset()[0]+"px",r=o.offsetWidth+"px",a=designerBase.createDomObject("DIV","overlay col");a.writeAttribute("id","columnOverlay_"+e),a.setStyle({left:s,width:r,top:i,height:n}),AdHocTable.columnOverlays[e]=a,adhocDesigner.overlayParent.appendChild(a)}}},AdHocTable.initSummaryOverlay=function(e){if($("grandSummaryRow")){var t=$("grandSummaryRow").cells;if(t.length<=e)return;var i=$(t[e]),n=i.cellIndex;if(jQuery("#grandSummaryOverlay_"+n).length>0)return;var o=i.offsetTop+$("canvasTable").offsetTop,s=i.cumulativeOffset()[0]-$("mainTableContainer").cumulativeOffset()[0],r=i.offsetWidth-2,a=i.offsetHeight,l=designerBase.createDomObject("DIV","overlay summary button");l.writeAttribute("id","grandSummaryOverlay_"+n),l.writeAttribute("data-summaryIndex",n),l.setStyle({left:s+"px",width:r+"px",top:o+"px",height:a+"px"}),AdHocTable.summaryOverlays[e]=l,adhocDesigner.overlayParent.appendChild(l)}},define("adhoc/table.init",["adhoc/table","adhoc/table.ajax","adhoc/table.actions","adhoc/table.helpers","adhoc/table.observers","adhoc/table.dnd"],function(e){return function(){var t;return t||e.AdHocTable}}(this)),define("common/util/classUtil",["require","underscore"],function(e){var t=e("underscore"),i={mixin:function(){var e,t,i=Array.prototype,n=i.shift.call(arguments);for(e=0;e<arguments.length;e+=1)if(arguments[e])for(t in arguments[e])arguments[e].hasOwnProperty(t)&&(n[t]=arguments[e][t]);return n},inherit:function(e,n){var o;o=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return e.apply(this,arguments)};var s=function(){};return s.prototype=e.prototype,o.prototype=new s,n&&t.extend(o.prototype,n),o.prototype.constructor=o,o.parent=e.prototype,o.extend=function(e){return i.inherit(o,e)},o},extend:function(e){return i.inherit(function(){},e)}};return i}),define("adhoc/calculatedFields/CalculatedFieldsService",["require","common/util/classUtil","jquery","common/config/requestSettings","components.dialogs","jrs.configs","report.execution.count"],function(e){var t=e("common/util/classUtil"),i=e("jquery"),n=e("common/config/requestSettings"),o=e("components.dialogs"),s=e("jrs.configs"),r=e("report.execution.count"),a=t.extend({constructor:function(e){this.clientKey=e.clientKey},createRestUrl:function(e){return"rest_v2/metadata/_temp/"+this.clientKey+e},_request:function(e,t,s){t="undefined"==typeof t?!0:t,s=s||a.defaultCallbacks;var r=i.ajax(_.defaults(e,n)).done(s.done||a.defaultCallbacks.done).fail(s.fail||a.defaultCallbacks.fail).always(s.always||a.defaultCallbacks.always);return t&&setTimeout(function(){"pending"===r.state()&&o.popup.show(i("#loading")[0],!1)},a.SLOW_REQUEST_TIMEOUT),r},fetchFieldsList:function(){return this._request({url:this.createRestUrl("/fields"),type:"GET",dataType:"json"})},fetchFunctionsList:function(){return this._request({url:this.createRestUrl("/functions"),type:"GET",dataType:"json"})},validate:function(e){return this._request({url:this.createRestUrl("/action/validate"),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e)})},get:function(e){return this._request({url:this.createRestUrl("/fields/"+e),type:"GET",dataType:"json"})},add:function(e){return this._request({url:this.createRestUrl("/fields"),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e)})},update:function(e,t){return this._request({url:this.createRestUrl("/fields/"+t),type:"PUT",dataType:"json",contentType:"application/json",data:JSON.stringify(e)})},remove:function(e){return this._request({url:this.createRestUrl("/fields/"+e),type:"DELETE",contentType:"application/json"})}});return a.defaultCallbacks={done:function(){s.isFreeOrLimitedEdition&&r.check()},fail:function(e,t,i){if(401==e.status||e.getResponseHeader("LoginRequested"))document.location=s.urlContext;else if(e.getResponseHeader("adhocException"))o.errorPopup.show(e.getResponseHeader("adhocException"));else if(500==e.status||e.getResponseHeader("JasperServerError")&&!e.getResponseHeader("SuppressError")){var n=JSON.parse(e.responseText),r="<p>"+i+"</p><p>"+n.message+"</p><p>"+n.parameters[0]+"</p>";o.errorPopup.show(r)}},always:function(){o.popup.hide(i("#loading")[0])}},a.SLOW_REQUEST_TIMEOUT=2e3,window.CalculatedFieldsService=a,a}),define("adhoc/calculatedFields/model/CalculatedFieldModel",["require","underscore","backbone"],function(e){var t=e("underscore"),i=e("backbone");return i.Model.extend({defaults:{fieldName:"",fieldLabel:"",kind:"",expression:"",summaryFunction:"",summaryExpression:"",summaryParameter:null,availableSummaryFunctions:[],availableFields:[],availableFunctions:[],operators:[]},populateFromField:function(e){this.set({fieldName:e.id,fieldLabel:e.label,expression:e.expression,kind:e.kind,summaryFunction:e.summaryFunction,summaryExpression:e.summaryExpression,summaryParameter:e.summaryParameter,availableSummaryFunctions:e.availableSummaries})},_checkForEmpty:function(e,t){return this.attributes[e]&&""!==this.attributes[e]?!0:(this.trigger("invalid:"+e,t),!1)},_checkForRestrictedChars:function(e,t){var i=/[<>"]/g;return i.test(this.attributes[e])?(this.trigger("invalid:"+e,t),!1):!0},_checkForReservedWords:function(e,i){return t.contains(["NOT","AND","IN","OR"],this.attributes[e].trim().toUpperCase())?(this.trigger("invalid:"+e,i),!1):!0},isLabelValid:function(){var e=!0;return e=this._checkForEmpty("fieldLabel",{errorCode:"adh.calculated.fields.name.empty"})&&e,e=this._checkForRestrictedChars("fieldLabel",{errorCode:"adh.calculated.fields.name.restrictedChars"})&&e,e=this._checkForReservedWords("fieldLabel",{errorCode:"adh.calculated.fields.name.reservedWords"})&&e},isExpressionValid:function(e){if(!e)throw"model.isExpressionValid(attr) requires an attribute!";var t=!0;return t=this._checkForEmpty(e,{errorCode:"adh.calculated.fields.formula.empty"})&&t},isSummaryFunctionValid:function(){var e=!0;return t.contains(this.attributes.availableSummaryFunctions,this.attributes.summaryFunction)||(e=!1),e},isSummaryParameterValid:function(){var e=!0;return e=this._checkForEmpty("summaryParameter",{errorCode:"adh.calculated.fields.summaryParameter.empty"})&&e},isValidField:function(){var e=!0;return e=this.isLabelValid()&&e,e=this.isExpressionValid("expression")&&e,"WeightedAverage"===this.attributes.summaryFunction&&(e=this.isSummaryParameterValid()&&e),"Custom"===this.attributes.summaryFunction&&(e=this.isExpressionValid("summaryExpression")&&e),e},toRequest:function(){var e={label:this.attributes.fieldLabel,display:this.attributes.fieldLabel,expression:this.attributes.expression,kind:this.attributes.kind},t=this.attributes.summaryFunction;return t&&""!==t&&(e.summaryFunction=t),"WeightedAverage"===t?e.summaryParameter=this.attributes.summaryParameter:"Custom"===t&&(e.summaryExpression=this.attributes.summaryExpression),e}})}),define("text!adhoc/calculatedFields/template/CalculatedFieldTemplate.htm",[],function(){return'<div class="section measureNameSection">\n    <div class="group noIndent">\n        <label class="control input">\n            <span class="wrap"> </span>\n            <input type="text" class="fieldLabelInput" value=""/>\n            <span class="message warning" data-field="fieldLabel"> </span>\n        </label>\n    </div>\n</div>\n\n<div class="section">\n    <div class="content tabbed">\n\n        <div class="header">\n            <ul class="control tabSet reverse buttons horizontal ">\n                <li tabid="" class="tab formulaBuilderTab first selected">\n                    <a class="button">\n                        <span class="wrap">{{= i18n.ADH_405_FORMULA_BUILDER }}</span>\n                    </a>\n                </li>\n                <li tabid="" class="tab summaryCalcTab">\n                    <a class="button">\n                        <span class="wrap">{{= i18n.ADH_405_SUMMARY_CALCULATION }}</span>\n                    </a>\n                </li>\n            </ul>\n        </div>\n\n        <div class="body section formulaBuilderSection noTitle"> </div>\n\n        <div class="body section summaryCalcSection noTitle hidden"> </div>\n\n    </div>\n</div>\n'}),define("adhoc/calculatedFields/factory/operatorsFactory",["require"],function(){return[{id:"add",value:"+"},{id:"subtract",value:"-"},{id:"multiply",value:"*"},{id:"divide",value:"/"},{id:"percent",value:"%"},{id:"parenLeft",value:"("},{id:"parenRight",value:")"},{id:"colon",value:":"},{id:"and",value:"AND"},{id:"or",value:"OR"},{id:"not",value:"NOT"},{id:"in",value:"IN"},{id:"equal",value:"=="},{id:"notEqual",value:"!="},{id:"greaterThan",value:">"},{id:"lessThan",value:"<"},{id:"greaterEqual",value:">="},{id:"lessEqual",value:"<="}]}),define("adhoc/calculatedFields/factory/codeExampleFactory",["require","underscore","bundle!adhoc_messages"],function(e){var t=e("underscore"),i=e("bundle!adhoc_messages"),n=function(e){var t=i["ADH_425_ARGS_"+e];return t?t:e},o=[{functions:["IsNull"],code:'"'+n("FIELD")+'"'},{functions:["Absolute","Rank"],code:'"'+n("NUMBER_FIELD")+'"'},{functions:["DayName","DayNumber","MonthName","MonthNumber","Year"],code:'"'+n("DATE_FIELD")+'"'},{functions:["Length"],code:'"'+n("TEXT_FIELD")+'"'},{functions:["Mode","CountAll","CountDistinct"],code:'"'+n("FIELD")+"\", '"+n("LEVEL")+"'"},{functions:["PercentOf","Range","StdDevP","StdDevS","Sum","Average"],code:'"'+n("NUMBER_FIELD")+"\", '"+n("LEVEL")+"'"},{functions:["Round"],code:'"'+n("NUMBER_FIELD")+'", '+n("INTEGER")},{functions:["WeightedAverage"],code:'"'+n("NUMBER_FIELD")+'1", "'+n("NUMBER_FIELD")+"2\", '"+n("LEVEL")+"'"},{functions:["Max","Min","Median"],code:'"'+n("NUMBER_OR_DATE_FIELD")+"\", '"+n("LEVEL")+"'"},{functions:["ElapsedDays","ElapsedWeeks","ElapsedMonths","ElapsedQuarters","ElapsedSemis","ElapsedYears"],code:'"'+n("DATE_FIELD")+'1", "'+n("DATE_FIELD")+'2"'},{functions:["ElapsedHours","ElapsedMinutes","ElapsedSeconds"],code:'"'+n("DATETIME_FIELD")+'1", "'+n("DATETIME_FIELD")+'2"'},{functions:["Contains","EndsWith","StartsWith"],code:'"'+n("TEXT_FIELD")+"\", '"+n("TEXT_STRING")+"'"},{functions:["Concatenate"],code:'"'+n("TEXT_FIELD")+"\", '"+n("TEXT_STRING")+"', ..."},{functions:["Mid"],code:'"'+n("TEXT_FIELD")+'", '+n("START_POSITION")+", "+n("LENGTH")},{functions:["IF"],code:'"'+n("BOOLEAN_FIELD")+'", '+n("TRUE_CALC")+", "+n("FALSE_CALC")},{functions:["Today"],code:n("INTEGER_OFFSET")}];return function(e,i){var n="";if(i){var s=t.find(o,function(i){return t.contains(i.functions,e)});n=s?s.code:""}return e+"("+n+")"}}),define("common/extension/jQueryDoubletapExtension",["require","jquery"],function(e){var t=e("jquery"),i=/android|iphone|ipad/i.test(navigator.userAgent.toLowerCase()),n=i?"touchend":"click";t.fn.doubletap=function(e,i){i=null==i?300:i,this.bind(n,function(n){var o=(new Date).getTime(),s=t(this).data("lastTouch")||o+1,r=o-s;i>r&&r>0?(t(this).data("lastTouch",null),null!==e&&"function"==typeof e&&e(n)):t(this).data("lastTouch",o)})}}),define("common/util/featureDetection",[],function(){return{supportsTouch:function(){return"ontouchstart"in window||navigator.msMaxTouchPoints}(),supportsModernSelection:function(){return"getSelection"in window.document}()}}),define("text!adhoc/calculatedFields/template/SimpleSelectListTemplate.htm",[],function(){return'{{_.each(items, function(item) { }}\n    <li class="node {{= item.nodeClass }}" itemId=\'{{= item.name }}\' title=\'{{= item.tooltip}}\'><p class="wrap"><b class="icon {{= item.iconClass }}"></b>{{= _.escapeHTML(item.label) }}</p></li>\n{{ }); }}'}),define("adhoc/calculatedFields/view/SimpleSelectListView",["require","common/extension/jQueryDoubletapExtension","underscore","jquery","backbone","common/util/featureDetection","text!adhoc/calculatedFields/template/SimpleSelectListTemplate.htm"],function(e){e("common/extension/jQueryDoubletapExtension");var t=e("underscore"),i=e("jquery"),n=e("backbone"),o=e("common/util/featureDetection"),s=e("text!adhoc/calculatedFields/template/SimpleSelectListTemplate.htm");return n.View.extend({template:t.template(s),events:{mousedown:"clickHandler"},initialize:function(){o.supportsTouch?this.$el.doubletap(t.bind(this.dblClickHandler,this)):this.events.dblclick="dblClickHandler"},render:function(e){this.$el.empty();var t={};return t.items=e,this.$el.html(this.template(t)),this},clickHandler:function(e){this.triggerEvent(e,"item:click")},dblClickHandler:function(e){this.triggerEvent(e,"item:dblClick")},triggerEvent:function(e,t){var n=e.target.match(".pickList li")?e.target:i(e.target).parents(".pickList li")[0];n&&(this.clearSelection(),i(n).addClass("selected"),this.trigger(t,n.readAttribute("itemId")))},clearSelection:function(){this.$el.find("li.selected").removeClass("selected")}})}),define("text!adhoc/calculatedFields/template/ExpressionEditorTemplate.htm",[],function(){return'<!-- Expression -->\n<div class="group">\n    <label class="control shorter textArea">\n        <span class="wrap">{{= title }}</span>\n        <textarea></textarea>\n    </label>\n</div>\n\n<!-- Available Operators -->\n<div class="group inputSet">\n    <ul class="expressionEditorOperators">\n        {{_.each(operators, function(item) { }}\n            <li class="button math" type="" value="{{= item.id }}" name=""><span class="icon icon-{{= item.id }}"></span></li>\n        {{ }); }}\n    </ul>\n</div>\n\n\n<ul class="list inputRow">\n\n    <!-- Available Fields -->\n    <li class="node">\n        <div class="group expressionEditorFieldsList">\n            <fieldset class="control standAlone pickList">\n                <label title="{{= i18n.ADH_421_AVAILABLE_FIELDS_TIP }}" class="control standAlone availableValues">\n                    <span class="wrap">{{= i18n.ADH_421_AVAILABLE_FIELDS }}</span>\n                    <ul class="list pickList" > </ul>\n                </label>\n            </fieldset>\n        </div>\n    </li>\n\n    <!-- Available Functions -->\n    <li class="node">\n        <div class="group expressionEditorFunctionsList">\n            <fieldset class="control standAlone pickList">\n                <label title="{{= i18n.ADH_421_AVAILABLE_FUNCTIONS_TIP }}" class="control standAlone availableValues">\n                    <span class="wrap">{{= i18n.ADH_421_AVAILABLE_FUNCTIONS }}</span>\n                    <ul class="list pickList" > </ul>\n                </label>\n            </fieldset>\n        </div>\n    </li>\n\n    <!-- Function Description -->\n    <li class="node">\n        <div class="group">\n            <span class="wrap label">{{= i18n.ADH_421_FUNCTION_DESCRIPTION }}</span>\n            <div class="description">\n                <p class="title"> </p>\n                <p class="text"> </p>\n                <p class="code"> </p>\n            </div>\n        </div>\n        <div class="group">\n            <div class="control checkBox">\n                <label title="{{= i18n.ADH_421_SHOW_ARGS_TIP }}" class="wrap">{{= i18n.ADH_421_SHOW_ARGS }}</label>\n                <input type="checkbox" checked="checked">\n            </div>\n        </div>\n    </li>\n</ul>\n\n<!-- Validate button -->\n<div class="group expressionEditorValidate">\n    <button type="button" class="button action">\n        <span class="wrap">{{= i18n["button.validate"] }}\n            <span class="icon"></span>\n        </span>\n    </button>\n    <span class="message warning"></span>\n</div>\n'}),function(e,t,i){var n=function(e){var n={text:"",start:0,end:0};if(!e.value)return n;try{if(t.getSelection)n.start=e.selectionStart,n.end=e.selectionEnd,n.text=e.value.slice(n.start,n.end);else if(i.selection){e.focus();var o=i.selection.createRange(),s=i.body.createTextRange();n.text=o.text;try{s.moveToElementText(e),s.setEndPoint("StartToStart",o)}catch(r){s=e.createTextRange(),s.setEndPoint("StartToStart",o)}n.start=e.value.length-s.text.length,n.end=n.start+o.text.length}}catch(r){}return n},o={getPos:function(e){var t=n(e);return{start:t.start,end:t.end}},setPos:function(e,i,n){n=this._caretMode(n),"start"==n?i.end=i.start:"end"==n&&(i.start=i.end),e.focus();try{if(e.createTextRange){var o=e.createTextRange();t.navigator.userAgent.toLowerCase().indexOf("msie")>=0&&(i.start=e.value.substr(0,i.start).replace(/\r/g,"").length,i.end=e.value.substr(0,i.end).replace(/\r/g,"").length),o.collapse(!0),o.moveStart("character",i.start),o.moveEnd("character",i.end-i.start),o.select()}else e.setSelectionRange&&e.setSelectionRange(i.start,i.end)}catch(s){}},getText:function(e){return n(e).text},_caretMode:function(e){switch(e=e||"keep",e===!1&&(e="end"),e){case"keep":case"start":case"end":break;default:e="keep"}return e},replace:function(t,i,o){var s=n(t),r=t.value,a=e(t).scrollTop(),l={start:s.start,end:s.start+i.length};t.value=r.substr(0,s.start)+i+r.substr(s.end),e(t).scrollTop(a),this.setPos(t,l,o)},insertBefore:function(t,i,o){var s=n(t),r=t.value,a=e(t).scrollTop(),l={start:s.start+i.length,end:s.end+i.length};t.value=r.substr(0,s.start)+i+r.substr(s.start),e(t).scrollTop(a),this.setPos(t,l,o)},insertAfter:function(t,i,o){var s=n(t),r=t.value,a=e(t).scrollTop(),l={start:s.start,end:s.end};t.value=r.substr(0,s.end)+i+r.substr(s.end),e(t).scrollTop(a),this.setPos(t,l,o)}};e.extend({selection:function(n){var o="text"==(n||"text").toLowerCase();try{if(t.getSelection){if(o)return t.getSelection().toString();var s,r=t.getSelection();return r.getRangeAt?s=r.getRangeAt(0):(s=i.createRange(),s.setStart(r.anchorNode,r.anchorOffset),s.setEnd(r.focusNode,r.focusOffset)),e("<div></div>").append(s.cloneContents()).html()}if(i.selection)return o?i.selection.createRange().text:i.selection.createRange().htmlText}catch(a){}return""}}),e.fn.extend({selection:function(e,t){switch(t=t||{},e){case"getPos":return o.getPos(this[0]);case"setPos":return this.each(function(){o.setPos(this,t)});case"replace":return this.each(function(){o.replace(this,t.text,t.caret)});case"insert":return this.each(function(){"before"==t.mode?o.insertBefore(this,t.text,t.caret):o.insertAfter(this,t.text,t.caret)});case"get":default:return o.getText(this[0])}return this}})}(jQuery,window,window.document),define("jquery.selection",["jquery"],function(e){return function(){var t;return t||e.jQuery}}(this)),define("adhoc/calculatedFields/view/ExpressionEditorView",["require","underscore","jquery","backbone","bundle!jasperserver_messages","bundle!adhoc_messages","adhoc/calculatedFields/factory/codeExampleFactory","adhoc/calculatedFields/view/SimpleSelectListView","common/util/featureDetection","text!adhoc/calculatedFields/template/ExpressionEditorTemplate.htm","underscore.string","jquery.selection"],function(e){var t=e("underscore"),i=e("jquery"),n=e("backbone"),o=t.extend(e("bundle!jasperserver_messages"),e("bundle!adhoc_messages")),s=e("adhoc/calculatedFields/factory/codeExampleFactory"),r=e("adhoc/calculatedFields/view/SimpleSelectListView"),a=e("common/util/featureDetection"),l=e("text!adhoc/calculatedFields/template/ExpressionEditorTemplate.htm");return e("underscore.string"),e("jquery.selection"),n.View.extend({template:t.template(l),events:{"keyup .control.textArea textarea":"onExpressionEdit","click .expressionEditorOperators li.button.math":"operatorClick","click .expressionEditorValidate .button":"validateButton"},initialize:function(e){this.assignedAttribute=e.assignedAttribute,this.title=e.title?e.title:"",this.lastSelectionPos={start:0,end:0},this.listenTo(this.model,"change:"+this.assignedAttribute,this.setExpression),this.listenTo(this.model,"change:availableFields",this.renderFields),this.listenTo(this.model,"change:availableFunctions",this.renderFunctions),this.listenTo(this.model,"invalid:"+this.assignedAttribute,this.setError)},render:function(){var e={i18n:o,title:this.title,operators:this.model.get("operators")};return this.$el.empty(),this.$el.html(this.template(e)),this.expressionInput=this.$(".control.textArea textarea"),enableSelection(this.expressionInput.parent()[0]),enableSelection(this.$(".inputRow .description p.text")[0]),this},renderFields:function(){var e=new r({el:this.$el.find(".expressionEditorFieldsList ul")});this.listenTo(e,"item:dblClick",this.fieldDblClick),!a.supportsModernSelection&&this.listenTo(e,"item:click",this.resetSelectionPos);var i=this.model.get("availableFields");i.length>0&&e.render(t.chain(i).map(function(e){return{name:e.id,label:e.label,tooltip:e.tooltip,nodeClass:e.expression?"calculated":"",iconClass:"DIMENSION"===e.kind?"field":"measure"}}).sortBy("label").value())},renderFunctions:function(){var e=new r({el:this.$el.find(".expressionEditorFunctionsList ul")});this.listenTo(e,"item:click",this.functionClick),this.listenTo(e,"item:dblClick",this.functionDblClick);var i=this.model.get("availableFunctions");i.length>0&&e.render(t.chain(i).map(function(e){return{name:e.name,label:e.name,iconClass:"function"}}).sortBy(function(e){return e.name.toUpperCase()}).value())},successMessage:function(){this.clearMessages(),this.$(".expressionEditorValidate.group span.message.warning").text(o["adh.calculated.fields.validation.successful"]),this.$(".expressionEditorValidate.group span.message.warning").addClass("success"),this.$(".expressionEditorValidate.group").addClass("error")},errorMessage:function(e){var t=e?e:"";this.clearMessages(),this.$(".expressionEditorValidate.group span.message.warning").text(t),this.$(".control.textArea").addClass("error"),this.$(".expressionEditorValidate.group").addClass("error")},clearMessages:function(){this.$(".control.textArea").removeClass("error"),this.$(".expressionEditorValidate.group").removeClass("error"),this.$(".expressionEditorValidate.group span.message.warning").removeClass("success")},operatorClick:function(e){var n=e.target.hasClassName("math")?e.target:i(e.target).parent("li.math")[0];if(n){var o=n.readAttribute("value"),s=t.find(this.model.get("operators"),function(e){return e.id===o});this.insertText(s.value)}},fieldDblClick:function(e){var i=t.find(this.model.get("availableFields"),function(t){return t.id===e});this.updateSelectionPos(),this.insertText(i.alias)},updateSelectionPos:function(){var e=this;!a.supportsModernSelection&&this.expressionInput.selection("setPos",{start:e.lastSelectionPos.start,end:e.lastSelectionPos.end})},resetSelectionPos:function(){a.supportsModernSelection||(this.lastSelectionPos=this.expressionInput.selection("getPos"))},functionClick:function(e){var t=o["adh.calculated.fields.function.description."+e];this.resetSelectionPos(),this.$(".inputRow .description p.title").text(e),this.$(".inputRow .description p.text").text(t?t:""),this.$(".inputRow .description p.code").text(s(e,!0))},functionDblClick:function(e){var t=this.$(".control.checkBox input")[0].checked,i=s(e,t);this.updateSelectionPos(),this.insertText(i)},insertText:function(e){var i=e,n=this.expressionInput.val()[this.expressionInput.selection("getPos").start-1],o=this.expressionInput.val()[this.expressionInput.selection("getPos").end];'"'===n&&'"'===o?i=t.trim(i,'"'):(n&&!t.contains([" ","("],n)&&")"!==i&&(i=" "+i),o&&!t.contains([" ",")",","],o)&&"("!==i&&(i+=" ")),this.clearMessages(),this.expressionInput.selection("replace",{text:i});var s=this.expressionInput.selection("getPos").end;this.expressionInput.selection("setPos",{start:s,end:s}),this.model.set(this.assignedAttribute,this.expressionInput.val(),{silent:!0})},setExpression:function(){var e=this.model.get(this.assignedAttribute);this.clearMessages(),this.expressionInput.val(e)},setError:function(e){this.errorMessage(e.errorCode?o[e.errorCode]:e.errorMessage)},onExpressionEdit:function(e){this.clearMessages(),this.model.set(this.assignedAttribute,i(e.target).val(),{silent:!0}),this.model.isExpressionValid(this.assignedAttribute)},validateButton:function(){this.model.trigger("validate:"+this.assignedAttribute,t.bind(this.successMessage,this))}})}),define("text!adhoc/calculatedFields/template/SummaryTabTemplate.htm",[],function(){return'<ul class="list inputRow">\n    <li class="node">\n        <div class="group">\n            <label title="{{= i18n.ADH_410_CALCULATION_TIP }}" class="control select">\n                <span class="wrap">{{= i18n.ADH_410_CALCULATION }}</span>\n                <select name="availableSummaries" class="availableSummaries">\n                </select>\n                <span class="message warning"> </span>\n            </label>\n        </div>\n    </li>\n\n    <li class="node">\n\n        <div class="weightedOnFieldsList group hidden">\n            <div class="control">\n                <label title="{{= i18n.ADH_410_WEIGHTED_ON_TIP }}" class="weightedOnInput control input">\n                    <span class="wrap">{{= i18n.ADH_410_WEIGHTED_ON }}</span>\n                    <input type="text" value="" disabled="disabled">\n                    <span class="message warning"> </span>\n                </label>\n            </div>\n\n            <fieldset class="control standAlone pickList">\n                <label title="{{= i18n.ADH_421_AVAILABLE_FIELDS_TIP }}" class="control availableValues">\n                    <span class="wrap">{{= i18n.ADH_421_AVAILABLE_FIELDS }}</span>\n                    <ul class="list pickList" > </ul>\n                </label>\n            </fieldset>\n        </div>\n    </li>\n</ul>\n\n<div class="customSummaryEditor hidden"> </div>\n'}),define("adhoc/calculatedFields/view/SummaryCalculationView",["require","underscore","jquery","backbone","bundle!adhoc_messages","adhoc/calculatedFields/view/ExpressionEditorView","adhoc/calculatedFields/view/SimpleSelectListView","text!adhoc/calculatedFields/template/SummaryTabTemplate.htm"],function(e){var t=e("underscore"),i=e("jquery"),n=e("backbone"),o=e("bundle!adhoc_messages"),s=e("adhoc/calculatedFields/view/ExpressionEditorView"),r=e("adhoc/calculatedFields/view/SimpleSelectListView"),a=e("text!adhoc/calculatedFields/template/SummaryTabTemplate.htm");return n.View.extend({template:t.template(a),events:{"change .availableSummaries":"summaryFunctionsChange"},initialize:function(){this.customSummaryEditor=new s({assignedAttribute:"summaryExpression",model:this.model}),this.listenTo(this.model,"change:availableFields",this.renderWeightedOnFields),this.listenTo(this.model,"change:availableSummaryFunctions",this.renderAvailableSummaries),this.listenTo(this.model,"change:summaryFunction",this.updateSummaryFunction),this.listenTo(this.model,"change:summaryParameter",this.updateSummaryParameter),this.listenTo(this.model,"change:availableFields",this.updateSummaryParameter),this.listenTo(this.model,"invalid:summaryParameter",this.showSummaryParameterError)
},summaryFunctionsChange:function(e){this.model.set("summaryFunction",i(e.target).val()),this.updateLayout()},render:function(){return this.$el.empty(),this.$el.html(this.template({i18n:o})),this.customSummaryEditor.setElement(".customSummaryEditor").render(),this},renderWeightedOnFields:function(){var e=new r({el:this.$el.find(".weightedOnFieldsList ul")}),i=this;this.listenTo(e,"item:click",function(e){i.model.set("summaryParameter",e)});var n=this.model.get("availableFields");if(n.length>0){var o=t.filter(n,function(e){return t.contains(["java.lang.Double","java.math.BigDecimal","java.lang.Long","java.lang.Integer","java.lang.Short","java.lang.Byte"],e.type)});e.render(t.map(o,function(e){return{name:e.id,label:e.label,tooltip:e.tooltip,nodeClass:e.expression?"calculated":"",iconClass:"DIMENSION"===e.kind?"field":"measure"}}).sortBy(function(e){return e.label}))}},renderAvailableSummaries:function(){var e=t.sortBy(this.model.get("availableSummaryFunctions"),function(e){return"None"===e?"AAA":e}),i=this.$(".availableSummaries").empty();t.each(e,function(e){i.append("<option value='"+e+"'>"+e+"</option>")}),i.val(this.model.get("summaryFunction")),this.updateLayout()},updateSummaryFunction:function(){this.renderAvailableSummaries()},updateSummaryParameter:function(){this.$("label.weightedOnInput.control").removeClass("error");var e=this.model.get("summaryParameter"),i=t.find(this.model.get("availableFields"),function(t){return t.id===e});i&&this.$(".weightedOnInput input").val(i.label)},showSummaryParameterError:function(e){var t=this.$(".weightedOnInput .message.warning"),i=e.errorCode?o[e.errorCode]:e.errorMessage;t.text(i?i:""),t.parent().addClass("error")},updateLayout:function(){var e=this.model.get("summaryFunction");"WeightedAverage"===e?(this.$(".weightedOnFieldsList").removeClass("hidden"),this.$(".customSummaryEditor").addClass("hidden")):"Custom"===e?(this.$(".weightedOnFieldsList").addClass("hidden"),this.$(".customSummaryEditor").removeClass("hidden")):(this.$(".weightedOnFieldsList").addClass("hidden"),this.$(".customSummaryEditor").addClass("hidden"))}})}),define("adhoc/calculatedFields/view/CalculatedFieldView",["require","jquery","underscore","backbone","bundle!adhoc_messages","adhoc/calculatedFields/model/CalculatedFieldModel","text!adhoc/calculatedFields/template/CalculatedFieldTemplate.htm","adhoc/calculatedFields/factory/operatorsFactory","adhoc/calculatedFields/view/SummaryCalculationView","adhoc/calculatedFields/view/ExpressionEditorView"],function(e){var t=e("jquery"),i=e("underscore"),n=e("backbone"),o=e("bundle!adhoc_messages"),s=e("adhoc/calculatedFields/model/CalculatedFieldModel"),r=e("text!adhoc/calculatedFields/template/CalculatedFieldTemplate.htm"),a=e("adhoc/calculatedFields/factory/operatorsFactory"),l=e("adhoc/calculatedFields/view/SummaryCalculationView"),c=e("adhoc/calculatedFields/view/ExpressionEditorView");return n.View.extend({template:i.template(r),events:{"click .formulaBuilderTab":"formulaTabClick","click .summaryCalcTab":"summaryTabClick","keyup .fieldLabelInput":"onFieldLabelChange"},initialize:function(){this.model=new s({operators:a}),this.formulaEditor=new c({assignedAttribute:"expression",title:o.ADH_421_FORMULA,model:this.model}),this.summaryTab=new l({model:this.model}),this.listenTo(this.model,"change:fieldLabel",this.updateFieldLabel),this.listenTo(this.model,"change:kind",this.setNameInputLabel),this.listenTo(this.model,"invalid:fieldLabel",this.showFieldLabelError),this.listenTo(this.model,"invalid:summaryExpression",this.showSummaryTab),this.listenTo(this.model,"invalid:summaryParameter",this.showSummaryTab)},render:function(){this.$el.empty(),this.$el.html(this.template({i18n:o})),this.formulaEditor.setElement(".formulaBuilderSection").render(),this.summaryTab.setElement(".summaryCalcSection").render();var e=this.$(".fieldLabelInput");return enableSelection(e.parent()[0]),setTimeout(function(){e.focus()},500),this},setNameInputLabel:function(){var e="MEASURE"===this.model.get("kind"),t=e?"ADH_402_MEASURE_NAME":"ADH_402_FIELD_NAME",i=e?"ADH_402_MEASURE_NAME_TIP":"ADH_402_FIELD_NAME_TIP";if(this.$(".measureNameSection label.control.input span.wrap").text(o[t]),this.$(".measureNameSection label.control.input").attr("title",o[i]),!this.isEdit){var n=e?o.ADH_403_NEW_MEASURE_DEFAULT_NAME:o.ADH_403_NEW_FIELD_DEFAULT_NAME;this.model.set("fieldLabel",n?n:"")}},updateFieldLabel:function(){var e=this.$(".fieldLabelInput");e.val(this.model.get("fieldLabel"));var t=e.val().length;e.selection("setPos",{start:t,end:t})},onFieldLabelChange:function(e){this.$(".measureNameSection label.control").removeClass("error"),this.model.set("fieldLabel",t(e.target).val(),{silent:!0}),this.model.isLabelValid()},showFieldLabelError:function(e){var t=this.$(".measureNameSection .message.warning"),i=e.errorCode?o[e.errorCode]:e.errorMessage;t.text(i?i:""),t.parent().addClass("error")},showFormulaTab:function(){this.$(".formulaBuilderTab").addClass("selected"),this.$(".formulaBuilderTab a").removeClass("over"),this.$(".summaryCalcTab").removeClass("selected"),this.$(".summaryCalcSection").addClass("hidden"),this.$(".formulaBuilderSection").removeClass("hidden")},showSummaryTab:function(){this.$(".summaryCalcTab").addClass("selected"),this.$(".summaryCalcTab a").removeClass("over"),this.$(".formulaBuilderTab").removeClass("selected"),this.$(".formulaBuilderSection").addClass("hidden"),this.$(".summaryCalcSection").removeClass("hidden")},formulaTabClick:function(){this.$(".formulaBuilderTab.selected")[0]||this.showFormulaTab()},summaryTabClick:function(){this.$(".summaryCalcTab.selected")[0]||this.model.trigger("validate:expression",i.bind(this.showSummaryTab,this))}})}),define("adhoc/calculatedFields/CalculatedFieldsController",["require","underscore","backbone","adhoc/calculatedFields/view/CalculatedFieldView"],function(e){var t=e("underscore"),i=e("backbone"),n=e("adhoc/calculatedFields/view/CalculatedFieldView");return i.View.extend({initialize:function(e){this.service=e.service,this.view=new n({el:e.element}),this.view.listenTo(this.view.model,"validate:expression",t.bind(this._validateExpression,this)),this.view.listenTo(this.view.model,"validate:summaryExpression",t.bind(this._validateCustomSummary,this))},start:function(e){e=e||{},this.view.isEdit=e.editingMode,this.view.render(),this._fetchFieldsAndFunctions(),this._setFieldMetadata(e)},stop:function(){this.view.stopListening(this.view.model),this.view.undelegateEvents()},applyField:function(){if(this.view.model.isValidField()){var e=this.view.isEdit?this.service.update.bind(this.service):this.service.add.bind(this.service);return e(this.view.model.toRequest(),this.view.model.get("fieldName")).done(t.bind(function(e){this.trigger("field:applied",e)},this)).fail(t.bind(this._handleServerError,this))}},_setFieldMetadata:function(e){this.view.isEdit&&e.selectedFieldName?this.service.get(e.selectedFieldName).done(t.bind(function(e){var t=e;this.view.model.populateFromField(t),this.trigger("field:loaded","MEASURE"===t.kind,!0)},this)):(this.view.model.set("kind",e.kind),this.trigger("field:loaded","MEASURE"===e.kind,!1))},_fetchFieldsAndFunctions:function(){this.service.fetchFieldsList().done(t.bind(function(e){this.view.model.set("availableFields",e)},this)),this.service.fetchFunctionsList().done(t.bind(function(e){this.view.model.set("availableFunctions",e)},this))},_handleServerError:function(e){if(500!==e.status){var t=JSON.parse(e.responseText);if(t&&t.parameters&&t.parameters[0]){var i=t.parameters[0];i="label"==i?"fieldLabel":i,this.view.model.trigger("invalid:"+i,{errorMessage:t.message})}}},_validateExpression:function(e){if(this.view.model.isExpressionValid("expression")){var i={expression:this.view.model.get("expression"),kind:this.view.model.get("kind")};this.service.validate(i).done(t.bind(function(t){this.view.model.set("availableSummaryFunctions",t.availableSummaries),this.view.model.isSummaryFunctionValid()||this.view.model.set("summaryFunction",t.summaryFunction),e&&e()},this)).fail(t.bind(function(e){this._handleServerError(e)},this))}},_validateCustomSummary:function(e){if(this.view.model.isExpressionValid("summaryExpression")){var i={expression:this.view.model.get("expression"),summaryFunction:this.view.model.get("summaryFunction"),summaryExpression:this.view.model.get("summaryExpression")};this.service.validate(i).done(t.bind(function(t){e&&e(t)},this)).fail(t.bind(function(e){this._handleServerError(e)},this))}}})}),define("adhoc/designer.calculatedFields",["require","bundle!jasperserver_messages","bundle!adhoc_messages","adhoc/calculatedFields/CalculatedFieldsController","adhoc/calculatedFields/CalculatedFieldsService"],function(e){var t,i=_.extend(e("bundle!jasperserver_messages"),e("bundle!adhoc_messages")),n=e("adhoc/calculatedFields/CalculatedFieldsController"),o=e("adhoc/calculatedFields/CalculatedFieldsService");return window.adhocCalculatedFields={DIALOG_ID:"calcFieldMeasure",FIELDS_CONTAINER_ID:"#calculatedFields-container",calcFieldsService:new o({clientKey:clientKey}),showDialog:function(e){t=$(this.DIALOG_ID),t.down("button.doneButton").observe("click",e.applyField.bind(e)),t.down("button.cancelButton").observe("click",function(){e.stop(),this.closeDialog()}.bind(this)),dialogs.popup.show(t),t.style.marginTop="0",t.style.top="15px"},closeDialog:function(){Event.stopObserving(t.down("button.doneButton")),Event.stopObserving(t.down("button.cancelButton")),dialogs.popup.hide(t)},setDialogLabels:function(e,n){var o=e?{dialogHeader:n?"ADH_401_DIALOG_HEADER_EDIT_CUSTOM_MEASURE":"ADH_401_DIALOG_HEADER_NEW_CUSTOM_MEASURE",okButtonLabel:n?"button.save":"ADH_430_BUTTON_CREATE_MEASURE"}:{dialogHeader:n?"ADH_401_DIALOG_HEADER_EDIT_CUSTOM_FIELD":"ADH_401_DIALOG_HEADER_NEW_CUSTOM_FIELD",okButtonLabel:n?"button.save":"ADH_430_BUTTON_CREATE_FIELD"};$(t.down(".header.mover > .title")).update(i[o.dialogHeader]),$(t.down(".footer button.doneButton span.wrap")).update(i[o.okButtonLabel])},createField:function(e){var t=new n({element:this.FIELDS_CONTAINER_ID,service:this.calcFieldsService});t.listenTo(t,"field:loaded",this.setDialogLabels.bind(this)),t.listenTo(t,"field:applied",function(e){t.stop(),this.closeDialog(),this.createCustomFieldCallback(e)}.bind(this)),this.showDialog(t),t.start({editingMode:!1,kind:e})},updateField:function(){var e=designerBase.getSelectedObject(),t=e.model?e.model.fieldName:adhocDesigner.getNameForSelected(e);if(null==t)throw'The field "'+t+'" is not found.';var i=new n({element:this.FIELDS_CONTAINER_ID,service:this.calcFieldsService});i.listenTo(i,"field:loaded",this.setDialogLabels.bind(this)),i.listenTo(i,"field:applied",function(e){i.stop(),this.closeDialog(),this.updateCustomFieldCallback(e)}.bind(this)),this.showDialog(i),i.start({editingMode:!0,selectedFieldName:t})},deleteField:function(){var e=designerBase.getSelectedObject(),t=adhocDesigner.getNameForSelected(e);if(adhocDesigner.isInUse(t))throw"The field in use.";var i=function(i){this.deleteCustomFieldCallback(t,e,i),adhocDesigner.enableCanUndoRedo()}.bind(adhocCalculatedFields);this.calcFieldsService.remove(t).done(_.bind(function(e,t,n){if(204===n.status)throw"Field not found.";adhocCalculatedFields._updateState(i)},this))},createCustomFieldCallback:function(e){var t="MEASURE"===e.kind;dialogs.systemConfirm.show(i[t?"ADH_435_CALCULATED_MEASURE_ADDED":"ADH_435_CALCULATED_FIELD_ADDED"],5e3),adhocCalculatedFields._updateState(function(i){var n=localContext.state.allColumns.length;if(adhocCalculatedFields._updateLocalContextFromState(i),adhocDesigner.enableCanUndoRedo(),localContext.state.allColumns.length>n){var o=e.name,s=adhocDesigner.getFieldIndexByName(o),r=adhocDesigner.findFieldByName(o).type,a={id:o,label:e.display,type:"com.jaspersoft.jasperserver.api.metadata.common.domain.NewNode",uri:"/"+o,cssClass:"calculatedField",order:s,extra:{id:o,name:o,isMeasure:t,dimensionId:t?adhocDesigner.MEASURES:o,dataType:r}},l=t?adhocDesigner.measuresTree:adhocDesigner.dimensionsTree;adhocDesigner.addNodeToTree(a,l),adhocDesigner.updateAllFieldLabels()}})},updateCustomFieldCallback:function(e){var t="MEASURE"===e.kind;dialogs.systemConfirm.show(i[t?"ADH_435_CALCULATED_MEASURE_UPDATED":"ADH_435_CALCULATED_FIELD_UPDATED"],5e3),adhocCalculatedFields._updateState(function(t){adhocCalculatedFields._updateLocalContextFromState(t),adhocDesigner.enableCanUndoRedo(),adhocDesigner.isInUse(e.name)&&(localContext.updateViewCallback(t),adhocDesigner.filtersController.setFilters(t,{reset:!0})),adhocDesigner.updateAllFieldLabels()})},deleteCustomFieldCallback:function(e,t,n){var o=t.param.extra.isMeasure;dialogs.systemConfirm.show(i[o?"ADH_435_CALCULATED_MEASURE_DELETED":"ADH_435_CALCULATED_FIELD_DELETED"],5e3);var s=localContext.state.allColumns.length;this._updateLocalContextFromState(n),adhocDesigner.enableCanUndoRedo(),localContext.state.allColumns.length<s&&t&&(adhocDesigner.removeNodeFromTree(t),adhocDesigner.updateAllFieldLabels())},_updateState:function(e){designerBase.sendRequest(adhocDesigner.getControllerPrefix()+"_loadState",[],function(t){e(t)})},_updateLocalContextFromState:function(e){localContext.state.allColumns=e.allColumns,localContext.state.canRedo=e.canRedo,localContext.state.canUndo=e.canUndo}},window.adhocCalculatedFields});var adhocSort={TEMPLATE_ID:"sortDialog",SORT_FIELDS_LIST_TEMPLATE_ID:"list_fields_hideRoot_column_simple",SORT_FIELDS_ITEM_TEMPLATE_ID:"list_fields_hideRoot_column_simple:leaf",AVAILABLE_ID:"sortDialogAvailable",AVAILABLE_FIELDS_PROVIDER_ID:"availableFieldsTreeDataProvider",SORT_FIELDS_ID:"sortDialogSortFields",OK_PATTERN:"#sortDialogOk",CANCEL_PATTERN:"#sortDialogCancel",ADD_PATTERN:"#sortDialogAddToSort",TO_TOP_PATTERN:"#sortDialogToTop",TO_BOTTOM_PATTERN:"#sortDialogToBottom",UP_PATTERN:"#sortDialogUpward",DOWN_PATTERN:"#sortDialogDownward",REMOVE_PATTERN:"#sortDialogRemoveFromSort",BUTTON_PATTERN:"#sortDialogSortFields .icon.button",DROP_CLASS:"dragging",SORT_DRAG_CLASS:".draggable",EVENT:{SORT:"sort:sort"},initialize:function(){this.originalSortFields=[],this.preselectedFieldNames=null,this._dialog=$(this.TEMPLATE_ID),this._add=$$(this.ADD_PATTERN)[0],this._remove=$$(this.REMOVE_PATTERN)[0],this._ok=$$(this.OK_PATTERN)[0],this._cancel=$$(this.CANCEL_PATTERN)[0],this._toTop=$$(this.TO_TOP_PATTERN)[0],this._toBottom=$$(this.TO_BOTTOM_PATTERN)[0],this._up=$$(this.UP_PATTERN)[0],this._down=$$(this.DOWN_PATTERN)[0],this.tree=this.createAvailableFieldsTree(),this.list=this.createSortFieldsList(),this.actionHash={"#sortDialogOk":function(){this.hideDialog()},"#sortDialogCancel":function(){this.fire(this.EVENT.SORT,{fields:this.originalSortFields,hide:!0})},"#sortDialogAddToSort":function(){this._addToSort()},"#sortDialogRemoveFromSort":function(){this._removeFromSort()},"#sortDialogUpward":function(){this._oneStepMoveTo(!0)},"#sortDialogDownward":function(){this._oneStepMoveTo(!1)},"#sortDialogToTop":function(){this._moveTo(!0)},"#sortDialogToBottom":function(){this._moveTo(!1)},"li .icon.button":function(e){this._toggleSortOrder(this.list.getItemByEvent(e))}},this.actionHash.getAction=function(e){for(var t in this)if(e.match(t)&&"getAction"!=t)return this[t];return doNothing},this.observe("sort:sort",function(e){adhocDesigner.setSorting(e.memo.fields,function(){e.memo.hide&&adhocSort.hideDialog()})}),this._dialog.observe(isSupportsTouch()?"touchend":"mouseup",function(e){var t=e.element(),i=matchAny(t,[this.ADD_PATTERN,this.REMOVE_PATTERN,this.OK_PATTERN,this.CANCEL_PATTERN,this.BUTTON_PATTERN,this.UP_PATTERN,this.DOWN_PATTERN,this.TO_TOP_PATTERN,this.TO_BOTTOM_PATTERN],!0);i&&this.actionHash.getAction(i).bind(this)(e)}.bindAsEventListener(this))},updateAndShowAvailableFieldsTree:function(e){var t=function(){this.tree=this.createAvailableFieldsTree(e),this.tree.showTree(20)}.bind(this);designerBase.sendRequest(adhocDesigner.getControllerPrefix()+"_updateAvailableTree",[],t,{target:"ajaxbuffer",bPost:!0})},createAvailableFieldsTree:function(e){var t=adhocDesigner.getAvailableFieldsTree(this.AVAILABLE_ID,adhocSort.AVAILABLE_FIELDS_PROVIDER_ID);if(t.DEFAULT_TREE_CLASS_NAME="responsive fields",t.multiSelectEnabled=!0,isIPad()){var i=$(this.AVAILABLE_ID);new TouchController(i,i.up(1))}t.observe("tree:loaded",function(){_.each(adhocDesigner.getAllLeaves(null,t),function(e){var t=adhocDesigner.findFieldByName(e.param.id);t.aggregateField&&adhocDesigner.removeNodeFromTree(e)}),e&&e.length>0&&e.each(function(e){t.openAndSelectNode(e)}.bind(this)),this._addSortFieldsToList(),buttonManager.disable(this._add)}.bindAsEventListener(this)),t.observe("leaf:dblclick",function(e){this._addToSort(e.memo.node)}.bindAsEventListener(this));var n=this._refreshAddButton;return t.observe("leaf:selected",n.bindAsEventListener(this)),t.observe("node:selected",n.bindAsEventListener(this)),t.observe("leaf:unselected",n.bindAsEventListener(this)),t.observe("node:unselected",n.bindAsEventListener(this)),Droppables.remove(t.getId()),Droppables.add(t.getId(),{accept:[this.SORT_FIELDS_ID],hoverclass:layoutModule.DROP_TARGET_CLASS,onDrop:function(e){e.items&&this._removeFromSort()}.bind(this)}),t},createSortFieldsList:function(){var e=new dynamicList.List(this.SORT_FIELDS_ID,{listTemplateDomId:this.SORT_FIELDS_LIST_TEMPLATE_ID,itemTemplateDomId:this.SORT_FIELDS_ITEM_TEMPLATE_ID,excludeFromSelectionTriggers:[this.BUTTON_PATTERN],dragPattern:isIPad()?void 0:this.SORT_DRAG_CLASS,multiSelect:!0,selectOnMousedown:!isIPad(),comparator:function(e,t){var i=e.getValue().order,n=t.getValue().order;return i>n?1:n>i?-1:0}});return e.observe("item:selected",function(){e.getSelectedItems().length>0&&buttonManager.enable(this._remove),this._refreshMoveButtons()}.bindAsEventListener(this)),e.observe("item:unselected",function(){0==e.getSelectedItems().length&&buttonManager.disable(this._remove),this._refreshMoveButtons()}.bindAsEventListener(this)),e.observe("item:dblclick",function(e){this._removeFromSort(e.memo.item)}.bindAsEventListener(this)),Droppables.add($(this.SORT_FIELDS_ID),{accept:[this.AVAILABLE_ID],hoverclass:layoutModule.DROP_TARGET_CLASS,onDrop:function(e){e.node&&this._addToSort()}.bind(this)}),e},createSortFieldItem:function(e){var t=new dynamicList.ListItem({label:e.label.unescapeHTML(),value:e});return t.refreshStyle=function(){dynamicList.ListItem.prototype.refreshStyle.call(this);var e=this.getValue().isAsc;e?(this._getElement().addClassName(layoutModule.ASCENDING_CLASS),this._getElement().removeClassName(layoutModule.DESCENDING_CLASS)):(this._getElement().addClassName(layoutModule.DESCENDING_CLASS),this._getElement().removeClassName(layoutModule.ASCENDING_CLASS))},t},recreateSortFieldsScroll:function(){if(isIPad()){var e=$(this.SORT_FIELDS_ID);return new TouchController(e,e.up(1))}return null},getSortFields:function(){return this.list.getItems().collect(function(e){var t=e.getValue();return t.toData()})},_isOriginalField:function(e){return this.originalSortFields.detect(function(t){return t.name==e}.bind(this))},_getMergedPreselectedWithOriginalFields:function(e){var t=this.originalSortFields?this.originalSortFields.slice(0):[],i=this;return jQuery(e).each(function(){var e=this.toString();i._isOriginalField(e)||t.push({name:e,isAsc:!0})}),t},_addSortFieldsToList:function(){var e=this._getMergedPreselectedWithOriginalFields(this.preselectedFieldNames),t=[],i=[],n=[],o=this;jQuery(e).each(function(e){var s=o.tree.findNodeById(this.name);if(s){var r=new adhocSort.Field(s,this.isAsc,e).item;t.push(s),o.preselectedFieldNames&&jQuery.inArray(this.name,o.preselectedFieldNames)>-1&&i.push(r),n.push(r)}}),this.list.setItems(n),jQuery(t).each(function(){this.refreshStyle()}),this.list.show(),this.recreateSortFieldsScroll(),jQuery(i).each(function(){this.select()}),e&&e.length!==(this.originalSortFields?this.originalSortFields.length:0)&&this.fire(this.EVENT.SORT,{fields:this.getSortFields(),hide:!1})},launchDialog:function(e){dialogs.popup.show(this._dialog),this.list.setItems([]),this.list.show(),[this._add,this._remove,this._up,this._down,this._toTop,this._toBottom].each(function(e){buttonManager.disable(e)}),this.originalSortFields=localContext.state.sortFields||[];var t=this.originalSortFields.collect(function(e){return adhocSort.Util.fieldNameToUriList(e.name)}).flatten();if(jQuery.isArray(e)){this.preselectedFieldNames=e;for(var i=0;i<e.length;i++)t=t.concat(adhocSort.Util.fieldNameToUriList(e[i]))}else this.preselectedFieldNames=e?[e]:null,e&&(t=t.concat(adhocSort.Util.fieldNameToUriList(e)));this.updateAndShowAvailableFieldsTree(t)},hideDialog:function(){dialogs.popup.hide(this._dialog)},stopObserving:function(e,t){this._dialog.stopObserving(e,t)},observe:function(e,t){this._dialog.observe(e,t)},fire:function(e,t){this._dialog.fire(e,t)},_isOnlyFieldsSelected:function(){return this.tree.getSelectedNode()&&!this.tree.selectedNodes.detect(function(e){return e.isParent()||e.param.id===designerBase.SPACER_NAME})},_getOnlyChildren:function(e){var t=[];return e.each(function(e){e.isParent()?t=t.concat(this._getOnlyChildren(e.childs)):t.push(e)}.bind(this)),t},_toggleSortOrder:function(e){e.getValue().isAsc=!e.getValue().isAsc,e.refresh(),this.fire(this.EVENT.SORT,{fields:this.getSortFields(),hide:!1})},_addToSort:function(e){if(this._isOnlyFieldsSelected()){var t=this._getOnlyChildren(e?[e]:this.tree.selectedNodes),i=this.list.getItems(),n=t.collect(function(e,t){return new adhocSort.Field(e,!0,i.length+t).item}.bind(this));this.list.addItems(n),t.invoke("refreshStyle"),t.invoke("deselect"),this.list.refresh(),this.fire(this.EVENT.SORT,{fields:this.getSortFields(),hide:!1}),this._refreshAddButton(),this._refreshMoveButtons()}},_removeFromSort:function(e){var t=e?[e]:this.list.getSelectedItems(),i=this.tree;this.list.removeItems(t),t.each(function(e){var t=e.getValue();i._deselectAllNodes(),t.node.hidden=!1,t.node.refreshStyle(),t.node.select()}),this.fire(this.EVENT.SORT,{fields:this.getSortFields(),hide:!1}),this._refreshMoveButtons()},_oneStepMoveTo:function(e){var t=this.list.getItems(),i=this.list.getSelectedItems();e||(t=t.clone().reverse());var n=e?-1:1,o=null;t.each(function(e){var t=i.detect(function(t){return t==e});t&&o?(o.getValue().order-=n,t.getValue().order+=n):o=e}),this._resort()},_moveTo:function(e){var t=this.list.getItems(),i=this.list.getSelectedItems(),n=t.findAll(function(e){return!i.include(e)});e||(i=i.clone().reverse(),n=n.clone().reverse());var o=e?1:-1,s=e?0:t.length,r=function(e){e.getValue().order=s,s+=o};i.each(r),n.each(r),this._resort()},_resort:function(){this.list.sort(),this.list.show(),this._refreshMoveButtons(),this.fire(this.EVENT.SORT,{fields:this.getSortFields(),hide:!1})},_refreshMoveButtons:function(){var e=this.list.getItems(),t=this.list.getSelectedItems(),i=e.length>1&&t.length>0,n=i&&!(1==t.length&&t[0].first),o=i&&!(1==t.length&&t[0].last);[this._toTop,this._up].each(function(e){(n?buttonManager.enable:buttonManager.disable)(e)}),[this._toBottom,this._down].each(function(e){(o?buttonManager.enable:buttonManager.disable)(e)})},_refreshAddButton:function(){(this._isOnlyFieldsSelected()?buttonManager.enable:buttonManager.disable)(this._add)}};adhocSort.Util={fieldNameToUri:function(e){return"/"+e},fieldNameToUriList:function(e){var t=".",i=e.split(t),n=i.slice(0,i.length-1).collect(function(e,t){return"/"+i.slice(0,t+1).join("/")});return n.length>0&&n.push(n.last()+"/"+e),n.push("/"+e),n},uriToFiledName:function(e){var t=e.split("/");return t[t.length-1]}},adhocSort.Field=function(e,t,i){this.name=adhocSort.Util.uriToFiledName(e.param.uri),this.label=e.name.escapeHTML(),this.isAsc=!!t,this.order=i||0,this.node=e,this.item=adhocSort.createSortFieldItem(this),this.node&&(this.node.hidden=!0)},adhocSort.Field.addMethod("toData",function(){return{name:this.name,isAsc:this.isAsc}}),adhocSort.Field.addMethod("toJSON",function(){return this.toData()}),define("adhoc/designer.sort",["prototype","utils.common"],function(e){return function(){var t;return t||e.adhocSort}}(this));var adhocReentrance={TEMPLATE_ID:"selectFields",TREE_TEMPLATE_DOM_ID:"list_responsive_collapsible_type_sets",OK_PATTERN:"#selectFieldsOk",CANCEL_PATTERN:"#selectFieldsCancel",ajaxBuffer:"ajaxbuffer",callbackCalled:!1,initialize:function(){this._dialog=$(this.TEMPLATE_ID),this.actionHash={"#selectFieldsOk":function(){dc_fields.fillForm(),adhocReentrance.callbackCalled=!0;var e=function(e){adhocDesigner.generalDesignerCallback(),adhocDesigner.filtersController.setFilters(e)};designerBase.sendRequest("co_setAdhocFields",["selectedModel="+encodeText($("selectedModel").value)],e,{bPost:!0}),this.close()},"#selectFieldsCancel":function(){this.close()}},this.getAction=function(e){for(var t in this.actionHash)if(e.match(t))return this.actionHash[t];return doNothing},this._dialog.observe("click",function(e){var t=e.element(),i=matchAny(t,[this.OK_PATTERN,this.CANCEL_PATTERN],!0);i&&this.getAction(i).bind(this)(e),e.stop()}.bindAsEventListener(this))},launchDialog:function(){designerBase.sendRequest("co_loadSchemaPos",[],adhocReentrance.init,{target:adhocReentrance.ajaxBuffer,bpost:!0,mode:AjaxRequester.prototype.EVAL_JSON})},init:function(e){e=e[0],dc_fields.mode=dc_fields.RE_ENTRANCE_MODE,dc_fields.TREE_TEMPLATE_DOM_ID=adhocReentrance.TREE_TEMPLATE_DOM_ID,dc_fields.NODE_CLASS=adhocReentrance.ReentranceNode,domain.setMessage("disabledFolderTooltip",disabledFolderTooltip),dc_fields.disableNodesInAdhocReEntrance=function(){adhocReentrance.disableNode(dynamicTree.trees[dc_fields.DESTINATION_FIELDS_DOM_ID].rootNode,e.disabledNodes)},dc_fields.updateReEntrantControls=function(e){var t=$$(adhocReentrance.OK_PATTERN);t.size()&&"undefined"!=typeof e.destTreeHasVisibleNodes&&domain.enableButton(t[0],e.destTreeHasVisibleNodes)},delete domain._bodyClickEventHandlers,dc_fields.init(),dialogs.popup.show($("selectFields")),designerBase.updateMainOverlay("hidden")},disableNode:function(e,t){var i=$H(t).keys().detect(function(t){return e.param.id==t});i&&e.disable(t[i]),e.childs.each(function(e){adhocReentrance.disableNode(e,t)});for(var n=e.parent;n&&n!=dynamicTree.trees[e.getTreeId()].rootNode;){var o=n.childs.findAll(function(e){return e.disabled});n.childs.length>0&&n.childs.length==o.length&&n.disable(disabledFolderTooltip),n=n.parent}},close:function(){dialogs.popup.hide($("selectFields")),adhocReentrance.callbackCalled||adhocDesigner.generalDesignerCallback(),adhocReentrance.callbackCalled=!1}};adhocReentrance.ReentranceNode=function(e){domain.ItemNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("ItemGroupType"),Leaf:new dynamicTree.TreeNode.Type("ItemType")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_type_sets:sets"},adhocReentrance.ReentranceNode.prototype=deepClone(domain.ItemNode.prototype),define("adhoc/designer.reentrant",["domain.components"],function(e){return function(){var t;return t||e.adhocReentrance}}(this)),function(e,t,i,n){var o=null,s=LayoutManager=function(e,t){this.init(e,t)};LayoutManager.fn=LayoutManager.prototype={axes:{},template:null,init:function(e,t){this.initProperties(t),this.initialized&&(this.initModeSpecificBehavior(this.mode),this.initAxes(e),this.initEventListeners())},initProperties:function(t){this.measuresGroupId=t.measuresGroupId,this.isOlapMode=!!t.isOlapMode,this.mode=t.mode,this.element=e("#"+t.id),this.initialized=!!this.element[0]},initModeSpecificBehavior:function(e){i.extend(this,o[e])},initAxes:function(t){i.each(t,function(t){var n=i.clone(t);n.element=e("#"+n.elementId),this.axes[n.elementId]=n,this.setData(n,n.data||[])},this)},getTemplate:function(){return null===this.template&&(this.template=s.compileTemplate("#"+this.mode+"LayoutManagerTemplate",{variable:"data"})),this.template},render:function(t,n){this.initialized&&(i.each(this.axes,function(i){n||this.setData(i,this.normalizeModel(t[i.name])),e(i.element).html(this.getTemplate()(i.data)),this.createSortable(i.element[0]),this.createMeasuresSortable(i.element[0])},this),Draggables.removeObserver(this.element[0]),Draggables.addObserver(new r(this.element[0],this.onMove)))},setData:function(e,t){e.data=t,this.updateAxesDataCache&&this.updateAxesDataCache()},initEventListeners:function(){i.bindAll(this,"onContextMenu","onRemove","onAdd","onMove","onMeasureReorder"),document.stopObserving(layoutModule.ELEMENT_CONTEXTMENU,s.onContextMenu||e.noop),document.observe(layoutModule.ELEMENT_CONTEXTMENU,this.onContextMenu),s.onContextMenu=this.onContextMenu;var t=isSupportsTouch()?"touchend":"mouseup";e(this.element).undelegate("span.remove",t),e(this.element).delegate("span.remove",t,this.onRemove)},onContextMenu:function(t){var n=this,o=e(t.memo.node).closest("li.button"),s=o.hasClass("meazure")||o.hasClass("member"),r=o.closest(s?"li.measure":"li.dimension");if(o){var a=e(o).closest("ul.sortable").attr("id"),l=this.axes[a];l&&(Event.stop(t),this.element.trigger("lm:contextMenu",i.extend(t.memo,{extra:{axis:l.name,axisId:a,name:o.attr(this.nameAttr),dimensionId:o.attr("data-dimension"),level:o.attr("data-level"),index:o.index(),groupIndex:r.index(),isMeasure:s,allLevels:o.siblings().addBack().map(function(){return e(this).attr(n.nameAttr)}).get()}})))}},onRemove:function(t){var i=e(t.target).closest("li");if(!s.isElementDragging(i)){var n=i.index(),o=this.axes[i.closest("ul.sortable").attr("id")],r=i.attr("data-dimension");this.element.trigger("lm:removeItem",{axis:o.name,index:n,item:{level:i.attr("data-level"),dimensionId:r,isMeasure:this.measuresGroupId===r}})}},onAdd:function(t){var n=t.node;if(n){var o,s=e(t).index(),r=t.nodes||[n],a=this.axes[e(t).closest("ul").attr("id")],l=this[a.name].validateAdd,c=[];return o=this.filter(r,a),l&&!l.call(this,o,s,a.name,c)?(!i.isEmpty(c)&&dialogs.systemConfirm.show(c.join("</br>"),5e3),void this.render(this.axes,!0)):void this.add(o,s,a.name)}},add:function(e,t,n){var o;if(!i.isEmpty(e))if(1===e.length){o=e[0];var s=o.param.extra||o.param;this.element.trigger("lm:addItem",{axis:n,dimensionId:s.dimensionId,level:s.id,index:t,hierarchyName:s.hierarchyName})}else this.element.trigger("lm:addItems",{axis:n,levels:i.pluck(e,"param"),index:t})},onMove:function(t,n,o,s,r,a){var l=e(t.element),c=this.axes[o],d=this.axes[s],u=this[d.name].validateMove,h=[];if(!n||r!==a)return n||!u||u.call(this,c,d,l,h)?void this.element.trigger("lm:"+(n?"moveItem":"switchItem"),{axis:d.name,item:l.attr(this.moveAttr),from:r,to:a}):(!i.isEmpty(h)&&dialogs.systemConfirm.show(h.join("</br>"),5e3),void this.render(this.axes,!0))},onMeasureReorder:function(t,i){var n=e(i.element);this.element.trigger("lm:measureReorder",{measure:n.attr("data-level"),to:n.index()})},createSortable:function(e){Sortable.create(e,{delay:isIE()?200:0,constraint:!1,overlap:"horizontal",containment:i(this.axes).keys(),dropOnEmpty:!0,accept:["measure","dimension","meazure","dimenzion"],onDrop:this.onAdd}),Draggables.removeObserver(e)},createMeasuresSortable:function(t){var i=e("li.measure > ul.members",t);if(0!==i.length)return 0===i.find("li.member").length?void Sortable.destroy(i[0]):void Sortable.create(i[0],{delay:isIE()?200:0,constraint:!1,overlap:"horizontal",onUpdate:this.onMeasureReorder})}},LayoutManager.basicFilter=function(e){return i.inject(e,function(e,t){return e.concat(s.toLeavesArray(t))},[])},LayoutManager.removeDuplicatesFilter=function(e,t,n){var o;return i(e).filter(function(e){return o=e.param.extra,"_spacer"===o.id||!i.any(t,function(e){return i.all(n,function(t,i){return o[i]===e[t]})})})},LayoutManager.compileTemplate=function(t,n){return i.template(e(t).html(),null,i.defaults(n,{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g}))},LayoutManager.toLeavesArray=function(e,t){var i=t||[];if(!e.childs||0===e.childs.length)return i.push(e),i;for(var n=0;n<e.childs.length;n++)s.toLeavesArray(e.childs[n],i);return i},LayoutManager.isElementDragging=function(e){return Draggable._dragging[e.jquery?e[0]:e]};var r=Class.create({initialize:function(e,i){this.element=t(e),this.observer=i,this.axes=["olap_rows","olap_columns"]},onStart:function(t,i){this.axis=this.getAxis(i),this.from=e(i.element).index(),isIE()&&(this.changedElement=i.element,this.changedElement&&(this.changedElement.setStyle({display:"inline-block"}),this.changedElement.hasClassName("measure")&&this.changedElement.setStyle({padding:"0px"})))
},onEnd:function(t,i){if(this.axis){var n=this.getAxis(i);if(n&&this.axes.include(n.id)){Sortable.unmark();var o=this.axis.id===n.id,s=e(i.element).index();this.observer(i,o,this.axis.id,n.id,this.from,s),isIE()&&this.changedElement&&(this.changedElement.style.removeAttribute("display"),this.changedElement.style.removeAttribute("padding"))}}},getAxis:function(e){return e.element.up("ul")}});o={table:{nameAttr:"fieldname",moveAttr:"fieldname",filter:function(e,t){return e=s.basicFilter(e),"column"===t.name?e:s.removeDuplicatesFilter(e,t.data,{id:"name"})},fieldExists:function(e,t){return i.find(e,function(e){return e.name===t})},group:{validateAdd:function(e,t,n,o){return 0===e.length?(o&&o.push("Field or measure already in use."),!1):i.any(e,function(e){return e.param.extra.isMeasure||"_spacer"===e.param.extra.id})?(o&&o.push(errorAddTpGroups),!1):!0},validateMove:function(e,t,i,n){return i.hasClass("meazure")?(n&&n.push(errorAddTpGroups),!1):this.fieldExists(t.data,i.attr("fieldname"))?(n&&n.push("Cannot move field already present in groups"),!1):!0}},column:{validateAdd:function(e,t,i,n){return 0===e.length?(n&&n.push("Field or measure already in use."),!1):!0},validateMove:function(e,t,i,n){return this.fieldExists(t.data,i.attr("fieldname"))?(n&&n.push("Cannot move field already present in columns"),!1):!0}},normalizeModel:function(e){var t=!1,n=null;return i.map(e,function(e){return t=e.measure||!!e.isSpacer,n="_null"!==e.currentDisplayName?e.currentDisplayName:null,{name:e.name,title:e.isSpacer?adhocDesigner.messages.spacer:n||e.name,isSpacer:!!e.isSpacer,isMeasure:t,itemClass:t?"meazure":"dimenzion"}})}},chart:{nameAttr:"fieldname",moveAttr:"fieldname",filter:function(e){return e},group:{validateAdd:function(e,t,n,o){return i.any(e,function(e){return"ItemGroupType"===e.param.type})?(o&&o.push(adhocDesigner.messages.cantAddSet),!1):i.any(e,function(e){return e.param.extra.isMeasure})?(o&&o.push(errorAddTpGroups),!1):!0},validateMove:function(e,t,i,n){return i.hasClass("meazure")?(n&&n.push(errorAddTpGroups),!1):!0}},measures:{},normalizeModel:function(e){return e instanceof Array?i.map(e,function(e){return{name:e.name,title:e.label,isSpacer:!1,isMeasure:e.isMeasure,itemClass:e.isMeasure?"meazure":"dimenzion"}}):e.name?[{name:e.name,title:e.label,isSpacer:!1,isMeasure:!1,itemClass:"dimenzion"}]:[]}},crosstab:{nameAttr:"data-level",moveAttr:"data-dimension",filter:function(e){e=s.basicFilter(this.isOlapMode?e.slice(0,1):e);var t=!this.isOlapMode&&i.any(e,function(e){return e.param.extra&&e.param.extra.isMeasure});return t?e:s.removeDuplicatesFilter(e,this.axesCache,{id:"name",dimensionId:"groupId"})},row:{validateMove:function(e,t){return!(t.isDependent&&1==e.data.length)},validateAdd:function(e,t,n,o){if(i.isEmpty(e))return o&&o.push(adhocDesigner.messages.ADH_1215_FIELD_IN_USE),!1;var s=this,r=e[0].param.extra,a=this.axes.olap_columns.data;return!(i.isEmpty(e)||this.axes.olap_rows.isDependent&&(i.isEmpty(a)||r.hierarchyName&&1===a.length&&a[0].groupId===r.dimensionId)||localContext.showAddHierarchyConfirm(r.hierarchyName,r.dimensionId,function(){s.add(e,t,n)}))}},column:{validateAdd:function(e,t,n,o){if(i.isEmpty(e))return o&&o.push(adhocDesigner.messages.ADH_1215_FIELD_IN_USE),!1;var s=this,r=e[0].param.extra;return!localContext.showAddHierarchyConfirm(r.hierarchyName,r.dimensionId,function(){s.add(e,t,n)})}},normalizeModel:function(e){for(var t=[],n="",o=0;o<e.length;o++){for(var s=e[o],r=s.name,a={groupId:r,levels:[],liClass:"dimension",ulClass:"levels",measureHandle:""},l=0;l<s.levels.length;l++){var c=s.levels[l];if(c.visible&&!(c.recursiveLevelNumber>0))if(i.isEmpty(c.members))a.levels.push({id:i.uniqueId(c.name+"_"),name:c.name,groupId:r,label:c.display?c.display:c.name,depth:c.depth,isMeasure:!1,levelClass:"level"});else{i.extend(a,{isMeasure:!0,liClass:"measure",ulClass:"members",measureHandle:"<span class='handle'>&nbsp;</span>"});for(var d=0;d<c.members.length;d++){var u=c.members[d];u.isSpacer!==!0&&(n=(u.fieldDisplay?u.fieldDisplay:u.name)+(u.aggregateColumnName&&"Sum"!==u["function"]&&u.functionOrDefault?i.sprintf(" (%s)",u.functionOrDefault):""),a.levels.push({id:i.uniqueId(i.underscored(u.name)+"_"),name:u.field.name,groupId:r,label:n,depth:d,isMeasure:!0,levelClass:"member"}))}}}t.push(a)}return t},updateAxesDataCache:function(){this.axesCache=i.chain(this.axes).values().pluck("data").flatten().pluck("levels").flatten().value()}}},n.LayoutManager=LayoutManager}(jQuery,$,_,window),define("adhoc/layout.manager",["jquery","underscore","prototype"],function(e){return function(){var t;return t||e.LayoutManager}}(this)),define("adhoc/filter/enum/filterExpressionTypes",{LITERAL:"literal",LIST:"list",RANGE:"range",DATE_RANGE:"dateRange",READ_ONLY:"readOnly"}),define("adhoc/filter/filterModelTrait/dateRangeFilterModelTrait",["require","underscore","adhoc/filter/enum/filterExpressionTypes"],function(e){var t=e("underscore"),i=e("adhoc/filter/enum/filterExpressionTypes");return{_expressionRValue:function(){return t.map(this.get("value"),function(e){return null==e&&console&&console.warn("Value is undefined or null for some reason",e),{value:encodeURIComponent(null==e?"":e),type:i.LITERAL,dataType:this.get("filterDataType")}},this)}}}),define("adhoc/filter/enum/filterOperators",{IS_ANY_VALUE:"isAnyValue",IN:"in",NOT_IN:"notin",BETWEEN:"between",NOT_BETWEEN:"notBetween",EQUALS:"equals",NOT_EQUAL:"notEqual",CONTAINS:"contains",NOT_CONTAINS:"notcontains",GREATER:"greater",GREATER_OR_EQUAL:"greaterOrEqual",LESS:"less",LESS_OR_EQUAL:"lessOrEqual",BETWEEN_DATES:"betweenDates",NOT_BETWEEN_DATES:"notbetweenDates",STARTS_WITH:"startsWith",NOT_STARTS_WITH:"notstartsWith",ENDS_WITH:"endsWith",NOT_ENDS_WITH:"notendsWith",READ_ONLY:"readonly"}),define("adhoc/filter/filterModelTrait/listFilterModelTrait",["require","underscore","adhoc/filter/enum/filterExpressionTypes","adhoc/filter/enum/filterOperators"],function(e){{var t=e("underscore"),i=e("adhoc/filter/enum/filterExpressionTypes");e("adhoc/filter/enum/filterOperators")}return{_expressionRValue:function(){return{type:"list",value:t.map(this.get("value"),function(e){return null==e&&console&&console.warn("Value is undefined or null for some reason",e),{value:encodeURIComponent(null==e?"":e),dataType:this.get("filterDataType"),type:i.LITERAL}},this)}}}}),define("adhoc/filter/enum/filterDataTypes",{TIMESTAMP:"Timestamp",DATE:"Date",TIME:"Time",INTEGER:"Integer",DECIMAL:"Decimal",LONG:"Long",NUMERIC:"Numeric",STRING:"String",BOOLEAN:"Boolean",READ_ONLY:"readonly"}),define("adhoc/filter/filterModelTrait/literalFilterModelTrait",["require","underscore","adhoc/filter/enum/filterExpressionTypes","adhoc/filter/enum/filterOperators","adhoc/filter/enum/filterDataTypes","jrs.configs"],function(e){{var t=(e("underscore"),e("adhoc/filter/enum/filterExpressionTypes"));e("adhoc/filter/enum/filterOperators"),e("adhoc/filter/enum/filterDataTypes"),e("jrs.configs")}return{_expressionRValue:function(){var e=this.get("value");return{value:encodeURIComponent(e),dataType:this.get("filterDataType"),type:t.LITERAL}}}}),define("adhoc/filter/filterModelTrait/rangeFilterModelTrait",["require","underscore","adhoc/filter/enum/filterExpressionTypes"],function(e){var t=(e("underscore"),e("adhoc/filter/enum/filterExpressionTypes"));return{_expressionRValue:function(){var e=this.get("value")[0],i=this.get("value")[1];return null==e&&console&&console.warn("Value is undefined or null for some reason",e),null==i&&console&&console.warn("Value is undefined or null for some reason",i),{start:encodeURIComponent(null==e?"":e),end:encodeURIComponent(null==i?"":i),dataType:this.get("filterDataType"),type:t.RANGE}}}}),define("adhoc/filter/filterModelTrait/readOnlyFilterModelTrait",["require"],function(){return{_expressionRValue:function(){return{}}}}),define("adhoc/filter/factory/filterModelValidationFactory",["require","adhoc/filter/enum/filterDataTypes","adhoc/filter/enum/filterOperators","underscore"],function(e){var t=e("adhoc/filter/enum/filterDataTypes"),i=e("adhoc/filter/enum/filterOperators"),n=e("underscore"),o={};return o[t.INTEGER]={},o[t.INTEGER][i.IN]={value:{listWithTrueAll:!0}},o[t.INTEGER][i.NOT_IN]={value:{list:!0}},o[t.INTEGER][i.EQUALS]={value:{required:!0,nullable:!0,integer:!0}},o[t.INTEGER][i.NOT_EQUAL]={value:{required:!0,nullable:!0,integer:!0}},o[t.INTEGER][i.LESS]={value:{required:!0,nullable:!1,integer:!0}},o[t.INTEGER][i.GREATER]={value:{required:!0,nullable:!1,integer:!0}},o[t.INTEGER][i.GREATER_OR_EQUAL]={value:{required:!0,nullable:!1,integer:!0}},o[t.INTEGER][i.LESS_OR_EQUAL]={value:{required:!0,nullable:!1,integer:!0}},o[t.INTEGER][i.BETWEEN]={value:{integerRange:!0}},o[t.INTEGER][i.NOT_BETWEEN]={value:{integerRange:!0}},o[t.DECIMAL]={},o[t.DECIMAL][i.IN]={value:{listWithTrueAll:!0}},o[t.DECIMAL][i.NOT_IN]={value:{list:!0}},o[t.DECIMAL][i.EQUALS]={value:{required:!0,nullable:!0,decimal:!0}},o[t.DECIMAL][i.NOT_EQUAL]={value:{required:!0,nullable:!0,decimal:!0}},o[t.DECIMAL][i.LESS]={value:{required:!0,nullable:!1,decimal:!0}},o[t.DECIMAL][i.GREATER]={value:{required:!0,nullable:!1,decimal:!0}},o[t.DECIMAL][i.GREATER_OR_EQUAL]={value:{required:!0,nullable:!1,decimal:!0}},o[t.DECIMAL][i.LESS_OR_EQUAL]={value:{required:!0,nullable:!1,decimal:!0}},o[t.DECIMAL][i.BETWEEN]={value:{decimalRange:!0}},o[t.DECIMAL][i.NOT_BETWEEN]={value:{decimalRange:!0}},o[t.LONG]={},o[t.LONG][i.IN]={value:{listWithTrueAll:!0}},o[t.LONG][i.NOT_IN]={value:{list:!0}},o[t.LONG][i.EQUALS]={value:{required:!0,nullable:!0,"long":!0}},o[t.LONG][i.NOT_EQUAL]={value:{required:!0,nullable:!0,"long":!0}},o[t.LONG][i.LESS]={value:{required:!0,nullable:!1,"long":!0}},o[t.LONG][i.GREATER]={value:{required:!0,nullable:!1,"long":!0}},o[t.LONG][i.GREATER_OR_EQUAL]={value:{required:!0,nullable:!1,"long":!0}},o[t.LONG][i.LESS_OR_EQUAL]={value:{required:!0,nullable:!1,"long":!0}},o[t.LONG][i.BETWEEN]={value:{longRange:!0}},o[t.LONG][i.NOT_BETWEEN]={value:{longRange:!0}},o[t.NUMERIC]={},n.extend(o[t.NUMERIC],o[t.INTEGER]),o[t.STRING]={},o[t.STRING][i.IN]={value:{listWithTrueAll:!0}},o[t.STRING][i.NOT_IN]={value:{list:!0}},o[t.STRING][i.EQUALS]={value:{required:!1,string:!0}},o[t.STRING][i.NOT_EQUAL]={value:{required:!1,string:!0}},o[t.STRING][i.CONTAINS]={value:{required:!1,string:!0}},o[t.STRING][i.NOT_CONTAINS]={value:{required:!1,string:!0}},o[t.STRING][i.STARTS_WITH]={value:{required:!1,string:!0}},o[t.STRING][i.NOT_STARTS_WITH]={value:{required:!1,string:!0}},o[t.STRING][i.ENDS_WITH]={value:{required:!1,string:!0}},o[t.STRING][i.NOT_ENDS_WITH]={value:{required:!1,string:!0}},o[t.BOOLEAN]={},o[t.BOOLEAN][i.IN]={value:{listWithTrueAll:!0}},o[t.BOOLEAN][i.NOT_IN]={value:{list:!0}},o[t.BOOLEAN][i.EQUALS]={value:{required:!0,"boolean":!0}},o[t.BOOLEAN][i.NOT_EQUAL]={value:{required:!0,"boolean":!0}},o[t.TIME]={},o[t.TIME][i.EQUALS]={value:{required:!0,nullable:!0,time:!0}},o[t.TIME][i.NOT_EQUAL]={value:{required:!0,nullable:!0,time:!0}},o[t.TIME][i.LESS]={value:{required:!0,nullable:!1,time:!0}},o[t.TIME][i.GREATER]={value:{required:!0,nullable:!1,time:!0}},o[t.TIME][i.GREATER_OR_EQUAL]={value:{required:!0,nullable:!1,time:!0}},o[t.TIME][i.LESS_OR_EQUAL]={value:{required:!0,nullable:!1,time:!0}},o[t.TIME][i.BETWEEN]={value:{timeRange:!0}},o[t.TIME][i.NOT_BETWEEN]={value:{timeRange:!0}},o[t.TIMESTAMP]={},o[t.TIMESTAMP][i.EQUALS]={value:{required:!0,nullable:!0,timestamp:!0}},o[t.TIMESTAMP][i.NOT_EQUAL]={value:{required:!0,nullable:!0,timestamp:!0}},o[t.TIMESTAMP][i.LESS]={value:{required:!0,nullable:!1,timestamp:!0}},o[t.TIMESTAMP][i.GREATER]={value:{required:!0,nullable:!1,timestamp:!0}},o[t.TIMESTAMP][i.GREATER_OR_EQUAL]={value:{required:!0,nullable:!1,timestamp:!0}},o[t.TIMESTAMP][i.LESS_OR_EQUAL]={value:{required:!0,nullable:!1,timestamp:!0}},o[t.TIMESTAMP][i.BETWEEN_DATES]={value:{timestampRange:!0}},o[t.TIMESTAMP][i.NOT_BETWEEN_DATES]={value:{timestampRange:!0}},o[t.DATE]={},o[t.DATE][i.EQUALS]={value:{required:!0,nullable:!0,date:!0}},o[t.DATE][i.NOT_EQUAL]={value:{required:!0,nullable:!0,date:!0}},o[t.DATE][i.LESS]={value:{required:!0,nullable:!1,date:!0}},o[t.DATE][i.GREATER]={value:{required:!0,nullable:!1,date:!0}},o[t.DATE][i.GREATER_OR_EQUAL]={value:{required:!0,nullable:!1,date:!0}},o[t.DATE][i.LESS_OR_EQUAL]={value:{required:!0,nullable:!1,date:!0}},o[t.DATE][i.BETWEEN_DATES]={value:{dateRange:!0}},o[t.DATE][i.NOT_BETWEEN_DATES]={value:{dateRange:!0}},function(e,t){return e in o&&t in o[e]?o[e][t]:{}}}),define("adhoc/filter/factory/filterModelExpressionTypeFactory",["require","adhoc/filter/enum/filterDataTypes","adhoc/filter/enum/filterExpressionTypes","adhoc/filter/enum/filterOperators","underscore"],function(e){var t=e("adhoc/filter/enum/filterDataTypes"),i=e("adhoc/filter/enum/filterExpressionTypes"),n=e("adhoc/filter/enum/filterOperators"),o=e("underscore"),s={};return s[t.STRING]={},s[t.STRING][n.IN]=i.LIST,s[t.STRING][n.NOT_IN]=i.LIST,s[t.STRING][n.EQUALS]=i.LITERAL,s[t.STRING][n.NOT_EQUAL]=i.LITERAL,s[t.STRING][n.CONTAINS]=i.LITERAL,s[t.STRING][n.NOT_CONTAINS]=i.LITERAL,s[t.STRING][n.STARTS_WITH]=i.LITERAL,s[t.STRING][n.NOT_STARTS_WITH]=i.LITERAL,s[t.STRING][n.ENDS_WITH]=i.LITERAL,s[t.STRING][n.NOT_ENDS_WITH]=i.LITERAL,s[t.NUMERIC]={},s[t.NUMERIC][n.IN]=i.LIST,s[t.NUMERIC][n.NOT_IN]=i.LIST,s[t.NUMERIC][n.EQUALS]=i.LITERAL,s[t.NUMERIC][n.NOT_EQUAL]=i.LITERAL,s[t.NUMERIC][n.LESS]=i.LITERAL,s[t.NUMERIC][n.GREATER]=i.LITERAL,s[t.NUMERIC][n.GREATER_OR_EQUAL]=i.LITERAL,s[t.NUMERIC][n.LESS_OR_EQUAL]=i.LITERAL,s[t.NUMERIC][n.BETWEEN]=i.RANGE,s[t.NUMERIC][n.NOT_BETWEEN]=i.RANGE,s[t.INTEGER]={},s[t.LONG]={},s[t.DECIMAL]={},o.extend(s[t.INTEGER],s[t.NUMERIC]),o.extend(s[t.LONG],s[t.NUMERIC]),o.extend(s[t.DECIMAL],s[t.NUMERIC]),s[t.BOOLEAN]={},s[t.BOOLEAN][n.IN]=i.LIST,s[t.BOOLEAN][n.NOT_IN]=i.LIST,s[t.BOOLEAN][n.EQUALS]=i.LITERAL,s[t.BOOLEAN][n.NOT_EQUAL]=i.LITERAL,s[t.TIMESTAMP]={},s[t.TIMESTAMP][n.EQUALS]=i.LITERAL,s[t.TIMESTAMP][n.NOT_EQUAL]=i.LITERAL,s[t.TIMESTAMP][n.LESS]=i.LITERAL,s[t.TIMESTAMP][n.GREATER]=i.LITERAL,s[t.TIMESTAMP][n.GREATER_OR_EQUAL]=i.LITERAL,s[t.TIMESTAMP][n.LESS_OR_EQUAL]=i.LITERAL,s[t.TIMESTAMP][n.BETWEEN_DATES]=i.DATE_RANGE,s[t.TIMESTAMP][n.NOT_BETWEEN_DATES]=i.DATE_RANGE,s[t.DATE]={},o.extend(s[t.DATE],s[t.TIMESTAMP]),s[t.TIME]={},s[t.TIME][n.EQUALS]=i.LITERAL,s[t.TIME][n.NOT_EQUAL]=i.LITERAL,s[t.TIME][n.LESS]=i.LITERAL,s[t.TIME][n.GREATER]=i.LITERAL,s[t.TIME][n.GREATER_OR_EQUAL]=i.LITERAL,s[t.TIME][n.LESS_OR_EQUAL]=i.LITERAL,s[t.TIME][n.BETWEEN]=i.RANGE,s[t.TIME][n.NOT_BETWEEN]=i.RANGE,s[t.READ_ONLY]={},s[t.READ_ONLY][n.READ_ONLY]=i.READ_ONLY,function(e,t){if(!(e in s))throw new Error("Filter data type '"+e+"' is not supported");if(!(t in s[e]))throw new Error("Operator '"+t+"' is not supported by filter data type '"+e+"'");return s[e][t]}}),define("adhoc/filter/factory/filterModelDefaultValueFactory",["require","adhoc/filter/enum/filterDataTypes","adhoc/filter/enum/filterOperators","jrs.configs","underscore"],function(e){var t=e("adhoc/filter/enum/filterDataTypes"),i=e("adhoc/filter/enum/filterOperators"),n=e("jrs.configs"),o=e("underscore"),s={};s[t.STRING]={},s[t.STRING][i.IN]={value:[],isAnyValue:!0},s[t.STRING][i.NOT_IN]={value:[],isAnyValue:!1},s[t.STRING][i.EQUALS]=function(e){return{value:e.values[0],isAnyValue:!1}},s[t.STRING][i.NOT_EQUAL]=function(e){return{value:e.values[0],isAnyValue:!1}},s[t.STRING][i.CONTAINS]={value:"",isAnyValue:!1},s[t.STRING][i.NOT_CONTAINS]={value:"",isAnyValue:!1},s[t.STRING][i.STARTS_WITH]={value:"",isAnyValue:!1},s[t.STRING][i.NOT_STARTS_WITH]={value:"",isAnyValue:!1},s[t.STRING][i.ENDS_WITH]={value:"",isAnyValue:!1},s[t.STRING][i.NOT_ENDS_WITH]={value:"",isAnyValue:!1};var r={};r[i.IN]={value:[],isAnyValue:!0},r[i.NOT_IN]={value:[],isAnyValue:!1},r[i.EQUALS]={value:n.inputControlsConstants.NULL_SUBSTITUTION_VALUE,isAnyValue:!1},r[i.NOT_EQUAL]={value:n.inputControlsConstants.NULL_SUBSTITUTION_VALUE,isAnyValue:!1},r[i.GREATER]=function(e){return{value:e.min,isAnyValue:!1}},r[i.GREATER_OR_EQUAL]=function(e){return{value:e.min,isAnyValue:!1}},r[i.LESS]=function(e){return{value:e.max,isAnyValue:!1}},r[i.LESS_OR_EQUAL]=function(e){return{value:e.max,isAnyValue:!1}},r[i.BETWEEN]=function(e){return{value:[e.min,e.max],isAnyValue:!1}},r[i.NOT_BETWEEN]=function(e){return{value:[e.min,e.max],isAnyValue:!1}};var a=o.omit(r,i.BETWEEN,i.NOT_BETWEEN);a[i.BETWEEN_DATES]=function(e){return{value:[e.min,e.max],isAnyValue:!0}},a[i.NOT_BETWEEN_DATES]=function(e){return{value:[e.min,e.max],isAnyValue:!1}},s[t.INTEGER]=o.clone(r),s[t.NUMERIC]=o.clone(r),s[t.LONG]=o.clone(r),s[t.DECIMAL]=o.clone(r),s[t.TIME]=o.clone(r),s[t.TIMESTAMP]=o.clone(a),s[t.DATE]=o.clone(a),s[t.BOOLEAN]={},s[t.BOOLEAN][i.IN]={value:[],isAnyValue:!0},s[t.BOOLEAN][i.NOT_IN]={value:[],isAnyValue:!1},s[t.BOOLEAN][i.EQUALS]={value:"false",isAnyValue:!1},s[t.BOOLEAN][i.NOT_EQUAL]={value:"false",isAnyValue:!1};var l={};return l[i.IN]=function(e){return e.allValuesLoaded?{value:e.values,isAnyValue:!1}:{value:[],isAnyValue:!1}},l[i.NOT_IN]={value:[],isAnyValue:!1},l[i.EQUALS]=function(e){return{value:e.values[0],isAnyValue:!1}},l[i.NOT_EQUAL]=function(e){return{value:e.values[0],isAnyValue:!1}},function(e,t,i,n){var r;if(i){if(!(t in l))throw new Error("Operator '"+t+"' is not supported in OLAP mode");r=l[t]}else{if(!(e in s))throw new Error("Filter data type '"+e+"' is not supported");if(!(t in s[e]))throw new Error("Operator '"+t+"' is not supported by filter data type '"+e+"'");r=s[e][t]}return o.isFunction(r)?r(n):r}}),define("adhoc/filter/format/OlapFilterValueFormatter",["require","underscore"],function(e){var t=e("underscore"),i=/(\[[\w\s.-]+\]\.){2}/,n=/(\[[\w\s.-]+\]\.){1}/,o=/\]\.\[/g,s=/^\[([^\]]+)\]$/g,r=function(e){t.bindAll(this,"format"),this.dimNamePrefixRegexp=e?i:n};return t.extend(r.prototype,{format:function(e){return e=e.replace(this.dimNamePrefixRegexp,""),e=e.replace(o," - "),e=e.replace(s,"$1")}}),r}),define("common/component/singleSelect/dataprovider/DataProviderNew",["require","underscore","jquery"],function(e){var t=e("underscore"),i=e("jquery"),n=999,o=50,s=50,r="criteria",a=2147483647,l=function(e){t.bindAll(this,"getData"),e=e||{},this.dataCache=[],this.dataCacheTotal=null,this.dataCachePages=[],this.pageSize=e.pageSize||n,this.criteriaKey=e.searchKey||r,this.maxSearchCacheSize=e.maxSearchCacheSize||o,this.getDataByCriteriaHolder={},this.controlGetTotal="undefined"!=typeof e.controlGetTotal?e.controlGetTotal:!1,this.dataConverter=e.dataConverter,this.saveLastCriteria="undefined"!=typeof e.saveLastCriteria?e.saveLastCriteria:!1,this.lastCriteria=null,this.serialRequestsDelay="undefined"!=typeof e.serialRequestsDelay?e.serialRequestsDelay:s,this.serialRequestsDelayedPromise=null,this.request=e.request};return t.extend(l.prototype,{getData:function(e){if(e=e||{},e[this.criteriaKey])return this._getDataByCriteria(e[this.criteriaKey])(e);if("undefined"==typeof e[this.criteriaKey]&&this.saveLastCriteria&&this.lastCriteria)return this._getDataByCriteria(this.lastCriteria)(e);this.lastCriteria=null;var t=i.Deferred(),n=this._getPagesToLoad(e);return n?this._requestData(e,n,t):this._resolveDeferredUsingDataFromCache(t,e),t.promise()},clear:function(){this.dataCache=[],this.dataCacheTotal=null,this.dataCachePages=[],this.getDataByCriteriaHolder={},this.lastCriteria=null},_requestData:function(e,i,n){var o=(i[i.length-1]-i[0]+1)*this.pageSize,s=t.extend({},e,{offset:i[0]*this.pageSize,limit:o});this.controlGetTotal&&(s.skipGetTotal=!0),o>=a/this.pageSize*this.pageSize&&delete s.limit,this.controlGetTotal&&"number"!=typeof this.dataCacheTotal&&delete s.skipGetTotal,this.serialRequestsDelay>0?(clearTimeout(this.deferredTimeout),this.deferredTimeout=setTimeout(t.bind(this._requestDataDeferred,this,e,s,n),this.serialRequestsDelay)):this._requestDataDeferred(e,s,n)},_requestDataDeferred:function(e,i,n){var o=this._getPagesToLoad(e);o?this.serialRequestsDelayedPromise&&t.isEqual(i,this.serialRequestsDelayedPromise.query)?this.serialRequestsDelayedPromise.promise.done(n.resolve).fail(n.reject):(this.serialRequestsDelayedPromise={promise:n.promise(),query:i},this.request(i).done(t.bind(this._requestDone,this,e,i,n)).fail(n.reject)):this._resolveDeferredUsingDataFromCache(n,e)},_requestDone:function(e,t,i,n){this._putDataToCache(t,n),this.serialRequestsDelayedPromise=null,this._resolveDeferredUsingDataFromCache(i,e)},_resolveDeferredUsingDataFromCache:function(e,t){var i=this._getDataFromCache(t);e.resolve({total:this.dataCacheTotal,data:i})},_getPagesToLoad:function(e){var t,i=this._convertLimitOffsetToFirstLast(e),n=this._findPageIndex(i.first),o=this._findPageIndex(i.last),s=[];for(t=n;o>=t;t++)if(!this.dataCachePages[t]){s.push(t);break}for(t=o;t>=n;t--)if(!this.dataCachePages[t]){s.push(t);break}return s.length>0?s:null},_findPageIndex:function(e){return Math.floor(e/this.pageSize)},_convertLimitOffsetToFirstLast:function(e){var t=e&&e.offset?e.offset:0,i=e&&e.limit?t+e.limit-1:this.dataCacheTotal?this.dataCacheTotal-1:a;return this.dataCacheTotal&&i>this.dataCacheTotal-1&&(i=this.dataCacheTotal-1),{first:t,last:i}},_getDataFromCache:function(e){e=t.defaults(e,{offset:0,limit:a});var i=Math.max(0,e.offset),n=Math.min(i+e.limit,this.dataCacheTotal);return this.dataCache.slice(i,n)},_putDataToCache:function(e,t){var i;for("undefined"!=typeof t.total&&(this.dataCacheTotal=t.total),e.limit=e.limit||a,i=0;i<t.data.length;i++)this.dataCache[i+e.offset]=this.dataConverter?this.dataConverter(t.data[i]):t.data[i];var n=e.offset/this.pageSize,o=Math.floor((Math.min(e.limit,t.data.length)+e.offset-1)/this.pageSize);for(i=n;o>=i;i++)this.dataCachePages[i]=!0},_getDataByCriteria:function(e){if(!this.getDataByCriteriaHolder[e]){var t,i=Number.MAX_VALUE,n=0,o=0;for(var s in this.getDataByCriteriaHolder)if(this.getDataByCriteriaHolder.hasOwnProperty(s)){o+=1;var r=this.getDataByCriteriaHolder[s];r.index<i&&(i=r.index,t=s),r.index>n&&(n=r.index)}o>=this.maxSearchCacheSize&&delete this.getDataByCriteriaHolder[t],this.getDataByCriteriaHolder[e]={getData:this._createDataProviderForCriteria(e),index:n+1}}return this.lastCriteria=e,this.getDataByCriteriaHolder[e].getData},_createDataProviderForCriteria:function(e){var i=this.request,n=this,o=new l({pageSize:this.pageSize,dataConverter:this.dataConverter,serialRequestsDelay:this.serialRequestsDelay,searchKey:this.criteriaKey,controlGetTotal:this.controlGetTotal,request:function(o){var s=t.extend({},o);return s[n.criteriaKey]=e,i(s)}}),s=o.getData;return o.getData=function(e){var i=t.extend({},e);return delete i[n.criteriaKey],s.call(o,i)},o.getData}}),l}),define("common/component/singleSelect/dataprovider/ValueFormattingDataProvider",["require","underscore","jquery"],function(e){var t=e("underscore"),i=e("jquery"),n=function(e){t.bindAll(this,"getData"),e=e||{},this.format=e.format,this.request=e.request};return t.extend(n.prototype,{getData:function(e){var n=i.Deferred();return this.request(e).done(t.bind(this._requestDone,this,n)).fail(n.reject),n.promise()},_requestDone:function(e,t){if(this.format&&t&&t.data){var i=t.data;if(i.length>0&&!i[0].label)for(var n=0;n<i.length;n++)i[n].label=this.format(i[n].value)}e.resolve(t)}}),n}),function(e){function t(e,t){return function(i){return l(e.call(this,i),t)}}function i(e,t){return function(i){return this.lang().ordinal(e.call(this,i),t)}}function n(){}function o(e){y(e),r(this,e)}function s(e){var t=m(e),i=t.year||0,n=t.month||0,o=t.week||0,s=t.day||0,r=t.hour||0,a=t.minute||0,l=t.second||0,c=t.millisecond||0;this._input=e,this._milliseconds=+c+1e3*l+6e4*a+36e5*r,this._days=+s+7*o,this._months=+n+12*i,this._data={},this._bubble()}function r(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function a(e){return 0>e?Math.ceil(e):Math.floor(e)}function l(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}function c(e,t,i,n){var o,s,r=t._milliseconds,a=t._days,l=t._months;r&&e._d.setTime(+e._d+r*i),(a||l)&&(o=e.minute(),s=e.hour()),a&&e.date(e.date()+a*i),l&&e.month(e.month()+l*i),r&&!n&&tt.updateOffset(e),(a||l)&&(e.minute(o),e.hour(s))}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}function u(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function h(e,t,i){var n,o=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),r=0;for(n=0;o>n;n++)(i&&e[n]!==t[n]||!i&&g(e[n])!==g(t[n]))&&r++;return r+s}function p(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=Pt[e]||Ft[t]||t}return e}function m(e){var t,i,n={};for(i in e)e.hasOwnProperty(i)&&(t=p(i),t&&(n[t]=e[i]));return n}function f(t){var i,n;if(0===t.indexOf("week"))i=7,n="day";else{if(0!==t.indexOf("month"))return;i=12,n="month"}tt[t]=function(o,s){var r,a,l=tt.fn._lang[t],c=[];if("number"==typeof o&&(s=o,o=e),a=function(e){var t=tt().utc().set(n,e);return l.call(tt.fn._lang,t,o||"")},null!=s)return a(s);for(r=0;i>r;r++)c.push(a(r));return c}}function g(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function v(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function _(e){return b(e)?366:365}function b(e){return e%4===0&&e%100!==0||e%400===0}function y(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[rt]<0||e._a[rt]>11?rt:e._a[at]<1||e._a[at]>v(e._a[st],e._a[rt])?at:e._a[lt]<0||e._a[lt]>23?lt:e._a[ct]<0||e._a[ct]>59?ct:e._a[dt]<0||e._a[dt]>59?dt:e._a[ut]<0||e._a[ut]>999?ut:-1,e._pf._overflowDayOfYear&&(st>t||t>at)&&(t=at),e._pf.overflow=t)}function T(e){e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function S(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function A(e){return e?e.toLowerCase().replace("_","-"):e}function C(e,t){return t.abbr=e,ht[e]||(ht[e]=new n),ht[e].set(t),ht[e]}function E(e){delete ht[e]}function x(e){var t,i,n,o,s=0,r=function(e){if(!ht[e]&&pt)try{require("./lang/"+e)}catch(t){}return ht[e]};if(!e)return tt.fn._lang;if(!d(e)){if(i=r(e))return i;e=[e]}for(;s<e.length;){for(o=A(e[s]).split("-"),t=o.length,n=A(e[s+1]),n=n?n.split("-"):null;t>0;){if(i=r(o.slice(0,t).join("-")))return i;if(n&&n.length>=t&&h(o,n,!0)>=t-1)break;t--}s++}return tt.fn._lang}function M(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function w(e){var t,i,n=e.match(vt);for(t=0,i=n.length;i>t;t++)n[t]=Ut[n[t]]?Ut[n[t]]:M(n[t]);return function(o){var s="";for(t=0;i>t;t++)s+=n[t]instanceof Function?n[t].call(o,e):n[t];return s}}function D(e,t){return e.isValid()?(t=I(t,e.lang()),Ht[t]||(Ht[t]=w(t)),Ht[t](e)):e.lang().invalidDate()}function I(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(_t.lastIndex=0;n>=0&&_t.test(e);)e=e.replace(_t,i),_t.lastIndex=0,n-=1;return e}function O(e,t){var i;switch(e){case"DDDD":return Tt;case"YYYY":case"GGGG":case"gggg":return St;case"YYYYY":case"GGGGG":case"ggggg":return At;case"S":case"SS":case"SSS":case"DDD":return yt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Et;case"a":case"A":return x(t._l)._meridiemParse;case"X":return wt;case"Z":case"ZZ":return xt;case"T":return Mt;case"SSSS":return Ct;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return bt;default:return i=new RegExp(B(H(e.replace("\\","")),"i"))}}function L(e){var t=(xt.exec(e)||[])[0],i=(t+"").match(Nt)||["-",0,0],n=+(60*i[1])+g(i[2]);return"+"===i[0]?-n:n}function N(e,t,i){var n,o=i._a;switch(e){case"M":case"MM":null!=t&&(o[rt]=g(t)-1);break;case"MMM":case"MMMM":n=x(i._l).monthsParse(t),null!=n?o[rt]=n:i._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(o[at]=g(t));break;case"DDD":case"DDDD":null!=t&&(i._dayOfYear=g(t));break;case"YY":o[st]=g(t)+(g(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":o[st]=g(t);break;case"a":case"A":i._isPm=x(i._l).isPM(t);break;case"H":case"HH":case"h":case"hh":o[lt]=g(t);break;case"m":case"mm":o[ct]=g(t);break;case"s":case"ss":o[dt]=g(t);break;case"S":case"SS":case"SSS":case"SSSS":o[ut]=g(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=L(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(i._w=i._w||{},i._w[e]=t)}}function R(e){var t,i,n,o,s,r,a,l,c,d,u=[];if(!e._d){for(n=P(e),e._w&&null==e._a[at]&&null==e._a[rt]&&(s=function(t){return t?t.length<3?parseInt(t,10)>68?"19"+t:"20"+t:t:null==e._a[st]?tt().weekYear():e._a[st]},r=e._w,null!=r.GG||null!=r.W||null!=r.E?a=X(s(r.GG),r.W||1,r.E,4,1):(l=x(e._l),c=null!=r.d?W(r.d,l):null!=r.e?parseInt(r.e,10)+l._week.dow:0,d=parseInt(r.w,10)||1,null!=r.d&&c<l._week.dow&&d++,a=X(s(r.gg),d,c,l._week.doy,l._week.dow)),e._a[st]=a.year,e._dayOfYear=a.dayOfYear),e._dayOfYear&&(o=null==e._a[st]?n[st]:e._a[st],e._dayOfYear>_(o)&&(e._pf._overflowDayOfYear=!0),i=G(o,0,e._dayOfYear),e._a[rt]=i.getUTCMonth(),e._a[at]=i.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=u[t]=n[t];for(;7>t;t++)e._a[t]=u[t]=null==e._a[t]?2===t?1:0:e._a[t];u[lt]+=g((e._tzm||0)/60),u[ct]+=g((e._tzm||0)%60),e._d=(e._useUTC?G:z).apply(null,u)}}function k(e){var t;e._d||(t=m(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],R(e))}function P(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function F(e){e._a=[],e._pf.empty=!0;var t,i,n,o,s,r=x(e._l),a=""+e._i,l=a.length,c=0;for(n=I(e._f,r).match(vt)||[],t=0;t<n.length;t++)o=n[t],i=(O(o,e).exec(a)||[])[0],i&&(s=a.substr(0,a.indexOf(i)),s.length>0&&e._pf.unusedInput.push(s),a=a.slice(a.indexOf(i)+i.length),c+=i.length),Ut[o]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(o),N(o,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(o);e._pf.charsLeftOver=l-c,a.length>0&&e._pf.unusedInput.push(a),e._isPm&&e._a[lt]<12&&(e._a[lt]+=12),e._isPm===!1&&12===e._a[lt]&&(e._a[lt]=0),R(e),y(e)}function H(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,o){return t||i||n||o})}function B(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function V(e){var t,i,n,o,s;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(o=0;o<e._f.length;o++)s=0,t=r({},e),T(t),t._f=e._f[o],F(t),S(t)&&(s+=t._pf.charsLeftOver,s+=10*t._pf.unusedTokens.length,t._pf.score=s,(null==n||n>s)&&(n=s,i=t));r(e,i||t)}function U(e){var t,i=e._i,n=Dt.exec(i);if(n){for(e._pf.iso=!0,t=4;t>0;t--)if(n[t]){e._f=Ot[t-1]+(n[6]||" ");break}for(t=0;4>t;t++)if(Lt[t][1].exec(i)){e._f+=Lt[t][0];break}xt.exec(i)&&(e._f+="Z"),F(e)}else e._d=new Date(i)}function j(t){var i=t._i,n=mt.exec(i);i===e?t._d=new Date:n?t._d=new Date(+n[1]):"string"==typeof i?U(t):d(i)?(t._a=i.slice(0),R(t)):u(i)?t._d=new Date(+i):"object"==typeof i?k(t):t._d=new Date(i)}function z(e,t,i,n,o,s,r){var a=new Date(e,t,i,n,o,s,r);return 1970>e&&a.setFullYear(e),a}function G(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function W(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function $(e,t,i,n,o){return o.relativeTime(t||1,!!i,e,n)}function q(e,t,i){var n=ot(Math.abs(e)/1e3),o=ot(n/60),s=ot(o/60),r=ot(s/24),a=ot(r/365),l=45>n&&["s",n]||1===o&&["m"]||45>o&&["mm",o]||1===s&&["h"]||22>s&&["hh",s]||1===r&&["d"]||25>=r&&["dd",r]||45>=r&&["M"]||345>r&&["MM",ot(r/30)]||1===a&&["y"]||["yy",a];return l[2]=t,l[3]=e>0,l[4]=i,$.apply({},l)}function Y(e,t,i){var n,o=i-t,s=i-e.day();return s>o&&(s-=7),o-7>s&&(s+=7),n=tt(e).add("d",s),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function X(e,t,i,n,o){var s,r,a=new Date(Date.UTC(e,0)).getUTCDay();
return i=null!=i?i:o,s=o-a+(a>n?7:0),r=7*(t-1)+(i-o)+s+1,{year:r>0?e:e-1,dayOfYear:r>0?r:_(e-1)+r}}function K(e){var t=e._i,i=e._f;return"undefined"==typeof e._pf&&T(e),null===t?tt.invalid({nullInput:!0}):("string"==typeof t&&(e._i=t=x().preparse(t)),tt.isMoment(t)?(e=r({},t),e._d=new Date(+t._d)):i?d(i)?V(e):F(e):j(e),new o(e))}function Q(e,t){tt.fn[e]=tt.fn[e+"s"]=function(e){var i=this._isUTC?"UTC":"";return null!=e?(this._d["set"+i+t](e),tt.updateOffset(this),this):this._d["get"+i+t]()}}function J(e){tt.duration.fn[e]=function(){return this._data[e]}}function Z(e,t){tt.duration.fn["as"+e]=function(){return+this/t}}function et(e){var t=!1,i=tt;"undefined"==typeof ender&&(this.moment=e?function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),i.apply(null,arguments)}:tt)}for(var tt,it,nt="2.4.0",ot=Math.round,st=0,rt=1,at=2,lt=3,ct=4,dt=5,ut=6,ht={},pt="undefined"!=typeof module&&module.exports,mt=/^\/?Date\((\-?\d+)/i,ft=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,gt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,vt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,_t=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,bt=/\d\d?/,yt=/\d{1,3}/,Tt=/\d{3}/,St=/\d{1,4}/,At=/[+\-]?\d{1,6}/,Ct=/\d+/,Et=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,xt=/Z|[\+\-]\d\d:?\d\d/i,Mt=/T/i,wt=/[\+\-]?\d+(\.\d{1,3})?/,Dt=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,It="YYYY-MM-DDTHH:mm:ssZ",Ot=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Lt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Nt=/([\+\-]|\d\d)/gi,Rt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),kt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Pt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Ft={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Ht={},Bt="DDD w W M D d".split(" "),Vt="M D H h m s w W".split(" "),Ut={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},gg:function(){return l(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return l(this.weekYear(),5)},GG:function(){return l(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return l(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return g(this.milliseconds()/100)},SS:function(){return l(g(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},SSSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(g(e/60),2)+":"+l(g(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(g(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},jt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Bt.length;)it=Bt.pop(),Ut[it+"o"]=i(Ut[it],it);for(;Vt.length;)it=Vt.pop(),Ut[it+it]=t(Ut[it],2);for(Ut.DDDD=t(Ut.DDD,3),r(n.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,n;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(i=tt.utc([2e3,t]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=tt([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var o=this._relativeTime[i];return"function"==typeof o?o(e,t,i,n):o.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return Y(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),tt=function(t,i,n,o){return"boolean"==typeof n&&(o=n,n=e),K({_i:t,_f:i,_l:n,_strict:o,_isUTC:!1})},tt.utc=function(t,i,n,o){var s;return"boolean"==typeof n&&(o=n,n=e),s=K({_useUTC:!0,_isUTC:!0,_l:n,_i:t,_f:i,_strict:o}).utc()},tt.unix=function(e){return tt(1e3*e)},tt.duration=function(e,t){var i,n,o,r=tt.isDuration(e),a="number"==typeof e,l=r?e._input:a?{}:e,c=null;return a?t?l[t]=e:l.milliseconds=e:(c=ft.exec(e))?(i="-"===c[1]?-1:1,l={y:0,d:g(c[at])*i,h:g(c[lt])*i,m:g(c[ct])*i,s:g(c[dt])*i,ms:g(c[ut])*i}):(c=gt.exec(e))&&(i="-"===c[1]?-1:1,o=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*i},l={y:o(c[2]),M:o(c[3]),d:o(c[4]),h:o(c[5]),m:o(c[6]),s:o(c[7]),w:o(c[8])}),n=new s(l),r&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},tt.version=nt,tt.defaultFormat=It,tt.updateOffset=function(){},tt.lang=function(e,t){var i;return e?(t?C(A(e),t):null===t?(E(e),e="en"):ht[e]||x(e),i=tt.duration.fn._lang=tt.fn._lang=x(e),i._abbr):tt.fn._lang._abbr},tt.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),x(e)},tt.isMoment=function(e){return e instanceof o},tt.isDuration=function(e){return e instanceof s},it=jt.length-1;it>=0;--it)f(jt[it]);for(tt.normalizeUnits=function(e){return p(e)},tt.invalid=function(e){var t=tt.utc(0/0);return null!=e?r(t._pf,e):t._pf.userInvalidated=!0,t},tt.parseZone=function(e){return tt(e).parseZone()},r(tt.fn=o.prototype,{clone:function(){return tt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return D(tt(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return S(this)},isDSTShifted:function(){return this._a?this.isValid()&&h(this._a,(this._isUTC?tt.utc(this._a):tt(this._a)).toArray())>0:!1},parsingFlags:function(){return r({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=D(this,e||tt.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var i;return i="string"==typeof e?tt.duration(+t,e):tt.duration(e,t),c(this,i,1),this},subtract:function(e,t){var i;return i="string"==typeof e?tt.duration(+t,e):tt.duration(e,t),c(this,i,-1),this},diff:function(e,t,i){var n,o,s=this._isUTC?tt(e).zone(this._offset||0):tt(e).local(),r=6e4*(this.zone()-s.zone());return t=p(t),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+s.daysInMonth()),o=12*(this.year()-s.year())+(this.month()-s.month()),o+=(this-tt(this).startOf("month")-(s-tt(s).startOf("month")))/n,o-=6e4*(this.zone()-tt(this).startOf("month").zone()-(s.zone()-tt(s).startOf("month").zone()))/n,"year"===t&&(o/=12)):(n=this-s,o="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-r)/864e5:"week"===t?(n-r)/6048e5:n),i?o:a(o)},from:function(e,t){return tt.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(tt(),e)},calendar:function(){var e=this.diff(tt().zone(this.zone()).startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){return b(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=W(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t,i=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+i+"Month"](e),this.date(Math.min(t,this.daysInMonth())),tt.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(e){switch(e=p(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=p(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+tt(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+tt(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+tt(e).startOf(t)},min:function(e){return e=tt.apply(null,arguments),this>e?this:e},max:function(e){return e=tt.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=L(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&c(this,tt.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?tt(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return v(this.year(),this.month())},dayOfYear:function(e){var t=ot((tt(this).startOf("day")-tt(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=Y(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=Y(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=Y(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=p(e),this[e]()},set:function(e,t){return e=p(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=x(t),this)}}),it=0;it<Rt.length;it++)Q(Rt[it].toLowerCase().replace(/s$/,""),Rt[it]);Q("year","FullYear"),tt.fn.days=tt.fn.day,tt.fn.months=tt.fn.month,tt.fn.weeks=tt.fn.week,tt.fn.isoWeeks=tt.fn.isoWeek,tt.fn.toJSON=tt.fn.toISOString,r(tt.duration.fn=s.prototype,{_bubble:function(){var e,t,i,n,o=this._milliseconds,s=this._days,r=this._months,l=this._data;l.milliseconds=o%1e3,e=a(o/1e3),l.seconds=e%60,t=a(e/60),l.minutes=t%60,i=a(t/60),l.hours=i%24,s+=a(i/24),l.days=s%30,r+=a(s/30),l.months=r%12,n=a(r/12),l.years=n},weeks:function(){return a(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12)},humanize:function(e){var t=+this,i=q(t,!e,this.lang());return e&&(i=this.lang().pastFuture(t,i)),this.lang().postformat(i)},add:function(e,t){var i=tt.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=tt.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=p(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=p(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:tt.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),o=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||o||s?"T":"")+(n?n+"H":"")+(o?o+"M":"")+(s?s+"S":""):"P0D"}});for(it in kt)kt.hasOwnProperty(it)&&(Z(it,kt[it]),J(it.toLowerCase()));Z("Weeks",6048e5),tt.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},tt.lang("en",{ordinal:function(e){var t=e%10,i=1===g(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),pt?(module.exports=tt,et(!0)):"function"==typeof define&&define.amd?define("moment",["require","exports","module"],function(t,i,n){return n.config().noGlobal!==!0&&et(n.config().noGlobal===e),tt}):et()}.call(this),define("common/util/datetime/RelativeDate",["require","underscore"],function(e){var t=e("underscore"),i=function(e,t,i){this.setKeyword(e),this.setSign(t),this.setNumber(i)};return i.prototype.setKeyword=function(e){this.keyword=e.toUpperCase()},i.prototype.setSign=function(e){this.sign=e},i.prototype.setNumber=function(e){if(t.isNumber(e))this.number=e;else{var i=parseInt(e,10);this.number=isNaN(i)?0:i}},i.prototype.toString=function(){return t.isNumber(this.number)&&!isNaN(this.number)&&this.number>0&&("+"===this.sign||"-"===this.sign)&&this.keyword in i.PATTERNS?this.keyword+this.sign+this.number.toString():this.keyword in i.PATTERNS?this.keyword:""},i.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},i.parse=function(e){if(i.isValid(e))for(var n in i.PATTERNS){var o=i.PATTERNS[n].exec(e);if(null!==o&&t.isArray(o)&&5===o.length)return new i(o[1],o[3],o[4])}return void 0},i.isValid=function(e){if(e instanceof i)return""!==e.toString();if(t.isString(e))for(var n in i.PATTERNS)if(i.PATTERNS[n].test(e))return!0;return!1},i}),define("common/util/datetime/RelativeTimestamp",["require","common/util/datetime/RelativeDate","underscore"],function(e){var t=e("common/util/datetime/RelativeDate"),i=e("underscore"),n=function(){t.apply(this,arguments)},o=function(){};return o.prototype=t.prototype,n.prototype=new o,n.prototype.constructor=n,n.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},n.parse=function(e){if(n.isValid(e))for(var t in n.PATTERNS){var o=n.PATTERNS[t].exec(e);if(null!==o&&i.isArray(o)&&5===o.length)return new n(o[1],o[3],o[4])}return void 0},n.isValid=function(e){if(e instanceof n)return""!==e.toString();if(i.isString(e))for(var t in n.PATTERNS)if(n.PATTERNS[t].test(e))return!0;return!1},n}),define("common/util/parse/date",["require","moment","jrs.configs","underscore","common/util/datetime/RelativeDate","common/util/datetime/RelativeTimestamp"],function(e){function t(e){var t=e.toLowerCase();return t.replace(t.indexOf("yyyy")>-1?"yyyy":"yy","YYYY").replace("mm","MM").replace("dd","DD")}function i(e){return e.toLowerCase().replace("hh","HH")}function n(e,n,o){var s=t(e),r=i(n);return s+(null!=o?o:" ")+r}function o(e){return A(e,t(C.localeSettings.dateFormat),!0)}function s(e){return A(e,n(C.localeSettings.dateFormat,C.localeSettings.timeFormat,C.localeSettings.timestampSeparator),!0)}function r(e){return x.isValid(e)}function a(e){return M.isValid(e)}function l(e){return E.isDate(e)&&A(e).isValid()||E.isString(e)&&""!==e&&o(e).isValid()}function c(e){return E.isDate(e)&&A(e).isValid()||E.isString(e)&&""!==e&&s(e).isValid()}function d(e){return A(e,w,!0).isValid()}function u(e,t){if(l(e)&&l(t)){var i=E.isDate(e)?A(e):o(e),n=E.isDate(t)?A(t):o(t);return p(i,n)}}function h(e,t){if(c(e)&&c(t)){var i=E.isDate(e)?A(e):s(e),n=E.isDate(t)?A(t):s(t);return p(i,n)}}function p(e,t){return e.isBefore(t)?-1:e.isAfter(t)?1:0}function m(e){var t=A(e);return E.isDate(e)&&t.isValid()?t.format(w):void 0}function f(e){var t=A(e,w,!0);return t.isValid()?t.toDate():void 0}function g(e){return S(e,n(C.localeSettings.dateFormat,C.localeSettings.timeFormat,C.localeSettings.timestampSeparator),w)}function v(e){return S(e,w,n(C.localeSettings.dateFormat,C.localeSettings.timeFormat,C.localeSettings.timestampSeparator))}function _(e){return S(e,t(C.localeSettings.dateFormat),D)}function b(e){return S(e,D,t(C.localeSettings.dateFormat))}function y(e){return S(e,i(C.localeSettings.timeFormat),I)}function T(e){return S(e,I,i(C.localeSettings.timeFormat))}function S(e,t,i){if(x.isValid(e))return e;var n=A(e,t);return n.isValid()?n.format(i):e}var A=e("moment"),C=e("jrs.configs"),E=e("underscore"),x=e("common/util/datetime/RelativeDate"),M=e("common/util/datetime/RelativeTimestamp"),w="YYYY-MM-DD[T]HH:mm:ss",D="YYYY-MM-DD",I="hh:mm:ss";return{isRelativeDate:r,isRelativeTimestamp:a,isDate:l,isTimestamp:c,isIso8601Timestamp:d,compareDates:u,compareTimestamps:h,dateObjectToIso8601Timestamp:m,iso8601TimestampToDateObject:f,localizedTimestampToIsoTimestamp:g,isoTimestampToLocalizedTimestamp:v,localizedDateToIsoDate:_,isoDateToLocalizedDate:b,localizedTimeToIsoTime:y,isoTimeToLocalizedTime:T}}),define("common/util/datetime/RelativeTime",["require","common/util/datetime/RelativeDate","underscore"],function(e){var t=e("common/util/datetime/RelativeDate"),i=e("underscore"),n=function(){t.apply(this,arguments)},o=function(){};return o.prototype=t.prototype,n.prototype=new o,n.prototype.constructor=n,n.PATTERNS={MINUTE:/^(MINUTE)(([+|\-])(\d{1,9}))?$/i,HOUR:/^(HOUR)(([+|\-])(\d{1,9}))?$/i},n.parse=function(e){if(n.isValid(e))for(var t in n.PATTERNS){var o=n.PATTERNS[t].exec(e);if(null!==o&&i.isArray(o)&&5===o.length)return new n(o[1],o[3],o[4])}return void 0},n.isValid=function(e){if(e instanceof n)return""!==e.toString();if(i.isString(e))for(var t in n.PATTERNS)if(n.PATTERNS[t].test(e))return!0;return!1},n}),define("common/util/datetime/Time",["require","underscore"],function(e){function t(e){return new RegExp("^"+e.toLowerCase().replace("hh","([0-1][0-9]|2[0-3])").replace("mm","([0-5][0-9])").replace("ss","([0-5][0-9])")+"$")}function i(e){var t=e.toLowerCase().match(/(hh|mm|ss)/g),i={h:-1,m:-1,s:-1};if(t)for(var n=0;n<t.length;n++)-1==i[t[n].toString().charAt(0)]&&(i[t[n].toString().charAt(0)]=n+1);return i}function n(e,t,i){this.hours=e||0,this.minutes=t||0,this.seconds=i||0}var o=e("underscore");return n.prototype.total=function(){return 3600*this.hours+60*this.minutes+this.seconds},n.prototype.isValid=function(){return this.hours>=0&&this.hours<=23&&this.minutes>=0&&this.minutes<=59&&this.seconds>=0&&this.seconds<=59},n.prototype.format=function(e){return e.toLowerCase().replace("hh",this.hours<10?"0"+this.hours:this.hours).replace("mm",this.minutes<10?"0"+this.minutes:this.minutes).replace("ss",this.seconds<10?"0"+this.seconds:this.seconds)},n.compare=function(e,t){var i=e.total(),n=t.total();return n>i?-1:i>n?1:0},n.parse=function(e,s){var r=t(s);if(o.isString(e)&&r.test(e)){var a=new n,l=r.exec(e),c=i(s);return a.hours=parseInt(l[c.h],10),a.minutes=parseInt(l[c.m],10),a.seconds=parseInt(l[c.s],10),a}return void 0},n}),define("common/util/parse/time",["require","jrs.configs","underscore","common/util/datetime/RelativeTime","common/util/datetime/Time"],function(e){function t(e){return l.isValid(e)}function i(e,t){var i=c.parse(e,null!=t?t:a.localeSettings.timeFormat);return"undefined"!=typeof i&&i.isValid()}function n(e){return i(e,d)}function o(e,t,i){var n=e instanceof c?e:c.parse(e,null!=i?i:a.localeSettings.timeFormat),o=t instanceof c?t:c.parse(t,null!=i?i:a.localeSettings.timeFormat);if("undefined"!=typeof n&&"undefined"!=typeof o)return c.compare(n,o)}function s(e,t,i){var n=new c(e,t,i);return n.isValid()?n.format(d):void 0}function r(e){return c.parse(e,d)}var a=e("jrs.configs"),l=(e("underscore"),e("common/util/datetime/RelativeTime")),c=e("common/util/datetime/Time"),d="hh:mm:ss";return{isRelativeTime:t,isTime:i,isIso8601Time:n,compareTimes:o,timeToIso8061Time:s,iso8601TimeToTimeObject:r}}),define("adhoc/filter/validation/ValidationError",["require","bundle!AdHocFiltersBundle"],function(e){var t=e("bundle!AdHocFiltersBundle"),i=function(e,t,n,o){this.value=e,this.messageCode=n,this.validator=o;var s=t.split(i.ATTRIBUTE_INDEX_SEPARATOR);2==s.length?(this.attribute=s[0],this.index=1*s[1]):(this.attribute=t,this.index=0)};return i.ATTRIBUTE_INDEX_SEPARATOR="__",i.prototype.getMessage=function(){return t[this.messageCode]},i.prototype.getAttr=function(){return 0===this.index?this.attribute:this.attribute+i.ATTRIBUTE_INDEX_SEPARATOR+this.index},i}),define("adhoc/filter/validation/validationMessageCodes",{REQUIRED:"ADHOC_VALIDATION_RULE_REQUIRED",INVALID_RANGE:"ADHOC_VALIDATION_RULE_INVALID_RANGE",INVALID_LIST:"ADHOC_VALIDATION_RULE_INVALID_LIST",INVALID_TRUE_ALL_LIST:"ADHOC_VALIDATION_RULE_INVALID_TRUE_ALL_LIST",INVALID_INTEGER:"ADHOC_VALIDATION_RULE_INVALID_INTEGER",INVALID_LONG:"ADHOC_VALIDATION_RULE_INVALID_LONG",INVALID_DECIMAL:"ADHOC_VALIDATION_RULE_INVALID_DECIMAL",INVALID_STRING:"ADHOC_VALIDATION_RULE_INVALID_STRING",INVALID_DATE:"ADHOC_VALIDATION_RULE_INVALID_DATE",INVALID_TIMESTAMP:"ADHOC_VALIDATION_RULE_INVALID_TIMESTAMP",INVALID_TIME:"ADHOC_VALIDATION_RULE_INVALID_TIME",INVALID_BOOLEAN:"ADHOC_VALIDATION_RULE_INVALID_BOOLEAN",NOT_NULLABLE:"ADHOC_VALIDATION_RULE_NOT_NULLABLE",NOT_BLANK:"ADHOC_VALIDATION_RULE_NOT_BLANK",START_BIGGER_THAN_END:"ADHOC_VALIDATION_RULE_START_BIGGER_THAN_END",START_DATE_LATER_THAN_FINISH:"ADHOC_VALIDATION_RULE_START_DATE_LATER_THAN_FINISH",START_TIME_LATER_THAN_FINISH:"ADHOC_VALIDATION_RULE_START_TIME_LATER_THAN_FINISH"}),define("adhoc/filter/validation/backboneValidationExtensions",["require","backbone","underscore","common/util/parse/number","common/util/parse/date","common/util/parse/time","jrs.configs","adhoc/filter/validation/ValidationError","adhoc/filter/validation/validationMessageCodes","backbone.validation"],function(e){var t=e("backbone"),i=e("underscore"),n=e("common/util/parse/number"),o=e("common/util/parse/date"),s=e("common/util/parse/time"),r=e("jrs.configs"),a=e("adhoc/filter/validation/ValidationError"),l=e("adhoc/filter/validation/validationMessageCodes");e("backbone.validation");var c=a.ATTRIBUTE_INDEX_SEPARATOR,d=r.inputControlsConstants&&r.inputControlsConstants.NULL_SUBSTITUTION_VALUE?r.inputControlsConstants.NULL_SUBSTITUTION_VALUE.toLowerCase():"~null~",u="~BLANK~",h=function(e){return!(i.isNull(e)||i.isUndefined(e)||i.isString(e)&&""===e)},p=function(e,n,o,s,r){for(var a=[],l=0;l<e.length;l++){var d=void 0;for(var u in r)if(d=t.Validation.validators[u](e[l],n+c+(l+1),r[u],s),!i.isUndefined(d))break;a.push(d)}return i.reject(a,function(e){return i.isUndefined(e)})};return i.extend(t.Validation.validators,{required:function(e,t,n,o,s){var r=i.isFunction(n)?n.call(o,e,t,s):n;return r||h(e)?r&&!h(e)?new a(e,t,l.REQUIRED,"required"):void 0:!1},integer:function(e,t){return n.isInt(e)?void 0:new a(e,t,l.INVALID_INTEGER,"integer")},integerRange:function(e,t,o,s){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"integerRange");var r=p(e,t,!0,s,{required:!0,nullable:!1,integer:!0});if(r.length)return r;var c=n.parseNumber(e[0]),d=n.parseNumber(e[1]);return c>d?new a(e,t,l.START_BIGGER_THAN_END,"integerRange"):void 0},listWithTrueAll:function(e,t,n,o,s){return i.isArray(e)&&e.length>0||s.isAnyValue===!0?void 0:new a(e,t,l.INVALID_TRUE_ALL_LIST,"listWithTrueAll")},list:function(e,t){return i.isArray(e)?void 0:new a(e,t,l.INVALID_LIST,"list")},decimal:function(e,t){return n.isDecimal(e)?void 0:new a(e,t,l.INVALID_DECIMAL,"decimal")},decimalRange:function(e,t,o,s){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"decimalRange");var r=p(e,t,o,s,{required:!0,nullable:!1,decimal:!0});if(r.length)return r;var c=n.parseNumber(e[0]),d=n.parseNumber(e[1]);return c>d?new a(e,t,l.START_BIGGER_THAN_END,"decimalRange"):void 0},"long":function(e,t){return n.isInt(e)?void 0:new a(e,t,l.INVALID_LONG,"long")},longRange:function(e,t,o,s){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"longRange");var r=p(e,t,o,s,{required:!0,nullable:!1,"long":!0});if(r.length)return r;var c=n.parseNumber(e[0]),d=n.parseNumber(e[1]);if(c!==!1&&d!==!1)return c>d?new a(e,t,l.START_BIGGER_THAN_END,"longRange"):void 0},string:function(e,t){return i.isString(e)?void 0:new a(e,t,l.INVALID_STRING,"string")},nullable:function(e,t,n){return n===!0&&i.isString(e)&&d===e.toLowerCase()?!1:n===!1&&i.isString(e)&&d===e.toLowerCase()?new a(e,t,l.NOT_NULLABLE,"nullable"):void 0},stringRange:function(e,t,n,o){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"stringRange");var s=p(e,t,n,o,{required:!0,string:!0,nullable:!1});return s.length?s:void 0},date:function(e,t){return o.isDate(e)||o.isRelativeDate(e)?void 0:new a(e,t,l.INVALID_DATE,"date")},dateRange:function(e,t,n,s){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"dateRange");var r=p(e,t,n,s,{required:!0,nullable:!1,date:!0});if(r.length)return r;var c=o.compareDates(e[0],e[1]);return"undefined"!=typeof c&&c>0?new a(e,t,l.START_DATE_LATER_THAN_FINISH,"dateRange"):void 0},timestamp:function(e,t){return o.isTimestamp(e)||o.isRelativeTimestamp(e)?void 0:new a(e,t,l.INVALID_TIMESTAMP,"timestamp")},timestampRange:function(e,t,n,s){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"timestampRange");var r=p(e,t,n,s,{required:!0,nullable:!1,timestamp:!0});if(r.length)return r;var c=o.compareTimestamps(e[0],e[1]);return"undefined"!=typeof c&&c>0?new a(e,t,l.START_DATE_LATER_THAN_FINISH,"timestampRange"):void 0},time:function(e,t){return s.isTime(e)?void 0:new a(e,t,l.INVALID_TIME,"time")},timeRange:function(e,t,n,o){if(!i.isArray(e)||2!==e.length)return new a(e,t,l.INVALID_RANGE,"timeRange");var r=p(e,t,n,o,{required:!0,nullable:!1,time:!0});if(r.length)return r;var c=s.compareTimes(e[0],e[1]);return"undefined"!=typeof c&&c>0?new a(e,t,l.START_TIME_LATER_THAN_FINISH,"timeRange"):void 0},"boolean":function(e,t){return i.isBoolean(e)||i.isString(e)&&i.include(["true","false"],e.toLowerCase())?void 0:new a(e,t,l.INVALID_BOOLEAN,"boolean")},blank:function(e,t,i){return i===!0&&e===u?!1:i===!1&&e===u?new a(e,t,l.NOT_BLANK,"blank"):void 0}}),t.Validation}),define("adhoc/filter/FilterModel",["require","underscore","jquery","backbone","bundle!AdHocFiltersBundle","common/util/parse/number","adhoc/filter/filterModelTrait/dateRangeFilterModelTrait","adhoc/filter/filterModelTrait/listFilterModelTrait","adhoc/filter/filterModelTrait/literalFilterModelTrait","adhoc/filter/filterModelTrait/rangeFilterModelTrait","adhoc/filter/filterModelTrait/readOnlyFilterModelTrait","adhoc/filter/enum/filterDataTypes","adhoc/filter/enum/filterExpressionTypes","adhoc/filter/enum/filterOperators","adhoc/filter/factory/filterModelValidationFactory","adhoc/filter/factory/filterModelExpressionTypeFactory","adhoc/filter/factory/filterModelDefaultValueFactory","adhoc/filter/format/OlapFilterValueFormatter","common/component/singleSelect/dataprovider/DataProviderNew","common/component/singleSelect/dataprovider/ValueFormattingDataProvider","settings!adhocFilterSettings","adhoc/filter/validation/backboneValidationExtensions"],function(e){function t(e){return e===g.TIMESTAMP||e===g.DATE}function i(e){return e===g.BOOLEAN}function n(e){return e===g.TIME}function o(e){return e===g.STRING}function s(e){return e===g.INTEGER||e===g.DECIMAL||e===g.LONG||e===g.NUMERIC}var r=e("underscore"),a=e("jquery"),l=e("backbone"),c=e("bundle!AdHocFiltersBundle"),d=e("common/util/parse/number"),u=e("adhoc/filter/filterModelTrait/dateRangeFilterModelTrait"),h=e("adhoc/filter/filterModelTrait/listFilterModelTrait"),p=e("adhoc/filter/filterModelTrait/literalFilterModelTrait"),m=e("adhoc/filter/filterModelTrait/rangeFilterModelTrait"),f=e("adhoc/filter/filterModelTrait/readOnlyFilterModelTrait"),g=e("adhoc/filter/enum/filterDataTypes"),v=e("adhoc/filter/enum/filterExpressionTypes"),_=e("adhoc/filter/enum/filterOperators"),b=e("adhoc/filter/factory/filterModelValidationFactory"),y=e("adhoc/filter/factory/filterModelExpressionTypeFactory"),T=e("adhoc/filter/factory/filterModelDefaultValueFactory"),S=e("adhoc/filter/format/OlapFilterValueFormatter"),A=e("common/component/singleSelect/dataprovider/DataProviderNew"),C=e("common/component/singleSelect/dataprovider/ValueFormattingDataProvider"),E=e("settings!adhocFilterSettings");e("adhoc/filter/validation/backboneValidationExtensions");var x={};x[v.LITERAL]=p,x[v.LIST]=h,x[v.DATE_RANGE]=u,x[v.RANGE]=m,x[v.READ_ONLY]=f;var M={DATA_CHOOSER_NO_PROMPT:"ADH_1215_DYNAMIC_FILTER_UNEDITABLE_TITLE",SLICE_COMPLEX_KEEPONLY:"ADH_1208_DYNAMIC_FILTER_KEEP",SLICE_COMPLEX_EXCLUDE:"ADH_1209_DYNAMIC_FILTER_EXCLUDE"},w=l.Model.extend({initialize:function(e,t){this.service=t.service,this.isOlap=t.isOlap,E=r.defaults(E||{},{availableItemsPageSizeOlap:"999",availableItemsPageSize:"999"}),this.dataProvider=new A({pageSize:this.isOlap?+E.availableItemsPageSizeOlap:+E.availableItemsPageSize,request:new C({request:r.bind(this._requestValues,this),format:this.isOlap?new S(this.get("isFirstLevelInHierarchyAll")).format:null}).getData,controlGetTotal:!0,saveLastCriteria:!0}),this.removeAvailableData(),this.removeMinMaxValues(),this.on("change:operatorName",this._onOperatorNameChange),this.on("change:expressionType",this._onExpressionTypeChange),this._updateModelBehavior()
},_requestValues:function(e){var t=this.get("showLoading");return this.service.fetchValues(this.get("name"),e,t)},setShowLoading:function(e){this.set("showLoading",e,{silent:!0})},removeAvailableData:function(){this.dataProvider.clear()},removeMinMaxValues:function(){this._minMaxValuesDeferred=null,this.minValue=null,this.maxValue=null},fetchDataForChangeFilterType:function(){return this.dataProvider.getData({offset:0,limit:1})},fetchMinMaxValues:function(){var e=this;return this._minMaxValuesDeferred||(this._minMaxValuesDeferred=this.service.getMaxMinValues(this.get("name")).done(function(t){var i=t.maxMin;e.minValue=i[0],e.maxValue=i[1]})),this._minMaxValuesDeferred},loadAdditionalServerData:function(e){var t=this;return this.additionalServerDataDeferred(e).done(function(){t._setValue()})},additionalServerDataDeferred:function(e){var t=new a.Deferred;return t.resolve(),this.isString()&&r.include([_.IN,_.NOT_IN,_.EQUALS,_.NOT_EQUAL],this.get("operatorName"))?e||(t=a.when(this.fetchDataForChangeFilterType())):(this.isNumber()||this.isDate()||this.isTime())&&(r.include([_.IN,_.NOT_IN],this.get("operatorName"))?e||(t=a.when(this.fetchDataForChangeFilterType())):r.include([_.LESS,_.LESS_OR_EQUAL,_.GREATER,_.GREATER_OR_EQUAL,_.BETWEEN,_.NOT_BETWEEN,_.BETWEEN_DATES,_.NOT_BETWEEN_DATES],this.get("operatorName"))&&(t=a.when(this.fetchMinMaxValues()))),t},_onOperatorNameChange:function(){var e=this.previousAttributes();"undefined"!=typeof e.operatorName&&e.operatorName===_.IN&&this.get("operatorName")!==_.IS_ANY_VALUE&&this.get("isAnyValue")&&this.set("isAnyValue",!1,{silent:!0});var t=y(this.get("filterDataType"),this.get("operatorName"));this.set("expressionType",t,{silent:!0}),this.trigger("change:expressionType",this,this.get("expressionType"))},saveValue:function(){return this.service.update(this.get("id"),this.toExpression())},_onExpressionTypeChange:function(){var e=this;this._updateModelBehavior(),this.loadAdditionalServerData().done(function(){e.trigger("operationChange",e)})},_updateModelBehavior:function(){this._updateInstanceWithTrait(),this._updateInstanceWithValidation()},_setValue:function(){if(!this.isReadOnly()){var e=this.previousAttributes();if(!r.isEmpty(e)&&this._isDefaultValueSelected(e))this._setDefaultValue();else{var t=this.get("value"),i=[_.EQUALS,_.NOT_EQUAL],n=[_.CONTAINS,_.NOT_CONTAINS,_.STARTS_WITH,_.NOT_STARTS_WITH,_.ENDS_WITH,_.NOT_ENDS_WITH],o=[_.IN,_.NOT_IN];r.include(n,e.operatorName)&&r.include(i,this.get("operatorName"))?this._setDefaultValue():(this.isString()||this.isBoolean())&&r.include(i,e.operatorName)&&r.include(o,this.get("operatorName"))?this.set({value:[t]},{silent:!0,validate:!0}):e.expressionType===v.LIST&&this.get("expressionType")===v.LITERAL?this.set({value:r.isArray(t)?t[0]:t},{silent:!0,validate:!0}):e.expressionType===v.LIST&&r.include([v.RANGE,v.DATE_RANGE],this.get("expressionType"))?this.set({value:[t[0],t[t.length-1]]},{silent:!0,validate:!0}):r.include([_.EQUALS,_.NOT_EQUAL],e.operatorName)&&r.include([v.RANGE,v.DATE_RANGE],this.get("expressionType"))?this.set({value:[t,t]},{silent:!0,validate:!0}):r.include([_.GREATER,_.GREATER_OR_EQUAL],e.operatorName)&&r.include([v.RANGE,v.DATE_RANGE],this.get("expressionType"))?this.set({value:[t,this.maxValue]},{silent:!0,validate:!0}):r.include([_.LESS,_.LESS_OR_EQUAL],e.operatorName)&&r.include([v.RANGE,v.DATE_RANGE],this.get("expressionType"))?this.set({value:[this.minValue,t]},{silent:!0,validate:!0}):r.include([v.RANGE,v.DATE_RANGE],e.expressionType)&&this.get("expressionType")===v.LIST?this._setDefaultValue():r.include([v.RANGE,v.DATE_RANGE],e.expressionType)&&r.include([_.EQUALS,_.NOT_EQUAL,_.GREATER,_.GREATER_OR_EQUAL],this.get("operatorName"))?this.set({value:t[0]},{silent:!0,validate:!0}):r.include([v.RANGE,v.DATE_RANGE],e.expressionType)&&r.include([_.LESS,_.LESS_OR_EQUAL],this.get("operatorName"))&&this.set({value:t[t.length-1]},{silent:!0,validate:!0}),this.isValid(!0)||this._setDefaultValue()}}},_getDefaultValue:function(){return T(this.get("filterDataType"),this.get("operatorName"),this.isOlap,this.additionalModelDataForDefaultValue())},_setDefaultValue:function(){this.set(this._getDefaultValue(),{silent:!0,validate:!0})},_isDefaultValueSelected:function(e){var t=T(this.get("filterDataType"),e.operatorName,this.isOlap,this.additionalModelDataForDefaultValue()),i={value:e.value,isAnyValue:e.isAnyValue};return w.valueObjectsAreEqual(i,t)},additionalModelDataForDefaultValue:function(){var e=[];if(this.dataProvider.dataCacheTotal>0){var t=this.dataProvider.dataCache.slice(0,this.dataProvider.pageSize);e=r.map(t,function(e){return e.value})}return{min:this.minValue,max:this.maxValue,values:e,allValuesLoaded:this.dataProvider.dataCacheTotal<=this.dataProvider.pageSize}},set:function(e,t,i){var n;return null==e?this:("object"==typeof e?(n=e,i=t):(n={})[e]=t,i||(i={}),n=w.normalizeAttributes(n),l.Model.prototype.set.call(this,n,i))},_updateInstanceWithTrait:function(){return r.extend(this,x[this.get("expressionType")])},_updateInstanceWithValidation:function(){this.validation=b(this.get("filterDataType"),this.get("operatorName"))},toExpression:function(){var e=this.get("operatorName");(this.isTime()||this.isNumber())&&(e===_.BETWEEN?e=_.IN:e===_.NOT_BETWEEN&&(e=_.NOT_IN)),this.get("isAnyValue")&&(e=_.IS_ANY_VALUE);var t={type:this.get("operatorType"),name:e,operands:[{type:this.get("filterLabelType"),name:this.get("name")}]};return this.get("isAnyValue")||[].push.apply(t.operands,this._rValue()),[t]},_rValue:function(){var e=this._expressionRValue();return r.isArray(e)?e:[e]},isDate:function(){return t(this.get("filterDataType"))},isBoolean:function(){return i(this.get("filterDataType"))},isTime:function(){return n(this.get("filterDataType"))},isString:function(){return o(this.get("filterDataType"))},isNumber:function(){return s(this.get("filterDataType"))},isReadOnly:function(){return!this.get("editable")}},{normalizeAttributes:function(e){var i=r.clone(e);if(i.hasOwnProperty("expressionAsString")&&delete i.expressionAsString,i.hasOwnProperty("editable")&&(i.editable||(i.filterDataType=g.READ_ONLY,i.operatorName=_.READ_ONLY,i.label=c[M[e.source]||M.DATA_CHOOSER_NO_PROMPT],i.isComplex="complex"===e.name.toLowerCase())),r.isUndefined(i.isAnyValue)&&i.hasOwnProperty("operatorName")&&(i.operatorName===_.IS_ANY_VALUE?(i.isAnyValue=!0,i.operatorName=t(i.filterDataType)?_.BETWEEN_DATES:_.IN):i.isAnyValue=!1),i.hasOwnProperty("operatorName")&&i.hasOwnProperty("filterDataType")){var n=y(i.filterDataType,i.operatorName);r.isUndefined(i.expressionType)&&(i.expressionType=n),n===v.LITERAL&&i.hasOwnProperty("value")&&r.isArray(i.value)&&1===i.value.length&&(i.value=i.value[0])}return i},_isArraysEquals:function(e,t){if(e.length!=t.length)return!1;var i,n={};for(i=0;i<e.length;i++)n[e[i]]=!0;for(i=0;i<t.length;i++)if(!n[t[i]])return!1;return!0},valueObjectsAreEqual:function(e,t){if("undefined"==typeof e.isAnyValue&&t.isAnyValue===!0||"undefined"==typeof t.isAnyValue&&e.isAnyValue===!0||"undefined"!=typeof e.isAnyValue&&"undefined"!=typeof t.isAnyValue&&e.isAnyValue!==t.isAnyValue)return!1;var i=e.value,n=t.value;if(r.isArray(i)&&r.isArray(n))return this._isArraysEquals(i,n);if(r.isArray(i)||r.isArray(n))return!1;var o=d.parseNumber(i),s=d.parseNumber(n);return"undefined"==typeof o&&"undefined"==typeof s?i==n:o==s}});return r.extend(w.prototype,l.Validation.mixin),w}),define("adhoc/filter/FilterCollection",["require","backbone","adhoc/filter/FilterModel","underscore"],function(e){var t=e("backbone"),i=e("adhoc/filter/FilterModel"),n=e("underscore");return t.Collection.extend({model:i,addFromField:function(e){return this.add(this.createFilter(e))},createFilter:function(e){return new this.model({filterDataType:e.type,id:e.name,label:e.defaultDisplayName,operatorName:"equals",filterLetter:this.nextLetter(),value:"",state:{value:""}})},initialize:function(e,t){this.service=t.service,this.isOlap=t.isOlap},set:function(e,i){return i=i||{},n.extend(i,{service:this.service,isOlap:this.isOlap}),t.Collection.prototype.set.call(this,e,i)},nextLetter:function(){return this.length>0?this.incLetter(this.at(this.length-1).get("filterLetter")):"A"},incLetter:function(e){return n.isEmpty(e)?e:String.fromCharCode(e.charCodeAt(0)+1)},editableFilters:function(){return this.filter(function(e){return e.get("editable")})},toExpression:function(){return n(this.editableFilters()).map(function(e){return{filterId:e.get("id"),filterExpression:e.toExpression()}})}})}),define("adhoc/filter/factory/filterOperatorLabelFactory",["require","adhoc/filter/enum/filterOperators","adhoc/filter/enum/filterDataTypes","underscore","bundle!AdHocFiltersBundle"],function(e){var t=e("adhoc/filter/enum/filterOperators"),i=e("adhoc/filter/enum/filterDataTypes"),n=e("underscore"),o=e("bundle!AdHocFiltersBundle"),s={};s[t.IN]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_IN",s[t.NOT_IN]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_IN",s[t.BETWEEN]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_BETWEEN",s[t.NOT_BETWEEN]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_BETWEEN",s[t.EQUALS]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_EQUAL",s[t.NOT_EQUAL]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_EQUAL",s[t.CONTAINS]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_CONTAINS",s[t.NOT_CONTAINS]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_CONTAINS",s[t.GREATER]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_GREATER",s[t.GREATER_OR_EQUAL]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_IS_GREATER_OR_EQUAL",s[t.LESS]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_LESS",s[t.LESS_OR_EQUAL]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_LESS_OR_EQUAL",s[t.BETWEEN_DATES]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_BETWEEN",s[t.NOT_BETWEEN_DATES]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_BETWEEN",s[t.STARTS_WITH]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_STARTS",s[t.NOT_STARTS_WITH]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_STARTS",s[t.ENDS_WITH]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_ENDS",s[t.NOT_ENDS_WITH]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_NOT_ENDS";var r={};return n.extend(r,s),r[t.GREATER]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_IS_AFTER",r[t.GREATER_OR_EQUAL]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_IS_ON_OR_AFTER",r[t.LESS]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_IS_BEFORE",r[t.LESS_OR_EQUAL]="ADH_1211_DYNAMIC_FILTER_COMPARISON_OPERATOR_IS_ON_OR_BEFORE",function(e,t){var a=s;return n.include([i.TIME,i.TIMESTAMP,i.DATE],t)&&(a=r),e in a&&a[e]in o?o[a[e]]:e}}),define("adhoc/filter/valueEditor/AbstractValueEditor",["require","backbone","underscore","adhoc/filter/validation/ValidationError","backbone.validation"],function(e){var t=e("backbone"),i=e("underscore"),n=e("adhoc/filter/validation/ValidationError");return e("backbone.validation"),t.View.extend({constructor:function(e){this.initOptions=e,this.template=i.template(e.template),t.View.apply(this,arguments)},i18nModel:function(e){return e.i18n=this.initOptions.i18n,e},serializeModel:function(){return this.model.toJSON()},modelVariableName:"value",initialize:function(e){t.Validation.bind(this,{valid:this.validCallback,invalid:this.invalidCallback,selector:"data-validation-field"}),this.init(e),this.render(),this.initView(e),this.registerEvents(),e.modelVariable&&(this.modelVariableName=e.modelVariable)},validCallback:function(e,t,i){e.markSingleFieldAsValid(t,i)},invalidCallback:function(e,t,i,n){e.markSingleFieldAsInvalid(t,i,n)},markSingleFieldAsValid:function(e,t){this.$("["+t+'="'+e+'"]').text("").parent().removeClass("error")},markSingleFieldAsInvalid:function(e,t,o){t=i.isArray(t)?t[0]:t,this.$("["+o+'="'+e+'"]').text(t instanceof n?t.getMessage():t).parent().addClass("error")},init:function(){},initView:function(){},removeView:function(){},registerEvents:function(){},render:function(){return this.$el.html(this.template(this.i18nModel(this.serializeModel()))),this.trigger("rendered",this),this},convert:function(e){return this.valueConverter?this.valueConverter(e):e},getValue:function(){return this.model.get(this.modelVariableName)},setValue:function(e){this.model.set(this.modelVariableName,e,{validate:!0})},updateData:function(){this.render()},remove:function(){return this.removeView(),t.Validation.unbind(this),t.View.prototype.remove.call(this),this}})}),define("adhoc/filter/format/filterValueFormatter",["require","settings!adhocFilterSettings"],function(e){var t=e("settings!adhocFilterSettings"),i=t?t.nullValue:null,n=t?t.nullLabel:null;return function(e){return e===i?n:e}}),define("common/component/list/model/listWithNavigationModelTrait",["require","underscore"],function(e){var t=e("underscore"),i={activate:function(e,i){if("number"!=typeof e)return void this.setActive({});if(i=i||{},e>=this.get("bufferStartIndex")&&e<=this.get("bufferEndIndex")){var n=this.get("items")[e-this.get("bufferStartIndex")];n&&this.setActive(t.extend(i,{index:e,item:n}))}else{var o=this;this.getData({offset:e,limit:1}).done(function(n){o.setActive(t.extend(i,{index:e,item:n.data[0]}))}).fail(this.fetchFailed)}},setActive:function(e){this.active&&e.index===this.active.index&&e.item.value===this.active.value||(this.active=e&&"number"==typeof e.index?{index:e.index,value:e.item.value,label:e.item.label}:void 0,e&&e.silent||(this.trigger("change"),this.trigger("active:changed",this.active)))},getActive:function(){return this.active}};return i}),define("common/component/singleSelect/manager/KeyboardManager",["require","underscore"],function(e){var t=e("underscore"),i=200,n=function(e){return this.initialize(e),this};return t.extend(n.prototype,{systemKeyCodes:[16,17,91],keydownHandlers:{38:"onUpKey",40:"onDownKey",13:"onEnterKey",27:"onEscKey",36:"onHomeKey",35:"onEndKey",9:"onTabKey",33:"onPageUpKey",34:"onPageDownKey"},initialize:function(e){t.bindAll(this,"onKeydown"),e.keydownHandlers&&(this.keydownHandlers=e.keydownHandlers),this.stopPropagation=e.stopPropagation,this.keydownTimeout=e.keydownTimeout||i,this.context=e.context,this.deferredKeydownHandler=e.deferredKeydownHandler,this.immediateHandleCondition=e.immediateHandleCondition,this.immediateKeydownHandler=e.immediateKeydownHandler},onKeydown:function(e){this._isSystemKeyPressed(e)||(this._canImmediatelyHandleKeyboardEvent(e)?this._immediatelyHandleKeyboardEvent(e):this.deferredHandleKeyboardEvent(e),this.stopPropagation&&e.stopPropagation())},deferredHandleKeyboardEvent:function(e){this.deferredKeydownHandler&&(this.keydownTimeout>0?(clearTimeout(this.deferredTimeout),this.deferredTimeout=setTimeout(t.bind(this.deferredKeydownHandler,this.context,e),this.keydownTimeout)):this.deferredKeydownHandler.call(this.context,e))},_isSystemKeyPressed:function(e){return t.indexOf(this.systemKeyCodes,e.which)>-1},_immediateHandleCondition:function(e){return this.immediateHandleCondition&&this.immediateHandleCondition.call(this.context,e)},_canImmediatelyHandleKeyboardEvent:function(e){var t=this.keydownHandlers[""+e.which];return t&&"function"==typeof this.context[t]||this._immediateHandleCondition(e)},_immediatelyHandleKeyboardEvent:function(e){var t=this.keydownHandlers[""+e.which];t&&"function"==typeof this.context[t]?this.context[t].call(this.context,e):this._immediateHandleCondition(e)&&this.immediateKeydownHandler&&this.immediateKeydownHandler.call(this.context,e)}}),n}),define("common/component/list/model/ScalableListModel",["require","backbone","underscore"],function(e){var t=e("backbone"),i=e("underscore"),n=100,o=.95,s=t.Model.extend({initialize:function(e){i.bindAll(this,"_fetchComplete","fetchFailed","afterFetchComplete","fetch"),this.set({items:[]},{silent:!0}),this.getData=e.getData,this.bufferSize=e.bufferSize||n,this.loadFactor=e.loadFactor||o},_fetchComplete:function(e){this.attributes.total=e.total,this.set({items:e.data},{silent:!0}),this.attributes.bufferEndIndex=Math.max(0,Math.min(this.attributes.bufferEndIndex,this.attributes.bufferStartIndex+e.data.length-1)),this.attributes.bufferEndIndex<this.attributes.bufferStartIndex+this.bufferSize-1&&(this.attributes.total=Math.min(e.total,this.attributes.bufferEndIndex+1)),this.afterFetchComplete&&this.afterFetchComplete(e.data,this.attributes.total)},_isBufferReloadNecessary:function(e,t){if("undefined"==typeof this.get("bufferStartIndex")||"undefined"==typeof this.get("bufferEndIndex"))return!0;if(e>=0&&e<this.get("bufferStartIndex")||t<this.get("total")&&t>this.get("bufferEndIndex"))return!0;if(e===this.get("bufferStartIndex")&&t===this.get("bufferEndIndex"))return!1;var i=1-(e-this.get("bufferStartIndex"))/this.bufferSize,n=1-(this.get("bufferEndIndex")-t)/this.bufferSize;return this.get("bufferStartIndex")>0&&i>=this.loadFactor||this.get("bufferEndIndex")<this.get("total")&&n>=this.loadFactor},afterFetchComplete:function(){this.trigger("change",this)},fetchFailed:function(e,t){this.trigger("fetchFailed",e,t)},fetch:function(e){if(e=i.extend({top:this.get("bufferStartIndex")||0,bottom:this.get("bufferEndIndex")||this.bufferSize-1},e),e.force||this._isBufferReloadNecessary(e.top,e.bottom)){if(e.top!==this.attributes.bufferStartIndex||e.bottom!==this.attributes.bufferEndIndex||e.force){var t=e.top+Math.floor((e.bottom-e.top)/2),n=Math.floor(this.bufferSize/2);this.attributes.bufferStartIndex=Math.max(0,t-n),this.attributes.bufferEndIndex=this.get("total")&&!e.force?Math.min(this.get("total"),this.attributes.bufferStartIndex+this.bufferSize)-1:this.attributes.bufferStartIndex+this.bufferSize-1}this.getData({offset:this.get("bufferStartIndex"),limit:this.get("bufferEndIndex")-this.get("bufferStartIndex")+1}).done(this._fetchComplete).fail(this.fetchFailed)}else this.afterFetchComplete&&this.afterFetchComplete(this.get("items"),this.get("total"))},reset:function(e){this.attributes={},this.set({items:[]},{silent:!0}),e&&e.silent||this.trigger("change",this)}});return s}),define("common/component/list/model/BaseListWithSelectionModel",["require","underscore","common/component/list/model/ScalableListModel"],function(e){var t=e("underscore"),i=e("common/component/list/model/ScalableListModel"),n=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.select(e.value,{silent:!0})},_addToSelection:function(){throw"Not implemented"},_removeFromSelection:function(){throw"Not implemented"},_clearSelection:function(){throw"Not implemented"},_selectionContains:function(){throw"Not implemented"},_getSelection:function(){throw"Not implemented"},_triggerSelectionChange:function(e){e&&e.silent||this.trigger("change"),this.trigger("selection:change")},_addRangeToSelection:function(e,t,i){for(var n=0;n<e.length;n++)this._addToSelection(e[n].value,n+t);this.trigger("selection:addRange",{start:t,end:i,selection:this.getSelection()})},_fetchAllDataAndModifySelection:function(e,t){return this.getData().done(function(i){for(var n=0;n<i.data.length;n++)e(i.data[n].value,n);t&&t()}).fail(this.fetchFailed),this},addValueToSelection:function(e,t){return this.selectionStartIndex=t,this._addToSelection(e,t),this.trigger("selection:add",{value:e,index:t})},addRangeToSelection:function(e,t){if("undefined"==typeof this.selectionStartIndex)return void this.addValueToSelection(e,t);if(this.selectionStartIndex!==t){var i=Math.min(this.selectionStartIndex,t),n=Math.max(this.selectionStartIndex,t);if(this.selectionStartIndex=t,i>=this.get("bufferStartIndex")&&n<=this.get("bufferEndIndex")){var o=Array.prototype.slice.call(this.get("items"),i-this.get("bufferStartIndex"),n-this.get("bufferStartIndex")+1);this._addRangeToSelection(o,i,n)}else{var s=this;this.getData({offset:i,limit:n-i+1}).done(function(e){s._addRangeToSelection(e.data,i,n)}).fail(this.fetchFailed)}}},removeValueFromSelection:function(e,t){this._removeFromSelection(e,t),this.trigger("selection:remove",{value:e,index:t})},toggleSelection:function(e,t){this.selectionContains(e,t)?this.removeValueFromSelection(e,t):this.addValueToSelection(e,t)},selectionContains:function(e,t){return this._selectionContains(e,t)},clearSelection:function(){return this._clearSelection(),this.trigger("selection:clear")},getSelection:function(){return this._getSelection()},select:function(){throw"Not implemented"},selectAll:function(){this._clearSelection();var e=this;this._fetchAllDataAndModifySelection(function(t,i){e._addToSelection(t,i)},t.bind(this._triggerSelectionChange,this))},invertSelection:function(){var e=this;this._fetchAllDataAndModifySelection(function(t,i){e._selectionContains(t,i)?e._removeFromSelection(t,i):e._addToSelection(t,i)},t.bind(this._triggerSelectionChange,this))}});return n}),define("common/component/list/model/ListWithSelectionModel",["require","underscore","common/component/list/model/BaseListWithSelectionModel"],function(e){var t=e("underscore"),i=e("common/component/list/model/BaseListWithSelectionModel"),n=i.extend({_addToSelection:function(e,t){this.selection[t]=e},_removeFromSelection:function(e,t){this.selection[t]=void 0},_clearSelection:function(){this.selection=[]},_selectionContains:function(e,t){return this.selection[t]===e},_getSelection:function(){return this.selection},_isSelectionEmpty:function(e){if(!e)return!0;if(t.isArray(e)&&0==e.length)return!0;if(t.isArray(e)||"string"==typeof e)return!1;for(var i in e)if(e.hasOwnProperty(i)&&void 0!==e[i])return!1;return!0},_selectPendingSelection:function(e,t){if(0==this.get("bufferStartIndex")&&this.get("bufferEndIndex")==this.get("total")-1)this._convertInitialArrayToSelection(this.get("items"),e,t);else{var i=this;this.getData().done(function(n){i._convertInitialArrayToSelection(n.data,e,t)}).fail(this.fetchFailed)}},_convertInitialArrayToSelection:function(e,t,i){for(var n=0;n<e.length;n++)t[e[n].value]&&this._addToSelection(e[n].value,n);this._triggerSelectionChange(i)},_triggerSelectionChange:function(e){this._calcSelectionStartIndex&&this._calcSelectionStartIndex(),i.prototype._triggerSelectionChange.call(this,e)},_calcSelectionStartIndex:function(){if("undefined"==typeof this.selectionStartIndex)for(var e in this.selection)if(this.selection.hasOwnProperty(e)&&void 0!==this.selection[e]){this.selectionStartIndex=parseInt(e,10);break}},select:function(e,i){if(this._clearSelection(),this._isSelectionEmpty(e))return void this._triggerSelectionChange(i);if(t.isArray(e)||"string"==typeof e){var n={};if("string"==typeof e)n[e]=!0;else for(var o=0;o<e.length;o++)n[e[o]]=!0;this._selectPendingSelection(n,i)}else{for(var s in e)if(e.hasOwnProperty(s)){var r=e[s];void 0!==r&&this._addToSelection(r,s)}this._triggerSelectionChange(i)}}});return n}),define("common/component/singleSelect/model/SingleSelectListModel",["require","underscore","common/component/list/model/ListWithSelectionModel","common/component/list/model/listWithNavigationModelTrait"],function(e){var t=e("underscore"),i=e("common/component/list/model/ListWithSelectionModel"),n=e("common/component/list/model/listWithNavigationModelTrait"),o=i.extend(n);return o=o.extend({setActive:function(e){n.setActive.call(this,t.extend(e,{silent:!0}));var i={};"number"==typeof e.index&&(i[e.index]=e.item.value),this.select(i)},_convertInitialArrayToSelection:function(e,t,i){for(var o=0;o<e.length;o++)t[e[o].value]&&(this._addToSelection(e[o].value,o),this.getActive()||n.setActive.call(this,{index:o,item:e[o],silent:!0}));this._triggerSelectionChange(i)},_convertSelectionObject:function(e){for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t]){var i=e[t];return{index:parseInt(t,10),value:i}}},_select:i.prototype.select,select:function(e,i){var o,s=!1;if(!e||"string"==typeof e||t.isArray(e))n.setActive.call(this,{silent:!0});else if(o=this._convertSelectionObject(e)){var r=this.getActive();r&&o.value===r.value&&o.index===r.index||(s=!0)}else n.setActive.call(this,{silent:!0});return s?this.activate(o.index):this._select(e,i),this}})}),define("text!common/component/list/templates/viewPortChunksTemplate.htm",[],function(){return'{{_.each(chunks, function(chunk) { }}\r\n<div class="viewPortChunk" style="height: {{= chunk.height}}px"></div>\r\n{{ }); }}\r\n'}),define("common/component/list/view/ScalableList",["require","jquery","backbone","underscore","common/component/list/model/ScalableListModel","text!common/component/list/templates/viewPortChunksTemplate.htm"],function(e){var t=e("jquery"),i=e("backbone"),n=e("underscore"),o=e("common/component/list/model/ScalableListModel"),s=e("text!common/component/list/templates/viewPortChunksTemplate.htm"),r=1e6,a=50,l=50,c=20,d=i.View.extend({ListModel:o,events:{scroll:"onScroll",touchmove:"onScroll"},initialize:function(e){if(n.bindAll(this,"_fetchVisibleData"),this.model=e.model||new this.ListModel(e),this.chunksTemplate=n.template(e.chunksTemplate||s),this.itemsTemplate=n.template(e.itemsTemplate),!this.itemsTemplate)throw"itemsTemplate is a required attribute. Please see doc for ScalableList.js component";return this.defaultChunkHeight=this.chunkHeight=e.chunkHeight||r,this.scrollTimeout="undefined"!=typeof e.scrollTimeout?e.scrollTimeout:a,this.manualScrollInterval=e.manualScrollInterval||l,this.lazy=e.lazy,this.defaultVisibleItemsCount=e.visibleItemsCount,this.defaultItemHeight=e.listItemHeight||c,this.initListeners(),this.render(),this.lazy||this.model.fetch(),this},initListeners:function(){this.listenTo(this.model,"change",this.onModelChange,this),this.listenTo(this.model,"fetchFailed",this.onFetchFailed,this)},render:function(){return this},onScroll:function(){this.scrollTimeout>0?(clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this._fetchVisibleData,this.scrollTimeout)):this._fetchVisibleData()},onModelChange:function(){this.renderData()},onFetchFailed:function(e,t){this.trigger("listRenderError",e,t)},postProcessChunkModelItem:function(e,i){e.index=this.model.get("bufferStartIndex")+i,void 0==e.label&&(e.label=e.value),e.label=t.trim(e.label)},_renderItems:function(){var e=this.model.get("bufferStartIndex"),i=this.model.get("bufferEndIndex"),n=this.itemsPerChunk?Math.ceil((e+1)/this.itemsPerChunk):1,o=this.itemsPerChunk?Math.ceil((i+1)/this.itemsPerChunk):1,s=this;this.$el.find(".viewPortChunk").each(function(r,a){var l=s._getChunkModel({index:r+1,firstChunkWithData:n,lastChunkWithData:o,bufferStart:e,bufferEnd:i,total:s.totalItems,itemsPerChunk:s.itemsPerChunk,itemHeight:s.itemHeight,chunkHeight:s.chunkHeight,model:s.model}),c=l?s.itemsTemplate(l):"";t(a).html(c)})},_renderViewChunks:function(e){(this.totalItems!==this.model.get("total")||e)&&(this.totalItems=this.model.get("total"),this.$el.html(this.chunksTemplate({_:n,chunks:this._getViewChunksModel()})),this.$firstViewChunk=this.$el.find(".viewPortChunk:first"))},_getViewChunksModel:function(){for(var e=this.itemsPerChunk?Math.ceil(this.totalItems/this.itemsPerChunk):1,t=e>0?this.itemHeight?this.totalItems*this.itemHeight-(e-1)*this.chunkHeight:this.chunkHeight:1,i=[],n=1;e>n;n++)i.push({height:this.chunkHeight});return i.push({height:t}),i},_calcViewPortConstants:function(){this.viewPortConstantsInitialized||(this.itemHeight=this.defaultItemHeight,this.$firstViewChunk&&(this.itemHeight=this.$el.find("li:first").height(),this.itemHeight?this.viewPortConstantsInitialized=!0:(this.itemHeight=this.defaultItemHeight,this.viewPortConstantsInitialized=!1)),this._calcViewPortHeight(),this.itemsPerChunk=Math.floor(this.defaultChunkHeight/this.itemHeight),this.chunkHeight=this.itemsPerChunk*this.itemHeight,this._renderViewChunks(!0),this._renderItems(),this.defaultVisibleItemsCount&&(this.$el.height(this.itemHeight*this.defaultVisibleItemsCount),delete this.defaultVisibleItemsCount))},_calcViewPortHeight:function(){this.viewPortHeight=this.$el.height(),this.itemsPerView=Math.floor(this.viewPortHeight/this.itemHeight)-1},_getItemsPerView:function(){return this._calcViewPortConstants(),this.itemsPerView},_getChunkModel:function(e){var t=e.index;if(t<e.firstChunkWithData||t>e.lastChunkWithData)return null;var i=e.itemsPerChunk?Math.max(e.bufferStart,e.itemsPerChunk*(t-1)):e.bufferStart,o=e.itemsPerChunk?Math.min(e.bufferEnd,e.itemsPerChunk*t-1):e.bufferEnd,s=e.itemHeight?i*e.itemHeight-(t-1)*e.chunkHeight:0,r=Array.prototype.slice.call(e.model.get("items"),i-e.bufferStart,o-e.bufferStart+1);return n.each(r,function(t,n){this.postProcessChunkModelItem(t,n+(i-e.bufferStart))},this),{top:s,items:r}},_fetchVisibleData:function(){var e=this._getVisibleItems();this.model.fetch({top:e.top,bottom:e.bottom})},_getVisibleItems:function(){var e=this._getScrollPos(),t=this.model.get("total"),i=Math.min(t-this.itemsPerView,Math.floor(e/this.itemHeight)),n=Math.min(t-1,i+this.itemsPerView+1);return{top:i,bottom:n}},_getScrollPos:function(){this._calcViewPortConstants();var e=0;if(this.$firstViewChunk){var t=this.$el.offset(),i=this.$firstViewChunk.offset();t&&i&&(e=t.top-i.top)}return e},renderData:function(){return!this.lazy&&this.model.has("bufferStartIndex")&&this.model.has("bufferEndIndex")?(this._renderViewChunks(),this._renderItems(),this._calcViewPortConstants(),this.trigger("render:data")):(this.lazy=null,this.model.fetch()),this},resize:function(){this.viewPortConstantsInitialized=!1,this._calcViewPortConstants()},fetch:function(e,t){t=t||{};var i;t.keepPosition?i=this.$el.get(0).scrollTop:this.reset({silent:!0}),this.model.once("change",function(){t.keepPosition&&this.$el.scrollTop(i),e&&e.apply(this,arguments)},this).fetch({force:!0})},reset:function(e){this.$el.scrollTop(0),this.lazy=!0,this.model.reset(e)},scrollTo:function(e){if("number"==typeof e){var t=this._getScrollPos();if(this.viewPortConstantsInitialized){this._calcViewPortHeight();var i=null,n=e*this.itemHeight;t>n?i=n:n+this.itemHeight>t+this.viewPortHeight&&(i=n+this.itemHeight-this.viewPortHeight),null!==i&&this.$el.scrollTop(i)}}}});return d}),define("common/component/list/view/ListWithSelection",["require","jquery","underscore","common/component/list/model/ListWithSelectionModel","common/component/list/view/ScalableList"],function(e){var t=e("jquery"),i=e("underscore"),n=e("common/component/list/model/ListWithSelectionModel"),o=e("common/component/list/view/ScalableList"),s=1,r=o.extend({ListModel:n,initialize:function(e){return i.bindAll(this,"onGlobalMouseup","onGlobalMousemove","_autoScroll","fetch"),this.eventListenerPattern=e.eventListenerPattern||"li",this.markerClass=e.markerClass?e.markerClass:"",this._initSelection(e.selection),o.prototype.initialize.call(this,e)},delegateEvents:function(){var e=o.prototype.delegateEvents.apply(this,arguments);return this.$el.on("mousedown",this.eventListenerPattern,i.bind(this.onMousedown,this)).on("mousemove",this.eventListenerPattern,i.bind(this.onMousemove,this)).on("dblclick",this.eventListenerPattern,i.bind(this.onMousedblclick,this)).on("contextmenu",this.eventListenerPattern,i.bind(this.onContextMenu,this,this.$el)),e},undelegateEvents:function(){var e=o.prototype.undelegateEvents.apply(this,arguments);return this.$el.off("mousedown").off("mousemove").off("dblclick").off("contextmenu"),e},_initSelection:function(e){this.selection={allowed:e&&"undefined"!=typeof e.allowed?e.allowed:!0,multiple:e&&"undefined"!=typeof e.multiple?e.multiple:!0}},initListeners:function(){o.prototype.initListeners.call(this),this.listenTo(this.model,"selection:clear",this.clearSelection,this),this.listenTo(this.model,"selection:add",this.selectValue,this),this.listenTo(this.model,"selection:addRange",this.selectRange,this),this.listenTo(this.model,"selection:remove",this.deselectValue,this),t("body").on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},postProcessChunkModelItem:function(e,t){o.prototype.postProcessChunkModelItem.call(this,e,t),e.selected=this.model.selectionContains(e.value,e.index)},onMousedblclick:function(e){if(!this.selection.multiple&&this.selection.allowed&&!this.getDisabled()){var t=this._getDomItemData(e.currentTarget);this._singleSelect(e,t.value,t.index),this.selectionChanged&&(this._triggerSelectionChanged(),this._triggerDblclicked(),this.selectionChanged=!1)}},onContextMenu:function(e,t){var i=this._getDomItemData(t.currentTarget),n=this.model.get("items")[i.index];
this.trigger("list:item:contextmenu",n,t)},onMousedown:function(e){if(this.selection.allowed&&!this.getDisabled()&&1===e.which){this.selection.multiple&&(this.leftMouseButtonPressed=!0,this.mouseDownPos=this._getMousePos(e));var t=this._getDomItemData(e.currentTarget);this.selection.multiple?this._multiSelect(e,t.value,t.index):this._singleSelect(e,t.value,t.index)}},onMousemove:function(e){if(this.selection.allowed&&this.selection.multiple&&!this.getDisabled()&&this.leftMouseButtonPressed&&(this._stopAutoScroll(),this._mouseMoved(e,this.mouseDownPos))){this.mouseDownPos=this._getMousePos(e);var t=this._getDomItemData(e.currentTarget);this.model.selectionContains(t.value,t.index)||this.model.addRangeToSelection(t.value,t.index)}},onGlobalMouseup:function(){this.leftMouseButtonPressed&&(this.leftMouseButtonPressed=!1,delete this.mouseDownPos,this._stopAutoScroll(),this.selectionChanged&&(this._triggerSelectionChanged(),this.selectionChanged=!1))},onGlobalMousemove:function(e){this.selection.allowed&&this.selection.multiple&&!this.getDisabled()&&this.leftMouseButtonPressed&&(this.mousePosY=e.clientY,this.scrollInterval||(this.scrollInterval=setInterval(this._autoScroll,this.manualScrollInterval)))},clearSelection:function(){this.$el.find("li.selected"+this.markerClass).removeClass("selected"),this.selectionChanged=!0},selectValue:function(e){this.$el.find("li"+this.markerClass+"[data-index='"+e.index+"']:not(.selected)").addClass("selected"),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},selectRange:function(e){var i=this,n=Math.max(this.model.get("bufferStartIndex"),e.start),o=Math.min(this.model.get("bufferEndIndex"),e.end);this.$el.find("li"+this.markerClass+":not(.selected)").each(function(){var e=t(this),s=parseInt(e.attr("data-index"),10);if(s>=n&&o>=s){var r=i.model.get("items")[s-i.model.get("bufferStartIndex")];i.model.selectionContains(r.value,s)&&e.addClass("selected")}}),this.selectionChanged=!0},deselectValue:function(e){this.$el.find("li[data-index='"+e.index+"'].selected"+this.markerClass).removeClass("selected"),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},_autoScroll:function(){var e,t=this.$el.offset().top,i=this.$el.scrollTop(),n="undefined"!=typeof this.scrollTop?this.scrollTop:i,o=!1;this.mousePosY<t?(e=n-3*this.itemHeight,o=i>e):this.mousePosY>t+this.viewPortHeight&&(e=n+3*this.itemHeight,o=e>i),o&&(this.$el.scrollTop(e),this.scrollTop=this.$el.scrollTop(),this._fetchVisibleData()),this._selectRangeOnAutoScroll(n,e)},_selectRangeOnAutoScroll:function(e,t){var i;if(t>e?i=this._getVisibleItems().bottom:e>t&&(i=this._getVisibleItems().top),i){var n=this.model.get("items")[i-this.model.get("bufferStartIndex")];n&&(this.model.selectionContains(n.value,i)||this.model.addRangeToSelection(n.value,i))}},_stopAutoScroll:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=void 0,this.scrollTop=void 0)},_multiSelect:function(e,t,i){e.shiftKey?this.model.addRangeToSelection(t,i):e.ctrlKey||e.metaKey?this._singleSelect(e,t,i):this.model.toggleSelection(t,i)},_singleSelect:function(e,t,i){this.model.clearSelection().addValueToSelection(t,i)},_triggerSelectionChanged:function(){this.trigger("selection:change",this.getValue())},_triggerDblclicked:function(){this.trigger("item:dblclick",this.getValue())},_getDomItemData:function(e){for(var i=t(e),n=i.attr("data-index");void 0===n;)i=i.parent(),n=i.attr("data-index");n=parseInt(n,10);var e=this.model.get("items")[n-this.model.get("bufferStartIndex")];return{value:e.value,index:n}},_mouseMoved:function(e,t){return Math.abs(t.x-e.clientX)+Math.abs(t.y-e.clientY)>=s},_getMousePos:function(e){return{x:e.clientX,y:e.clientY}},getValue:function(){return this.model.getSelection()},setValue:function(e,t){return t=t||{},t&&t.silent||t.modelOptions&&t.modelOptions.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),t=t.modelOptions,this.model.select(e,t),this},selectAll:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.selectAll(),this},selectNone:function(e){return this.setValue({},e)},invertSelection:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.invertSelection(),this},setDisabled:function(e){return this.disabled=e,this.disabled?this.$el.addClass("disabled"):this.$el.removeClass("disabled"),this},getDisabled:function(){return this.disabled},remove:function(){return t("body").off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove),o.prototype.remove.call(this)}});return r}),define("common/component/list/view/ListWithNavigation",["require","common/component/list/view/ListWithSelection","common/component/list/model/ListWithSelectionModel","common/component/list/model/listWithNavigationModelTrait"],function(e){var t=e("common/component/list/view/ListWithSelection"),i=e("common/component/list/model/ListWithSelectionModel"),n=e("common/component/list/model/listWithNavigationModelTrait"),o=t.extend({canActivate:!0,initialize:function(e){e=e||{};var o=i.extend(n);e.model=e.model||new o(e),t.prototype.initialize.call(this,e)},onMousemove:function(e){if(t.prototype.onMousemove.call(this,e),!this.mouseMovePos||this._mouseMoved(e,this.mouseMovePos)){this.mouseMovePos=this._getMousePos(e);var i=this._getDomItemData(e.currentTarget);this.activate(i.index)}},setCanActivate:function(e){this.canActivate=e},getCanActivate:function(){return this.canActivate&&!this.getDisabled()},activateFirst:function(){this.activate(0)},activateLast:function(){this.activate(Math.max(0,this.model.get("total")-1))},activateNext:function(){this.activate(Math.min(this.model.get("total")-1,this._getActiveIndex()+1))},activatePrevious:function(){this.activate(Math.max(0,this._getActiveIndex()-1))},pageDown:function(){this.activate(Math.min(this.model.get("total")-1,this._getActiveIndex()+this._getItemsPerView()))},pageUp:function(){this.activate(Math.max(0,this._getActiveIndex()-this._getItemsPerView()))},getActiveValue:function(){return this.model.getActive()},activate:function(e){if(this.getCanActivate()){var t=this.getActiveValue();if(t&&t.index===e)return;var i=this;this.model.once("active:changed",function(){i.trigger("active:changed",i.getActiveValue())}).activate(e)}},postProcessChunkModelItem:function(e,i){t.prototype.postProcessChunkModelItem.call(this,e,i);var n=this._getActiveIndex();e.active="undefined"!=typeof n&&n===this.model.get("bufferStartIndex")+i},_getActiveIndex:function(){var e=this.getActiveValue();return e&&e.index}});return o}),define("common/component/singleSelect/view/SingleSelectList",["require","underscore","common/component/singleSelect/model/SingleSelectListModel","common/component/list/view/ListWithNavigation"],function(e){var t=e("underscore"),i=e("common/component/singleSelect/model/SingleSelectListModel"),n=e("common/component/list/view/ListWithNavigation"),o=n.extend({events:t.extend({},n.prototype.events,{"mouseup li":"onMouseup"}),initialize:function(e){var o=e.model||new i(e);n.prototype.initialize.call(this,t.extend({model:o,lazy:!0,selection:{allowed:!0,multiple:!1}},e))},onMouseup:function(){this.trigger("item:mouseup")},activate:function(e){if(this.getCanActivate()){var t=this.getActiveValue();if(t&&t.index===e)return;this.model.once("selection:change",this._triggerSelectionChanged,this).activate(e)}}});return o}),define("common/component/singleSelect/dataprovider/SearcheableDataProvider",["require","jquery","underscore"],function(e){var t=e("jquery"),i=e("underscore"),n=function(e){i.bindAll(this,"getData","_filterValues","_shouldFilter"),this.indexMapping={},this.internalGetData=e.getData};return i.extend(n.prototype,{getData:function(e){var i=new t.Deferred;if(e&&"undefined"!=typeof e.criteria)return this.dataCache=null,this.criteria=e.criteria,i.resolve(),i.promise();var n=this;return n._shouldFilter()?(this.dataCache?this._resolvePromise(e,i):this.internalGetData().done(function(t){n.indexMapping={},n.reverseIndexMapping={},n.dataCache=n._filterValues(t.data),n._resolvePromise(e,i)}).fail(i.reject),i.promise()):(this.indexMapping=null,this.reverseIndexMapping=null,this.dataCache=null,this.internalGetData(e))},getIndexMapping:function(){return this.indexMapping},getReverseIndexMapping:function(){return this.reverseIndexMapping},_resolvePromise:function(e,t){var i=e&&e.offset?e.offset:0,n=e&&e.limit?i+e.limit:this.dataCache.length,o=this._getDataSegment(this.dataCache,i,n);t.resolve({data:o,total:this.dataCache.length})},_shouldFilter:function(){return this.criteria},_filterValues:function(e){for(var t=[],i=0,n=0;n<e.length;n++){var o=e[n],s=void 0==o.label?o.value:o.label;s.toLowerCase().indexOf(this.criteria.toLowerCase())>-1&&(t[i]=o,this.indexMapping[i]=n,this.reverseIndexMapping[n]=i,i+=1)}return t},_getDataSegment:function(e,t,i){i=Math.min(i,e.length);for(var n=[],o=t;i>o;o++)n.push({label:e[o].label,value:e[o].value});return n}}),n}),define("common/component/singleSelect/manager/DropDownManager",["require","underscore","jquery"],function(e){var t=e("underscore"),i=e("jquery"),n=500,o=i("body"),s=function(e){return this.initialize(e),this};return t.extend(s.prototype,{initialize:function(e){t.bindAll(this,"checkOffset","setNewOffset"),this.$dropDownEl=e.dropDownEl,this.calcOffset=e.calcOffset,this.isOffsetChanged=e.isOffsetChanged||this._isOffsetChanged,this.recalcInterval=e.recalcInterval||n,this.onOffsetChanged=e.onOffsetChanged},startCalc:function(){this.checkOffset(this.setNewOffset),clearInterval(this.recalcTimer),this.recalcTimer=setInterval(t.bind(this.checkOffset,this,this.onOffsetChanged),this.recalcInterval)},stopCalc:function(){clearInterval(this.recalcTimer)},checkOffset:function(e){var t=this.calcOffset(),i=this.$dropDownEl.offset();this.$dropDownEl.width()!==t.width&&this.setNewOffset(t),this.isOffsetChanged(i,t)&&e&&e(t)},setNewOffset:function(e){this.$dropDownEl.css("top",e.top-o.offset().top).css("left",e.left-o.offset().left).css("width",e.width)},_isOffsetChanged:function(e,t){return Math.floor(e.top)!==Math.floor(t.top)||Math.floor(e.left)!==Math.floor(t.left)}}),s}),define("text!common/component/singleSelect/templates/singleSelectTemplate.htm",[],function(){return'<div class="sSelect {{ if (isIPad) print(\'ipad\'); }} {{ print(expanded ? \'expanded\' : \'collapsed\'); }}">\r\n    <label>{{= label}}{{ print(label ? \':\' : \'\'); }}</label>\r\n    <a class="sSelect-input" title="{{= value}}">\r\n        <span>{{ print(value != null ? value : i18n[\'sic.singleselect.select.one\']); }}</span>\r\n        <div class="sSelect-disclosureContainer">\r\n            <span class="sSelect-disclosure"></span>\r\n        </div>\r\n    </a>\r\n    <div class="sSelect-listContainer">\r\n        <div class="sSelect-sSearch">\r\n                <span data-component-type="search" class="control searchLockup ">\r\n                    <div class="wrap">\r\n                        <input type="text" autocomplete="off">\r\n                    </div>\r\n                    <a class="button search up"></a>\r\n                </span>\r\n        </div>\r\n        <!-- list position -->\r\n    </div>\r\n</div>'}),define("text!common/component/singleSelect/templates/listTemplate.htm",[],function(){return'<div class="sList" onselectstart="return false" unselectable="on" ondragstart="return false" draggable="false"></div>'}),define("text!common/component/singleSelect/templates/itemsTemplate.htm",[],function(){return'<ul class="sSelect-list" style="top: {{=top}}px;">\r\n    {{_.each(items, function(item) { }}\r\n    <li class="{{ if (item.selected) print(\'selected\'); }}" data-index="{{=item.index}}" title="{{ print(item.label && item.label.trim() ? _.escape(item.label) : \'&nbsp;\')}}">\r\n        <div><a title="{{ print(item.label && item.label.trim() ? _.escape(item.label) : \'&nbsp;\')}}">{{ print(item.label && item.label.trim() ? item.label : \'&nbsp;\')}}</a></div>\r\n    </li>\r\n    {{ }); }}\r\n</ul>\r\n'}),define("text!common/component/singleSelect/templates/dropDownTemplate.htm",[],function(){return"<div class=\"sSelect-dropDown {{ if (isIPad) print('ipad'); }}\"></div>"}),define("common/component/singleSelect/view/SingleSelect",["require","jquery","backbone","underscore","common/component/singleSelect/manager/KeyboardManager","common/component/singleSelect/view/SingleSelectList","common/component/singleSelect/model/SingleSelectListModel","common/component/singleSelect/dataprovider/SearcheableDataProvider","common/component/singleSelect/manager/DropDownManager","text!common/component/singleSelect/templates/singleSelectTemplate.htm","text!common/component/singleSelect/templates/listTemplate.htm","text!common/component/singleSelect/templates/itemsTemplate.htm","text!common/component/singleSelect/templates/dropDownTemplate.htm","bundle!ScalableInputControlsBundle"],function(e){var t=e("jquery"),i=e("backbone"),n=e("underscore"),o=e("common/component/singleSelect/manager/KeyboardManager"),s=e("common/component/singleSelect/view/SingleSelectList"),r=e("common/component/singleSelect/model/SingleSelectListModel"),a=e("common/component/singleSelect/dataprovider/SearcheableDataProvider"),l=e("common/component/singleSelect/manager/DropDownManager"),c=e("text!common/component/singleSelect/templates/singleSelectTemplate.htm"),d=e("text!common/component/singleSelect/templates/listTemplate.htm"),u=e("text!common/component/singleSelect/templates/itemsTemplate.htm"),h=e("text!common/component/singleSelect/templates/dropDownTemplate.htm"),p=e("bundle!ScalableInputControlsBundle"),m=t("body"),f=i.View.extend({events:function(){return{"keydown input":this.keyboardManager.onKeydown,"focus input":"onFocus","blur input":"onBlur",mousedown:"onMousedown",mouseup:"onMouseup","click .sSelect-input":"onClickOnInput"}},initialize:function(e){n.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onGlobalMousemove","onMousedown","calcOffsetForListView","collapse"),this.model||(this.model=new i.Model),this.model.set("expanded",!1,{silent:!0}),this.model.set("criteria","",{silent:!0}),this.model.set("value",{},{silent:!0}),this.label=e.label,this.template=n.template(e.template||c),this.dropDownTemplate=n.template(e.dropDownTemplate||h),this.keyboardManager=new o({keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0}),this.listViewModel=this._createListViewModel(e),this.listView=this._createListView(e),this.render(),this.dropDownManager=new l({dropDownEl:this.$dropDownEl,calcOffset:this.calcOffsetForListView,isOffsetChanged:this.isDimensionsChangedforListView,onOffsetChanged:this.collapse}),this.initListeners(),this.setValue(e.value,{modelOptions:{silent:!0}})},_createListView:function(e){return new s({el:e.listElement||t(d),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||u,scrollTimeout:e.scrollTimeout})},_createListViewModel:function(e){return this.searcheableDataProvider=new a({getData:e.getData}),new r({getData:this._getGetData(),bufferSize:e.bufferSize,loadFactor:e.loadFactor})},_getGetData:function(){return this.searcheableDataProvider.getData},_getActiveValueIndex:function(e){var t=this.searcheableDataProvider.getIndexMapping();return t?t[e.index]:e.index},initListeners:function(){this.listenTo(this.listView,"selection:change",this.selectionChange,this),this.listenTo(this.listView,"item:mouseup",this.itemMouseup,this),this.listenTo(this.model,"change:expanded",this.changeExpandedState,this),this.listenTo(this.model,"change:value",this.changeValue,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.model,"change:criteria",this.changeFilter,this),this.$dropDownEl.on("mousedown",this.onMousedown),t("body").on("mousedown",this.onGlobalMousedown).on("dataavailable",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},render:function(){var e=t(this.template({label:this.label,isIPad:"iPad"===navigator.platform,value:this.model.get("value").label,expanded:this.model.get("expanded"),i18n:p}));return this.renderListView(),this.$el.empty(),this.$el.append(e),this},renderListView:function(){this.listRendered||(this.$dropDownEl=t(this.dropDownTemplate({isIPad:"iPad"===navigator.platform})),this.listView.undelegateEvents(),this.$dropDownEl.append(this.listView.$el),t("body").append(this.$dropDownEl),this.listView.delegateEvents(),this.listRendered=!0),this.model.get("expanded")?this.$dropDownEl.show():this.$dropDownEl.hide()},renderData:function(){return this.listView.renderData(),this},itemMouseup:function(){if(!this.model.get("disabled")){delete this.preventBlur,this.$el.find("input").focus();var e=this.model.get("activeValue");e.value!==this.model.get("value").value?(this.model.unset("activeValue"),this.model.set("value",e)):this.collapse()}},selectionChange:function(){var e=this.listView.getActiveValue();e?(this.listView.scrollTo(e.index),this.model.set("activeValue",{value:e.value,label:e.label,index:this._getActiveValueIndex(e)}),this.updateValueFromActive()):this.model.unset("activeValue")},onClickOnInput:function(){this.model.get("expanded")?this.collapse():this.expand()},onFocus:function(){this.model.get("expanded")||this.$el.find(".sSelect").addClass("focused")},onBlur:function(){this.preventBlur||(this.collapse(),this.$el.find(".sSelect").removeClass("focused"))},onMousedown:function(){this.preventBlur=!0},onMouseup:function(){this.preventBlur&&(delete this.preventBlur,this.model.get("expanded")&&this.$el.find("input").focus())},changeExpandedState:function(e){e.get("expanded")?this.doExpand():this.doCollapse()},changeValue:function(){this.collapse(),this.updateControlLabel(),this.silent?delete this.silent:this.trigger("selection:change",this.model.get("value").value),this.$el.find("input").val(""),this.model.set("criteria","")},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$el.addClass("disabled"),this.$el.find("input[type='text']").attr("disabled","disabled"),this.collapse()):(this.$el.find("input[type='text']").removeAttr("disabled"),this.$el.removeClass("disabled")),this.listView.setDisabled(e)},onGlobalMousedown:function(e){if(this.model.get("expanded")){if(e.target===this.el||this.$el.find(e.target).length>0||e.target===this.$dropDownEl[0]||this.$dropDownEl.find(e.target).length>0)return void this.$el.find("input").focus();this.preventBlur=!1,this.onBlur()}},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onUpKey:function(){if(this.model.get("expanded")){var e=this.listView.getActiveValue();if(!e||0===e.index)return void this.collapse();this.listView.activatePrevious()}else this.expand()},onDownKey:function(){if(this.model.get("expanded")){var e=this.listView.getActiveValue();e?this.listView.activateNext():this.listView.activateFirst()}else this.expand()},onEnterKey:function(e){e.preventDefault(),this.model.get("expanded")?this.model.get("activeValue")?this.itemMouseup():this.collapse():this.expand()},onEscKey:function(){this.model.get("expanded")&&this.collapse()},onHomeKey:function(){this.model.get("expanded")?this.listView.activateFirst():this.expand()},onEndKey:function(){this.model.get("expanded")?this.listView.activateLast():this.expand()},onPageUpKey:function(){this.model.get("expanded")?this.listView.pageUp():this.expand()},onPageDownKey:function(){this.model.get("expanded")?this.listView.pageDown():this.expand()},onTabKey:function(){},doExpand:function(){this.$el.find(".sSelect").removeClass("collapsed").addClass("expanded").addClass("focused"),this.$el.find("input").focus(),this.expandListView(),this.listView.lazy?this.listView.fetch(n.bind(this.listView.resize,this.listView)):this.listView.resize(),"undefined"!=typeof this.model.get("value").value&&this.setValueToList(),this.trigger("expand",this)},expandListView:function(){this.$dropDownEl.show(),this.dropDownManager.startCalc()},doCollapse:function(){this.model.unset("activeValue"),this.$el.find(".sSelect").removeClass("expanded").addClass("collapsed"),this.$el.find("input").val(""),this.$dropDownEl.hide(),this.model.set("criteria",""),this.dropDownManager.stopCalc(),this.trigger("collapse",this)},calcOffsetForListView:function(){var e=this.$el.offset(),t=m.offset().top+e.top+this.$el.height()+this.$el.find(".sSelect-listContainer").height()-2,i=m.offset().left+e.left;return{top:t,left:i,width:this.$el.find(".sSelect").width()}},isDimensionsChangedforListView:function(e,t){return Math.floor(e.top)!==Math.floor(t.top)||Math.floor(e.left)!==Math.floor(t.left)},immediateHandleCondition:function(){return!this.model.get("expanded")},immediateKeydownHandler:function(e){this.expand(),this.keyboardManager.deferredHandleKeyboardEvent(e)},processKeydown:function(){this.model.set("criteria",this.$el.find("input").val())},changeFilter:function(){var e=this;this._getGetData()({criteria:this.model.get("criteria")}).done(function(){e.listView.fetch(function(){e.setValueToList()})})},setValueToList:function(e){var t=this.model.get("value"),i=t.value;if("undefined"!=typeof t.index){var n=this.searcheableDataProvider.getReverseIndexMapping(),o=n?n[t.index]:t.index;i={},"undefined"!=typeof o&&(i[o]=t.value)}this.listView.setValue(i,e)},convertExternalValueToInternalFormat:function(e){var t={};if("undefined"!=typeof e)if("string"==typeof e||null===e)t={value:e};else for(var i in e)if(e.hasOwnProperty(i)&&void 0!==e[i]){t={value:e[i],index:parseInt(i,10)};break}return t},updateValueFromActive:function(){var e=this.model.get("value"),t=this.model.get("activeValue");e.value===t.value&&"undefined"==typeof e.label&&(e.label=t.label,this.updateControlLabel())},updateControlLabel:function(){var e=this.model.get("value");if(n.isEmpty(e)||null==e.value)this.render();else{var t=this.getControlLabelByValue(e);this.$el.find(".sSelect-input").attr("title",t).find("> span").html(t)}},getControlLabelByValue:function(e){return null==e.label?e.value:e.label},fetch:function(e,t){return this.listView.fetch(e,t),this},reset:function(e){return this.listView.reset(e),this},expand:function(){return this.model.get("disabled")?void 0:(this.model.set("expanded",!0),this)},collapse:function(){return this.model.set("expanded",!1),this},getValue:function(){return this.model.get("value").value},setValue:function(e,t){var e=this.convertExternalValueToInternalFormat(e);t&&t.silent&&(this.silent=!0),this.model.set("value",e),this.setValueToList()},setDisabled:function(e){return this.model.set("disabled",e),this},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.$dropDownEl.off("mousedown",this.onMousedown).remove(),this.listView.remove(),i.View.prototype.remove.call(this),t("body").off("mousedown",this.onGlobalMousedown).off("dataavailable",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove)}});return f}),define("common/component/list/model/ListWithSelectionAsObjectHashModel",["require","underscore","common/component/list/model/BaseListWithSelectionModel"],function(e){var t=e("underscore"),i=e("common/component/list/model/BaseListWithSelectionModel"),n=i.extend({_addToSelection:function(e){this.selection[e]=!0},_removeFromSelection:function(e){delete this.selection[e]},_clearSelection:function(){this.selection={}},_selectionContains:function(e){return this.selection[e]},_getSelection:function(){return t.keys(this.selection)},select:function(e,i){if(this._clearSelection(),"string"==typeof e)this._addToSelection(e);else if(t.isArray(e))for(var n=0;n<e.length;n++)this._addToSelection(e[n]);else if("undefined"!=typeof e)for(var o in e)if(e.hasOwnProperty(o)){var s=e[o];void 0!==s&&this._addToSelection(s,o)}this._afterSelect&&this._afterSelect(e,i),this._triggerSelectionChange(i)}});return n}),define("common/component/singleSelect/model/SingleSelectListModelNew",["require","common/component/singleSelect/model/SingleSelectListModel","common/component/list/model/ListWithSelectionAsObjectHashModel"],function(e){var t=e("common/component/singleSelect/model/SingleSelectListModel"),i=e("common/component/list/model/ListWithSelectionAsObjectHashModel"),n=i.prototype,o=t.extend({_addToSelection:n._addToSelection,_removeFromSelection:n._removeFromSelection,_clearSelection:n._clearSelection,_selectionContains:n._selectionContains,_getSelection:n._getSelection,_calcSelectionStartIndex:void 0,_select:n.select});return o}),define("common/component/singleSelect/view/SingleSelectNew",["require","underscore","common/component/list/model/listWithNavigationModelTrait","common/component/singleSelect/view/SingleSelect","common/component/singleSelect/model/SingleSelectListModelNew"],function(e){var t=e("underscore"),i=e("common/component/list/model/listWithNavigationModelTrait"),n=e("common/component/singleSelect/view/SingleSelect"),o=e("common/component/singleSelect/model/SingleSelectListModelNew"),s=function(e){for(var t=this.listViewModel.get("bufferStartIndex"),i=this.listViewModel.get("items"),n=0;n<i.length;n++)if(e===i[n].value)return t+n;return void 0},r=n.extend({initialize:function(e){s=t.bind(s,this),this.formatValue=e.formatValue,n.prototype.initialize.call(this,e)},_createListViewModel:function(e){this.getData=e.getData;var i=e.model||t.extend(new o(e),{_afterSelect:this._afterSelect});return i},_getGetData:function(){return this.getData},_afterSelect:function(e){if(e&&"string"==typeof e&&!this.getActive()){var t=s(e);"undefined"!=typeof t&&i.setActive.call(this,{index:t,item:{value:e},silent:!0})}},_getActiveValueIndex:function(e){return s(e.value)},changeFilter:function(){var e=this;this.listView.scrollTo(0),this._getGetData()({criteria:this.model.get("criteria"),offset:0,limit:1}).done(function(){e.listView.fetch(function(){e.listView.resize(),e.setValueToList()})})},getControlLabelByValue:function(e){return null==e.label?this.formatValue?this.formatValue(e.value):e.value:e.label},setValue:function(e,t){var e=this.convertExternalValueToInternalFormat(e);t&&t.silent&&(this.silent=!0),this.model.set("value",e),this.setValueToList(t)},setValueToList:function(e){var t=this.model.get("value"),i={};t&&t.index?i[t.index]=t.value:t&&(i=t.value),this.listView.setValue(i,e)}});return r}),define("adhoc/filter/valueEditor/ListValueEditorAdapter",["require","underscore","adhoc/filter/valueEditor/AbstractValueEditor","adhoc/filter/format/OlapFilterValueFormatter","adhoc/filter/format/filterValueFormatter","common/component/singleSelect/view/SingleSelectNew","settings!adhocFilterSettings"],function(e){var t=e("underscore"),i=e("adhoc/filter/valueEditor/AbstractValueEditor"),n=e("adhoc/filter/format/OlapFilterValueFormatter"),o=e("adhoc/filter/format/filterValueFormatter"),s=e("common/component/singleSelect/view/SingleSelectNew"),r=e("settings!adhocFilterSettings");return i.extend({tagName:"div",className:"values",initialize:function(){r=t.defaults(r||{},{preloadAvailableValuesOlap:"false",preloadAvailableValues:"true"}),this.list=this.createList(),i.prototype.initialize.apply(this,arguments)},createList:function(){return new s({getData:t.bind(this.model.dataProvider.getData,this.model),formatValue:this.model.isOlap?new n(this.model.get("isFirstLevelInHierarchyAll")).format:o})},registerEvents:function(){this.listenTo(this.list,"selection:change",t.bind(function(e,i){i&&this.model.set("isAnyValue",i.isTrueAll,{silent:!0}),this.setValue(t.isArray(e)?t.reject(e,function(e){return void 0==e}):e)},this))},render:function(){return this.$el.empty(),this.list.$el.hide(),this.$el.append(this.list.el),this.$el.append('<span class="message warning" data-validation-field="value"></span>'),this.list.render(),this},renderData:function(){this.list.renderData()},_setValueToList:function(e){this.list.setValue(this.getValue(),e)},_loadAvailableValuesImmediately:function(){return this.model.isOlap?"true"===r.preloadAvailableValuesOlap:"true"===r.preloadAvailableValues},_removeAvailableData:function(){this.model.isOlap&&(this.model.removeAvailableData(),this.list.reset({silent:!0}))},updateData:function(){this._removeAvailableData();var e={};this._loadAvailableValuesImmediately()?(this.model.setShowLoading(!1),this.list.once("selection:change",t.bind(this.model.setShowLoading,this.model,!0))):e={modelOptions:{silent:!0}},this._setValueToList(e),this.list.$el.show(),this.trigger("rendered",this)},remove:function(){this.removeView(),i.prototype.remove.call(this),this.list.remove()}})}),define("text!common/component/multiSelect/templates/availableItemsListTemplate.htm",[],function(){return'<div class="mSelect-avListPlaceholder {{ print(expanded ? \'expanded\' : \'collapsed\'); }}">\r\n    <input type="text" class="mSelect-input placeholder" placeholder="{{= i18n[\'sic.multiselect.select.few\'] }}" value="{{= i18n[\'sic.multiselect.select.few\'] }}">\r\n</div>'}),define("text!common/component/multiSelect/templates/availableItemsListDropdownTemplate.htm",[],function(){return'<div class="mSelect-dropDown mSelect-listContainer {{ if (isIPad) print(\'ipad\'); }}">\r\n    <!-- list position -->\r\n    <div class="mSelect-footer">\r\n        <a class="mSelect-footer-selectOptions all" {{ if (disabled) { }}disabled="disabled"{{ } }} >{{=i18n[\'sic.multiselect.all\']}}</a>\r\n        <a class="mSelect-footer-selectOptions none" {{ if (disabled) { }}disabled="disabled"{{ } }}>{{=i18n[\'sic.multiselect.none\']}}</a>\r\n        <a class="mSelect-footer-selectOptions invert" {{ if (disabled) { }}disabled="disabled"{{ } }}>{{=i18n[\'sic.multiselect.inverse\']}}</a>\r\n        <button tabindex="-1" class="mSelect-footer-button">{{=i18n[\'sic.multiselect.close\']}}</button>\r\n    </div>\r\n</div>\r\n'}),define("text!common/component/multiSelect/templates/availableItemsTemplate.htm",[],function(){return'<ul class="mSelect-list mSelect-avList" style="top: {{=top}}px;">\r\n    {{ _.each(items, function(item) { }}\r\n    <li class="{{ if (item.selected) print(\'selected\'); }} {{ if (item.active) print(\' active\'); }}" data-index="{{= item.index}}" title="{{ print(item.label && item.label ? _.escape(item.label) : \'&nbsp;\')}}">\r\n        <div><a title="{{ print(item.label && item.label ? _.escape(item.label) : \'&nbsp;\')}}">{{ print(item.label && item.label ? item.label : \'&nbsp;\')}}</a></div>\r\n    </li>\r\n    {{ }); }}\r\n</ul>'}),define("text!common/component/multiSelect/templates/listTemplate.htm",[],function(){return'<div class="sList" onselectstart="return false" unselectable="on" ondragstart="return false" draggable="false"></div>\r\n'}),define("common/component/multiSelect/view/AvailableItemsList",["require","jquery","backbone","underscore","common/component/singleSelect/manager/KeyboardManager","common/component/list/view/ListWithNavigation","common/component/list/model/ListWithSelectionModel","common/component/list/model/listWithNavigationModelTrait","common/component/singleSelect/dataprovider/SearcheableDataProvider","common/component/singleSelect/manager/DropDownManager","text!common/component/multiSelect/templates/availableItemsListTemplate.htm","text!common/component/multiSelect/templates/availableItemsListDropdownTemplate.htm","text!common/component/multiSelect/templates/availableItemsTemplate.htm","text!common/component/multiSelect/templates/listTemplate.htm","bundle!ScalableInputControlsBundle"],function(e){var t=e("jquery"),i=e("backbone"),n=e("underscore"),o=e("common/component/singleSelect/manager/KeyboardManager"),s=e("common/component/list/view/ListWithNavigation"),r=e("common/component/list/model/ListWithSelectionModel"),a=e("common/component/list/model/listWithNavigationModelTrait"),l=e("common/component/singleSelect/dataprovider/SearcheableDataProvider"),c=e("common/component/singleSelect/manager/DropDownManager"),d=e("text!common/component/multiSelect/templates/availableItemsListTemplate.htm"),u=e("text!common/component/multiSelect/templates/availableItemsListDropdownTemplate.htm"),h=e("text!common/component/multiSelect/templates/availableItemsTemplate.htm"),p=e("text!common/component/multiSelect/templates/listTemplate.htm"),m=e("bundle!ScalableInputControlsBundle"),f=200,g=t("body"),v=i.View.extend({events:function(){return{"keydown input.mSelect-input":this.keyboardManager.onKeydown,"focus input.mSelect-input":"onFocus","blur input.mSelect-input":"onBlur","click input.mSelect-input":"onClickOnInput","touchend input.mSelect-input":"onClickOnInput",mousedown:"onMousedown",mouseup:"onMouseup"}
},keydownHandlers:n.extend({65:"onAKey"},o.prototype.keydownHandlers),initialize:function(e){n.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onGlobalMousemove","onMousedown","onMouseup","onDropdownMouseup","onEscKey","onSelectAll","onSelectNone","onInvertSelection","calcOffsetForDropDown","collapse"),this.model||(this.model=new i.Model),this.model.set("expanded",!1,{silent:!0}),this.model.set("criteria","",{silent:!0}),this.label=e.label,this.template=n.template(e.availableItemsListTemplate||d),this.dropDownTemplate=n.template(e.dropDownTemplate||u),this.keyboardManager=new o({keydownHandlers:this.keydownHandlers,keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0}),this.listViewModel=this._createListViewModel(e),this.setValue(e.value,{silent:!0}),this.listView=this._createListView(e),this.render(),this.dropDownManager=new c({dropDownEl:this.$dropDownEl,calcOffset:this.calcOffsetForDropDown,onOffsetChanged:this.collapse}),this.initListeners()},_createListViewModel:function(e){this.searcheableDataProvider=new l({getData:e.getData});var t=r.extend(a);return e.listViewModel||new t({getData:this.searcheableDataProvider.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor})},_createListView:function(e){return e.listView||new s({el:e.listElement||t(p),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||h,scrollTimeout:e.scrollTimeout,lazy:!0,selection:{allowed:!0,multiple:!0}})},initListeners:function(){this.listenTo(this.listView,"active:changed",this.activeChange,this),this.listenTo(this.listViewModel,"selection:clear",this.selectionClear,this),this.listenTo(this.listViewModel,"selection:add",this.selectionAdd,this),this.listenTo(this.listViewModel,"selection:addRange",this.selectionAddRange,this),this.listenTo(this.listViewModel,"selection:remove",this.selectionRemove,this),this.listenTo(this.model,"change:expanded",this.changeExpandedState,this),this.listenTo(this.model,"change:value",this.changeValue,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.model,"change:criteria",this.changeFilter,this),this.$dropDownEl.on("mousedown",this.onMousedown).on("mouseup",this.onDropdownMouseup).on("click",".mSelect-footer-button",this.onEscKey).on("click","a.all",this.onSelectAll).on("click","a.none",this.onSelectNone).on("click","a.invert",this.onInvertSelection),t("body").on("mousedown",this.onGlobalMousedown).on("dataavailable",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},render:function(){return this.renderDropdownPart(),this.$el.empty(),this.$el.append(t(this.template(this.getModelForRendering()))),this.changeDisabled(),this},renderDropdownPart:function(){this.$dropDownEl||(this.listView.undelegateEvents(),this.$dropDownEl=t(this.dropDownTemplate(this.getModelForRendering())),this.$dropDownEl.prepend(this.listView.el),t("body").append(this.$dropDownEl),this.listView.delegateEvents()),this.model.get("expanded")?this.$dropDownEl.show():this.$dropDownEl.hide()},renderData:function(){return this.listView.renderData(),this},activeChange:function(e){e&&(this.activeChangedWithShift&&(delete this.activeChangedWithShift,this.listViewModel.addRangeToSelection(e.value,e.index)),this.listView.scrollTo(e.index))},selectionAdd:function(e){var t=this.searcheableDataProvider.getIndexMapping(),i=t?t[e.index]:e.index;this.model.get("value")[i]=e.value,this.model.trigger("change:value")},selectionAddRange:function(e){for(var t=this.searcheableDataProvider.getIndexMapping(),i=(this.model.get("value"),e.start);i<=e.end;i++){var n=t?t[i]:i;this.model.get("value")[n]=e.selection[i]}this.model.trigger("change:value")},selectionRemove:function(e){var t=this.searcheableDataProvider.getIndexMapping(),i=t?t[e.index]:e.index;this.model.get("value")[i]=void 0,this.model.trigger("change:value")},selectionClear:function(){this.model.attributes.value=[]},onSelectAll:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.listView.selectAll())},onSelectNone:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.listView.selectNone())},onInvertSelection:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.listView.invertSelection())},changeExpandedState:function(e){e.get("expanded")?this.doExpand():this.doCollapse()},changeValue:function(){this.trigger("selection:change",this.getValue())},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$el.addClass("disabled").find("input[type='text']").attr("disabled","disabled"),this.$dropDownEl.addClass("disabled").find(".mSelect-footer a").attr("disabled","disabled")):(this.$el.removeClass("disabled").find("input[type='text']").removeAttr("disabled"),this.$dropDownEl.removeClass("disabled").find(".mSelect-footer a").removeAttr("disabled")),this.listView.setDisabled(e)},onClickOnInput:function(){this.onFocus()},onFocus:function(){this.model.get("expanded")||this.model.set("expanded",!0);var e=this.$el.find("input");e.val()==e.attr("placeholder")&&(e.val(""),e.removeClass("placeholder"))},onBlur:function(){var e=this.$el.find("input");return(""==e.val()||e.val()==e.attr("placeholder"))&&(e.addClass("placeholder"),e.val(e.attr("placeholder"))),this.preventBlur?!1:void this.collapse()},onMousedown:function(){this.preventBlur=!0},onDropdownMouseup:function(e){t(e.target).hasClass("mSelect-footer-button")?delete this.preventBlur:this.onMouseup()},onMouseup:function(){this.preventBlur&&(delete this.preventBlur,this.model.get("expanded")&&this.$el.find("input.mSelect-input").focus())},onGlobalMousedown:function(e){if(this.model.get("expanded")){if(e.target===this.el||this.$el.find(e.target).length>0||e.target===this.$dropDownEl[0]||this.$dropDownEl.find(e.target).length>0)return;delete this.preventBlur,this.onBlur()}},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onUpKey:function(e){this.model.get("expanded")?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activatePrevious()):this.expand()},onDownKey:function(e){if(this.model.get("expanded")){var t=this.listView.getActiveValue();t?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateNext()):this.listView.activateFirst()}else this.expand()},onEnterKey:function(e){if(e.preventDefault(),!this.model.get("expanded"))return void this.expand();var t=this.listView.getActiveValue();e.shiftKey?this.listViewModel.addRangeToSelection(t.value,t.index):e.ctrlKey||e.metaKey?(this.listViewModel.clearSelection(),this.listViewModel.addValueToSelection(t.value,t.index)):this.listViewModel.toggleSelection(t.value,t.index)},onEscKey:function(){this.model.get("expanded")&&this.collapse()},onHomeKey:function(e){this.model.get("expanded")?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateFirst()):this.expand()},onEndKey:function(e){this.model.get("expanded")?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateLast()):this.expand()},onPageUpKey:function(e){this.model.get("expanded")?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageUp()):this.expand()},onPageDownKey:function(e){this.model.get("expanded")?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageDown()):this.expand()},onTabKey:function(){},onAKey:function(e){e.ctrlKey||e.metaKey?(e.stopPropagation(),this.onSelectAll()):this.keyboardManager.deferredHandleKeyboardEvent(e)},doExpand:function(){this.$el.find(".mSelect-avListPlaceholder").removeClass("collapsed").addClass("expanded"),this.expandDropdownPart(),this.listView.lazy?this.listView.fetch(n.bind(this.listView.resize,this.listView)):this.listView.resize(),this.trigger("expand")},expandDropdownPart:function(){this.$el.width()<f&&this.$dropDownEl.find(".mSelect-footer").addClass("mSelect-footer-narrow"),this.$dropDownEl.show(),this.dropDownManager.startCalc()},doCollapse:function(){this.$el.find(".mSelect-avListPlaceholder").removeClass("expanded").addClass("collapsed"),this.$el.find("input").val(""),this.$dropDownEl.hide().find(".mSelect-footer").removeClass("mSelect-footer-narrow"),this.model.set("criteria",""),this.dropDownManager.stopCalc(),this.trigger("collapse")},calcOffsetForDropDown:function(){var e=this.$el.offset(),t=g.offset().top+e.top+this.$el.height(),i=g.offset().left+e.left;return{top:t,left:i,width:this.$el.width()}},processKeydown:function(){this.model.set("criteria",this.$el.find("input").val())},changeFilter:function(e){var t=this;this.searcheableDataProvider.getData({criteria:this.model.get("criteria")}).done(e&&"function"==typeof e?e:function(){t.listView.fetch(function(){t.listView.setValue(t.model.get("value"),{silent:!0})})})},processSelectionThroughApi:function(e){var t=this.searcheableDataProvider.getIndexMapping(),i=(this.listViewModel.get("total"),[]);for(var n in e)if(e.hasOwnProperty(n)){var o=t?t[n]:n,s=e[n];void 0!==s&&(i[o]=s)}this.model.attributes.value=i,this.model.trigger("change:value")},convertSelectionForListViewModel:function(e){var t=this.searcheableDataProvider.getReverseIndexMapping();if(!t)return e;var i={};for(var n in e)if(e.hasOwnProperty(n)){var o=t[n];if(o){var s=e[n];void 0!==s&&(i[o]=s)}}return i},getModelForRendering:function(){return{label:this.label,isIPad:"iPad"===navigator.platform,expanded:this.model.get("expanded"),disabled:this.model.get("disabled"),i18n:m}},fetch:function(e,t){this.listView.fetch(e,t)},reset:function(e){this.listView.reset(e)},expand:function(){return this.model.set("expanded",!0),this},collapse:function(){return this.model.set("expanded",!1),this},getValue:function(){return this.model.get("value")},setValue:function(e,t){this.listViewModel.once("selection:change",function(){this.model.attributes.value=this.listViewModel.getSelection(),t&&t.silent||this.changeValue()},this),n.isArray(e)||"string"==typeof e||(e=this.convertSelectionForListViewModel(e)),this.listViewModel.select(e)},setDisabled:function(e){this.model.set("disabled",e)},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.listView.remove(),i.View.prototype.remove.call(this),this.$dropDownEl.off("mousedown",this.onMousedown).off("mouseup",this.onDropdownMouseup).off("click",this.onEscKey).off("click",this.onSelectAll).off("click",this.onSelectNone).off("click",this.onInvertSelection).remove(),t("body").off("mousedown",this.onGlobalMousedown).off("dataavailable",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove)}});return v}),define("common/component/multiSelect/view/new/AvailableItemsListNew",["require","underscore","common/component/multiSelect/view/AvailableItemsList","common/component/list/model/listWithNavigationModelTrait","common/component/list/model/ListWithSelectionAsObjectHashModel"],function(e){var t=e("underscore"),i=e("common/component/multiSelect/view/AvailableItemsList"),n=e("common/component/list/model/listWithNavigationModelTrait"),o=e("common/component/list/model/ListWithSelectionAsObjectHashModel"),s=i.extend({_createListViewModel:function(e){this.getData=e.getData;var t=o.extend(n);return e.listViewModel||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor})},selectionAdd:function(e){this.model.get("value")[e.value]=!0,this.model.trigger("change:value")},selectionAddRange:function(e){for(var t=e.selection,i=this.model.get("value"),n=0;n<t.length;n++)i[t[n]]=!0;this.model.trigger("change:value")},selectionRemove:function(e){delete this.model.get("value")[e.value],this.model.trigger("change:value")},selectionClear:function(){this.model.attributes.value={}},changeFilter:function(e){var t=this;this.listView.scrollTo(0),this.getData({criteria:this.model.get("criteria"),offset:0,limit:1}).done(e&&"function"==typeof e?e:function(){t.listView.fetch(function(){t.listView.resize(),t.listView.setValue(t.model.get("value"),{silent:!0})})})},processSelectionThroughApi:function(e){var t={};this.selectionClear();for(var i=0;i<e.length;i++)t[e[i]]=!0;this.model.attributes.value=t,this.model.trigger("change:value")},convertSelectionForListViewModel:function(e){return e},getValue:function(){return t.keys(this.model.get("value"))},setValue:function(e,i){i=i||{},this.listViewModel.once("selection:change",function(){this.selectionClear();for(var e=this.listViewModel.getSelection(),t=0;t<e.length;t++)this.model.attributes.value[e[t]]=!0;i&&i.silent||this.changeValue()},this),t.isArray(e)||"string"==typeof e||(e=this.convertSelectionForListViewModel(e)),this.listViewModel.select(e,i.modelOptions)}});return s}),define("common/component/multiSelect/view/ListViewForSelectedItemsList",["require","jquery","common/component/list/view/ListWithNavigation"],function(e){var t=e("jquery"),i=e("common/component/list/view/ListWithNavigation"),n=i.extend({_multiSelect:function(e,n,o){t(e.target).hasClass("mSelect-svList-button")?this.model.selectionContains(n,o)||this._singleSelect(e,n,o):i.prototype._multiSelect.call(this,e,n,o)}});return n}),define("text!common/component/multiSelect/templates/selectedItemsListTemplate.htm",[],function(){return'<div class="mSelect-svListPlaceholder">\r\n    <input type="text" class="mSelect-svInput" {{ if (disabled) { }}disabled="disabled"{{ } }}>\r\n    <!-- list position -->\r\n</div>'}),define("text!common/component/multiSelect/templates/selectedItemsTemplate.htm",[],function(){return'<ul class="mSelect-list mSelect-svList" style="top: {{=top}}px;">\r\n    {{_.each(items, function(item) { }}\r\n    <li class="{{ if (item.selected) print(\'selected\'); }} {{ if (item.active) print(\' active\'); }}" data-index="{{=item.index}}" title="{{ print(item.label && item.label ? _.escape(item.label) : \'&nbsp;\')}}">\r\n        <div>\r\n            <div class="button mSelect-svList-button"></div>\r\n            <a title="{{ print(item.label && item.label ? _.escape(item.label) : \'&nbsp;\')}}">{{ print(item.label && item.label ? item.label : \'&nbsp;\')}}</a>\r\n        </div>\r\n    </li>\r\n    {{ }); }}\r\n</ul>'}),define("common/component/multiSelect/view/SelectedItemsList",["require","jquery","backbone","underscore","common/component/singleSelect/manager/KeyboardManager","common/component/multiSelect/view/ListViewForSelectedItemsList","common/component/list/model/ListWithSelectionModel","common/component/list/model/listWithNavigationModelTrait","text!common/component/multiSelect/templates/selectedItemsListTemplate.htm","text!common/component/multiSelect/templates/selectedItemsTemplate.htm","text!common/component/multiSelect/templates/listTemplate.htm"],function(e){var t=e("jquery"),i=e("backbone"),n=e("underscore"),o=e("common/component/singleSelect/manager/KeyboardManager"),s=e("common/component/multiSelect/view/ListViewForSelectedItemsList"),r=e("common/component/list/model/ListWithSelectionModel"),a=e("common/component/list/model/listWithNavigationModelTrait"),l=e("text!common/component/multiSelect/templates/selectedItemsListTemplate.htm"),c=e("text!common/component/multiSelect/templates/selectedItemsTemplate.htm"),d=e("text!common/component/multiSelect/templates/listTemplate.htm"),u=i.View.extend({attributes:{"class":"svList"},events:function(){return{"keydown input":this.keyboardManager.onKeydown,"focus input":"onFocus","blur input":"onBlur","mouseup li .mSelect-svList-button":"onMouseupOnDeleteButton",mousedown:"onMousedown",mouseup:"onMouseup"}},keydownHandlers:n.extend({65:"onAKey",8:"onDeleteKey",46:"onDeleteKey"},o.prototype.keydownHandlers),initialize:function(e){n.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onGlobalMousemove"),this.model||(this.model=new i.Model),this.model.set("focused",!1,{silent:!0}),this.template=n.template(l),this.keyboardManager=new o({keydownHandlers:this.keydownHandlers,keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0});var u=r.extend(a);this.listViewModel=e.listViewModel||new u({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor}),this.listView=e.listView||new s({el:e.listElement||t(d),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||c,scrollTimeout:e.scrollTimeout,lazy:!0,visibleItemsCount:e.visibleItemsCount,selection:{allowed:!0,multiple:!0}}),this.listView.setCanActivate(!1),this.initListeners(),this.render().resize()},initListeners:function(){this.listenTo(this.listView,"active:changed",this.activeChange,this),this.listenTo(this.model,"change:focused",this.focusStateChanged,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),t("body").on("mousedown",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},render:function(){this.listView.undelegateEvents();var e=t(this.template({disabled:this.model.get("disabled")}));return e.append(this.listView.el),this.$el.empty(),this.$el.append(e),this.listView.delegateEvents(),this},renderData:function(){return this.listView.renderData(),this},activeChange:function(e){e&&(this.activeChangedWithShift&&(delete this.activeChangedWithShift,this.listViewModel.addRangeToSelection(e.value,e.index)),this.listView.scrollTo(e.index))},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$el.addClass("disabled"),this.$el.find("input[type='text']").attr("disabled","disabled"),this.listView.setValue({}),this.listView.activate(void 0)):(this.$el.find("input[type='text']").removeAttr("disabled"),this.$el.removeClass("disabled")),this.listView.setDisabled(e)},focusStateChanged:function(){this.model.get("focused")?(this.$el.find(".mSelect-svListPlaceholder").addClass("focused"),this.listView.setCanActivate(!0),this._activateFirstSelectedItem()):(this.$el.find(".mSelect-svListPlaceholder").removeClass("focused"),this.listView.setValue({}),this.listView.activate(void 0),this.listView.setCanActivate(!1))},onFocus:function(){this.model.set("focused",!0)},onBlur:function(){this.preventBlur||this.model.set("focused",!1)},onMouseupOnDeleteButton:function(e){this.onDeleteKey(e)},onMousedown:function(){this.preventBlur=!0,this.model.get("focused")||this.$el.find("input").focus()},onMouseup:function(){this.preventBlur&&(this.$el.find("input").focus(),delete this.preventBlur)},onGlobalMousedown:function(e){if(this.preventBlur){if(e.target===this.$el||this.$el.find(e.target).length>0)return;delete this.preventBlur,this.onBlur()}},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onUpKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activatePrevious()},onDownKey:function(e){var t=this.listView.getActiveValue();t?(e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateNext()):this.listView.activateFirst()},onEnterKey:function(e){e.preventDefault();var t=this.listView.getActiveValue();e.shiftKey?this.listViewModel.addRangeToSelection(t.value,t.index):e.ctrlKey||e.metaKey?(this.listViewModel.clearSelection(),this.listViewModel.addValueToSelection(t.value,t.index)):this.listViewModel.toggleSelection(t.value,t.index)},onHomeKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateFirst()},onEndKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateLast()},onPageUpKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageUp()},onPageDownKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageDown()},onTabKey:function(){},onAKey:function(e){(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),this.listView.selectAll())},onDeleteKey:function(){var e=this.listView.getValue();if(e&&e.length>0){var t=!0;for(var i in e)if(e.hasOwnProperty(i)&&void 0!==e[i]){t=!1;break}t||this.trigger("selection:remove",e)}},_activateFirstSelectedItem:function(){var e=this.listView.getValue();for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t]){this.listViewModel.activate(parseInt(t,10),{silent:!0});break}},fetch:function(e,t){this.listView.setValue({}),this.listView.activate(void 0),this.listView.fetch(e,t)},resize:function(){this.listViewModel.get("items")&&0!==this.listViewModel.get("items").length?(this.$el.show(),this.listView.resize()):this.$el.hide()},setDisabled:function(e){this.model.set("disabled",e)},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.listView.remove(),i.View.prototype.remove.call(this),t("body").off("mousedown",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove)}});return u}),define("common/component/singleSelect/dataprovider/CacheableDataProvider",["require","jquery","underscore"],function(e){var t=e("jquery"),i=e("underscore"),n=function(){i.bindAll(this,"getData"),this.data=[]};return i.extend(n.prototype,{setData:function(e){this.data=e||[]},getData:function(e){var i=new t.Deferred,n=e&&e.offset?e.offset:0,o=e&&e.limit?n+e.limit:this.data.length,s=this._getDataSegment(this.data,n,o);return i.resolve({data:s,total:this.data.length}),i.promise()},_getDataSegment:function(e,t,i){i=Math.min(i,e.length);for(var n=[],o=t;i>o;o++)n.push({label:e[o].label,value:e[o].value});return n}}),n}),define("common/component/multiSelect/dataprovider/SelectedItemsDataProvider",["require","underscore","common/component/singleSelect/dataprovider/SearcheableDataProvider"],function(e){var t=e("underscore"),i=e("common/component/singleSelect/dataprovider/SearcheableDataProvider"),n=function(e){this.selectedData=e.selectedData||[],i.call(this,e)};return t.extend(n.prototype,i.prototype),t.extend(n.prototype,{getData:function(e){return e&&e.criteria&&delete e.criteria,i.prototype.getData.call(this,e)},setSelectedData:function(e){this.dataCache=null,this.selectedData=e},getIndexMapping:function(){return i.prototype.getIndexMapping.call(this)},getReverseIndexMapping:function(){return i.prototype.getReverseIndexMapping.call(this)},_shouldFilter:function(){return!0},_filterValues:function(e){for(var t=[],i=0,n=0;n<e.length;n++){var o=e[n];void 0!==this.selectedData[n]&&(t[i]=o,this.indexMapping[i]=n,this.reverseIndexMapping[n]=i,i+=1)}return t}}),n}),define("text!common/component/multiSelect/templates/multiSelectTemplate.htm",[],function(){return"<div class=\"mSelect {{ if (isIPad) print('ipad'); }}\"></div>"}),define("common/component/multiSelect/view/MultiSelect",["require","jquery","backbone","underscore","common/component/multiSelect/view/AvailableItemsList","common/component/multiSelect/view/SelectedItemsList","common/component/multiSelect/dataprovider/SelectedItemsDataProvider","text!common/component/multiSelect/templates/multiSelectTemplate.htm"],function(e){var t=e("jquery"),i=e("backbone"),n=e("underscore"),o=e("common/component/multiSelect/view/AvailableItemsList"),s=e("common/component/multiSelect/view/SelectedItemsList"),r=e("common/component/multiSelect/dataprovider/SelectedItemsDataProvider"),a=e("text!common/component/multiSelect/templates/multiSelectTemplate.htm"),l=100,c=i.View.extend({initialize:function(e){this.template=n.template(a),this.availableItemsList=this._createAvailableItemsList(e),this.selectedItemsDataProvider=this._createSelectedItemsListDataProvider(e),this.selectedItemsList=this._createSelectedItemsList(e),this.initListeners(),"undefined"!=typeof e.value&&(this.silent=!0,this.availableItemsList.setValue(e.value)),this.render()},_createAvailableItemsList:function(e){return e.availableItemsList||new o({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},_createSelectedItemsListDataProvider:function(e){return this.selectedItemsDataProvider=new r({getData:e.getData})},_createSelectedItemsList:function(e){return new s({getData:this.selectedItemsDataProvider.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout,visibleItemsCount:e.visibleItemsCount})},initListeners:function(){this.listenTo(this.availableItemsList,"selection:change",this.selectionChange,this),this.listenTo(this.availableItemsList,"expand",this.onExpand,this),this.listenTo(this.availableItemsList,"collapse",this.onCollapse,this),this.listenTo(this.selectedItemsList,"selection:remove",this.selectionRemoved,this)},render:function(){this.availableItemsList.undelegateEvents(),this.selectedItemsList.undelegateEvents();var e=t(this.template({isIPad:"iPad"===navigator.platform}));return this.availableItemsList.render(),this.selectedItemsList.render(),e.append(this.availableItemsList.el),e.append(this.selectedItemsList.el),this.$el.empty(),this.$el.append(e),this.availableItemsList.delegateEvents(),this.selectedItemsList.delegateEvents(),this},selectionChange:function(e){clearTimeout(this.selectionChangeTimeout),this.selectionChangeTimeout=setTimeout(n.bind(this.selectionChangeInternal,this,e),l)},selectionRemoved:function(e){var t=this.selectedItemsDataProvider.getReverseIndexMapping(),i=this.availableItemsList.getValue(),n={};for(var o in i)if(i.hasOwnProperty(o)){var s=t?t[o]:o;if(void 0!==s&&void 0===e[s]){var r=i[o];void 0!==r&&(n[o]=r)}}this.availableItemsList.setValue(n)},onExpand:function(){this.selectedItemsList.$el.addClass("disabled"),this.trigger("expand")},onCollapse:function(){this.selectedItemsList.$el.removeClass("disabled"),this.trigger("collapse")},selectionChangeInternal:function(e){var t=this;this.selectedItemsDataProvider.setSelectedData(e),this.selectedItemsList.fetch(function(){t.selectedItemsList.resize()}),this.silent?delete this.silent:this.triggerSelectionChange()},triggerSelectionChange:function(){this.trigger("selection:change",this.getValue())},renderData:function(){return this.availableItemsList.renderData(),this.selectedItemsList.renderData(),this},fetch:function(e,t){this.availableItemsList.fetch(e,t)},reset:function(e){this.availableItemsList.reset(e)},setValue:function(e,t){t&&t.silent&&(this.silent=!0),delete t.silent,this.availableItemsList.setValue(e,t)},getValue:function(){var e=this.availableItemsList.getValue(),t=[],i=0;for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t[i++]=e[n]);return t},setDisabled:function(e){return this.availableItemsList.setDisabled(e),this.selectedItemsList.setDisabled(e),this},getDisabled:function(){return this.availableItemsList.getDisabled()},remove:function(){this.availableItemsList.remove(),this.selectedItemsList.remove(),i.View.prototype.remove.call(this)}});return c}),define("common/component/multiSelect/view/new/MultiSelectNew",["require","underscore","common/component/multiSelect/view/new/AvailableItemsListNew","common/component/multiSelect/view/SelectedItemsList","common/component/singleSelect/dataprovider/CacheableDataProvider","common/component/multiSelect/view/MultiSelect"],function(e){var t=e("underscore"),i=e("common/component/multiSelect/view/new/AvailableItemsListNew"),n=e("common/component/multiSelect/view/SelectedItemsList"),o=e("common/component/singleSelect/dataprovider/CacheableDataProvider"),s=e("common/component/multiSelect/view/MultiSelect"),r=s.extend({_createAvailableItemsList:function(e){return e.availableItemsList||new i({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},_createSelectedItemsListDataProvider:function(){return new o},_createSelectedItemsList:function(e){return this.formatValue=e.formatValue,new n({getData:this.selectedItemsDataProvider.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},selectionRemoved:function(e){for(var e=t.compact(e),i=this.availableItemsList.model.get("value"),n=0;n<e.length;n++)delete i[e[n]];this.availableItemsList.setValue(t.keys(i))},selectionChangeInternal:function(e){var t=this;e=this._sortSelection(e),e=this._convertSelectionToStandardData(e),this.selectedItemsDataProvider.setData(e),this.selectedItemsList.fetch(function(){t.selectedItemsList.resize()}),this.silent?delete this.silent:this.triggerSelectionChange()},_sortSelection:function(e){return t.sortBy(e,function(e){var t=e.toUpperCase();return"[NULL]"===t||"~NULL~"==t?"":e})},_convertSelectionToStandardData:function(e){var i=this;return t.map(e,function(e){return{value:e,label:i.formatValue&&i.formatValue(e)}})},getValue:function(){return this.availableItemsList.getValue()}});return r}),define("adhoc/filter/valueEditor/MultiSelectValueEditorAdapter",["require","adhoc/filter/valueEditor/ListValueEditorAdapter","common/component/multiSelect/view/new/MultiSelectNew","adhoc/filter/format/OlapFilterValueFormatter","adhoc/filter/format/filterValueFormatter","common/util/featureDetection"],function(e){{var t=e("adhoc/filter/valueEditor/ListValueEditorAdapter"),i=e("common/component/multiSelect/view/new/MultiSelectNew"),n=e("adhoc/filter/format/OlapFilterValueFormatter"),o=e("adhoc/filter/format/filterValueFormatter");e("common/util/featureDetection")}return t.extend({INITIAL_MAX_HEIGHT:240,createList:function(){return new i({getData:_.bind(this.model.dataProvider.getData,this.model),formatValue:this.model.isOlap?new n(this.model.get("isFirstLevelInHierarchyAll")).format:o})},render:function(){return t.prototype.render.apply(this,arguments),this.$el.append('<div class="sizer vertical ui-resizable-handle ui-resizable-s hidden"><span class="ui-icon ui-icon-grip-solid-horizontal"></span></div>'),this._makeResizable(),this},_makeResizable:function(){var e=this.$(".sList"),t=this.$(".sizer").removeClass("hidden");e.resizable({handles:{s:t}}),e.one("resize",function(){var e=jQuery(this).height();jQuery(this).css("max-height","").css("height",e)}),e.css("max-height",this.INITIAL_MAX_HEIGHT+"px")}})}),define("common/component/multiSelect/dataprovider/DelegatingDataProvider",["require","underscore"],function(e){var t=e("underscore"),i=function(e){t.bindAll(this,"getData"),this._getData=e&&e.getData};return t.extend(i.prototype,{getData:function(e){return this._getData(e)},setGetData:function(e){this._getData=e}}),i}),define("text!common/component/multiSelect/templates/availableItemsListDropdownWithTrueAllTemplate.htm",[],function(){return'<div class="mSelect-dropDown mSelect-listContainer {{ if (isIPad) print(\'ipad\'); }}">\r\n    <!-- list position -->\r\n    <div class="mSelect-footer mSelect-footer-trueAll">\r\n        <input tabindex="-1" type="checkbox"  {{ if (disabled) { }}disabled="disabled"{{ } }} {{ if (isTrueAll) { }}checked="checked"{{ } }}>\r\n        <a class="mSelect-footer-selectOptions trueAll all" {{ if (disabled) { }}disabled="disabled"{{ } }}>{{=i18n[\'sic.multiselect.trueAll\']}}</a>\r\n        <a class="mSelect-footer-selectOptions none" {{ if (disabled) { }}disabled="disabled"{{ } }}>{{=i18n[\'sic.multiselect.none\']}}</a>\r\n        <a class="mSelect-footer-selectOptions invert" {{ if (disabled) { }}disabled="disabled"{{ } }}>{{=i18n[\'sic.multiselect.inverse\']}}</a>\r\n        <button tabindex="-1" class="mSelect-footer-button">{{=i18n[\'sic.multiselect.close\']}}</button>\r\n    </div>\r\n</div>\r\n'}),define("common/component/multiSelect/view/AvailableItemsListWithTrueAll",["require","jquery","underscore","text!common/component/multiSelect/templates/availableItemsListDropdownWithTrueAllTemplate.htm","common/component/multiSelect/view/AvailableItemsList"],function(e){var t=e("jquery"),i=e("underscore"),n=e("text!common/component/multiSelect/templates/availableItemsListDropdownWithTrueAllTemplate.htm"),o=e("common/component/multiSelect/view/AvailableItemsList"),s=o.extend({initialize:function(e){i.bindAll(this,"onSetTrueAll"),e=i.extend({dropDownTemplate:n},e),e.trueAll&&delete e.value,o.prototype.initialize.call(this,e),this.setTrueAll(e.trueAll)
},initListeners:function(){o.prototype.initListeners.call(this),this.listenTo(this.model,"change:isTrueAll",this.changeTrueAll,this),this.$dropDownEl.on("change",".mSelect-footer input[type='checkbox']",this.onSetTrueAll)},onSelectAll:function(){if(!this.model.get("disabled")){var e=this.$dropDownEl.find(".mSelect-footer input[type='checkbox']");e.prop("checked",!e.prop("checked")),this.model.set("isTrueAll",e.is(":checked"))}},onSelectNone:function(){this.model.get("isTrueAll")||o.prototype.onSelectNone.call(this)},onInvertSelection:function(){this.model.get("isTrueAll")||o.prototype.onInvertSelection.call(this)},onSetTrueAll:function(e){var i=t(e.target).is(":checked");this.model.set("isTrueAll",i)},changeTrueAll:function(){var e=this.model.get("isTrueAll"),t=this.$dropDownEl.find(".mSelect-footer input[type='checkbox']");if(e!==t.is(":checked")&&t.prop("checked",e),e){this.$dropDownEl.find("a.none, a.invert").addClass("disabled"),this.listView.activate(void 0),this.listView.reset({silent:!0});var i=this;this.clearFilterForTrueAll(function(){i.listView.once("selection:change",i.processSelectionThroughApi,i),i.setTrueAllForListView(!0)})}else this.$dropDownEl.find("a.none, a.invert").removeClass("disabled"),this.model.trigger("change:value"),this.setTrueAllForListView(!1)},setTrueAllForListView:function(e){e&&this.listView.selectAll(),this.listView.setDisabled(e)},clearFilterForTrueAll:function(e){this.model.get("criteria")?(this.$el.find("input").val(""),this.model.set("criteria","",{silent:!0}),this.changeFilter(e)):e&&e()},changeDisabled:function(){var e=this.model.get("disabled");e?this.$dropDownEl.find(".mSelect-footer input[type='checkbox']").attr("disabled","disabled"):this.$dropDownEl.find(".mSelect-footer input[type='checkbox']").removeAttr("disabled"),o.prototype.changeDisabled.call(this)},getModelForRendering:function(){return i.extend(o.prototype.getModelForRendering.call(this),{isTrueAll:this.model.get("isTrueAll")})},setTrueAll:function(e){this.model.set("isTrueAll",e)},getTrueAll:function(){return this.model.get("isTrueAll")},remove:function(){o.prototype.remove.call(this),this.$dropDownEl.off("change",this.onSetTrueAll)}});return s}),define("common/component/list/view/listWithTrueAllSelectionTrait",["require","common/component/list/view/ListWithNavigation"],function(e){var t=e("common/component/list/view/ListWithNavigation"),i={postProcessChunkModelItem:function(e,i){t.prototype.postProcessChunkModelItem.call(this,e,i),this.getTrueAll()&&(e.selected=!0)},setTrueAll:function(e,t){this.isTrueAll=e,this.setDisabled(e),this.setValue({},t)},getTrueAll:function(){return this.isTrueAll}};return i}),define("common/component/multiSelect/view/new/AvailableItemsListWithTrueAllNew",["require","underscore","common/component/multiSelect/view/AvailableItemsListWithTrueAll","common/component/multiSelect/view/new/AvailableItemsListNew","common/component/multiSelect/view/AvailableItemsList","common/component/list/view/listWithTrueAllSelectionTrait"],function(e){var t=e("underscore"),i=e("common/component/multiSelect/view/AvailableItemsListWithTrueAll"),n=e("common/component/multiSelect/view/new/AvailableItemsListNew"),o=e("common/component/multiSelect/view/AvailableItemsList"),s=e("common/component/list/view/listWithTrueAllSelectionTrait"),r=i.extend({_createListViewModel:n.prototype._createListViewModel,_createListView:function(e){var i=o.prototype._createListView.call(this,e);return t.extend(i,s)},selectionAdd:n.prototype.selectionAdd,selectionAddRange:n.prototype.selectionAddRange,selectionRemove:n.prototype.selectionRemove,selectionClear:n.prototype.selectionClear,setTrueAllForListView:function(e){this.listView.setTrueAll(e)},changeFilter:n.prototype.changeFilter,processSelectionThroughApi:n.prototype.processSelectionThroughApi,convertSelectionForListViewModel:n.prototype.convertSelectionForListViewModel,getValue:n.prototype.getValue,setValue:n.prototype.setValue});return r}),define("common/component/multiSelect/view/MultiSelectWithTrueAll",["require","underscore","common/component/multiSelect/view/AvailableItemsListWithTrueAll","common/component/multiSelect/view/MultiSelect"],function(e){var t=(e("underscore"),e("common/component/multiSelect/view/AvailableItemsListWithTrueAll")),i=e("common/component/multiSelect/view/MultiSelect"),n=i.extend({initialize:function(e){e.trueAll&&delete e.value,i.prototype.initialize.call(this,e)},_createAvailableItemsList:function(e){return e.availableItemsList||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout,trueAll:e.trueAll})},selectionChangeInternal:function(e){this.selectedItemsList.setDisabled(this.getTrueAll()),i.prototype.selectionChangeInternal.call(this,e)},triggerSelectionChange:function(){this.trigger("selection:change",this.getValue(),{isTrueAll:this.getTrueAll()})},getValue:function(){return this.getTrueAll()?[]:this.availableItemsList.getValue()},setTrueAll:function(e,t){t=t||{},t.silent&&(this.silent=!0),delete t.silent,this.availableItemsList.setTrueAll(e,t)},getTrueAll:function(){return this.availableItemsList.getTrueAll()}});return window.MultiSelectWithTrueAll=n,n}),define("common/component/multiSelect/view/new/MultiSelectWithTrueAllNew",["require","underscore","common/component/multiSelect/dataprovider/DelegatingDataProvider","common/component/singleSelect/dataprovider/CacheableDataProvider","common/component/multiSelect/view/new/AvailableItemsListWithTrueAllNew","common/component/multiSelect/view/new/MultiSelectNew","common/component/multiSelect/view/MultiSelectWithTrueAll"],function(e){var t=e("underscore"),i=e("common/component/multiSelect/dataprovider/DelegatingDataProvider"),n=e("common/component/singleSelect/dataprovider/CacheableDataProvider"),o=e("common/component/multiSelect/view/new/AvailableItemsListWithTrueAllNew"),s=e("common/component/multiSelect/view/new/MultiSelectNew"),r=e("common/component/multiSelect/view/MultiSelectWithTrueAll"),a=r.extend({_createSelectedItemsList:s.prototype._createSelectedItemsList,selectionRemoved:s.prototype.selectionRemoved,_sortSelection:s.prototype._sortSelection,_convertSelectionToStandardData:s.prototype._convertSelectionToStandardData,getValue:s.prototype.getValue});return a=a.extend({_createAvailableItemsList:function(e){return this.availableItemsListDataProvider=e.getData,e.availableItemsList||new o({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout,trueAll:e.trueAll})},_createSelectedItemsListDataProvider:function(){return new i},selectionChangeInternal:function(e){var i=this.getTrueAll();if(i){this.selectedItemsDataProvider.setGetData(this.availableItemsListDataProvider),this.selectedItemsDataProvider.setData=null;var o=this;this.selectedItemsList.fetch(function(){o.selectedItemsList.resize(),o.selectedItemsList.setDisabled(!0)}),this.silent?delete this.silent:this.triggerSelectionChange()}else{var r=new n;this.selectedItemsDataProvider.setGetData(r.getData),this.selectedItemsDataProvider.setData=t.bind(r.setData,r),s.prototype.selectionChangeInternal.call(this,e),this.selectedItemsList.setDisabled(!1)}}})}),define("adhoc/filter/valueEditor/MultiSelectWithTrueAllValueEditorAdapter",["require","adhoc/filter/valueEditor/MultiSelectValueEditorAdapter","common/component/multiSelect/view/new/MultiSelectWithTrueAllNew","adhoc/filter/format/OlapFilterValueFormatter","adhoc/filter/format/filterValueFormatter"],function(e){var t=e("adhoc/filter/valueEditor/MultiSelectValueEditorAdapter"),i=e("common/component/multiSelect/view/new/MultiSelectWithTrueAllNew"),n=e("adhoc/filter/format/OlapFilterValueFormatter"),o=e("adhoc/filter/format/filterValueFormatter");return t.extend({createList:function(){return new i({getData:_.bind(this.model.dataProvider.getData,this.model),formatValue:this.model.isOlap?new n(this.model.get("isFirstLevelInHierarchyAll")).format:o})},_setValueToList:function(e){this.model.get("isAnyValue")?this.list.setTrueAll(!0):this.list.setValue(this.getValue(),e)}})}),define("adhoc/filter/valueEditor/InputValueEditor",["require","underscore","jquery","jrs.configs","adhoc/filter/valueEditor/AbstractValueEditor"],function(e){var t=e("underscore"),i=e("jquery"),n=e("jrs.configs"),o=e("adhoc/filter/valueEditor/AbstractValueEditor"),s="_corrupted";return o.extend({inputSelector:"input[type='text']",events:function(){var e={};return e["change "+this.inputSelector]="onChange",e},registerEvents:function(){this.listenTo(this.model,"change:"+this.modelVariableName,this.render)},onChange:function(){var e=i(this.$(this.inputSelector)[0]),t=this.convert(e.val());this.setValue(t)},serializeModel:function(){var e=this.model.toJSON();return e.value=this._replaceValue(e.value),e},_replaceValue:function(e){return e===n.inputControlsConstants.NULL_SUBSTITUTION_VALUE&&(e=""),!t.isString(e)||e.toLowerCase()!==n.inputControlsConstants.NULL_SUBSTITUTION_VALUE.toLowerCase()+s&&e.toLowerCase()!==n.inputControlsConstants.NULL_SUBSTITUTION_LABEL.toLowerCase()+s||(e=e.split(s)[0]),e},_basicValueConverter:function(e){return(e.toLowerCase()===n.inputControlsConstants.NULL_SUBSTITUTION_VALUE.toLowerCase()||e.toLowerCase()===n.inputControlsConstants.NULL_SUBSTITUTION_LABEL.toLowerCase())&&(e+=s),""===e&&(e=n.inputControlsConstants.NULL_SUBSTITUTION_VALUE),e}})}),define("adhoc/filter/valueEditor/rangeTrait",["require","jquery","underscore","adhoc/filter/validation/ValidationError"],function(e){var t=e("jquery"),i=e("underscore"),n=e("adhoc/filter/validation/ValidationError");return{onChange:function(){var e=this.$(this.inputSelector),i=e.map(function(){return t(this).val()}).get(),n=this.convert(i);this.setValue(n)},convert:function(e){var t=this;return i.map(e,function(e){return t.valueConverter?t.valueConverter(e):e})},getValue:function(e){var t=this.model.get("value");return i.isNumber(e)?t[e]:t},validCallback:function(e,t,i){e.markAllFieldsAsValid(t,i)},invalidCallback:function(e,t,o,s){e.markAllFieldsAsValid(t,s),i.isArray(o)||(o=[o]),i.each(o,function(i){e.markSingleFieldAsInvalid(i instanceof n?i.getAttr():t,i,s)})},markAllFieldsAsValid:function(e,t){this.$("["+t+"]").text("").parent().removeClass("error")}}}),define("adhoc/filter/valueEditor/numericTrait",["require","jquery"],function(e){var t=e("jquery");return{valueConverter:function(e){var i=t.trim(e);return this._basicValueConverter(i)}}}),define("adhoc/filter/valueEditor/NumericValueEditor",["require","adhoc/filter/valueEditor/numericTrait","adhoc/filter/valueEditor/InputValueEditor"],function(e){var t=e("adhoc/filter/valueEditor/numericTrait"),i=e("adhoc/filter/valueEditor/InputValueEditor");return i.extend(t)}),define("adhoc/filter/valueEditor/NumericRangeValueEditor",["require","adhoc/filter/valueEditor/rangeTrait","adhoc/filter/valueEditor/NumericValueEditor"],function(e){var t=e("adhoc/filter/valueEditor/rangeTrait"),i=e("adhoc/filter/valueEditor/NumericValueEditor");return i.extend(t)}),define("adhoc/filter/valueEditor/BooleanSelectEditor",["require","adhoc/filter/valueEditor/AbstractValueEditor","underscore"],function(e){var t=e("adhoc/filter/valueEditor/AbstractValueEditor"),i=e("underscore");return t.extend({inputSelector:"select",isMultiple:!1,getDefaultViewModel:function(){return{multiple:this.isMultiple,options:[{value:"false",label:"false"},{value:"true",label:"true"}]}},serializeModel:function(){var e,t=this.getDefaultViewModel(),n=this.getValue()||"";return(e=i.find(t.options,function(e){return e.value===n}))&&(e.selected=!0),t},events:function(){var e={};return e["change "+this.inputSelector]="onChange",e},onChange:function(){var e=this.$(this.inputSelector).val(),t=this.convert(e);this.setValue(t)}})}),define("adhoc/filter/valueEditor/BooleanMultiSelectEditor",["require","adhoc/filter/valueEditor/BooleanSelectEditor","underscore","adhoc/filter/enum/filterOperators"],function(e){var t=e("adhoc/filter/valueEditor/BooleanSelectEditor"),i=e("underscore"),n=e("adhoc/filter/enum/filterOperators");return t.extend({isMultiple:!0,serializeModel:function(){var e=this.getDefaultViewModel(),t=this.model.get("isAnyValue")&&this.model.get("operatorName")===n.IN,o={"true":t,"false":t};if(!t){var s=this.getValue();i.each(s,function(e){o[e]=!0})}return i.each(e.options,function(e){e.selected=o[e.value]||!1}),e},setValue:function(e){this.model.get("operatorName")===n.IN&&(this.model.attributes.isAnyValue=e&&2===e.length,this.model.get("isAnyValue")&&(e=[])),t.prototype.setValue.call(this,e||[])}})}),define("text!common/component/calendar/template/calendar2Template.htm",[],function(){return'<div id=\'{{= uniqueId }}\' class=\'calendar2 dialog overlay\'>\r\n    <div class="content hasFooter">\r\n        <div class="header">\r\n            <div class="title">{{= i18n.CAL_date_chooser }}</div>\r\n        </div>\r\n        <div class=\'body\'>\r\n            <div class=\'tabsControl\'>\r\n                <div class="tabSelect">\r\n                    {{ if (calendarType === "datetime") { }}\r\n                        {{= i18n.CAL_fixed_timestamp }}\r\n                    {{ } else if (calendarType === "time") { }}\r\n                        {{= i18n.CAL_fixed_time }}\r\n                    {{ } else { }}\r\n                        {{= i18n.CAL_fixed_date }}\r\n                    {{ } }}\r\n                </div>\r\n                <div class="separator">|</div>\r\n                <div class="tabSelect">\r\n                    {{ if (calendarType === "datetime") { }}\r\n                        {{= i18n.CAL_relative_timestamp }}\r\n                    {{ } else if (calendarType === "time") { }}\r\n                        {{= i18n.CAL_relative_time }}\r\n                    {{ } else { }}\r\n                        {{= i18n.CAL_relative_date }}\r\n                    {{ } }}\r\n                </div>\r\n            </div>\r\n            <div class=\'tabs\'>\r\n                <div id=\'{{= uniqueId }}_calendar\' class=\'tab calendar\'></div>\r\n                <div class=\'tab relativeDates\'>\r\n                    <div class="dates">\r\n                        <div class="label">{{= i18n.CAL_time_period }}</div>\r\n                        <div class="measure">\r\n                            <select>\r\n                                <option selected="selected" value="">------</option>\r\n                                {{ _.each(rdWords, function(word) { }}\r\n                                <option value="{{= word.value }}">{{= word.label }}</option>\r\n                                {{ }); }}\r\n                            </select>\r\n                        </div>\r\n                        <div class="label">{{= i18n.CAL_adjustment }}</div>\r\n                        <div class="sign">\r\n                            <select>\r\n                                <option selected="selected" value="+">+</option>\r\n                                <option value="-">-</option>\r\n                            </select>\r\n                        </div>\r\n                        <div class="label">{{= i18n.CAL_number }}</div>\r\n                        <div class="amount">\r\n                            <input value="" type="text"/>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="footer">\r\n            <button class="button action up nowButton">\r\n                <span class="wrap">\r\n                    {{ if (calendarType === "date") { }}\r\n                        {{= i18n.CAL_today }}\r\n                    {{ } else { }}\r\n                        {{= i18n.CAL_now }}\r\n                    {{ } }}\r\n                    <span class="icon"></span>\r\n                </span></button>\r\n            <button class="button action up closeButton"><span class="wrap">{{= i18n.CAL_close }}<span class="icon"></span></span></button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("common/component/calendar/calendar2",["require","jquery","underscore","common/util/datetime/RelativeDate","common/util/datetime/RelativeTime","common/util/datetime/RelativeTimestamp","text!./template/calendar2Template.htm","bundle!calendar","jquery.ui","common/jquery/extension/datepickerExt","common/jquery/extension/timepickerExt"],function(e){var t=e("jquery"),i=e("underscore"),n=e("common/util/datetime/RelativeDate"),o=e("common/util/datetime/RelativeTime"),s=e("common/util/datetime/RelativeTimestamp"),r=e("text!./template/calendar2Template.htm"),a=e("bundle!calendar");e("jquery.ui"),e("common/jquery/extension/datepickerExt"),e("common/jquery/extension/timepickerExt");var l={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g},c=function(e){return e=null==e?"":String(e),e=e.toLowerCase(),e.charAt(0).toUpperCase()+e.slice(1)},d=i.template(r,null,l),u={counter:0,activeMark:"activeCalendar2",hasActiveCalendar:function(e){return t(e).hasClass(this.activeMark)},instance:function(e){e=e||{};var r=this,l="hidden",u="calendar2_"+ ++this.counter,h={calContainer:!1,tabs:[],tabButtons:[],rdFunction:void 0,build:function(){e.calendarType=e.calendarType||"datetime",e.disabled=e.disabled||!1,e.relativeTime=e.relativeTime||!1,e.inputField=t(e.inputField),"date"==e.calendarType?h.rdFunction=n:"datetime"==e.calendarType?h.rdFunction=s:"time"==e.calendarType&&(h.rdFunction=o);var r=i.map(i.keys(h.rdFunction.PATTERNS),function(e){return{label:c(e)+"(s)",value:e}});e.inputField.addClass("hasCalendar2"),h.calContainer=t(d({uniqueId:u,i18n:a,rdWords:r,calendarType:e.calendarType})),h.calContainer.appendTo("body"),t("<button type='button' class='ui-datepicker-trigger button picker'></button>").insertAfter(e.inputField),h.initTabs(),h.attachListeners(),e.disabled&&h.calContainer.addClass("disabled"),this.RD.init(h.rdFunction),this.Calendar.init()},attachListeners:function(){h.tabButtons.each(function(e,i){t(i).bind("click",function(){h.activateTab(e)})}),e.inputField.next(".ui-datepicker-trigger").bind("click",h.show),h.calContainer.find(".closeButton").bind("click",h.hide),h.calContainer.find(".nowButton").bind("click",i.bind(h.Calendar.setCurrent,h.Calendar)),t(document).bind("mousedown",h.checkExternalClick)},removeListeners:function(){h.tabButtons.each(function(e,i){t(i).unbind("click",function(){h.activateTab(e)})}),e.inputField.next(".ui-datepicker-trigger").unbind("click",h.show),h.calContainer.find(".closeButton").unbind("click",h.hide),h.calContainer.find(".nowButton").unbind("click",i.bind(h.Calendar.setCurrent,h.Calendar)),t(document).unbind("mousedown",h.checkExternalClick)},checkExternalClick:function(e){"shown"==l&&0===t(e.target).parents("#"+u).length&&h.hide()},initTabs:function(){h.tabs=h.calContainer.find(".tabs > div"),h.tabButtons=h.calContainer.find(".tabsControl > .tabSelect"),"time"!==e.calendarType||e.relativeTime||(h.tabs[1].remove(),h.tabButtons[1].remove(),h.calContainer.find(".tabsControl").hide()),h.activateTab(0)},activateTab:function(e){e>=h.tabs.length||(h.tabButtons.removeClass("opened"),h.tabs.removeClass("opened"),t(h.tabs[e]).addClass("opened"),t(h.tabButtons[e]).addClass("opened"),h.calContainer.find(".nowButton")[1===e?"hide":"show"]())},destroy:function(){e.inputField.removeClass("hasCalendar2"),h.removeListeners(),h.RD.destroy(),h.calContainer.remove()},show:function(){e.inputField.attr("readonly","readonly");var t=e.inputField.val(),i=h.rdFunction.isValid(t);h.activateTab(i?1:0),h.calContainer.show(),h.Calendar.create(),i?h.RD.setValue(t):h.Calendar.setValue(t),h.adjustPosition(),l="shown";var n=e.inputField;n.length&&n.addClass(r.activeMark)},adjustPosition:function(){var i=e.inputField,n=i.offset(),o=h.calContainer.width(),s=h.calContainer.height(),r=t(window),a=r.width(),l=r.height();n.top+25+s<=l||n.top-s-5<0?n.top+=25:n.top=n.top-s-5,n.left+o>a&&(n.left=Math.max(a-(o+20),50)),h.calContainer.offset(n)},hide:function(){e.inputField.removeAttr("readonly"),h.calContainer.hide(),h.Calendar.destroy(),l="hidden";var t=e.inputField;t.length&&t.removeClass(r.activeMark)},RD:{possibleValues:[],holder:!1,date:{},init:function(e){this.date=new e("","+",""),this.holder=h.calContainer.find(".relativeDates > .dates"),this.attachEventListeners()},attachEventListeners:function(){this.holder.find(".measure select, .sign select").bind("change",this.onSelect),this.holder.find(".amount input").bind("keyup",this.onSelect)},removeEventListeners:function(){this.holder.find(".measure select, .sign select").unbind("change",this.onSelect),this.holder.find(".amount input").unbind("keyup",this.onSelect)},onSelect:function(){e.inputField.val(h.RD.getValue()),e.inputField.trigger("change")},destroy:function(){this.removeEventListeners()},getValue:function(){return this.date.setKeyword(this.holder.find(".measure select").val()),this.date.setSign(this.holder.find(".sign select").val()),this.date.setNumber(this.holder.find(".amount input").val()),this.date.toString()},setValue:function(e){var t=h.rdFunction.parse(e);t?this.date=t:(this.date.setKeyword(""),this.date.setSign("+"),this.date.setNumber("")),this.holder.find(".measure select").val(this.date.keyword),this.holder.find(".sign select").val(this.date.sign),this.holder.find(".amount input").val(this.date.number)}},Calendar:{jqueryCalendar:!1,jqueryCalendarConfig:{},jqueryCalendarType:!1,init:function(){this.jqueryCalendarType="datetimepicker","time"==e.calendarType?this.jqueryCalendarType="timepicker":"date"==e.calendarType&&(this.jqueryCalendarType="datepicker"),this.jqueryCalendarConfig={dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss",showHour:!1,showMinute:!1,showSecond:!1,showTime:!1,constrainInput:!1,showButtonPanel:!1,onSelect:function(t){e.inputField.val(t),e.inputField.trigger("change")}},("datetime"==e.calendarType||"date"==e.calendarType)&&(this.jqueryCalendarConfig=i.extend(this.jqueryCalendarConfig,{changeYear:!0,changeMonth:!0})),("datetime"==e.calendarType||"time"==e.calendarType)&&(this.jqueryCalendarConfig=i.extend(this.jqueryCalendarConfig,{showTime:!0,showHour:!0,showMinute:!0,showSecond:!0})),this.jqueryCalendarConfig=i.extend(this.jqueryCalendarConfig,e.jqueryPickerOptions||{}),this.jqueryCalendarConfig.disabled=e.disabled,this.jqueryCalendar=h.calContainer.find("#"+u+"_calendar")},destroy:function(){this.jqueryCalendar[this.jqueryCalendarType]("destroy")},create:function(){this.jqueryCalendar[this.jqueryCalendarType](this.jqueryCalendarConfig)},getValue:function(){return this.jqueryCalendar[this.jqueryCalendarType]("getDate")},setCurrent:function(){var t=new Date;this.jqueryCalendar[this.jqueryCalendarType]("time"===e.calendarType?"setTime":"setDate",t),this.jqueryCalendar.find(".ui-datepicker-today").click()},setValue:function(n){if("time"==e.calendarType)try{i.isString(n)?(n=t.datepicker.parseTime(this.jqueryCalendarConfig.timeFormat,n),n&&this.jqueryCalendar[this.jqueryCalendarType]("setTime",n)):(n=new Date(n.getTime()),"Invalid Date"!==n.toString()&&this.jqueryCalendar[this.jqueryCalendarType]("setTime",n))}catch(o){}else{if(!(n instanceof Date))try{"datetime"==e.calendarType?n=t.datepicker.parseDateTime(this.jqueryCalendarConfig.dateFormat,this.jqueryCalendarConfig.timeFormat,n):"date"==e.calendarType&&(n=t.datepicker.parseDate(this.jqueryCalendarConfig.dateFormat,n))}catch(o){}if(n instanceof Date&&"Invalid Date"!==n.toString())return this.jqueryCalendar[this.jqueryCalendarType]("setDate",n)}}}};return h.build(),h}};return window.Calendar2=u,u}),define("adhoc/filter/valueEditor/dateTrait",["require","common/jquery/extension/timepickerExt","jrs.configs","underscore","common/component/calendar/calendar2"],function(e){var t=e("common/jquery/extension/timepickerExt"),i=e("jrs.configs"),n=e("underscore"),o=e("common/component/calendar/calendar2"),s=/([\s]+$|^[\s]+)/g,r=/[\s]*(\+|\-)[\s]*/g;return{init:function(e){this._calendars=[],this.pickerType=e.pickerType},render:function(){return this._destroyCalendars(),this.$el.html(this.template(this.i18nModel(this.serializeModel()))),this._setupCalendar(this.$(this.inputSelector),this.pickerType),this.trigger("rendered",this),this},valueConverter:function(e){var t=(e||"").toUpperCase().replace(s,"");return t=t.replace(r,"$1"),this._basicValueConverter(t)},removeView:function(){this._destroyCalendars(),this._calendars=null},_setupCalendar:function(e,n){var s=this;e.each(function(){var e=t(this);s._calendars.push(o.instance({inputField:e,calendarType:n,jqueryPickerOptions:i.calendar.timepicker}))})},_destroyCalendars:function(){n.invoke(this._calendars,"destroy"),this._calendars=[]}}}),define("adhoc/filter/valueEditor/DateValueEditor",["require","adhoc/filter/valueEditor/dateTrait","adhoc/filter/valueEditor/InputValueEditor"],function(e){var t=e("adhoc/filter/valueEditor/dateTrait"),i=e("adhoc/filter/valueEditor/InputValueEditor");return i.extend(t)}),define("adhoc/filter/valueEditor/InputRangeValueEditor",["require","adhoc/filter/valueEditor/rangeTrait","adhoc/filter/valueEditor/InputValueEditor"],function(e){var t=e("adhoc/filter/valueEditor/rangeTrait"),i=e("adhoc/filter/valueEditor/InputValueEditor");return i.extend(t)}),define("adhoc/filter/valueEditor/DateRangeValueEditor",["require","underscore","jquery","adhoc/filter/valueEditor/dateTrait","adhoc/filter/valueEditor/InputRangeValueEditor"],function(e){var t=e("underscore"),i=e("jquery"),n=e("adhoc/filter/valueEditor/dateTrait"),o=e("adhoc/filter/valueEditor/InputRangeValueEditor"),s=o.prototype;return o.extend(t.extend({},n,{onChange:function(e){this.model.set("isAnyValue",!1,{silent:!0}),s.onChange.call(this,e)},registerEvents:function(){s.registerEvents.call(this),this.$el.on("change","input[type=checkbox]",t.bind(function(e){var t=i(e.target).prop("checked");this.model.set("isAnyValue",t),t&&(this.model._setDefaultValue(),this.render())},this))}}))}),define("text!adhoc/filter/valueEditor/template/inputRangeValueEditorTemplate.htm",[],function(){return'<fieldset class="values between">\n    <label class="control input text">\n        <input class="" type="text" value="{{-value[0]}}">\n        <span data-validation-field="value__1" class="message warning"></span>\n    </label>\n    <div class="compare">{{= i18n.ADH_DYNAMIC_FILTER_AND }}</div>\n    <label class="control input text">\n        <input class="" type="text" value="{{-value[1]}}">\n        <span data-validation-field="value__2" class="message warning"></span>\n    </label>\n    <span data-validation-field="value" class="message warning"></span>\n</fieldset>\n'}),define("text!adhoc/filter/valueEditor/template/inputValueEditorTemplate.htm",[],function(){return'<fieldset class="values ">\n    <label class="control input text">\n        <input class="" type="text" value="{{-value}}">\n        <span data-validation-field="value" class="message warning"></span>\n    </label>\n</fieldset>'}),define("text!adhoc/filter/valueEditor/template/booleanSelectEditorTemplate.htm",[],function(){return'<fieldset class="values ">\n    <label class="control select">\n        <select class="" {{ if (multiple) { }}multiple="multiple"{{ } }}>\n        {{ _.each(options, function(option) { }}\n            <option value="{{- option.value }}" {{ if (option.selected) { }}selected="selected"{{ } }}>{{- option.label }}</option>\n        {{ }); }}\n        </select>\n        <span data-validation-field="value" class="message warning"></span>\n    </label>\n</fieldset>'}),define("text!adhoc/filter/valueEditor/template/dateRangeValueEditorTemplate.htm",[],function(){return'<fieldset class="values between">\n    <label class="control picker" title="{{= i18n.ADH_DYNAMIC_FILTER_RELATIVE_DATE_TOOLTIP }}">\n        <input class="" name="value1" type="text" value="{{-value[0]}}">\n        <span data-validation-field="value__1" class="message warning"></span>\n    </label>\n    <div class="compare">{{= i18n.ADH_DYNAMIC_FILTER_AND }}</div>\n    <label class="control picker" title="{{= i18n.ADH_DYNAMIC_FILTER_RELATIVE_DATE_TOOLTIP }}">\n        <input class="" name="value2" type="text" value="{{-value[1]}}">\n        <span data-validation-field="value__2" class="message warning"></span>\n    </label>\n    <span data-validation-field="value" class="message warning"></span>\n</fieldset>\n\n<fieldset class="all {{= operatorName != \'betweenDates\' ? \'hidden\' : \'\'}}">\n    <div class="control checkBox">\n        <label class="wrap" title="{{= i18n.ADH_1216_DYNAMIC_FILTER_RESET_ALL }}">\n            {{= i18n.ADH_1202_DYNAMIC_FILTER_ALL_OPTION }}\n        </label>\n        <input type="checkbox" value="All" {{= isAnyValue ? \'checked="checked"\' : \'\'}} />\n    </div>\n</fieldset>'}),define("text!adhoc/filter/valueEditor/template/dateValueEditorTemplate.htm",[],function(){return'<fieldset class="values ">\n    <label class="control picker" title="{{= i18n.ADH_DYNAMIC_FILTER_RELATIVE_DATE_TOOLTIP }}">\n        <input type="text" value="{{-value}}">\n        <span data-validation-field="value" class="message warning"></span>\n    </label>\n</fieldset>'}),define("adhoc/filter/factory/valueEditorFactory",["require","underscore","adhoc/filter/enum/filterDataTypes","adhoc/filter/enum/filterOperators","adhoc/filter/valueEditor/ListValueEditorAdapter","adhoc/filter/valueEditor/MultiSelectValueEditorAdapter","adhoc/filter/valueEditor/MultiSelectWithTrueAllValueEditorAdapter","adhoc/filter/valueEditor/InputValueEditor","adhoc/filter/valueEditor/NumericRangeValueEditor","adhoc/filter/valueEditor/NumericValueEditor","adhoc/filter/valueEditor/BooleanSelectEditor","adhoc/filter/valueEditor/BooleanMultiSelectEditor","adhoc/filter/valueEditor/DateValueEditor","adhoc/filter/valueEditor/DateRangeValueEditor","text!adhoc/filter/valueEditor/template/inputRangeValueEditorTemplate.htm","text!adhoc/filter/valueEditor/template/inputValueEditorTemplate.htm","text!adhoc/filter/valueEditor/template/booleanSelectEditorTemplate.htm","text!adhoc/filter/valueEditor/template/dateRangeValueEditorTemplate.htm","text!adhoc/filter/valueEditor/template/dateValueEditorTemplate.htm","bundle!AdHocFiltersBundle"],function(e){var t=e("underscore"),i=e("adhoc/filter/enum/filterDataTypes"),n=e("adhoc/filter/enum/filterOperators"),o=e("adhoc/filter/valueEditor/ListValueEditorAdapter"),s=e("adhoc/filter/valueEditor/MultiSelectValueEditorAdapter"),r=e("adhoc/filter/valueEditor/MultiSelectWithTrueAllValueEditorAdapter"),a=e("adhoc/filter/valueEditor/InputValueEditor"),l=e("adhoc/filter/valueEditor/NumericRangeValueEditor"),c=e("adhoc/filter/valueEditor/NumericValueEditor"),d=e("adhoc/filter/valueEditor/BooleanSelectEditor"),u=e("adhoc/filter/valueEditor/BooleanMultiSelectEditor"),h=e("adhoc/filter/valueEditor/DateValueEditor"),p=e("adhoc/filter/valueEditor/DateRangeValueEditor"),m=e("text!adhoc/filter/valueEditor/template/inputRangeValueEditorTemplate.htm"),f=e("text!adhoc/filter/valueEditor/template/inputValueEditorTemplate.htm"),g=e("text!adhoc/filter/valueEditor/template/booleanSelectEditorTemplate.htm"),v=e("text!adhoc/filter/valueEditor/template/dateRangeValueEditorTemplate.htm"),_=e("text!adhoc/filter/valueEditor/template/dateValueEditorTemplate.htm"),b=e("bundle!AdHocFiltersBundle"),y={createInstance:function(e){return new this.constructor({model:e})},constructor:r},T={createInstance:function(e){return new this.constructor({model:e})},constructor:s},S={createInstance:function(e){return new this.constructor({model:e})},constructor:o},A={createInstance:function(e){return new this.constructor({template:f,model:e,i18n:b})},constructor:a},C={createInstance:function(e){return new this.constructor({template:g,model:e,i18n:b})},constructor:u},E={createInstance:function(e){return new this.constructor({template:g,model:e,i18n:b})},constructor:d},x={createInstance:function(e){return new this.constructor({template:m,model:e,i18n:b})},constructor:l},M={createInstance:function(e){return new this.constructor({template:f,model:e,i18n:b})},constructor:c},w={createInstance:function(e){return new this.constructor({template:_,model:e,pickerType:"date",i18n:b})
},constructor:h},D={createInstance:function(e){return new this.constructor({template:v,model:e,pickerType:"date",i18n:b})},constructor:p},I={createInstance:function(e){return new this.constructor({template:_,model:e,pickerType:"time",i18n:b})},constructor:h},O={createInstance:function(e){return new this.constructor({template:v,model:e,pickerType:"time",i18n:b})},constructor:p},L={createInstance:function(e){return new this.constructor({template:_,model:e,pickerType:"datetime",i18n:b})},constructor:h},N={createInstance:function(e){return new this.constructor({template:v,model:e,pickerType:"datetime",i18n:b})},constructor:p},R={};R[i.STRING]={},R[i.STRING][n.IN]=y,R[i.STRING][n.NOT_IN]=T,R[i.STRING][n.EQUALS]=S,R[i.STRING][n.NOT_EQUAL]=S,R[i.STRING][n.CONTAINS]=A,R[i.STRING][n.NOT_CONTAINS]=A,R[i.STRING][n.STARTS_WITH]=A,R[i.STRING][n.NOT_STARTS_WITH]=A,R[i.STRING][n.ENDS_WITH]=A,R[i.STRING][n.NOT_ENDS_WITH]=A,R[i.BOOLEAN]={},R[i.BOOLEAN][n.IN]=C,R[i.BOOLEAN][n.NOT_IN]=C,R[i.BOOLEAN][n.EQUALS]=E,R[i.BOOLEAN][n.NOT_EQUAL]=E,R[i.NUMERIC]={},R[i.NUMERIC][n.IN]=y,R[i.NUMERIC][n.NOT_IN]=T,R[i.NUMERIC][n.EQUALS]=M,R[i.NUMERIC][n.NOT_EQUAL]=M,R[i.NUMERIC][n.GREATER]=M,R[i.NUMERIC][n.LESS]=M,R[i.NUMERIC][n.GREATER_OR_EQUAL]=M,R[i.NUMERIC][n.LESS_OR_EQUAL]=M,R[i.NUMERIC][n.BETWEEN]=x,R[i.NUMERIC][n.NOT_BETWEEN]=x,R[i.LONG]={},t.extend(R[i.LONG],R[i.NUMERIC]),R[i.INTEGER]={},t.extend(R[i.INTEGER],R[i.NUMERIC]),R[i.DECIMAL]={},t.extend(R[i.DECIMAL],R[i.NUMERIC]),R[i.DATE]={},R[i.DATE][n.EQUALS]=w,R[i.DATE][n.NOT_EQUAL]=w,R[i.DATE][n.GREATER]=w,R[i.DATE][n.LESS]=w,R[i.DATE][n.GREATER_OR_EQUAL]=w,R[i.DATE][n.LESS_OR_EQUAL]=w,R[i.DATE][n.BETWEEN_DATES]=D,R[i.DATE][n.NOT_BETWEEN_DATES]=D,R[i.TIME]={},R[i.TIME][n.EQUALS]=I,R[i.TIME][n.NOT_EQUAL]=I,R[i.TIME][n.GREATER]=I,R[i.TIME][n.LESS]=I,R[i.TIME][n.GREATER_OR_EQUAL]=I,R[i.TIME][n.LESS_OR_EQUAL]=I,R[i.TIME][n.BETWEEN]=O,R[i.TIME][n.NOT_BETWEEN]=O,R[i.TIMESTAMP]={},R[i.TIMESTAMP][n.EQUALS]=L,R[i.TIMESTAMP][n.NOT_EQUAL]=L,R[i.TIMESTAMP][n.GREATER]=L,R[i.TIMESTAMP][n.LESS]=L,R[i.TIMESTAMP][n.GREATER_OR_EQUAL]=L,R[i.TIMESTAMP][n.LESS_OR_EQUAL]=L,R[i.TIMESTAMP][n.BETWEEN_DATES]=N,R[i.TIMESTAMP][n.NOT_BETWEEN_DATES]=N;var k={};return k[n.IN]=T,k[n.NOT_IN]=T,k[n.EQUALS]=S,k[n.NOT_EQUAL]=S,function(e,t,i){return i?k.hasOwnProperty(t)?k[t]:void 0:R.hasOwnProperty(e)&&R[e].hasOwnProperty(t)?R[e][t]:void 0}}),define("adhoc/filter/factory/possibleOperatorsFactory",["require","adhoc/filter/enum/filterDataTypes","adhoc/filter/enum/filterOperators","underscore"],function(e){var t=e("adhoc/filter/enum/filterDataTypes"),i=e("adhoc/filter/enum/filterOperators"),n=(e("underscore"),{});n[t.STRING]=[i.IN,i.NOT_IN,i.EQUALS,i.NOT_EQUAL,i.CONTAINS,i.NOT_CONTAINS,i.STARTS_WITH,i.NOT_STARTS_WITH,i.ENDS_WITH,i.NOT_ENDS_WITH],n[t.NUMERIC]=[i.IN,i.NOT_IN,i.EQUALS,i.NOT_EQUAL,i.LESS,i.GREATER,i.GREATER_OR_EQUAL,i.LESS_OR_EQUAL,i.BETWEEN,i.NOT_BETWEEN],n[t.BOOLEAN]=[i.IN,i.NOT_IN,i.EQUALS,i.NOT_EQUAL],n[t.TIMESTAMP]=[i.EQUALS,i.NOT_EQUAL,i.LESS,i.GREATER,i.GREATER_OR_EQUAL,i.LESS_OR_EQUAL,i.BETWEEN_DATES,i.NOT_BETWEEN_DATES],n[t.TIME]=[i.EQUALS,i.NOT_EQUAL,i.LESS,i.GREATER,i.GREATER_OR_EQUAL,i.LESS_OR_EQUAL,i.BETWEEN,i.NOT_BETWEEN],n[t.INTEGER]=n[t.NUMERIC],n[t.LONG]=n[t.NUMERIC],n[t.DECIMAL]=n[t.NUMERIC],n[t.DATE]=n[t.TIMESTAMP];var o=[i.IN,i.NOT_IN,i.EQUALS,i.NOT_EQUAL];return function(e,t){return t?o:n.hasOwnProperty(e)?n[e]:[]}}),define("text!adhoc/filter/editor/template/filterEditorTemplate.htm",[],function(){return'<li class="leaf filter">\n    <div class="pane panel filter {{print(filterPodMinimized ? \'minimized\' : \'\');}}">\n        <div class="content">\n            <div class="header">\n                <div class="title">\n                    <div class="filterName">\n                        <div class="button disclosure noBubble"></div>\n                        <span title="{{=filterLetter}}.{{-label}}">{{=filterLetter}}.{{-label}}</span>\n                    </div>\n                    <div class="button operator">\n                        <span class="icon"></span>\n                        <div>{{=operatorName}}</div>\n                    </div>\n                    <div class="button mutton">\n                        <span class="icon"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="body"></div>\n        </div>\n    </div>\n</li>'}),define("adhoc/filter/editor/FilterEditor",["require","underscore","common/util/featureDetection","actionModel.modelGenerator","backbone","adhoc/filter/enum/filterOperators","adhoc/filter/factory/filterOperatorLabelFactory","adhoc/filter/factory/valueEditorFactory","adhoc/filter/factory/possibleOperatorsFactory","bundle!AdHocFiltersBundle","text!adhoc/filter/editor/template/filterEditorTemplate.htm"],function(e){var t=e("underscore"),i=e("common/util/featureDetection"),n=e("actionModel.modelGenerator"),o=e("backbone"),s=(e("adhoc/filter/enum/filterOperators"),e("adhoc/filter/factory/filterOperatorLabelFactory")),r=e("adhoc/filter/factory/valueEditorFactory"),a=e("adhoc/filter/factory/possibleOperatorsFactory"),l=e("bundle!AdHocFiltersBundle"),c=e("text!adhoc/filter/editor/template/filterEditorTemplate.htm");return o.View.extend({template:t.template(c),isOlap:!1,el:function(){var e=this.model.toJSON();return e.i18n=l,this.template(e)},events:function(){var e={"click .header .operator":"showOperatorMenu","click .header .button.disclosure":"onToggleFilter"};return i.supportsTouch?e["click .header .mutton"]="showFilterMenu":e["mouseover .header .mutton"]="showFilterMenu",e}(),operators:{},initialize:function(){var e=this;this.valueEditorUIChanged=!1,t.bindAll(this,"removeFilter","upFilter","downFilter","drawToggleFilter"),this.operationsMenuActionModel=this.createOperationsMenuActionModel(),this.filterMenuActionModel=this.createFilterMenuActionModel(),this.listenTo(this.model,"operationChange",this.render),this.listenTo(this.model,"ready",this.render),this.listenTo(this.model,"change:filterPodMinimized",this.drawToggleFilter),this.listenTo(this.model,"change:filterLetter",this.redrawFilterTitle),this.listenTo(this.model,"change:label",this.redrawFilterTitle),this.model.loadAdditionalServerData(!0).done(function(){e.model.trigger("ready",e.model)})},redrawFilterTitle:function(){this.$(".filterName span").text(this.model.get("filterLetter")+"."+this.model.get("label")),this.$(".filterName span").attr("title",this.model.get("filterLetter")+"."+this.model.get("label"))},resizeTitle:function(){var e=this.$(".header .button.disclosure").width()+this.$(".header .button.operator div").width()+this.$(".header .button.operator .icon").width()+this.$(".header .button.mutton").width()+15,t=this.$(".header .title").width(),i=this.$(".header .filterName");i.css({overflow:"visible",width:"auto"});var n=i.find("span").width()+this.$(".header .button.disclosure").width()+15;i.css("overflow","hidden"),i.width(Math.min(t-e,n))},render:function(){var e=(this.model.get("operatorName"),this.getValueEditorFactory());return this.renderOperator(),this.valueEditor&&this.valueEditor.constructor==e.constructor||(this.valueEditor?(this.stopListening(this.valueEditor,"rendered",this.uiChanged),this.valueEditor.remove()):(this.$(".filter.panel").addClass("minimized"),t.defer(t.bind(this.drawToggleFilter,this))),this.valueEditor=this.createValueEditor()),this.valueEditor.updateData(),this},uiChanged:function(){this.trigger("uiChange:filters",this)},createValueEditor:function(){var e=this.getValueEditorFactory(),t=e.createInstance(this.model);return this.listenTo(t,"rendered",this.uiChanged),this.$(".body").html(t.$el),t},renderOperator:function(){this.$(".operator div").text(s(this.model.get("operatorName"),this.model.get("filterDataType"))),this.resizeTitle()},showOperatorMenu:function(e){n.showDynamicMenu("filterOperation_"+this.cid,e.originalEvent,"menu vertical dropDown fitable",null,this.operationsMenuActionModel)},showFilterMenu:function(e){n.showDynamicMenu(this.cid,e.originalEvent,"menu vertical dropDown fitable",null,this.filterMenuActionModel),e.stopPropagation()},onToggleFilter:function(){this.model.set("filterPodMinimized",!this.model.get("filterPodMinimized")),this.model.trigger("toggle",this.model)},drawToggleFilter:function(){this.$(".filter.panel")[this.model.get("filterPodMinimized")?"addClass":"removeClass"]("minimized")},removeFilter:function(e){var t=e&&e.force;this.model.get("used")&&!t?this.model.trigger("destroyConfirm",this.model,this.model.collection):this.model.trigger("destroy",this.model,this.model.collection)},upFilter:function(){this.model.trigger("move",this.model,{direction:-1})},downFilter:function(){this.model.trigger("move",this.model,{direction:1})},getValueEditorFactory:function(){var e=r(this.model.get("filterDataType"),this.model.get("operatorName"),this.isOlap);if(!e)throw"Value editor for filter data type '"+this.model.get("filterDataType")+"' and operator '"+this.model.get("operatorName")+"' does not exist";return e},createOperationsMenuActionModel:function(){var e=this,i={};return i["filterOperation_"+this.cid]=t.map(a(this.model.get("filterDataType"),this.isOlap),function(t){return n.createMenuElement("optionAction",{text:s(t,e.model.get("filterDataType")),action:function(t){e.model.set("operatorName",t)},actionArgs:[t],isSelectedTest:function(t){return e.model.get("operatorName")===t},isSelectedTestArgs:[t]})}),i},createFilterMenuActionModel:function(){var e={};return e[this.cid]=[n.createMenuElement("simpleAction",{text:l.ADH_1217_DYNAMIC_FILTER_REMOVE_FILTER,action:this.removeFilter}),n.createMenuElement("separator"),n.createMenuElement("simpleAction",{text:l.ADH_084_MOVE_UP,action:this.upFilter}),n.createMenuElement("simpleAction",{text:l.ADH_085_MOVE_DOWN,action:this.downFilter})],e},remove:function(){return this.valueEditor&&this.valueEditor.remove(),o.View.prototype.remove.call(this),this}})}),define("text!adhoc/filter/editor/template/readOnlyFilterTemplate.htm",[],function(){return'<li class="leaf filter">\n    <div class="panel pane filter {{ print(filterPodMinimized ? \'minimized\' : \'\'); }}">\n        <div class="content">\n            <div class="header">\n                <div class="title">\n                    <div class="filterName">\n                        <div class="button disclosure noBubble"></div>\n                        <span title="{{=filterLetter}}.{{-label}}">{{=filterLetter}}.{{-label}}</span>\n                    </div>\n                    <div class="button mutton">\n                        <span class="icon"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="body ">\n                <fieldset>\n                    {{ if (isComplex) { }}\n                    <ul class="message">\n                        {{ _.each(variableNames, function(value) { }}\n                        <li>{{=value}}</li>\n                        {{ }); }}\n                    </ul>\n                    <p class="message">{{= i18n.ADH_1215_DYNAMIC_FILTER_ADVANCED_INFO }}</p>\n                    {{ } else { }}\n                    <p class="message">{{=filter.expressionAsString}}</p>\n                    <p class="message">{{= i18n.ADH_1215_DYNAMIC_FILTER_UNEDITABLE_INFO }}</p>\n                    {{ } }}\n                </fieldset>\n            </div>\n        </div>\n    </div>\n</li>'}),define("adhoc/filter/editor/ReadOnlyFilterEditor",["require","adhoc/filter/editor/FilterEditor","underscore","text!adhoc/filter/editor/template/readOnlyFilterTemplate.htm"],function(e){var t=e("adhoc/filter/editor/FilterEditor"),i=e("underscore"),n=e("text!adhoc/filter/editor/template/readOnlyFilterTemplate.htm");return t.extend({template:i.template(n),resizeTitle:function(){},render:function(){return this}})}),define("text!adhoc/filter/editor/template/olapFilterEditorTemplate.htm",[],function(){return'<li class="leaf filter">\n    <div class="pane panel filter {{print(filterPodMinimized ? \'minimized\' : \'\');}}">\n        <div class="content">\n            <div class="header">\n                <div class="title">\n                    <div class="filterName">\n                        <div class="button disclosure noBubble"></div>\n                        <span title="{{-label}}">{{-label}}</span>\n                    </div>\n                    <div class="button operator">\n                        <span class="icon"></span>\n                        <div>{{=operatorName}}</div>\n                    </div>\n                    <div class="button mutton">\n                        <span class="icon"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="body"></div>\n        </div>\n    </div>\n</li>'}),define("adhoc/filter/editor/OlapFilterEditor",["require","adhoc/filter/editor/FilterEditor","underscore","text!adhoc/filter/editor/template/olapFilterEditorTemplate.htm"],function(e){var t=e("adhoc/filter/editor/FilterEditor"),i=e("underscore"),n=e("text!adhoc/filter/editor/template/olapFilterEditorTemplate.htm");return t.extend({template:i.template(n),isOlap:!0,initialize:function(){t.prototype.initialize.apply(this,arguments),this.stopListening(this.model,"change:filterLetter",this.redrawFilterTitle)}})}),define("adhoc/filter/factory/filterEditorFactory",["require","adhoc/filter/editor/FilterEditor","adhoc/filter/editor/ReadOnlyFilterEditor","adhoc/filter/editor/OlapFilterEditor","adhoc/filter/enum/filterDataTypes"],function(e){var t=e("adhoc/filter/editor/FilterEditor"),i=e("adhoc/filter/editor/ReadOnlyFilterEditor"),n=e("adhoc/filter/editor/OlapFilterEditor"),o=e("adhoc/filter/enum/filterDataTypes");return function(e,s){var r;return r=s?n:e===o.READ_ONLY?i:t,function(e){return new r({model:e})}}}),function(e,t){if("function"==typeof define&&define.amd)define("jquery.ui.mouse.touch",["jquery.ui"],e);else{if(!t||!t.ui)throw"jQuery UI is not loaded.";e(t)}}(function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var i=e.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}if(e.support.touch="ontouchend"in document,e.support.touch){var i,n=e.ui.mouse.prototype,o=n._mouseInit,s=n._mouseDestroy;n._touchStart=function(e){var n=this;!i&&n._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,n._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},n._touchMove=function(e){i&&(this._touchMoved=!0,t(e,"mousemove"))},n._touchEnd=function(e){i&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),i=!1)},n._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),o.call(t)},n._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),s.call(t)}}}),this.jQuery,define("adhoc/filter/BaseFiltersController",["require","backbone","jquery","actionModel.modelGenerator","adhoc/filter/FilterCollection","json3","namespace","underscore","core.layout","common/util/featureDetection","adhoc/filter/enum/filterDataTypes","adhoc/filter/factory/filterEditorFactory","bundle!AdHocFiltersBundle","jquery.ui.mouse.touch","components.dialog"],function(e){var t=e("backbone"),i=e("jquery"),n=e("actionModel.modelGenerator"),o=e("adhoc/filter/FilterCollection"),s=e("json3"),r=e("namespace"),a=e("underscore"),l=e("core.layout"),c=e("common/util/featureDetection"),d=e("adhoc/filter/enum/filterDataTypes"),u=e("adhoc/filter/factory/filterEditorFactory"),h=e("bundle!AdHocFiltersBundle");e("jquery.ui.mouse.touch"),e("components.dialog");var p=r.components.ConfirmDialog;return t.View.extend({collectionConstructor:o,events:function(){var e={"click .button.action.primary":"applyFilters","click .button.minimize":"markPanelStateAsManuallyChanged"};return c.supportsTouch?e["click #filterPanelMutton"]="showFiltersMenu":e["mouseover #filterPanelMutton"]="showFiltersMenu",e}(),initialize:function(e){this.onApply=e.onApply,this.onStateUpdate=e.onStateUpdate,this.onFilterRemove=e.onFilterRemove,this.resetFilterPanelState=e.resetFilterPanelState,this.service=e.service,this.clientKey=e.clientKey,this.collection=e.collection||new o([],{service:this.service,isOlap:this.isOlap}),this._filtersChanged=!1,this.confirmDialog=new p,a.bindAll(this,"addFilter","addSliceFilter","updateFilter","toggleFilter","minimizeAllFilters","maximizeAllFilters","deleteAllFilters","onMove"),this.filtersMenuActionModel=this.createFiltersMenuActionModel(),this.once("reset:panel",this.resetFilterPanelState),this.on("reset:panel",this.render),this.on("change:filters",this.toggleApplyButtonState),this.on("invalid:filters",this.showFilterServerError),this.listenTo(this.collection,"reset",this.recreateFilterEditors),this.listenTo(this.collection,"add",this.addFilterEditor),this.listenTo(this.collection,"remove",this.removeFilterEditor),this.listenTo(this.collection,"destroy",this.deleteFilter),this.listenTo(this.collection,"destroyConfirm",this.removeConfirm),this.listenTo(this.collection,"move",this.onMove),this.listenTo(this.collection,"toggle",this.toggleFilter),this.listenTo(this.collection,"operationChange",this.updateFilter),this.listenTo(this.collection,"validated",this.toggleApplyButtonState),this.listenTo(this.collection,"change:value change:isAnyValue add remove operationChange",a.partial(this.setFiltersChanged,!0)),this.sizerEl=this.$(".sizer:eq(0)")[0]},markPanelStateAsManuallyChanged:function(){l.manuallyChangePanelState("filters",this.clientKey,!0)},unmarkPanelStateAsManuallyChanged:function(){l.manuallyChangePanelState("filters",this.clientKey,!1)},onPanelResize:function(){this.filterEditors&&a.invoke(this.filterEditors,"resizeTitle")},hasNotAppliedFilters:function(){return this._filtersChanged},setFiltersChanged:function(e){this._filtersChanged=e,this.trigger("change:filters")},render:function(){this.$("#filter-container ul.filters").empty();var e=document.createDocumentFragment();return a.each(this.filterEditors,function(t){e.appendChild(t.el)}),this.$("#filter-container ul.filters").html(e),this.initSortable(),this.resizeFilterEditorTitles(),this},initSortable:function(){this.$el.sortable({delay:200,handle:".header",items:"#filter-container li.filter",axis:"y",start:function(e,t){t.item.data("oldIndex",t.item.index())},stop:a.bind(function(e,t){var i=t.item.data("oldIndex"),n=t.item.index();i!=n&&this.moveFilter(this.collection.at(i),i,n)},this)})},createFiltersMenuActionModel:function(){var e={};return e[this.cid]=[n.createMenuElement("simpleAction",{text:h.ADH_1220_DYNAMIC_FILTER_MINIMIZE_ALL,action:this.minimizeAllFilters}),n.createMenuElement("simpleAction",{text:h.ADH_1221_DYNAMIC_FILTER_MAXIMIZE_ALL,action:this.maximizeAllFilters}),n.createMenuElement("separator"),n.createMenuElement("simpleAction",{text:h.ADH_1219_DYNAMIC_FILTER_REMOVE_ALL,action:this.deleteAllFilters})],e},removeFilterEditor:function(e){var t=this._getFilterEditorByModel(e);t&&this.stopListening(t,"uiChange:filters",this.onFilterEditorUIChanged),t&&t.remove(),this.$el.sortable("refresh")},addFilterEditor:function(e){l.maximize(this.el,!0),this.unmarkPanelStateAsManuallyChanged();var t=this.createEditor(e);a.isArray(this.filterEditors)||(this.filterEditors=[]),this.filterEditors.push(t),this.$("#filter-container ul.filters").append(t.$el),a.defer(a.bind(t.resizeTitle,t)),this.$el.sortable("refresh")},resizeFilterEditorTitles:function(){a.invoke(this.filterEditors||[],"resizeTitle")},onFilterEditorUIChanged:function(e){setTimeout(a.bind(this.resizeFilterEditorTitles,this),100),e.valueEditorUIChanged&&e.el===a.last(this.$(".leaf.filter"))&&setTimeout(a.bind(function(){this.$("> .content > .body").scrollTop(a.reduce(this.$(".leaf.filter"),function(e,t){return e+i(t).height()},0))},this),50),e.valueEditorUIChanged=!0},showFiltersMenu:function(e){n.showDynamicMenu(this.cid,e.originalEvent,"menu vertical dropDown fitable",null,this.filtersMenuActionModel),e.stopPropagation()},recreateFilterEditors:function(){this.cleanUpEditors(),this.filterEditors=this.collection.map(function(e){return this.createEditor(e)},this),this.trigger("reset:panel")},cleanUpEditors:function(){var e=this;a.each(this.filterEditors,function(t){e.stopListening(t,"uiChange:filters",e.onFilterEditorUIChanged)}),a.invoke(this.filterEditors||[],"remove")},createEditor:function(e){var t=u(e.isReadOnly()?d.READ_ONLY:e.get("filterDataType"),this.isOlap),i=t(e);return this.listenTo(i,"uiChange:filters",this.onFilterEditorUIChanged),i},showFilterServerError:function(e,t){this.$("#filterMessage span").html(t)},onMove:function(e,t){var i=this._getFilterEditorByModel(e),n=i.$el.index(),o=t.direction;0>o&&0===n||o>0&&n===this.collection.length-1||(-1===o?i.$el.insertBefore(this.$("#filter-container li.filter:eq("+(n+o)+")")):i.$el.insertAfter(this.$("#filter-container li.filter:eq("+(n+o)+")")),this.$el.sortable("refreshPositions"),this.moveFilter(e,n,n+o))},removeConfirm:function(e){this.confirmDialog.show({ok:a.bind(function(){var t=this._getFilterEditorByModel(e);t.removeFilter({force:!0})},this),messages:h.ADH_1230_DYNAMIC_FILTER_ADVANCED_CONFIRM_REMOVE})},_getFilterEditorByModel:function(e){return a.find(this.filterEditors,function(t){return e.cid===t.model.cid})},hasFilterForField:function(e){return!a.isEmpty(this.collection.where({name:e}))},toggleApplyButtonState:function(){this._filtersChanged&&this.collection.every(function(e){return e.get("filterDataType")===d.READ_ONLY?!0:e.isValid()})?this.enableApplyButton():this.disableApplyButton()},disableApplyButton:function(){this.$("#applyFilter > button.action").attr("disabled","disabled").removeClass("over")},enableApplyButton:function(){this.$("#applyFilter > button.action").removeAttr("disabled")},setFilters:function(e,t){this.setFiltersChanged(e.isFiltersDraft);var i=t&&t.reset?"reset":"set";this.collection[i](e.existingFilters)},getFilters:function(){return this.service.get().done(a.bind(function(e){this.setFilters(e,{reset:!0})},this))},addFilter:function(e){var t=!a.isEmpty(e)&&e[0].fieldName?"fieldName":"name";return this.service.add(a.pluck(e,t)).done(a.bind(function(e){this.collection.set(e.existingFilters),this.onStateUpdate(e)},this))},addSliceFilter:function(e,t){var i=a(t).filter(function(e){return"true"!==e.isSummary}).map(function(e){return e.path}).uniq();return this.service.addSlice(t[0].axis,"true"===e,i).done(a.bind(function(e){this.onApply(e),l.maximize(this.el,!0),this.setFilters(e,{reset:!0}),this.unmarkPanelStateAsManuallyChanged()},this))},updateFilter:function(e){return e.isValid(!0)?e.saveValue().done(a.bind(function(t){var i=a.findWhere(t.existingFilters,{id:e.id});i&&e.set(i,{silent:!0}),this.onStateUpdate(t)},this)):void 0},_deleteFilterDoneCallback:function(e,t){this.collection.set(t.existingFilters),this.onStateUpdate(t),this.onFilterRemove([e])},deleteFilter:function(e){return this.service.remove(e.id).done(a.bind(this._deleteFilterDoneCallback,this,e.toJSON()))},_deleteAllFiltersDoneCallback:function(e,t){this.collection.reset(t.existingFilters),this.onStateUpdate(t),this.onFilterRemove(e),this.setFiltersChanged(!0)},deleteAllFilters:function(){return this.service.removeAll().done(a.bind(this._deleteAllFiltersDoneCallback,this,this.collection.toJSON()))},moveFilter:function(e,t,i){return this.service.reorder(t,i).done(a.bind(function(e){this.collection.set(e.existingFilters),this.onStateUpdate(e)},this))},toggleFilter:function(e){return this.service.toggleVisibility(e.get("id"))},minimizeAllFilters:function(){return this.collection.invoke("set","filterPodMinimized",!0),this.service.minimizeAll()},maximizeAllFilters:function(){return this.collection.invoke("set","filterPodMinimized",!1),this.service.maximizeAll()},applyFilters:function(){return this.$("#filterMessage span").empty(),this.setFiltersChanged(!1),this.service.applyFiltersAndExpression(this.collection.toExpression(),"").done(a.bind(function(e){this.setFilters(e),this.onApply(e)},this)).fail(a.bind(function(e){var t=s.parse(e.responseText);t.editFilterError&&this.collection.trigger("invalid:filters",this.collection,t.editFilterError)},this))}})}),define("text!adhoc/filter/editor/template/complexExpressionTemplate.htm",[],function(){return'<div class="panel pane expression {{print(filterPodMinimized ? \'minimized\' : \'\');}}">\n    <div class="content">\n        <div class="header">\n            <div class="title">\n                <div class="filterName">\n                    <div class="button disclosure noBubble"></div>\n                    <span title="{{= i18n.ADH_DYNAMIC_FILTER_CUSTOMIZE_RELATIONSHIPS }}">{{= i18n.ADH_DYNAMIC_FILTER_CUSTOMIZE_RELATIONSHIPS }}</span>\n                </div>\n            </div>\n        </div>\n        <div class="body">\n            <fieldset class="values" id="">\n                <label class="control input text">\n                    <span class="wrap">{{= i18n.ADH_DYNAMIC_FILTER_FILTER_EXPRESSION }}</span>\n                    <input value="{{-complexExpression}}" type="text">\n                </label>\n            </fieldset>\n        </div>\n    </div>\n</div>'}),define("adhoc/filter/editor/ComplexExpressionEditor",["require","backbone","underscore","bundle!AdHocFiltersBundle","text!adhoc/filter/editor/template/complexExpressionTemplate.htm"],function(e){var t=e("backbone"),i=e("underscore"),n=e("bundle!AdHocFiltersBundle"),o=e("text!adhoc/filter/editor/template/complexExpressionTemplate.htm");return t.View.extend({events:{"change input":"onExpressionChange","click .header .button.disclosure":"onToggleFilter"},template:i.template(o),initialize:function(){this.listenTo(this.model,"change:complexExpression",this.updateComplexExpression),this.listenTo(this.model,"change:filterPodMinimized",this.drawToggleFilter)},onToggleFilter:function(){this.model.set("filterPodMinimized",!this.model.get("filterPodMinimized")),this.model.trigger("toggle",this.model)},drawToggleFilter:function(){this.$(".expression.panel")[this.model.get("filterPodMinimized")?"addClass":"removeClass"]("minimized")},render:function(){this.$el.empty();var e=this.model.toJSON();return e.i18n=n,this.$el.html(this.template(e)),this},onExpressionChange:function(){this.model.set("complexExpression",this.$("input").val())},updateComplexExpression:function(){this.$("input").val(this.model.get("complexExpression"))}})}),define("adhoc/filter/ComplexExpressionModel",["require","backbone"],function(e){var t=e("backbone");return t.Model.extend({})}),define("adhoc/filter/FiltersController",["require","exports","module","adhoc/filter/BaseFiltersController","adhoc/filter/editor/ComplexExpressionEditor","logger","adhoc/filter/ComplexExpressionModel"],function(e,t,i){var n=e("adhoc/filter/BaseFiltersController"),o=e("adhoc/filter/editor/ComplexExpressionEditor"),s=e("logger").register(i),r=e("adhoc/filter/ComplexExpressionModel"),a=n.extend({isOlap:!1,initialize:function(){n.prototype.initialize.apply(this,arguments),this.expressionModel=new r({id:"complexFilter",complexExpression:"",filterPodMinimized:!0}),this.complexExpressionEditor=new o({el:this.$("#expression-container"),model:this.expressionModel}),this.on("invalid:complexExpression",this.showComplexExpressionServerError),this.listenTo(this.collection,"change:value",this.updateFilter),this.listenTo(this.collection,"change:isAnyValue",this.updateFilter),this.listenTo(this.expressionModel,"toggle",this.toggleFilter),this.listenTo(this.expressionModel,"change:complexExpression",_.partial(this.setFiltersChanged,!0)),this.listenTo(this.expressionModel,"change:complexExpression",this.clearComplexExpressionServerError),this.listenTo(this.expressionModel,"change:filterPodMinimized",this.changeFilterPanelHeight)},changeFilterPanelHeight:function(){var e=this.$("> .content > .body"),t=this.$("> .content > .footer");e[this.expressionModel.get("filterPodMinimized")?"addClass":"removeClass"]("complexExpressionMinimized"),t[this.expressionModel.get("filterPodMinimized")?"addClass":"removeClass"]("complexExpressionMinimized"),e[this.expressionModel.get("filterPodMinimized")?"removeClass":"addClass"]("complexExpressionMaximized"),t[this.expressionModel.get("filterPodMinimized")?"removeClass":"addClass"]("complexExpressionMaximized")},render:function(){return n.prototype.render.apply(this,arguments),this.complexExpressionEditor.render(),this.changeFilterPanelHeight(),this},clearComplexExpressionServerError:function(){this.complexExpressionEditor.$("label.control.input").hasClass("error")&&(this.$("#filterMessage span").empty(),this.complexExpressionEditor.$("label.control.input").removeClass("error"))},showComplexExpressionServerError:function(e,t){this.$("#filterMessage span").html(t),this.complexExpressionEditor.$("label.control.input").addClass("error")},setFilters:function(e){this.expressionModel.set("complexExpression",e.complexExpression),this.expressionModel.set("filterPodMinimized",e.isComplexFilterPodMinimized),n.prototype.setFilters.apply(this,arguments)},_deleteFilterDoneCallback:function(e,t){this.expressionModel.set("complexExpression",t.complexExpression),n.prototype._deleteFilterDoneCallback.apply(this,arguments)},_deleteAllFiltersDoneCallback:function(e,t){this.expressionModel.set("complexExpression",t.complexExpression),n.prototype._deleteAllFiltersDoneCallback.apply(this,arguments)},applyFilters:function(){return this.$("#filterMessage span").empty(),this.setFiltersChanged(!1),this.service.applyFiltersAndExpression(this.collection.toExpression(),this.expressionModel.get("complexExpression")).done(_.bind(function(e,t,i){var n=i.getResponseHeader("adhocException");return n?void s.error(n):(this.setFilters(e),void this.onApply(e))},this)).fail(_.bind(function(e){var t=JSON.parse(e.responseText);t.editFilterError&&this.trigger("invalid:filters",this.collection,t.editFilterError),t.complexFilterError&&this.trigger("invalid:complexExpression",this.collection,t.complexFilterError)},this))}});return window.FiltersController=a,a}),define("adhoc/filter/OlapFiltersController",["require","adhoc/filter/BaseFiltersController","underscore","adhoc/filter/factory/filterModelExpressionTypeFactory","adhoc/filter/enum/filterExpressionTypes"],function(e){var t=e("adhoc/filter/BaseFiltersController"),i=e("underscore"),n=(e("adhoc/filter/factory/filterModelExpressionTypeFactory"),e("adhoc/filter/enum/filterExpressionTypes"),t.extend({isOlap:!0,initialize:function(){t.prototype.initialize.apply(this,arguments),this.listenTo(this.collection,"change:value",this.updateFilter)},addFilter:function(e){var t=e[0];return this.service.addOlapFilter(t.dimensionId,t.name).done(i.bind(function(e){this.collection.set(e.existingFilters),this.onStateUpdate(e)},this))},updateFilter:function(e){return e.isValid(!0)?this.service.update(e.get("id"),e.toExpression()).done(i.bind(function(t){var n=this;i.each(t.existingFilters,function(t){if(t.id!==e.get("id")){var i=n.collection.get(t.id);t.expressionType=i.get("expressionType"),i.set(t),i.removeAvailableData();var o=n._getFilterEditorByModel(i);o&&o.render()}}),this.onStateUpdate(t)},this)):void 0}}));return window.OlapFiltersController=n,n}),define("adhoc/filter/FilterService",["require","common/util/classUtil","underscore","jquery","json3","components.dialogs","jrs.configs","report.execution.count"],function(e){var t={table:"adhoc/table.html",crosstab:"adhoc/crosstab.html",olap_crosstab:"adhoc/crosstab.html",ichart:"adhoc/intelligentChart.html",olap_ichart:"adhoc/intelligentChart.html"},i=e("common/util/classUtil"),n=e("underscore"),o=e("jquery"),s=e("json3"),r=e("components.dialogs"),a=e("jrs.configs"),l=e("report.execution.count"),c=i.extend({constructor:function(e){this.clientKey=e.clientKey,this.mode=e.mode},createUrl:function(e,i){return(i||t[this.mode()])+"?action="+e},_request:function(e,t,i){t="undefined"==typeof t?!0:t,i=i||c.defaultCallbacks;
var n=o.ajax(e).done(i.done||c.defaultCallbacks.done).fail(i.fail||c.defaultCallbacks.fail).always(i.always||c.defaultCallbacks.always);return t&&setTimeout(function(){"pending"===n.state()&&r.popup.show(o("#loading")[0],!1,{focus:!1})},c.SLOW_REQUEST_TIMEOUT),n},get:function(){return this._request({url:this.createUrl("generateFilterPanel"),data:{clientKey:this.clientKey}})},add:function(e){return this._request({url:this.createUrl("addAdhocFilter"),type:"POST",data:{addAdhocFilterFields:e,clientKey:this.clientKey}})},addOlapFilter:function(e,i){return this._request({url:this.createUrl("addOLAPFilter",t.olap_crosstab),type:"POST",data:{dim:e,child:i,clientKey:this.clientKey}})},addSlice:function(e,i,o){return this._request({url:this.createUrl("addQuickSliceFilter",t.crosstab),type:"POST",data:{axis:e,includeOrExclude:i,pathList:s.stringify(n.map(o,function(e){return encodeURIComponent(e)})),clientKey:this.clientKey}})},update:function(e,t){return this._request({url:this.createUrl("editAdhocFilter"),type:"POST",data:{filterId:e,editAdhocFilter:s.stringify(t),clientKey:this.clientKey}})},remove:function(e){return this._request({url:this.createUrl("deleteAdhocFilter"),type:"POST",data:{filterId:e,clientKey:this.clientKey}})},removeAll:function(){return this._request({url:this.createUrl("deleteAllAdhocFilters"),type:"POST",data:{clientKey:this.clientKey}})},reorder:function(e,t){return this._request({url:this.createUrl("reorderFilters"),type:"POST",data:{oldIndex:e,newIndex:t,clientKey:this.clientKey}})},toggleVisibility:function(e){return this._request({url:this.createUrl("toggleFilterPodState"),type:"POST",data:{filterId:e,clientKey:this.clientKey}})},minimizeAll:function(){return this._request({url:this.createUrl("minimizeAllAdhocFilterPods"),type:"POST",data:{clientKey:this.clientKey}})},maximizeAll:function(){return this._request({url:this.createUrl("maximizeAllAdhocFilterPods"),type:"POST",data:{clientKey:this.clientKey}})},fetchValues:function(e,t,i){return this._request({url:this.createUrl("getFieldValues"),data:n.extend({fieldName:encodeURIComponent(e),clientKey:this.clientKey},t)},i)},applyFiltersAndExpression:function(e,t){return this._request({url:this.createUrl("applyAdhocFiltersAndExpression"),type:"POST",data:{complexFilterExpression:t,adhocFilters:s.stringify(e),clientKey:this.clientKey}})},getMaxMinValues:function(e){return this._request({url:this.createUrl("getMaxMinValues"),data:{fieldName:encodeURIComponent(e),clientKey:this.clientKey}})}});return c.defaultCallbacks={done:function(){a.isFreeOrLimitedEdition&&l.check()},fail:function(e){e.getResponseHeader("LoginRequested")?document.location=a.urlContext:e.getResponseHeader("adhocException")?r.errorPopup.show(e.getResponseHeader("adhocException")):(500==e.status||e.getResponseHeader("JasperServerError")&&!e.getResponseHeader("SuppressError"))&&r.errorPopup.show(e.responseText)},always:function(){r.popup.hide(o("#loading")[0])}},c.SLOW_REQUEST_TIMEOUT=2e3,window.FilterService=c,c}),Draggable.prototype.startDrag=function(e){if(Draggable.isDragging=!0,this.dragging=!0,this.delta||(this.delta=this.currentDelta()),this.options.zindex&&(this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0),this.element.style.zIndex=this.options.zindex),this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this._originallyAbsolute="absolute"==this.element.getStyle("position"),this._originallyAbsolute||Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element),"TR"===this.element.parentNode.tagName&&document.body.appendChild(this.element)),this.options.superghosting){Position.prepare();var t=[Event.pointerX(e),Event.pointerY(e)],i=document.getElementsByTagName("body")[0],n=this.element;this._clone=n.cloneNode(!0),Prototype.Browser.IE&&(this._clone.clearAttributes(),this._clone.mergeAttributes(n.cloneNode(!1))),n.parentNode.insertBefore(this._clone,n),n.id="clone_"+n.id,n.hide(),Position.absolutize(n),n.parentNode.removeChild(n),i.appendChild(n),("0px"==n.style.width||"0px"==n.style.height)&&(n.style.width=Element.getWidth(this._clone)+"px",n.style.height=Element.getHeight(this._clone)+"px"),this.originalScrollTop=Element.getHeight(this._clone)/2,this.draw(t),n.show()}if(this.options.scroll)if(this.options.scroll==window){var o=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=o.left,this.originalScrollTop=o.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,this.originalScrollTop=this.options.scroll.scrollTop;Draggables.notify("onStart",this,e),this.options.starteffect&&this.options.starteffect(this.element)},Draggable.prototype.draw=function(e){var t=Position.cumulativeOffset(this.element);if(this.options.ghosting){var i=Position.realOffset(this.element);t[0]+=i[0]-Position.deltaX,t[1]+=i[1]-Position.deltaY}var n=this.currentDelta();t[0]-=n[0],t[1]-=n[1],this.options.scroll&&(t[0]-=this.options.scroll.scrollLeft,t[1]-=this.options.scroll.scrollTop),this.options.scroll&&this.options.scroll!=window&&this._isScrollChild&&(t[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft,t[1]-=this.options.scroll.scrollTop-this.originalScrollTop);var o=[0,1].map(function(i){return e[i]-t[i]-(this.options.mouseOffset?-2:this.offset[i])}.bind(this));this.options.snap&&(o=Object.isFunction(this.options.snap)?this.options.snap(o[0],o[1],this):o.map(Object.isArray(this.options.snap)?function(e,t){return(e/this.options.snap[t]).round()*this.options.snap[t]}.bind(this):function(e){return(e/this.options.snap).round()*this.options.snap}.bind(this))),this.options.superghosting&&("absolute"==this.element.getStyle("position")?o[1]=e[1]-this.originalScrollTop:o[1]-=this.originalScrollTop||10);var s=this.element.style;this.options.constraint&&"horizontal"!=this.options.constraint||(s.left=o[0]+"px"),this.options.constraint&&"vertical"!=this.options.constraint||(s.top=o[1]+"px"),"hidden"==s.visibility&&(s.visibility="")},Draggable.prototype.initDrag=function(e){if((Object.isUndefined(Draggable._dragging[this.element])||!Draggable._dragging[this.element])&&(e.touches&&1==e.touches.length||Event.isLeftClick(e))){var t=Event.element(e),i=t.tagName.toUpperCase();if("INPUT"==i||"SELECT"==i||"OPTION"==i||"BUTTON"==i||"TEXTAREA"==i)return;if(jQuery(this.element).parents("#sortDialog").length>0&&"B"==i)return;var n=[Event.pointerX(e),Event.pointerY(e)],o=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(e){return n[e]-o[e]}),Draggables.activate(this),this.countdown=Draggables.DEFAULT_TOLERANCE,Event.stop(e),this.element.fire("drag:mousedown",{targetEvent:e})}},Droppables.isAffected=function(e,t,i){var n=jQuery(i.element),o=n.width(),s=n.height(),r=n.offset(),a={left:r.left+o,top:r.top+s},l=e[0]>r.left&&e[0]<a.left&&e[1]>r.top&&e[1]<a.top;return i.element!=t&&(t.parentNode===$(document.body)||!i._containers||this.isContained(t,i))&&(!i.accept||Element.classNames(t).detect(function(e){return i.accept.include(e)}))&&l},Draggable.prototype.finishDrag=function(e,t){if(Draggable.isDragging=!1,this.dragging=!1,isIE()&&(document.body.onmousemove=function(){}),this.options.quiet){Position.prepare();var i=[Event.pointerX(e),Event.pointerY(e)];Droppables.show(i,this.element)}this.options.ghosting&&(this._originallyAbsolute||(Position.relativize(this.element),"TR"===this._clone.parentNode.tagName&&this._clone.parentNode.insertBefore(this.element,this._clone)),delete this._originallyAbsolute,Element.remove(this._clone),this._clone=null);var n=!1;t&&(n=Droppables.fire(e,this.element),n||(n=!1)),n&&this.options.onDropped&&this.options.onDropped(this.element),Draggables.notify("onEnd",this,e);var o=this.options.revert;o&&Object.isFunction(o)&&(o=o(this.element));var s=this.currentDelta();o&&this.options.reverteffect?(0==n||"failure"!=o)&&this.options.reverteffect(this.element,s[1]-this.delta[1],s[0]-this.delta[0]):this.delta=s,this.options.zindex&&(this.element.style.zIndex=this.originalZ,this._clone&&(this._clone.style.zIndex=this.originalZ)),this.options.endeffect&&this.options.endeffect(this.element),this.options.superghosting&&(null==this.element.parentNode&&(Element.hide(this.element),$(document.body).appendChild(this.element)),Element.remove(this.element),new Draggable(this._clone,this.options)),Draggables.deactivate(this),Droppables.reset()},Sortable.defaultOnHover=Sortable.onHover,Sortable.onHover=function(e,t,i){e.hasClassName("dialog")||Sortable.defaultOnHover(e,t,i)},Sortable.defaultOnEmptyHover=Sortable.onEmptyHover,Sortable.onEmptyHover=function(e,t,i){e.hasClassName("dialog")||Sortable.defaultOnEmptyHover(e,t,i)};var SortableObserver=Class.create({initialize:function(e,t){this.element=$(e),this.observer=t,this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(e,t){Sortable.unmark(),this.lastValue!=Sortable.serialize(this.element)&&this.observer(this.element,t)}});Droppables.show=function(e,t){if(this.drops.length){var i,n=[];this.drops.each(function(i){Droppables.isAffected(e,t,i)&&(t.hasClassName("sortDialogAvailable")||t.hasClassName("sortDialogSortFields")?("sortDialogAvailable"==i.element.id||"sortDialogSortFields"==i.element.id)&&n.push(i):n.push(i))}),n.length>0&&(i=Droppables.findDeepestChild(n)),this.last_active&&this.last_active!=i&&this.deactivate(this.last_active),i&&(Position.within(i.element,e[0],e[1]),i.onHover&&(t.classNames().include("wrap")&&(t.relativize(),t.classNames().set(t.classNames().include("measure")?"draggable dragging measure"+(t.classNames().include("supportsFilter")?" supportsFilter":""):"draggable dragging dimension"+(t.classNames().include("supportsFilter")?" supportsFilter":"")),t.style.position="relative",t.style.display="inline-block",t.style.width="",t.style.height=""),i.onHover(t,i.element,Position.overlap(i.overlap,i.element))),i!=this.last_active&&Droppables.activate(i))}},define("dragdrop.extra.v0.5",["dragdrop.extra"],function(e){return function(){var t;return t||e.Draggable}}(this));var rom_orgMode=null,rom_showRoot=null,rom_repositoryModifier=function(e,t){var i;if(t){i=[];for(var n=0;n<e.length;n++)e[n].uri!=publicFolderUri&&i.push(e[n])}else if(rom_orgMode&&null!=e.children){for(var o,s=e.children,r=[],n=0;n<s.length;n++)s[n].uri==publicFolderUri?o=s[n]:r.push(s[n]);e.children=r,i={type:"superroot",label:"",extra:{}},i.children=[e,o]}else i=e;return i},rom_getRootNode=function(){var e=this.tree.rootNode;return e.param&&"superroot"==e.param.type&&(e="public"==e.childs[0].param.id?e.childs[1]:e.childs[0]),e},rom_findNodeChildByMetaName=function(e,t){if(e.param&&"superroot"==e.param.type){var i,n;if("public"==e.childs[0].param.id?(i=e.childs[0],n=e.childs[1]):(i=e.childs[1],n=e.childs[0]),"public"==t)return i;e=n}if(e.hasChilds())for(var o=0;o<e.childs.length;o++)if(e.childs[o].param.id==t)return e.childs[o];return null};define("org.rootObjectModifier",function(e){return function(){var t;return t||e.rom_init}}(this)),function(e,t,i){var n=i.Base.extend({structureFormater:function(e){if(!e)return e;var i=t.map(e.inputControl,function(e){return e.readOnly="true"==String(e.readOnly),e.uri=e.uri.replace("repo:",""),e}),n=t.map(i,function(e){return e.state});return n=t.compact(n),t.each(i,function(e){delete e.state}),t.extend({structure:i},this.convertResponseToControlsState(n))},convertResponseToControlsState:function(e){var i={},n=e.inputControlState?e.inputControlState:e,o=function(e){var t={value:e.value,label:e.label};return"true"==String(e.selected)&&(t.selected=!0),t},s=function(e){var i;return i=t.isArray(e)?t.map(e,o):[]},r=function(e){return t.isUndefined(e.value)||t.isNull(e.value)?s(e.options):e.value};return t.each(n,function(e){e&&e.uri&&(i[e.id]={error:t.isUndefined(e.error)?null:e.error,values:r(e)})}),{state:i}}});return e.DataConverter=n,e}(JRS.Controls,_,JRS.Controls),define("controls.dataconverter",["underscore","controls.core"],function(e){return function(){var t;return t||e.JRS.Controls}}(this)),JRS.Controls=function(e,t,i,n){function o(e){try{try{var o=t.parseJSON(e.responseText)}catch(s){}if(o&&o.error)i.each(o.error,function(e){var t=n.getViewModel(),i=e.inputControlUri.replace("repo:",""),o=t.find({uri:i});e.errorCode?o.set({error:e.errorCode}):e.defaultMessage&&o.set({error:e.defaultMessage})});else if(e.getResponseHeader("LoginRequested")||401===e.status)document.location=__jrsConfigs__.urlContext;else if(500==e.status||e.getResponseHeader("JasperServerError")&&!e.getResponseHeader("SuppressError")){var r="";r=o?Mustache.to_html("<div><b>{{message}}</b></div><p>{{#parameters}}<div>{{.}}</div>{{/parameters}}</p>",o):statusText,dialogs.errorPopup.show(r)}}catch(s){}}return i.extend(n,{DataTransfer:n.Base.extend({CONTROLS_STRUCTURE_TEMPLATE_URI:__jrsConfigs__.contextPath+"/rest_v2/reports{{reportUri}}/inputControls/{{controlIds}}",INITIAL_CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath+"/rest_v2/reports{{reportUri}}/inputControls/values",CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath+"/rest_v2/reports{{reportUri}}/inputControls/{{controlIds}}/values",constructor:function(e){this.dataConverter=e.dataConverter,this.initialize(e)},initialize:function(){},setReportUri:function(e){this.currentReportUri=e},buildUrl:function(e,t,o){return t=i.isArray(t)?t.join(";"):t||"",n.TemplateEngine.renderUrl(o,{reportUri:e,controlIds:t})},sendRequest:function(n,s,r){var a={url:n,type:"GET",dataType:"json",cache:!1};i.isEmpty(s)||i.extend(a,{type:"POST",processData:!1,data:e.stringify(s),contentType:"application/json"});var l=i.defaults(r||{},a);return l.headers||(l.headers={}),i.defaults(l.headers,{"X-Suppress-Basic":"true","Accept-Language":__jrsConfigs__.userLocale.replace(/_/g,"-")}),t.ajax(l).fail(o)},fetchControlsStructure:function(e,t){var o=this.buildUrl(this.currentReportUri,e,this.CONTROLS_STRUCTURE_TEMPLATE_URI),s=this.sendRequest(o,t).then(i.bind(this.dataConverter.structureFormater,this.dataConverter));return n.Utils.showLoadingDialogOn(s),s},updateControlsStructure:function(e,t){var n=this.buildUrl(t||this.currentReportUri,null,this.CONTROLS_STRUCTURE_TEMPLATE_URI);return this.sendRequest(n,e,{type:"PUT"}).then(i.bind(this.dataConverter.structureFormater,this.dataConverter))},fetchInitialControlValues:function(e){var t=this.buildUrl(e,null,this.INITIAL_CONTROLS_VALUES_TEMPLATE_URL),i=this.sendRequest(t).then(this.dataConverter.convertResponseToControlsState);return n.Utils.showLoadingDialogOn(i),i},fetchControlsUpdatedValues:function(e,o){var s=this.buildUrl(this.currentReportUri,e,this.CONTROLS_VALUES_TEMPLATE_URL),r=this.dataConverter;this.fullUpdateDeferred&&"pending"==this.fullUpdateDeferred.state()&&this.fullUpdateDeferred.reject();var a=new t.Deferred,l=n.Utils.wait(n.DataTransfer.FREQUENT_CHANGES_MIN_DELAY);return l.done(i.bind(function(){this.sendRequest(s,o).then(r.convertResponseToControlsState).done(function(e){"pending"==a.state()&&a.resolve(e)}).fail(function(){a.reject(this,arguments)})},this)),a.fail(function(){l.reject()}),n.Utils.showLoadingDialogOn(a),this.fullUpdateDeferred=a,a}},{CONTROLS_STRUCTURE_TEMPLATE_URI:__jrsConfigs__.contextPath+"/rest_v2/reports{{reportUri}}/inputControls/{{controlIds}}",INITIAL_CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath+"/rest_v2/reports{{reportUri}}/inputControls/values",CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath+"/rest_v2/reports{{reportUri}}/inputControls/{{controlIds}}/values",FREQUENT_CHANGES_MIN_DELAY:400})})}(JSON,jQuery,_,JRS.Controls),define("controls.datatransfer",["json3","jquery","controls.core","backbone","controls.dataconverter"],function(e){return function(){var t;return t||e.JRS.Controls}}(this)),JRS.Controls=function(e,t,i){var n=i.Base.extend({constructor:function(e){this.containerSelector=e&&e.containerSelector||i.ViewModel.DEFAULT_CONTAINER,this.controls={},i.getViewModel=t.bind(function(){return this},this),t.bindAll(this),this.registerEvents()},registerEvents:function(){i.ignore("changed:control",this.onControlChange),i.listen({"changed:control":this.onControlChange})},onControlChange:function(n,o){var s,r=o.slaveDependencies&&o.slaveDependencies.length;if(r){var a=this._getAllSlaveControlIds(o.id),l=this._getParentControlIds(a),c=t.union(a,l);s=this.get("selection"),t.isEmpty(c)||t.each(s,function(e,i){-1===t.indexOf(c,i)&&delete s[i]})}else s=this.get("selection");e(document).trigger(i.ViewModel.CHANGE_SELECTION,[s,a,r]),r||e(document).trigger(i.ViewModel.CHANGE_VALUES,[this.state])},_getAllSlaveControlIds:function(e){var i=[],n=this.findControl({id:e});return n&&!t.isEmpty(n.slaveDependencies)&&t.each(n.slaveDependencies,function(e){i.push(e),i.push.apply(i,this._getAllSlaveControlIds(e))},this),t.uniq(i)},_getParentControlIds:function(e){var i=[];return t.each(e,function(e){var t=this.findControl({id:e});i.push.apply(i,t.masterDependencies)},this),t.uniq(i)}},{DEFAULT_CONTAINER:"#inputControlsContainer",CHANGE_VALUES:"viewmodel:values:changed",CHANGE_SELECTION:"viewmodel:selection:changed",CHANGE_ORDER:"viewmodel:order:changed",isSelectionChanged:function(e,i){var n=e?t(e).keys():[],o=i?t(i).keys():[],s=t.union(n,o);if(s.length===n.length){var r=e?t.flatten(t(e).values()):[],a=i?t.flatten(t(i).values()):[];return t.difference(r,a).length>0||t.difference(a,r).length>0}return!0}}),o={getControls:function(){return this.controls},instantiate:function(e){this.controls={},t.each(e,this.createControl,this)},createControl:function(e){var t=function(e){for(var t in i)if(e.toLowerCase()===t.toLowerCase())return i[t]}(e.type);if(!t)throw new Error("Can not find implementation of the control type: "+e.type);return this.controls[e.id]=new t(e),this.controls[e.id]},removeControl:function(e){delete this.controls[e]},reorderControl:function(t,n){if(1!=this.structure.length){for(var o,s=n>t?1:-1,r=n>t?Math.min(t,n):Math.max(t,n),a=n>t?Math.max(t,n):Math.min(t,n),l=r;l!=a;l+=s)o=this.structure[l],this.structure[l]=this.structure[l+s],this.structure[l+s]=o;e(document).trigger(i.ViewModel.CHANGE_ORDER,[this.structure])}},set:function(n,o){if(n){if(t.extend(this,n),void 0!==n.structure){var s=n.structure;this.instantiate(s),this.draw(s)}if(void 0!==n.state){var r=n.state;this.update(r),!o&&e(document).trigger(i.ViewModel.CHANGE_VALUES,[n.state])}}},get:function(e){if(e){if("selection"===e){var i={};return t.each(this.getControls(),function(e){var n=e.get("selection");n instanceof Array?i[e.id]=n:t.isUndefined(n)||(i[e.id]=[n])}),i}return this[e]}},findControl:function(e){var i=t.keys(e)[0],n=t.values(e)[0];return t.find(this.getControls(),function(e){return e[i]===n})},pluck:function(e){return t.pluck(this.getControls(),e)}},s={draw:function(i){var n=this.getContainer();if(n.empty(),t.each(i,function(e){if(e.visible){var t=this.findControl({id:e.id});t.makeResizable&&t.makeResizable(),n.append(t.getElem())}},this),window.Report&&window.Report.icReorderEnabled){var o=window.Controls.layouts.LAYOUT_TOP_OF_PAGE==Report.reportControlsLayout;/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)||e(n).sortable({delay:200,placeholder:o?"verticalPlaceholder":"horizontalPlaceholder",axis:o?"x":"y",items:"> .leaf",cancel:"input,textarea,button,select,option,.list.inputSet",start:function(e,t){t.item.data("oldIndex",t.item.index())},stop:t.bind(function(e,t){var i=t.item.data("oldIndex"),n=t.item.index();i!=n&&this.reorderControl(i,n)},this)})}},update:function(e){t.each(e,function(e,t){var i=this.findControl({id:t});i.set({values:e.values,error:e.error})},this)},getContainer:function(){return this.container&&1==this.container.length?this.container:(this.container=e(this.containerSelector),this.container)},removeValidationMessages:function(){t.each(this.getControls(),function(e){e.set({error:null})})},areAllControlsValid:function(){return t.isEmpty(t.filter(this.getControls(),function(e){return!e.isValid()}))},setContainer:function(t){this.container=e(t)},reloadContainer:function(){return this.container=e(this.containerSelector),this.container},disable:function(){t.each(this.getControls(),function(e){e.set({disabled:!0})})},enable:function(){t.each(this.getControls(),function(e){e.set({disabled:!1})})}};return t.extend(n.prototype,o,s),t.extend(i,{ViewModel:n})}(jQuery,_,JRS.Controls),define("controls.viewmodel",["jquery","underscore","controls.core","controls.basecontrol"],function(e){return function(){var t;return t||e.JRS.Controls}}(this)),JRS.Controls=function(e,t,i){function n(e){this.set({selection:e})}function o(e){var t=e.toUpperCase().replace(/([\s]+$|^[\s]+)/g,"");return t.replace(/[\s]*(\+|\-)[\s]*/g,"$1")}function s(e,t){if(!e)return null;for(var i={},n=0;n<e.length;n++){var o=e[n];if(o.selected&&(i[n]=o.value,t))break}return i}var r;require(["common/util/parse/date"],function(e){r=e});var a,l,c;return require(["common/component/singleSelect/view/SingleSelect"],function(e){a=e}),require(["common/component/multiSelect/view/MultiSelect"],function(e){l=e}),require(["common/component/singleSelect/dataprovider/CacheableDataProvider"],function(e){c=e}),t.extend(i,{Bool:i.BaseControl.extend({update:function(e){var t=this.getElem(),i=t.find("input");"true"==e?i.prop("checked",!0):i.removeAttr("checked")},bindCustomEventListeners:function(){this.getElem().on("change","input",t.bind(function(e){var t=null==e.target.getValue()?"false":"true";this.set({selection:t})},this))}}),SingleValueText:i.BaseControl.extend({update:function(e){var t=e==ControlsBase.NULL_SUBSTITUTION_VALUE?ControlsBase.NULL_SUBSTITUTION_LABEL:e,i=this.getElem();i&&(i.find("input").attr("value",t),i.find("input").val(t))},bindCustomEventListeners:function(){this.getElem().on("change","input",t.bind(function(e){var t=e.target.value,i=t==ControlsBase.NULL_SUBSTITUTION_LABEL?ControlsBase.NULL_SUBSTITUTION_VALUE:t;this.set({selection:i})},this))}}),SingleValueNumber:i.BaseControl.extend({update:function(e){this.getElem().find("input").attr("value",e),this.getElem().find("input").val(e)},bindCustomEventListeners:function(){this.getElem().on("change","input",t.bind(function(e){this.set({selection:e.target.value})},this))}}),SingleValueDate:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.setupCalendar()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return r.localizedDateToIsoDate(t)},set:function(e,t){e.values&&(e.values=r.isoDateToLocalizedDate(e.values)),i.BaseControl.prototype.set.call(this,e,t)},setupCalendar:function(){var i=this.getElem().find("input");i.datepicker({showOn:"button",dateFormat:JRS.i18n.bundledCalendarFormat,changeMonth:!0,changeYear:!0,showButtonPanel:!0,disabled:i[0].disabled,onSelect:t.bind(n,this),onChangeMonthYear:null,beforeShow:e.datepicker.movePickerRelativelyToTriggerIcon,constrainInput:!1}),i.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(o(t.target.value)),n.call(this,e(t.target).val())},this)),i.after("&nbsp;");var s=this.getElem().find("button");s.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty()},update:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleValueDatetime:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.setupCalendar()},setupCalendar:function(){var i=this.getElem().find("input");i.datetimepicker({showOn:"button",dateFormat:JRS.i18n.bundledCalendarFormat,timeFormat:JRS.i18n.bundledCalendarTimeFormat,showSecond:!0,changeMonth:!0,changeYear:!0,showButtonPanel:!0,disabled:i[0].disabled,onSelect:t.bind(n,this),onChangeMonthYear:null,beforeShow:e.datepicker.movePickerRelativelyToTriggerIcon,constrainInput:!1}),i.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(o(t.target.value)),n.call(this,e(t.target).val())},this)),i.after("&nbsp;");var s=this.getElem().find("button");s.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return r.localizedTimestampToIsoTimestamp(t)},set:function(e,t){e.values&&(e.values=r.isoTimestampToLocalizedTimestamp(e.values)),i.BaseControl.prototype.set.call(this,e,t)},update:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleValueTime:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.setupCalendar()},setupCalendar:function(){var i=this.getElem().find("input");i.timepicker({showOn:"button",timeFormat:JRS.i18n.bundledCalendarTimeFormat,showSecond:!0,disabled:i[0].disabled,onClose:t.bind(n,this),beforeShow:e.datepicker.movePickerRelativelyToTriggerIcon,constrainInput:!1}),i.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(o(t.target.value)),n.call(this,e(t.target).val())},this)),i.after("&nbsp;");var s=this.getElem().find("button");s.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return r.localizedTimeToIsoTime(t)},set:function(e,t){e.values&&(e.values=r.isoTimeToLocalizedTime(e.values)),i.BaseControl.prototype.set.call(this,e,t)},update:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleSelect:i.BaseControl.extend({baseRender:function(n){this.singleSelect||(this.dataProvider=new c,this.singleSelect=new a({getData:this.dataProvider.getData}).setDisabled(n.readOnly)),n&&t.extend(this,n);var o=i.TemplateEngine.createTemplate(this.type);if(o){this.singleSelect.undelegateEvents();var s=e(o(this));this.singleSelect.render().renderData(),s.find(".ssPlaceholder").append(this.singleSelect.el),this.setElem(s),this.singleSelect.delegateEvents()}},update:function(e){this.dataProvider.setData(e);var t=this;this.singleSelect.fetch(function(){t.singleSelect.setValue(s(e,!0),{silent:!0})})},bindCustomEventListeners:function(){this.singleSelect.off("selection:change").on("selection:change",function(e){this.set({selection:e})},this)}}),MultiSelect:i.BaseControl.extend({INITIAL_MAX_HEIGHT:"240px",baseRender:function(n){this.multiSelect||(this.dataProvider=new c,this.multiSelect=new l({getData:this.dataProvider.getData}).setDisabled(n.readOnly)),n&&t.extend(this,n);var o=i.TemplateEngine.createTemplate(this.type);if(o){this.multiSelect.undelegateEvents();var s=e(o(this));this.multiSelect.render().renderData(),s.find(".msPlaceholder").append(this.multiSelect.el),this.setElem(s),this.multiSelect.delegateEvents()}},update:function(e){this.dataProvider.setData(e);var t=this;this.multiSelect.fetch(function(){var i=s(e);t.multiSelect.setValue(i,{silent:!0}),t.checkSelectionSize(i)})},bindCustomEventListeners:function(){this.multiSelect.off("selection:change").on("selection:change",function(e){this.set({selection:e}),this.checkSelectionSize(e)},this)},get:function(e){var i=this[e];return"selection"==e&&t.isEmpty(i)?[ControlsBase.NOTHING_SUBSTITUTION_VALUE]:i},checkSelectionSize:function(e){var t=0;for(var i in e)if(e.hasOwnProperty(i)&&t++>=4)break;5>t&&this.getElem()[0].clientHeight<125?(this.getElem().find(".sizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".sizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))},makeResizable:function(){this.resizable=!0;var t=this.getElem().find(".sList"),i=t.parents(".leaf").find(".sizer").removeClass("hidden");i.addClass("ui-resizable-handle ui-resizable-s"),t.resizable({handles:{s:i}}),t.one("resize",function(){var t=e(this).height();e(this).css("max-height","").css("height",t)}),t.css("max-height",this.INITIAL_MAX_HEIGHT)}}),SingleSelectRadio:i.BaseControl.extend({update:function(n){var o=((new Date).getTime(),this.getElem().find("ul")[0]),s=t.map(n,function(e){var i=t.clone(e);return i.readOnly=this.readOnly,i.name=this.getOptionName(),i.uuid=t.uniqueId(this.id),i},this),r=this.getTemplateSection("data");i.Utils.setInnerHtml(o,r,{data:s}),o.innerHTML+="&nbsp;",e(o).find("li").length<5&&this.getElem()[0].clientHeight<125?(this.getElem().find(".sizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".sizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))},getOptionName:function(){return this.id+"_option"},bindCustomEventListeners:function(){this.getElem().on("change","input",t.bind(function(e){var t=e.target.value,i=this;setTimeout(function(){i.set({selection:t})})},this))},makeResizable:function(){this.resizable=!0;var e=this.getElem().find("ul"),t=this.getElem().find(".sizer").removeClass("hidden");t.addClass("ui-resizable-handle ui-resizable-s"),e.resizable({handles:{s:t}})}}),MultiSelectCheckbox:i.BaseControl.extend({update:function(n){var o=t.map(n,function(e){var i=t.clone(e);return i.readOnly=this.readOnly,i.uuid=t.uniqueId(this.id),i},this),s=this.getElem().find("ul")[0],r=this.getTemplateSection("data");i.Utils.setInnerHtml(s,r,{data:o}),e(s).find("li").length<5&&this.getElem()[0].clientHeight<125?(this.getElem().find(".sizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".sizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))},getSelection:function(){var i=this.getElem().find(":checkbox").filter(":checked");return t.map(i,function(t){return e(t).val()})},bindCustomEventListeners:function(){this.getElem().on("change","input",t.bind(function(){var e=this.getSelection(),t=this;setTimeout(function(){t.set({selection:e})})},this)),this.getElem().on("click","a",t.bind(function(i){var n=this.getElem().find("input"),o=e(i.target)[0].name;"multiSelectAll"===o||"multiSelectNone"===o?t.each(n,function(e){e.checked="multiSelectAll"===o}):"multiSelectInverse"===o&&t.each(n,function(e){e.checked=!e.checked}),this.getElem().find("input").change()},this))},get:function(e){var i=this[e];return"selection"==e&&t.isEmpty(i)?[ControlsBase.NOTHING_SUBSTITUTION_VALUE]:i},makeResizable:function(){this.resizable=!0;var e=this.getElem().find("ul"),t=this.getElem().find(".sizer").removeClass("hidden");t.addClass("ui-resizable-handle ui-resizable-s"),e.resizable({handles:{s:t}})}})})}(jQuery,_,JRS.Controls),define("controls.components",["jquery","underscore","controls.basecontrol","common/jquery/extension/datepickerExt","common/jquery/extension/timepickerExt","common/component/singleSelect/view/SingleSelect","common/component/multiSelect/view/MultiSelect","common/component/singleSelect/dataprovider/CacheableDataProvider","common/util/parse/date"],function(e){return function(){var t;return t||e.JRS.Controls}}(this)),jQuery.url=function(e){function t(e){for(var t="",i=0,n=0,o=0;i<e.length;)n=e.charCodeAt(i),128>n?(t+=String.fromCharCode(n),i++):n>191&&224>n?(o=e.charCodeAt(i+1),t+=String.fromCharCode((31&n)<<6|63&o),i+=2):(o=e.charCodeAt(i+1),c3=e.charCodeAt(i+2),t+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&c3),i+=3);return t}function i(t,i){var n={},o={"true":!0,"false":!1,"null":null};return e.each(t.replace(/\+/g," ").split("&"),function(t,s){var a,l=s.split("="),c=r(l[0]),d=n,u=0,h=c.split("]["),p=h.length-1;if(/\[/.test(h[0])&&/\]$/.test(h[p])?(h[p]=h[p].replace(/\]$/,""),h=h.shift().split("[").concat(h),p=h.length-1):p=0,2===l.length)if(a=r(l[1]),i&&(a=a&&!isNaN(a)?+a:"undefined"===a?void 0:void 0!==o[a]?o[a]:a),p)for(;p>=u;u++)c=""===h[u]?d.length:h[u],d=d[c]=p>u?d[c]||(h[u+1]&&isNaN(h[u+1])?{}:[]):a;else e.isArray(n[c])?n[c].push(a):n[c]=void 0!==n[c]?[n[c],a]:a;else c&&(n[c]=i?void 0:"")}),n}function n(e){e=e||window.location;for(var t=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],o=t.exec(e),s={},r=n.length;r--;)s[n[r]]=o[r]||"";return s.query&&(s.params=i(s.query,!1)),s}function o(t){if(t.source)return encodeURI(t.source);var i=[];return t.protocol&&i.push("file"==t.protocol?"file:///":"mailto"==t.protocol?"mailto:":t.protocol+"://"),t.authority?i.push(t.authority):(t.userInfo?i.push(t.userInfo+"@"):t.user&&(i.push(t.user),t.password&&i.push(":"+t.password),i.push("@")),t.host&&(i.push(t.host),t.port&&i.push(":"+t.port))),t.path?i.push(t.path):(t.directory&&i.push(t.directory),t.file&&i.push(t.file)),t.query?i.push("?"+t.query):t.params&&i.push("?"+e.param(t.params)),t.anchor&&i.push("#"+t.anchor),i.join("")
}function s(e){return encodeURIComponent(e)}function r(e){return t(unescape(e.replace(/\+/g," ")))}return{encode:s,decode:r,parse:n,build:o}}(jQuery),define("jquery.urldecoder",["jquery"],function(e){return function(){var t;return t||e.jQuery}}(this)),function(e,t,i){function n(t){var i=e.url.parse(location.href).params;return i&&i[t]}return t.extend(i,{Controller:i.Base.extend({constructor:function(e){this.viewModel=e&&e.viewModel?e.viewModel:new i.ViewModel,this.dataTransfer=e&&e.dataTransfer?e.dataTransfer:new i.DataTransfer({dataConverter:new i.DataConverter}),this.initialize(e),i.listen({"viewmodel:selection:changed":t.bind(function(e,t,i,n){t&&n&&this.updateControlsValues(t,i)},this),"reportoptions:selection:changed":t.bind(function(e,t){this.reset(t&&t.uri)},this)}),i.getController=t.bind(function(){return this},this),t.bindAll(this)},initialize:function(e){this.dataTransfer.setReportUri(this.detectReportUri(e))},fetchControlsStructure:function(e,i){var n=this.dataTransfer,o=this.viewModel,s=i&&!t.isEmpty(e)?t.keys(e):[];return n.fetchControlsStructure(s,e).done(function(e){e&&o.set({structure:e.structure,state:e.state})})},detectReportUri:function(e){if(this.reportUri=e&&e.reportUri||n("reportUnitURI"),!this.reportUri)throw Error("Can't initialize without reportUri");return this.reportOptionUri=e&&e.reportOptionUri||n("reportOptionsURI"),this.getReportUri()},getReportUri:function(){return this.reportOptionUri||this.reportUri},getDataTransfer:function(){return this.dataTransfer},getViewModel:function(){return this.viewModel},updateControlsValues:function(e,i){var n=this.getDataTransfer(),o=this.getViewModel(),s=i||t.map(o.getControls(),function(e){return e.id});return n.fetchControlsUpdatedValues(s,e).done(o.set)},reset:function(e){return this.getDataTransfer().fetchInitialControlValues(e||this.getReportUri()).done(this.getViewModel().set)},update:function(e){return e||(e=this.getViewModel().get("selection")),this.updateControlsValues(e)},validate:function(){var e=this.getDataTransfer(),i=this.getViewModel(),n=t.map(i.getControls(),function(e){return e.id}),o=i.get("selection");return e.fetchControlsUpdatedValues(n,o).then(function(e){var n=t(e.state).reduce(function(e,t,i){return e[i]={error:t.error},e},{});i.set({state:n})}).then(function(){return i.areAllControlsValid()})}})})}(jQuery,_,JRS.Controls),define("controls.controller",["jquery","underscore","controls.core","controls.datatransfer","controls.viewmodel","controls.components","report.view.base","jquery.urldecoder"],function(e){return function(){var t;return t||e.JRS.Controls}}(this));var adhocControls={};adhocControls={CONTROLS_LOCATION:"filtersMainTableICCell",filterSaveAsCheckbox:null,controlsController:null,hideDialog:null,lastSelection:{controlsData:null,saveAsDefault:null},initialize:function(e){if("true"===hasVisibleInputControls&&$(ControlsBase.INPUT_CONTROLS_DIALOG)){this.controlsController=new JRS.Controls.Controller({reportUri:Report.reportUnitURI});var t="#"+ControlsBase.INPUT_CONTROLS_FORM+" .sub.header";if(jQuery("#"+ControlsBase.INPUT_CONTROLS_DIALOG).length>0&&(t="#"+ControlsBase.INPUT_CONTROLS_DIALOG+" .sub.header"),this.viewModel=this.controlsController.getViewModel(),this.viewModel.reloadContainer(),this.controlsController.fetchControlsStructure(e.adhocParameters,!0).always(function(){var e=adhocControls.viewModel;e.areAllControlsValid()&&"true"!==reportForceControlsOnStart?adhocControls.forceFiltersFromControls():adhocControls.launchDialog()}),this.filterSaveAsCheckbox=jQuery("#filterssaveasdefault"),0==this.filterSaveAsCheckbox.length)throw Error("Can't find filter save as default");adhocControls.setSaveAsDefaultCheckbox(e.isSaveParametersAsDefault);var i={"button#ok":this.applyFilters.curry(!0),"button#cancel":this.cancel,"button#reset":this.reset,"button#apply":this.applyFilters.curry(!1)};this._dialog=new ControlDialog(i),jQuery(document).trigger("controls:initialized",[this.viewModel])}},launchDialog:function(){"true"===hasVisibleInputControls&&(adhocControls._dialog.show(),enableSelection(adhocControls._dialog._dom),adhocControls.setFocusOnFirstInputControl())},applyFilters:function(e){adhocControls.hideDialog=e,adhocControls.isSelectionChanged()?adhocControls.controlsController.validate().then(function(t){t&&(adhocControls.forceFiltersFromControls(),e&&adhocControls.closeDialog())}):adhocControls.viewModel.areAllControlsValid()&&e&&adhocControls.closeDialog()},reset:function(){adhocControls.controlsController.reset(),adhocControls.setSaveAsDefaultCheckbox(!0)},cancel:function(){adhocControls.closeDialog(),adhocControls.isSelectionChanged()&&adhocControls.restoreDialogLastSelection()},forceFiltersFromControls:function(){var e,t=adhocControls.getControlsSelection(),i=adhocControls.isSaveAsDefaultCheckbox();i&&(e={filterssaveasdefault:"on"}),adhocControls.forceFilterAction(ControlsBase.buildSelectedDataUri(t,e)),adhocControls.saveDialogLastSelection(t,i)},closeDialog:function(){adhocControls._dialog.hide()},leaveAdhoc:function(){document.location=buildActionUrl({_flowId:"homeFlow"})},refreshAdhocDesigner:function(){var e=function(e){localContext.standardOpCallback(e),adhocDesigner.filtersController.setFilters(e,{reset:!0})};designerBase.sendRequest("co_loadState",[],e)},requestFilterAction:function(e,t,i,n){var o={_flowId:"adhocAjaxFilterDialogFlow",clientKey:clientKey,decorate:"no"};o[t]="true";var s=buildActionUrl(o),r=Object.extend({postData:n,callback:e,mode:AjaxRequester.prototype.EVAL_JSON,errorHandler:baseErrorHandler},i);ajaxTargettedUpdate(s,r)},setFilters:function(e){adhocControls.requestFilterAction(e,"setFilters")},forceFilterAction:function(e){adhocControls.requestFilterAction(function(e){"success"===e&&(adhocControls.refreshAdhocDesigner(),adhocControls.hideDialog&&adhocControls.closeDialog())},"setFilters",null,e)},setFocusOnFirstInputControl:function(){if("undefined"!=typeof firstInputControlName&&firstInputControlName){var e=$(firstInputControlName);e&&e.focus()}},isSelectionChanged:function(){return JRS.Controls.ViewModel.isSelectionChanged(adhocControls.getControlsLastSelection(),adhocControls.getControlsSelection())||adhocControls.getSaveAsDefaultCheckboxLastValue()!=adhocControls.isSaveAsDefaultCheckbox()},setSaveAsDefaultCheckbox:function(e){e?adhocControls.filterSaveAsCheckbox.prop("checked",!0):adhocControls.filterSaveAsCheckbox.removeAttr("checked")},isSaveAsDefaultCheckbox:function(){return adhocControls.filterSaveAsCheckbox.is(":checked")},getControlsSelection:function(){return adhocControls.viewModel.get("selection")},restoreDialogLastSelection:function(){adhocControls.controlsController.update(adhocControls.lastSelection.controlsData),adhocControls.setSaveAsDefaultCheckbox(adhocControls.lastSelection.saveAsDefault)},saveDialogLastSelection:function(e,t){adhocControls.lastSelection.controlsData=e,adhocControls.lastSelection.saveAsDefault=t},getControlsLastSelection:function(){return adhocControls.lastSelection.controlsData},getSaveAsDefaultCheckboxLastValue:function(){return adhocControls.lastSelection.saveAsDefault}},define("controls.adhoc",["controls.controller","report.view.base"],function(e){return function(){var t;return t||e.adhocControls}}(this));var crossTabMultiSelect={};crossTabMultiSelect.ROW_GROUP="rowGroup",crossTabMultiSelect.COL_GROUP="colGroupHeaderRow",crossTabMultiSelect.ROW_GROUP_LEVEL="rowGroupLevel_",crossTabMultiSelect.COl_GROUP_LEVEL="colGroupLevel_",crossTabMultiSelect.selectedCells=[],crossTabMultiSelect.selectXtabGroupMember=function(e,t){e=$(e);var i=null,n=null,o=null,s=null,r=new RegExp("\\d+"),a="SPAN"==e.tagName&&e.parentNode||e;a||(i=null);var l=$(a).identify(),c=r.exec(l)[0];if(l.startsWith(crossTabMultiSelect.ROW_GROUP)?(i=crossTabMultiSelect.ROW_GROUP_LEVEL+c,s=crossTabMultiSelect.ROW_GROUP,n="row"):l.startsWith(crossTabMultiSelect.COL_GROUP)&&(i=crossTabMultiSelect.COl_GROUP_LEVEL+c,s=crossTabMultiSelect.COL_GROUP,n="column"),i){var d=null,u=null;if(o={id:e.identify(),path:e.readAttribute("data-path"),value:e.readAttribute("data-fieldValue"),isSummary:e.readAttribute("data-isSummaryHeader"),isSliceable:"true"===e.readAttribute("data-sliceable"),axis:n,isInner:e.hasClassName("inner"),sorting:e.readAttribute("data-sorting"),level:e.readAttribute("data-levelname"),name:e.readAttribute("data-levelname")},u=isShiftHeld(t),selectionCategory.area==i&&u){r=new RegExp(/\d+$/);var h=selObjects[selObjects.length-1];if(h){var p=parseInt(r.exec(h.id)),m=parseInt(r.exec(e.id)),f=Math.abs(m-p),g=m>p;if(crossTabMultiSelect.isObjectAlreadySelected(o))adhocDesigner.removeSelectedObject(o);else for(var v=0;f>=v;v++){var _=g?p+v:p-v,b=$(s+"_"+c+"_"+_);if(b){var y={id:b.identify(),path:b.readAttribute("data-path"),value:b.readAttribute("data-fieldValue"),isSummary:b.readAttribute("data-isSummaryHeader"),isSliceable:"true"===b.readAttribute("data-sliceable"),axis:n,isInner:b.hasClassName("inner"),sorting:b.readAttribute("data-sorting"),level:b.readAttribute("data-levelname"),name:b.readAttribute("data-levelname")};designerBase.addToSelected(y),crossTabMultiSelect.activateSelectedXtabCells()}}selectionCategory.area=i}}else"false"===$(e).getAttribute("data-isSummaryHeader")?(d=isMetaHeld(t),o={id:e.identify(),path:e.readAttribute("data-path"),value:e.readAttribute("data-fieldValue"),isSummary:e.readAttribute("data-isSummaryHeader"),isSliceable:"true"===e.readAttribute("data-sliceable"),axis:n,isInner:e.hasClassName("inner"),sorting:e.readAttribute("data-sorting"),level:e.readAttribute("data-levelname"),name:e.readAttribute("data-levelname")},crossTabMultiSelect.isObjectAlreadySelected(o)&&d?crossTabMultiSelect.removeSelectedObject(o):((!d||designerBase.shouldClearSelections(t,i))&&(crossTabMultiSelect.deselectAllGroupMembers(t),designerBase.unSelectAll()),designerBase.addToSelected(o),crossTabMultiSelect.activateSelectedXtabCells(),selectionCategory.area=i)):isRightClick(t)&&(crossTabMultiSelect.isObjectAlreadySelected(o)||(crossTabMultiSelect.deselectAllGroupMembers(),designerBase.unSelectAll(),designerBase.addToSelected(o)));actionModel.setSelected(selObjects)}},crossTabMultiSelect.selectXtabGroupLabel=function(e){designerBase.unSelectAll(),selectionCategory.area="column"===e.axis?designerBase.COLUMN_GROUP_MENU_LEVEL:designerBase.ROW_GROUP_MENU_LEVEL,actionModel.setSelected([e]),designerBase.addToSelected(e)},crossTabMultiSelect.isObjectAlreadySelected=function(e){return designerBase.isObjectInSelection(e,"id")},crossTabMultiSelect.removeSelectedObject=function(e){crossTabMultiSelect.deactivateXtabCell(e);for(var t=null,i=0;i<selObjects.length;i++)if(selObjects[i].id==e.id){t=i;break}selObjects=selObjects.without(selObjects[t])},crossTabMultiSelect.activateSelectedXtabCells=function(){selObjects.each(function(e){crossTabMultiSelect.activateXtabCell(e)})},crossTabMultiSelect.activateXtabCell=function(e){if(e&&e.id){var t=e.id;(t.startsWith("colGroupHeaderRow")||t.startsWith("rowGroup"))&&$(t)&&($(t).addClassName("selected"),crossTabMultiSelect.selectedCells.push(e))}},crossTabMultiSelect.deactivateXtabCell=function(e){if(e&&e.id){var t=e.id;(t.startsWith("colGroupHeaderRow")||t.startsWith("rowGroup"))&&$(t)&&($(t).removeClassName("selected"),crossTabMultiSelect.selectedCells.without(e))}},crossTabMultiSelect.deactivateSelectedXtabCells=function(){selObjects.each(function(e){crossTabMultiSelect.deactivateXtabCell(e)})},crossTabMultiSelect.deselectAllGroupMembers=function(){crossTabMultiSelect.selectedCells.each(function(e){crossTabMultiSelect.deactivateXtabCell(e)}),crossTabMultiSelect.selectedCells.clear()},define("adhoc/crosstab.multiselect",function(e){return function(){var t;return t||e.crossTabMultiSelect}}(this)),define("adhoc/designer",["require","jrs.configs","prototype","jquery","designer.base","components.toolbar","touchcontroller","core.layout","utils.common","adhoc/chart/adhocIntelligentChart","adhoc/crosstab.tests","adhoc/chart.observers","adhoc/table.init","report.execution.count","actionModel.modelGenerator","adhoc/designer.calculatedFields","adhoc/designer.sort","adhoc/designer.reentrant","adhoc/layout.manager","adhoc/filter/FiltersController","adhoc/filter/OlapFiltersController","adhoc/filter/FilterService","dragdrop.extra.v0.5","org.rootObjectModifier","controls.adhoc","adhoc/crosstab.multiselect","common/util/classUtil"],function(e){e("jrs.configs"),e("prototype"),e("jquery"),e("designer.base"),e("components.toolbar"),e("touchcontroller"),e("core.layout"),e("utils.common"),e("adhoc/chart/adhocIntelligentChart"),e("adhoc/crosstab.tests"),e("adhoc/chart.observers"),e("adhoc/table.init"),e("report.execution.count"),e("actionModel.modelGenerator"),e("adhoc/designer.calculatedFields"),e("adhoc/designer.sort"),e("adhoc/designer.reentrant"),e("adhoc/layout.manager"),e("adhoc/filter/FiltersController"),e("adhoc/filter/OlapFiltersController"),e("adhoc/filter/FilterService"),e("dragdrop.extra.v0.5"),e("org.rootObjectModifier"),e("controls.adhoc"),e("adhoc/crosstab.multiselect");var t=e("common/util/classUtil");JRS.vars.current_flow="adhoc";var i,n;window.localContext=window,window.theBody=document.body,window.requestLogEnabled=!1,window.TIMEOUT_INTERVAL=1e3*serverTimeoutInterval,window.ADHOC_SESSION_TIMEOUT_MESSAGE=adHocSessionExpireCode,window.ADHOC_EXIT_MESSAGE=adHocExitConfirmation;var o={ui:{header_title:null,display_manager:null,canvas:null,dataMode:null},_leafSelectedFired:!1,dimensionsTree:null,measuresTree:null,_availableTreeLastOpened:null,_AVAILABLE_TREE_DEPTH:10,_cookieName:"lastNodeUri",_cookieTime:3,FOLDER_TYPE:"ItemGroupType",multiSelect:!1,MEASURES:"Measures",DIMENSIONS_TREE_DOM_ID:"dimensionsTree",DIMENSIONS_TREE_PROVIDER_ID:"dimensionsTreeDataProvider",MEASURES_TREE_DOM_ID:"measuresTree",MEASURES_TREE_PROVIDER_ID:"measuresTreeDataProvider",TREE_CONTEXT_MENU_PATTERN:["ul#dimensionsTree li.leaf .button","ul#dimensionsTree li.node .button","ul#measuresTree li.leaf .button","ul#measuresTree li.node .button"],DIMENSION_TREE_DIMENSION_CONTEXT:"dimensionsTree_dimension",DIMENSION_TREE_LEVEL_CONTEXT:"dimensionsTree_level",MEASURE_TREE_GROUP_CONTEXT:"measuresTree_group",MEASURE_TREE_CONTEXT:"measuresTree",TREE_NODE_AND_LEAF_PATTERN:["ul#visibleFieldsTree li.leaf","ul#visibleFieldsTree li.node","ul#dimensionsTree li.leaf","ul#dimensionsTree li.node","ul#measuresTree li.node"],CANVAS_ID:"canvasTable",CANVAS_PARENT_ID:"mainTableContainer",CANVAS_PANEL_ID:"canvas",OLAP_MEASURES_TREE:"measuresTree",DISPLAY_MANAGER_ID:"displayManagerPanel",overlayParent:null,overlayDraggedColumn:null,initialDragXposition:null,NaN:"NaN",removeDroppables:null,addDroppables:null,DEFAULT_SUMMARY_NUM_FUNC:"Sum",DEFAULT_SUMMARY_NONNUM_FUNC:"DistinctCount",COLUMN_OVERLAY_PATTERN:"div.overlay.col",GROUP_OVERLAY_PATTERN:"div.overlay.group",SUMMARY_OVERLAY_PATTERN:"div.overlay.summary",GROUP_LABEL_SPAN_PATTERN:"span.labelOverlay.label",COLUMN_SIZER_PATTERN:"div.columnSizer",ROW_OVERLAY_PATTERN:"div.rowOverlay",ROW_GROUP_OVERLAY_PATTERN:"div.rowGroupOverlay",COLUMN_GROUP_OVERLAY_PATTERN:"div.columnGroupOverlay",MEASURE_OVERLAY_PATTERN:"div.measureOverlay",XTAB_GROUP_HEADER_PATTERN:"th.label.group",XTAB_GROUP_OVERLAY_PATTERN:"div.overlay.xtab.gr",XTAB_GROUP_HEADER_OVERLAY_PATTERN:"div.overlay.xtab.header",XTAB_MEASURE_OVERLAY_PATTERN:"div.overlay.xtab.m",XTAB_MEASURE_HEADER_OVERLAY_PATTERN:"div.overlay.xtab.measure",ROW_GROUP_MEMBER_PATTERN:"tbody#detailRows tr td.label.member",COLUMN_GROUP_MEMBER_PATTERN:"thead#headerAxis th.label.member",LEGEND_OVERLAY_PATTERN:"div.legend.overlay",AVAILABLE_FIELDS_PATTERN:["ul#visibleFieldsTree","ul#dimensionsTree","ul#measuresTree"],CANVAS_PATTERN:"table#canvasTable",MENU_PATTERN:"div#menu",CANVAS_PARENT_PATTERN:"div#mainTableContainer",EXPORT_FORM_PATTERN:"#exportActionForm",FILTER_OPERATOR_MENU_PATTERN:"#filter-container .button.operator",FILTER_GENERAL_MENU_PATTERN:"#filter-container #filterPanelMutton",FILTER_ITEM_MENU_PATTERN:"#filter-container .button.mutton",SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG:{DIALOG_ID:"saveWithoutFiltersApplyConfirmationDialog",OK_BUTTON_ID:"saveWithoutFiltersApplyConfirmationDialogOK",CANCEL_BUTTON_ID:"saveWithoutFiltersApplyConfirmationDialogCancel"},INTEGER_JAVA_TYPES:["java.lang.Byte","java.lang.Integer","java.lang.Short","java.lang.Long","java.math.BigInteger"],DECIMAL_JAVA_TYPES:["java.lang.Float","java.lang.Double","java.math.BigDecimal","java.lang.Number"],DATE_JAVA_TYPES:["java.sql.Timestamp","java.sql.Time","java.sql.Date","java.util.Date"],BOOLEAN_JAVA_TYPES:["java.lang.Boolean"],DATE_TYPE_DISPLAY:"date",INTEGER_TYPE_DISPLAY:"int",DECIMAL_TYPE_DISPLAY:"dec",BOOLEAN_TYPE_DISPLAY:"bool",NOT_A_NUMBER_TYPE_DISPLAY:"NaN",toolbarActionMap:{presentation:"adhocDesigner.goToPresentationView",explorer:"adhocDesigner.goToDesignView",execute:"adhocDesigner.saveAndRun",undo:"adhocDesigner.undo",redo:"adhocDesigner.redo",undoAll:"adhocDesigner.undoAll",pivot:"adhocDesigner.pivot",sort:"adhocDesigner.sort",controls:"adhocDesigner.launchDialogMenu",styles:"adhocDesigner.showAdhocThemePane",query:"adhocDesigner.showViewQueryDialog"},dialogESCFunctions:{save:"saveAs",saveDataViewAndReport:"saveDataViewAndReport",sort:"sortDialog",reentrant:"selectFields",editLabel:"editLabel"},contextMap:{table:AdHocTable,crosstab:AdHocCrosstab,olap_crosstab:AdHocCrosstab,chart:AdHocChart,ichart:AdhocIntelligentChart,olap_ichart:AdhocIntelligentChart},isIntegerType:function(e){return o.INTEGER_JAVA_TYPES.indexOf(e)>=0},isDecimalType:function(e){return o.DECIMAL_JAVA_TYPES.indexOf(e)>=0},isDateType:function(e){return o.DATE_JAVA_TYPES.indexOf(e)>=0},isBooleanType:function(e){return o.BOOLEAN_JAVA_TYPES.indexOf(e)>=0},getSuperType:function(e){return o.isIntegerType(e)?o.INTEGER_TYPE_DISPLAY:o.isDecimalType(e)?o.DECIMAL_TYPE_DISPLAY:o.isDateType(e)?o.DATE_TYPE_DISPLAY:o.NOT_A_NUMBER_TYPE_DISPLAY},getSelectedColumnOrGroup:function(){return selObjects[0]},generalDesignerCallback:function(){localContext.initAll(),o.updateTrees()},launchDialogMenu:function(){adhocControls.launchDialog()},showViewQueryDialog:function(){o.viewQueryDialog.show()},sort:function(){adhocSort.launchDialog()},selectFields:function(){adhocReentrance.launchDialog()},run:function(e){if(JRS.reportExecutionCounter.check(),webHelpModule.setCurrentContext(e.indexOf("olap")>=0?"analysis":"ad_hoc"),this.ui.dataMode=jQuery("#dataSizeSelector"),this.ui.canvas=jQuery(isSupportsTouch()?"#mainTableContainer > .scrollWrapper":"#mainTableContainer"),this.ui.header_title=jQuery("#canvas > div.content > div.header > div.title"),this.observePointerEvents(),this.observeKeyEvents(),this.observeCustomEvents(),this.observeTableContainerEvents(),this.initDroppables(),this.initComponents(e),this.loadState(),window.isEmbeddedDesigner?(toolbarButtonModule.initialize(_.extend(this.toolbarActionMap,{presentation:"doNothing","export":"doNothing",save:"adhocDesigner.handleBack",closeDesigner:"adhocDesigner.handleCancel"}),$("adhocToolbar")),o.observeCloseDesignerEvent(),o.observeCrossDocumentMessages()):toolbarButtonModule.initialize(this.toolbarActionMap,$("adhocToolbar")),isSupportsTouch()){var t=this.ui.canvas.get(0);this._touchController=new TouchController(t,t.parentNode,{useParent:!0,absolute:!0,scrollbars:!0})}this.initTitle(),this.initFieldsPanel(!0),this.initFiltersPanel(),this.initPanelsState(),this.initDialogs(),"undefined"!=typeof window.orientation&&0===window.orientation&&this.hideOnePanel(),$("errorPageContent")?o.initEnableBrowserSelection($("designer")):o.initPreventBrowserSelection($("designer"))},initLocalContext:function(e){localContext=this.contextMap[e],localContext.setMode(e),localContext.init&&localContext.init(e),o.resetState(),localContext.reset()},initComponents:function(e){this.isCrosstabMode=e.indexOf("ichart")>=0||e.indexOf("crosstab")>=0,this.ui.canvas.empty(),jQuery("#level-container").hide(),jQuery("#dataModeSelector").val(e),this.initLocalContext(e),e.indexOf("ichart")<0&&o.registerTemplate(localContext,e+"Template"),this.initLayoutManager(e),e.indexOf("chart")>=0||e.indexOf("olap")>=0?this.ui.dataMode.hide():this.ui.dataMode.show(),jQuery("#columns").children().eq(0).html(layoutManagerLabels.column[e]),jQuery("#rows").children().eq(0).html(layoutManagerLabels.row[e])},render:function(e){toolbarButtonModule.setActionModel(e.actionmodel),localContext.getMode()!=designerBase.ICHART&&localContext.getMode()!=designerBase.OLAP_ICHART&&o.ui.canvas.empty(),o.updateCanvasClasses(o.isCrosstabMode),o.updateState(e);var t=localContext.render();isDesignView&&(o.enableCanUndoRedo(),o.enableRunAndSave(localContext.canSaveReport())),t&&(editor=null,designerBase.initAdhocSpecificDesignerBaseVar(),designerBase.setState(),designerBase.updateSessionWarning(),designerBase.updateFlowKey(),localContext.initAll&&localContext.initAll()),isDesignView&&o.isDisplayManagerVisible()&&jQuery("#"+o.DISPLAY_MANAGER_ID).removeClass(layoutModule.HIDDEN_CLASS),o.updateModeLabelSelection(localContext.state.viewType),o.updateDataMode(localContext.state.dataSize),o.ui.display_manager.render(e.columns?{column:e.columns,group:e.groups}:e.chartItems?{measures:e.chartItems,group:e.group}:{column:e.crosstabState.columnGroups,row:e.crosstabState.rowGroups}),jQuery("#designer").trigger("layout_update"),o.updateAllFieldLabels(),o.resetScroll(),isDesignView&&o.enableRunAndSave(localContext.canSaveReport()),o.enableSort("table"==e.viewType),o.viewQueryDialog.updateContent(localContext.state.query),jQuery("#designer").trigger("rendering:done")},resetState:function(){localContext.state=new o.State({})},updateState:function(e){localContext.state.update(e)},updateModeLabelSelection:function(e){jQuery("#dataModeSelector").val(e)},updateDataMode:function(e){jQuery("#dataSizeSelector").val(e)},setNothingToDisplayVisibility:function(e){if(e){if(jQuery("#titleCaption").css("min-width","400px"),jQuery("#nothingToDisplay").removeClass(layoutModule.HIDDEN_CLASS),centerElement($("nothingToDisplay"),{horz:!0,vert:!0}),isIPad()){{var t=$("nothingToDisplay"),i=parseInt(t.getStyle("width")),n=(i+getBufferWidth(t,!0),jQuery("#displayManager"));n?n.width():t.up(1).getWidth()}t.style.marginLeft=i/2+"px",t.style.left="0%",t.style.position="relative",t.style.minWidth="300px"}}else jQuery("#titleCaption").css("min-width",""),jQuery("#nothingToDisplay").addClass(layoutModule.HIDDEN_CLASS)},updateCanvasClasses:function(e){jQuery("#"+o.CANVAS_PANEL_ID)[(e?"add":"remove")+"Class"]("showingSubHeader OLAP")},showSaveConfirmationDialog:function(e){var t=jQuery("#"+o.SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG.DIALOG_ID);dialogs.popupConfirm.show(t[0],!1,{okButtonSelector:"#"+o.SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG.OK_BUTTON_ID,cancelButtonSelector:"#"+o.SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG.CANCEL_BUTTON_ID}).done(e)},resetScroll:function(){o._touchController&&(o._touchController.reset(),o._touchController.addPadding("canvasTable",{right:200}))},resetFilterPanelState:function(){layoutModule.panelStateWasManuallyChanged("filters",clientKey)?layoutModule["true"===layoutModule.getPanelMinimizedState("filters")?"minimize":"maximize"]($("filters"),!0):o.filtersController.collection.length>0||jQuery("#level-container .sliderTick").length>0?layoutModule.maximize($("filters"),!0):layoutModule.minimize($("filters"),!0)},canShowFilterOption:function(e){for(var t=!0,i=0;i<selObjects.length;i++)if(!localContext.canAddFilter(selObjects[i],e)){t=!1;break}return t},getMode:function(){return localContext.getMode()},isOlapMode:function(){return localContext.getMode().indexOf("olap")>-1}};return o.State=function(e){this.update(e),t.mixin(this,localContext.State)},o.State.prototype.update=function(e){_.extend(this,e)},window.adhocDesigner=o,window.adhocSessionButton=i,window.adhocSessionDialog=n,o}),define("adhoc/designer.label.actions",["require","adhoc/designer"],function(e){var t=e("adhoc/designer");return t.editDataHeader=function(e,i){var n=null,o=null,s=null,r=null,a=null,l=null,c=null,d=$("editLabel"),u=100,h=function(){t.initPreventBrowserSelection($("designer"))};if(this.initEnableBrowserSelection($("designer")),"title"===i)t.prevTitle=jQuery("#titleCaption").html(),editor=new InPlaceEditor(e),editor.oldTitle=editor.value.strip(),editor.makeEditable({onMouseup:t.returnToNormalReportTitle,onTab:t.returnToNormalReportTitle,onEnter:t.returnToNormalReportTitle,onEsc:t.returnToNormalReportTitle}),jQuery("#mainTableContainer").scrollLeft(0);else if(d){if(a=d.down("button#cancelEditBtn"),r=d.down("button#editLabelBtn"),"legend"===i){var p=designerBase.getSelectedObject();p&&(l=p.index,n=p.userName,o=d.down("input#editLabelInput"),o&&(o.value=n.strip(),s=function(){c=o.value,c=c.replace(/<\/?[^>]+(>|$)|["]/g,""),localContext.updateLegendLabel(c,l)}))}else if("column"===i){var m=t.getSelectedColumnOrGroup();m&&(n=getInnerText(m.header),u=$(m.header).getWidth(),l=m.index,o=d.down("input#editLabelInput"),o&&(o.value=n.strip(),s=function(){c=o.value,c=c.replace(/<\/?[^>]+(>|$)|["]/g,""),localContext.updateColumnHeaderRequest(c,l,u)}))}else if("tableGroup"===i){var f=t.getSelectedColumnOrGroup();if(f){var g=f.index;n=f.label,o=d.down("input#editLabelInput"),o&&(o.value=n.strip(),s=function(){c=o.value,c=c.replace(/<\/?[^>]+(>|$)|["]/g,""),localContext.updateGroupLabel(c,g)})}}if(o){$(a).observe("click",function(e){$(r).stopObserving("click"),h(),dialogs.popup.hide(d),Event.stop(e)}),$(r).observe("click",function(e){s(),h(),$(r).stopObserving("click"),dialogs.popup.hide(d),Event.stop(e)}),$(o).observe("key:enter",function(e){s(),h(),$(r).stopObserving("click"),$(o).stopObserving("key:enter"),dialogs.popup.hide(d),Event.stop(e)}),$(o).observe("keypress",function(e){e=e?e:window.event,"legend"===i&&(62==e.keyCode||60==e.keyCode||38==e.keyCode||61==e.keyCode||62==e.charCode||60==e.charCode||38==e.charCode||61==e.charCode)&&Event.stop(e)}),dialogs.popup.show(d);var v=500,_=function(){o.focus(),o.select()};isIE8()?setTimeout(_,v):_()}}},t.addColumnLabel=function(){if(1==selObjects.length){var e=designerBase.getSelectedObject(),i=e.header;i.hasClassName("deletedHeader")&&t.editDataHeader(i,"column")}},t.deleteColumnLabel=function(){if(1==selObjects.length){var e=designerBase.getSelectedObject(),t=e.header;t.hasClassName("deletedHeader")||(t.addClassName("deletedHeader"),t.innerHTML=t.readAttribute("data-fieldName")),localContext.removeColumnHeaderRequest()}},t.selectAndEditLabel=function(e){var i=null,n=$("legendOverlay_"+e);n&&(i={id:n.identify(),legendName:n.readAttribute("data-legendName"),index:n.readAttribute("data-index"),defaultName:n.readAttribute("data-defaultName"),userName:n.readAttribute("data-userName")},designerBase.unSelectAll(),localContext.deselectAllSelectedOverlays(),designerBase.addToSelected(i),buttonManager.select(n),t.editLegendLabel())},t.editLegendLabel=function(){if(1==selObjects.length){var e=designerBase.getSelectedObject(),i=$(e.id);i&&t.editDataHeader(i,"legend")}},t.editColumnLabel=function(){if(1==selObjects.length){var e=designerBase.getSelectedObject(),i=e.header;t.editDataHeader(i,"column")}},t.adhocTitleEdit=function(e){var t=e.element();!isNotNullORUndefined(editor)&&matchMeOrUp(t,"#titleCaption")&&(this.editDataHeader($("titleCaption"),"title"),Event.stop(e))},t.returnToNormalReportTitle=function(e){if(editor)if(e=e?e:window.event,e.keyCode==Event.KEY_ESC)editor.revertEdit(),editor=null,t.initPreventBrowserSelection($("designer"));else{editor.makeNonEditable(!0);var i=editor.elem.innerHTML;editor.oldTitle!=i?(t.updateReportTitle(i),t.initPreventBrowserSelection($("designer"))):"table"==localContext.getMode()&&jQuery("#titleCaption").html(t.prevTitle),editor=null}},t.addGroupLabel=function(){localContext.editGroupLabel()},t.deleteGroupLabel=function(){localContext.removeGroupLabel()},t.editGroupLabel=function(){localContext.editGroupLabel()},t}),define("adhoc/designer.field.actions",["require","bundle!adhoc_messages","adhoc/designer"],function(e){var t=e("bundle!adhoc_messages"),i=e("adhoc/designer");return i.addFieldToCanvas=function(){localContext.getMode()===designerBase.TABLE?AdHocTable.addFieldAsColumn():localContext.getMode()===designerBase.CROSSTAB?localContext.addFieldAsLastMeasure():localContext.getMode()===designerBase.CHART&&localContext.addFieldAsMeasure()},i.checkIfFieldIsNumeric=function(e){var t=i.findFieldByName(e);return null!=t&&"Numeric"==t.type},i.checkIfAllSelectedAreNumeric=function(){for(var e=null,t=null,n=0;n<selObjects.length;n++)if(t=selObjects[n],t&&(selectionCategory.area===designerBase.AVAILABLE_FIELDS_AREA?e=t.param.id:selectionCategory.area===designerBase.COLUMN_LEVEL&&(e=t.header.getAttribute("data-fieldName")),!i.checkIfFieldIsNumeric(e)))return!1;return!0},i.collectFields=function(e,t,i){for(var n=[],o=0;o<e.length;o++){var s=e[o];s.isParent()&&t?n=n.concat(this.collectFields(s.childs,t,i)):i?i(s.param.id)&&n.push(s.param.id):n.push(s.param.id)}return n},i.getAllFields=function(){return isNotNullORUndefined(localContext.state.allColumns)?localContext.state.allColumns:[]},i.findFieldByName=function(e){var t=null;return localContext.state.allColumns&&localContext.state.allColumns.each(function(i){if(i.name&&i.name==e)throw t=i,$break}),t},i.getNameForSelected=function(e){return selectionCategory.area===designerBase.AVAILABLE_FIELDS_AREA?e?e.param.id:"":e.chartMeasureId?e.chartMeasureId:selectionCategory.area===designerBase.COLUMN_LEVEL?e.header.getAttribute("data-fieldName"):selectionCategory.area===designerBase.GROUP_LEVEL?e.fieldName:selectionCategory.area===designerBase.ROW_GROUP_MENU_LEVEL||selectionCategory.area===designerBase.COLUMN_GROUP_MENU_LEVEL?e.name:selectionCategory.area===designerBase.SUMMARY_LEVEL?e.model.name:selectionCategory.area===designerBase.LEGEND_MENU_LEVEL?e.legendName:void 0},i.getFieldName=function(){var e=designerBase.getSelectedObject();return e?this.getNameForSelected(e):""},i.getFieldIndexByName=function(e){if(isNotNullORUndefined(localContext.state.allColumns))for(var t=localContext.state.allColumns.length,i=0;t>i;i++){var n=localContext.state.allColumns[i];if(n.name==e)return i}return-1},i.moveToDimensions=function(){if(selObjects.first()){var e=selObjects.clone();i.moveToMeasuresOrAttributes(e);var t=e.collect(function(e){return e.param.id}).join(",");i.changeFieldAttributeOrMeasure(t,"attribute")}},i.moveToMeasures=function(){if(selObjects.first()){var e=selObjects.clone();i.moveToMeasuresOrAttributes(e);var t=e.collect(function(e){return e.param.id}).join(",");i.changeFieldAttributeOrMeasure(t,"measures")}},i.selectFromAvailableFields=function(e,t){e||this.addSelectedObject(e,t,!1,!0);var i=this.isMultiSelect(e,designerBase.AVAILABLE_FIELDS_AREA);selectionCategory.area=designerBase.AVAILABLE_FIELDS_AREA;var n=this.isAlreadySelected(t);this.addSelectedObject(e,t,i,n),actionModel.setSelected(_.map(dynamicTree.trees[t.getTreeId()].selectedNodes,function(e){return e.param.extra}))},i.updateFieldsInUse=function(e){[].push.apply(localContext.state.fieldsInUse,e)},i.removeFromFieldsInUse=function(e){localContext.state.fieldsInUse&&(localContext.state.fieldsInUse=_.difference(localContext.state.fieldsInUse,e))},i.isInUse=function(e){var t=_.find(localContext.state.fieldsInUse,function(t){return t===e});return t||i.hasDependencyOnIt(e)},i.createCalculatedField=function(){adhocCalculatedFields.createField("DIMENSION")},i.createCalculatedMeasure=function(){adhocCalculatedFields.createField("MEASURE")},i.editCalculatedField=function(){adhocCalculatedFields.updateField()},i.deleteCalculatedField=function(){var e=designerBase.getSelectedObject(),i=new jaspersoft.components.ConfirmDialog;i.show({ok:adhocCalculatedFields.deleteField.bind(adhocCalculatedFields),messages:t.ADH_436_CALCULATED_FIELD_REMOVE_CONFIRM+" "+e.name.unescapeHTML()})},i.isPercentOfParentCalcSelected=function(e){return i.isAggregateSelected(e)},i.isAggregateSelected=function(e){if(e||(e=designerBase.getSelectedObject()),e){var t=i.getNameForSelected(e),n=i.findFieldByName(t);return n&&n.aggregateField}return!1},i.isPercentOfParentCalc=function(e){var t=i.findFieldByName(e);
return t&&t.aggregateField},i.hasDependencyOnIt=function(e){var t=i.findFieldByName(e);return t&&t.isUsed},i.updateAllFieldLabels=function(){if(isDesignView){var e=i,t=[e.dimensionsTree,e.measuresTree];_.each(t,function(t){_.each(e.getAllLeaves(null,t),function(t){var i=e.findFieldByName(t.param.id);i&&i.isCustomField&&(t.name=i.defaultDisplayName.replace(/\\'/g,"'").escapeHTML(),t.param.label=i.defaultDisplayName.replace(/\\'/g,"'").escapeHTML(),t.param.cssClass=e.isInUse(t.param.id)?"calculatedField dependency":"calculatedField",t.refreshStyle())}),t.renderTree()})}},i}),define("adhoc/designer.tree.actions",["require","adhoc/designer"],function(e){var t=e("adhoc/designer");return t.moveToMeasuresOrAttributes=function(e){if(e){var i=Object.isArray(e)?e:[e];e=i.first();var n=e.getTreeId(),o=t[n].getRootNode(),s=0==n.indexOf("dimension")?t.measuresTree:t.dimensionsTree;_.each(i,function(e){t.mergeToDestTree(t.copyParentStructure(e,s),s.getRootNode());for(var i=e;i!=o&&0==i.childs.length;){var n=i.parent;n.removeChild(i),i=n}}),s.resortTree(),s.renderTree(),s.openAndSelectNode(e.param.uri)}},t.addNodeToTree=function(e,t){var i=t.processNode(e);i.isloaded=!0,i.editable=!1,t.rootNode.addChild(i),i.refreshStyle()},t.removeNodeFromTree=function(e){if(!e.parent)throw"The parent node is undefined";var t=e.parent,i=e.param.extra.isMeasure;t.removeChild(e),0==t.childs.length&&!i&&t.parent&&t.parent.removeChild(t)},t.copyParentStructure=function(e,i){if(e&&i){for(var n=dynamicTree.trees[e.getTreeId()],o=i===t.measuresTree,s=localContext.metaNodeBuilder?localContext.metaNodeBuilder:t.metaNodeBuilder,r=i.processNode(s(e,o)),a=e.parent,l=null;a&&a!=n.getRootNode();)l=i.processNode(s(a,o)),l.addChild(r),r=l,a=a.parent;return r}},t.mergeToDestTree=function(e,i){if(i){var n=dynamicTree.trees[i.getTreeId()],o=n.findNodeChildByMetaName(i,e.param.id);null!=o?e.hasChilds()&&e.childs.each(function(e){t.mergeToDestTree(e,o)}):(t.markNodeAsLoaded(e),i.addChild(e))}},t.metaNodeBuilder=function(e,i){var n={id:e.param.id,label:e.name,type:e.param.type,uri:e.param.uri,order:e.orderNumber};if(e.param.extra){var o=Object.extend({},e.param.extra);n.extra=Object.extend(o,{id:e.param.id,isMeasure:i,dimensionId:i?t.MEASURES:e.param.id})}return n},t.markNodeAsLoaded=function(e){e.isloaded=!0,e.isParent()&&e.childs.each(function(e){t.markNodeAsLoaded(e)})},t.getAllLeaves=function(e,t){var i=arguments[2]||[];if(!e){if(!t)return i;if(e=t.getRootNode(),!e)return i}if(!e.hasChilds())return i.push(e),i;for(var n=0;n<e.childs.length;n++)this.getAllLeaves(e.childs[n],null,i);return i},t.getFirstLeaf=function(e){if(!e)return null;var t=e;if(!e.childs||0===e.childs.length)return t;for(var i=0;i<e.childs.length;i++)if(t=this.getFirstLeaf(e.childs[i]))return t},t.getNodeByEvent=function(e){return this.measuresTree.getTreeNodeByEvent(e)||this.dimensionsTree.getTreeNodeByEvent(e)},t}),define("adhoc/designer.report.actions",["require","adhoc/designer","jrs.configs"],function(e){var t=e("adhoc/designer"),i=e("jrs.configs");return t.goToTopicView=function(e){var t="flow.html?_flowId=adhocFlow&_mode="+e+"&launchType="+localContext.state.launchType+"&alreadyEditing=true";i.initAdditionalUIComponents||(t+="&decorate=no"),window.isEmbeddedDesigner&&(t+="&"+jQuery.param({embeddedDesigner:!0,embeddedName:window.embeddedName,saveAsUri:window.embeddedSaveAsUri,saveAsOverwrite:window.embeddedSaveAsOverwrite})),document.location.href=t},t.cancelAdHoc=function(){return exists(localContext.isDashboard)&&localContext.isDashboard?void gotoDefaultLocation():void(usingAdhocLauncher&&""!=usingAdhocLauncher?history.back():this.redirectToTopicPage())},t.cancelTopic=function(e){e?history.back():designerBase.redirectToHomePage()},t.enableCanUndoRedo=function(){exists(toolbarButtonModule)&&(toolbarButtonModule.setButtonState($("undo"),localContext.state.canUndo),toolbarButtonModule.setButtonState($("redo"),localContext.state.canRedo),toolbarButtonModule.setButtonState($("undoAll"),localContext.state.canUndo))},t.enableRunAndSave=function(e){exists(toolbarButtonModule)&&(toolbarButtonModule.setButtonState($("save"),e),toolbarButtonModule.setButtonState($("presentation"),e),toolbarButtonModule.setButtonState($("export"),e)),canRunAndSave=e},t.canSaveAdhocReport=function(){return localContext.canSaveReport()},t.toggleDisplayManager=function(){t.isDisplayManagerVisible()?(jQuery("#"+t.DISPLAY_MANAGER_ID).addClass(layoutModule.HIDDEN_CLASS),t.setDisplayManagerVisible(!1)):(jQuery("#"+t.DISPLAY_MANAGER_ID).removeClass(layoutModule.HIDDEN_CLASS),t.setDisplayManagerVisible(!0)),jQuery("#designer").trigger("layout_update"),t.setShowDisplayManager(t.isDisplayManagerVisible())},t.isDisplayManagerVisible=function(){return localContext.state.showDisplayManager},t.setDisplayManagerVisible=function(e){localContext.state.showDisplayManager=e},t.exportReport=function(e){var i=jQuery(t.EXPORT_FORM_PATTERN);i.attr("target","_blank"),i.find('input[name="exportFormat"]').val(e),i.submit()},t.enableXtabPivot=function(e){exists(toolbarButtonModule)&&toolbarButtonModule.setButtonState($("pivot"),e)},t.enableSort=function(e){exists(toolbarButtonModule)&&toolbarButtonModule.setButtonState($("sort"),e)},t}),define("adhoc/designer.ajax",["require","adhoc/designer"],function(e){var t=e("adhoc/designer");return t.ajaxActionPrefix={table:"co",crosstab:"cr",olap_crosstab:"cr",chart:"ch",ichart:"ich",olap_ichart:"ich"},t.getControllerPrefix=function(){return t.ajaxActionPrefix[localContext.getMode()]},t.loadState=function(){designerBase.sendRequest(t.getControllerPrefix()+"_loadState",[],function(e){localContext.setMode(e.viewType),adhocControls.initialize(e),t.render(e),t.filtersController.setFilters(e,{reset:!0})})},t.updateTrees=function(){isDesignView&&designerBase.sendRequest(t.getControllerPrefix()+"_updateAvailableTree",[],function(){t.dimensionsTree.showTree(t._AVAILABLE_TREE_DEPTH),t.measuresTree.showTree(t._AVAILABLE_TREE_DEPTH)})},t.undo=function(){localContext.state.modeOnUndo&&!localContext.state.modeOnUndo.blank()&&localContext.state.modeOnUndo!=localContext.getMode()?(localContext.hide&&localContext.hide(),t.switchMode(localContext.state.modeOnUndo,"undo")):designerBase.sendRequest("co_undo",[],t.undoAndRedoCallback)},t.undoAll=function(){localContext.state.undoModeNames.length>0&&localContext.state.undoModeNames[0]!==localContext.getMode()?(localContext.hide&&localContext.hide(),t.switchMode(localContext.state.undoModeNames[0],"undoAll")):designerBase.sendRequest("co_undoAll",[],t.undoAndRedoCallback)},t.redo=function(){localContext.state.modeOnRedo&&!localContext.state.modeOnRedo.blank()&&localContext.state.modeOnRedo!=localContext.getMode()?(localContext.hide&&localContext.hide(),t.switchMode(localContext.state.modeOnRedo,"redo")):designerBase.sendRequest("co_redo",[],t.undoAndRedoCallback)},t.switchMode=function(e,i){var n=["_mode="+e];i&&n.push("undoOrRedo="+i);var o=function(e){var n=e.viewType;i&&t.selectDisplayModeTab(n),t.initComponents(n),t.undoAndRedoCallback(e)};localContext.cleanupOnSwitch&&localContext.cleanupOnSwitch(),designerBase.sendRequest(t.getControllerPrefix()+"_switchMode",n,o)},t.selectDisplayModeTab=function(e){jQuery("#displayMode > li").each(function(){jQuery(this).attr("id").startsWith(e)?jQuery(this).addClass("selected"):jQuery(this).removeClass("selected")})},t.updateReportTitle=function(e){e=e.replace(/<\/?[^>]+(>|$)/g,"");var i=t.getControllerPrefix();e.blank()?designerBase.sendRequest(i+"_setTitle",["l=_null"]):designerBase.sendRequest(i+"_setTitle",["l="+encodeText(e)])},t.toggleTitleBar=function(){designerBase.sendRequest(t.getControllerPrefix()+"_toggleTitleBar",[])},t.setShowDisplayManager=function(e){var t=function(){};designerBase.sendRequest("co_toggleDisplayManager",new Array("name=showDisplayManager","value="+e),t,null)},t.toggleAdhocDataSetSize=function(e){var i=!1,n="datasize="+e;if(e.startsWith("full")&&1!=localContext.state.isShowingFullData?i=!0:e.startsWith("sample")&&1!=localContext.state.isShowingSampleData?i=!0:e.startsWith("nodata")&&1!=localContext.state.isShowingNoData&&(i=!0),i){var o=function(e){t.render(e),this.checkMaxRowsLimit()}.bind(t);designerBase.sendRequest("co_toggleAdhocDataSetSize",[n],o)}},t.tryToKeepServerAlive=function(){var e=function(e){localContext.standardOpCallback(e)};designerBase.sendRequest("co_tryToKeepServerAlive",[],e,null)},t.setProperty=function(e,t,i){designerBase.sendRequest("co_setProperty",["name="+e,"value="+t],i)},t.changeFieldAttributeOrMeasure=function(e,t){designerBase.sendRequest("co_changeFieldAttributeOrMeasure",["name="+encodeText(e),"type="+t])},t.setFilter=function(e){designerBase.sendRequest("co_setFilter",["testFilter="+e])},t.setSorting=function(e,i){localContext.state.sortFields=e;var n=Object.toJSON(e),o=function(e){t.render(e),i()};designerBase.sendRequest("ta_resort",["so="+n],o)},t.pivot=function(){localContext.pivot?localContext.pivot():designerBase.sendRequest(t.getControllerPrefix()+"_pivot",[])},t.undoAndRedoCallback=function(e){t.updateTrees(),t.render(e),t.filtersController.setFilters(e,{reset:!0})},t}),define("adhoc/designer.helpers",["require","adhoc/designer"],function(e){var t=e("adhoc/designer");return t.setDragStartState=function(e,i,n,o){var s=[Event.pointerX(o),Event.pointerY(o)],r=n.element,a=n.element=new Element("LI").update(r.innerHTML);a.classNames().set(r.classNames()),a.writeAttribute("fieldname",t.getFieldName()),a.setStyle({"z-index":r.getStyle("z-index")}),a.hide(),r.parentNode.appendChild(a),Element.clonePosition(a,r),Position.absolutize(a),r.remove(),dynamicTree.Tree.prototype.setDragStartState.apply(e,Array.prototype.slice.call(arguments,1)),n.draw(s),a.show()},t.deSelectAllPressedNavMuttons=function(){var e=$$("UL#navigationOptions li");e&&e.each(function(e){buttonManager.out($(e),function(e){return $(e).down(layoutModule.LIST_ITEM_WRAP_PATTERN)})})},t.hideAllDialogsAndMenus=function(){actionModel.hideMenu();var e=Object.values(this.dialogESCFunctions);e.each(function(e){var t=$(e);t&&dialogs.popup.hide(t)}.bind(this))},t.initPreventBrowserSelection=function(e){disableSelectionWithoutCursorStyle($(e))},t.initEnableBrowserSelection=function(e){enableSelection($(e))},t.isNoDataToDisplay=function(){return localContext.getMode()===designerBase.TABLE?jQuery("#nothingToDisplay").is(":visible"):void 0},t.checkMaxRowsLimit=function(){if(localContext.state.hitMaxRows&&!this.isNoDataToDisplay()){var e=rowLimitMessage.replace("{0}",localContext.state.maxDataRowsCount);dialogs.systemConfirm.show(e,5e3)}},t.isOnlyFieldsSelected=function(){var e=function(e){return e.hasChilds()};return null==this.getSelectedTreeNodes().detect(e)},t.showButtonMenuMouseOut=function(e){actionModel.hideMenu(),Event.stopObserving($(e),"mouseleave",t.showButtonMenuMouseOut)},t.isSelectedFieldCustom=function(){if(1==selObjects.length){var e=designerBase.getSelectedObject();if(e.model)return e.model.isCustomField;var i=t.findFieldByName(t.getNameForSelected(e));return i&&i.isCustomField}},t.isSelectFieldsAllowed=function(){return isDomainType},t.isDeleteAllowed=function(){if(1!=selObjects.length)return!1;var e=designerBase.getSelectedObject()?designerBase.getSelectedObject().param.id:null,i=t.findFieldByName(e);return null!=i&&i.isCustomField&&!i.isUsed&&!t.isInUse(e)},t.isUsedInRowsOrColumns=function(e){return _.find(localContext.state.fieldsInUse,function(t){return t===e})},t.canMoveToDimensions=function(){var e=selObjects.find(function(e){var i=t.findFieldByName(t.getNameForSelected(e));return i&&i.isCustomField&&i.aggregateField}),i=selObjects.find(function(e){return e.param.id===designerBase.SPACER_NAME||!e.param.extra.isMeasure||t.isUsedInRowsOrColumns(e.param.extra.id)});return!i&&!e},t.canMoveToMeasures=function(){var e=selObjects.find(function(e){return e.param.id===designerBase.SPACER_NAME||e.param.extra.isMeasure||t.isUsedInRowsOrColumns(e.param.extra.id)});return!e},t.getMessage=function(e,i){var n=t.messages[e];return n?new Template(n).evaluate(i?i:{}):""},t.registerTemplate=function(e,t){if(!e||!t)throw"Some of required params to register template are missing";return e[t]||(e[t]=_.template(jQuery("#"+t).html(),null,{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g})),e[t]},t.createTemplate=function(e){if(!e)throw"Some of required params to register template are missing";var t=_.templateSettings;_.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g};var i=_.template(jQuery("#"+e).html());return _.templateSettings=t,i},t.updateTrees=function(){isDesignView&&designerBase.sendRequest("co_updateAvailableTree",[],function(){t.dimensionsTree.showTree(t._AVAILABLE_TREE_DEPTH),t.measuresTree.showTree(t._AVAILABLE_TREE_DEPTH)})},t.hideOnePanel=function(){if(0===window.orientation){var e,t=document.getElementById("filters"),i=document.getElementById("fields"),n=jQuery("#filter-container").find("div.panel.pane.filter").filter(":visible").length,o=t.className.indexOf("minimized")>=0;o||(e=n?i:t,layoutModule.minimize(e))}},t.defaultFieldJSONBuilder=function(e){return{dimensionId:e.param.extra.dimensionId,name:e.param.extra.id}},t.getListOfSelectedFields=function(e){var i=t.getSelectedTreeNodes();if(this.isOlapMode())return e=Object.isFunction(e)?e:t.defaultFieldJSONBuilder,i.collect(function(t){if(t.isParent()){var i=t.childs.detect(function(e){return localContext.canAddFilter(e)});return i.collect(e)}return localContext.canAddFilter(t)?e(t):null}).compact().flatten();for(var n=[],o=0;o<i.length;o++){var s=i[o];if(s.isParent()){for(var r=s.childs,a=0;a<r.length;a++){var l=r[a].param.id;localContext.canAddFilter(r[a])&&n.push(l)}if(0===n.length)continue}else{if(!localContext.canAddFilter(s))continue;n.push(s.param.id)}}return _.map(n,function(e){return{name:e}})},t.generateAvailableSummaryCalculationsMenu=function(e,t,i){var n=_.chain(localContext.state.fieldAvailableSummaries[e]).filter(function(e){return"None"!==e}).sortBy().value();n.unshift("None"),t.children=_.map(n,function(e){return actionModel.createMenuElement("optionAction",_.extend({text:e,actionArgs:[e],isSelectedTestArgs:[e]},i))})},t}),define("adhoc/designer.init",["require","adhoc/designer","adhoc/layout.manager","underscore","underscore.string","dialog.definitions"],function(e){function t(e,t){var i=parseInt(layoutModule.getPanelWidth(e),10);i||layoutModule.storePanelWidth(e,t)}{var i=e("adhoc/designer"),n=e("adhoc/layout.manager"),o=e("underscore");e("underscore.string"),e("dialog.definitions")}return i.layoutManagerProperties={table:function(){return{axes:[{name:"column",elementId:"olap_columns"},{name:"group",elementId:"olap_rows"}],common:{mode:"table",id:i.DISPLAY_MANAGER_ID}}},crosstab:function(e){return{axes:[{name:"column",elementId:"olap_columns"},{name:"row",elementId:"olap_rows",isDependent:!!e}],common:{mode:"crosstab",id:i.DISPLAY_MANAGER_ID,measuresGroupId:"Measures",isOlapMode:!!e}}},olap_crosstab:function(){return i.layoutManagerProperties.crosstab(!0)},ichart:function(e){return{axes:[{name:"column",elementId:"olap_columns"},{name:"row",elementId:"olap_rows",isDependent:!!e}],common:{mode:"crosstab",id:i.DISPLAY_MANAGER_ID,measuresGroupId:"Measures",isOlapMode:!!e}}},olap_ichart:function(){return i.layoutManagerProperties.crosstab(!0)},chart:function(){return{axes:[{name:"measures",elementId:"olap_columns"},{name:"group",elementId:"olap_rows"}],common:{mode:"chart",id:i.DISPLAY_MANAGER_ID}}}},i.initTitle=function(){var e=window.isEmbeddedDesigner?embeddedName:saveLabel;o.isBlank(e)||i.ui.header_title.html(e)},i.initLayoutManager=function(e){var t=i.layoutManagerProperties[e]();i.ui.display_manager=new n(t.axes,t.common),i.observeDisplayManagerEvents()},i.initDialogs=function(){isDesignView&&adhocReentrance.initialize(),adhocSort.initialize(),i.initViewQueryDialog(),i.initSaveConfirmationDialog(),i.addConfirmDialog=new jaspersoft.components.ConfirmDialog({messages:[i.messages.ADH_1216_DIMENSION_HIERARCHY_ADD_WARNING_1,i.messages.ADH_1216_DIMENSION_HIERARCHY_ADD_WARNING_2]})},i.initSaveConfirmationDialog=function(){var e=jQuery("#standardConfirm").clone();e.attr("id",i.SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG.DIALOG_ID),e.find(".body").text(i.messages.ADH_1236_SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION),e.find(".button.action.up").attr("id",i.SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG.CANCEL_BUTTON_ID),e.find(".button.action.primary.up").attr("id",i.SAVE_WITHOUT_FILTERS_APPLY_CONFIRMATION_DIALOG.OK_BUTTON_ID),e.find(".button.action.primary.up .wrap").text(i.messages.ADH_1237_IGNORE),e.appendTo(jQuery("#frame .content:eq(0)"))},i.initViewQueryDialog=function(){i.viewQueryDialog=new JRS.ViewQueryDialog({id:"#queryViewer",content:"",selectionContainer:$("designer")})},i.initFieldsPanel=function(e){if(isDesignView){var t=i;e&&(Event.observe($("topicMutton"),"mouseover",function(e){actionModel.showDynamicMenu("topicMenu",e,null,null,localContext.state.actionmodel),$("menu").clonePosition($("topicMutton"),{setWidth:!1,setHeight:!1,offsetTop:5}),Event.stop(e),Event.observe($("menu"),"mouseleave",function(){this.showButtonMenuMouseOut($("menu"))}.bind(this))}.bind(i)),i.isOlapMode()||(Event.observe($("availableFieldsMutton"),"mouseover",function(e){actionModel.showDynamicMenu("availableFieldsMenu",e,null,null,localContext.state.actionmodel),$("menu").clonePosition($("availableFieldsMutton"),{setWidth:!1,setHeight:!1,offsetTop:5}),Event.stop(e),Event.observe($("menu"),"mouseleave",function(){this.showButtonMenuMouseOut($("menu"))}.bind(this))}.bind(i)),Event.observe($("availableMeasuresMutton"),"mouseover",function(e){actionModel.showDynamicMenu("availableMeasuresMenu",e,null,null,localContext.state.actionmodel),$("menu").clonePosition($("availableMeasuresMutton"),{setWidth:!1,setHeight:!1,offsetTop:5}),Event.stop(e),Event.observe($("menu"),"mouseleave",function(){this.showButtonMenuMouseOut($("menu"))}.bind(this))}.bind(i))));var n,o={dimensions:{name:"dimensionsTree",className:"dimension",domId:t.DIMENSIONS_TREE_DOM_ID,providerId:t.DIMENSIONS_TREE_PROVIDER_ID},measures:{name:"measuresTree",className:"measure",domId:t.MEASURES_TREE_DOM_ID,providerId:t.MEASURES_TREE_PROVIDER_ID}};for(n in o){var s=$(o[n].domId);if(s){var r=s.childElements();r.each(function(e){e.remove()})}t[o[n].name]=t.getAvailableFieldsTree(o[n].domId,o[n].providerId);var a=new JSCookie(t._cookieName).value;t._availableTreeLastOpened=a&&a.length>0?a:"/",t[o[n].name].DEFAULT_TREE_CLASS_NAME="responsive fields",t[o[n].name].multiSelectEnabled=!i.isOlapMode(),t[o[n].name].dragClasses=o[n].className,t[o[n].name].setDragStartState=function(e){return function(t,n,o){i.setDragStartState(e,t,n,o),selectionCategory.area=designerBase.AVAILABLE_FIELDS_AREA,localContext.canAddFilter&&localContext.canAddFilter(t)&&n.element.addClassName("supportsFilter")}}(t[o[n].name]),t[o[n].name].showTree(t._AVAILABLE_TREE_DEPTH),isIPad()&&(s=document.getElementById(o[n].domId),new TouchController(s,s.parentNode,{scrollbars:!0}))}t.observeTreeEvents(t.dimensionsTree,t.measuresTree),t.observeTreeEvents(t.measuresTree,t.dimensionsTree)}},i.FILTERS_PANEL_DEFAULT_WIDTH=300,i.FILTERS_PANEL_MIN_WIDTH=250,i.initPanelsState=function(){layoutModule.panelStateWasManuallyChanged("filters",clientKey)||"false"===layoutModule.getPanelMinimizedState("filters")&&jQuery("#filters").hasClass("minimized")&&layoutModule.storePanelMinimizedState("filters",!0),t("filters",i.FILTERS_PANEL_MIN_WIDTH);var e=i.CANVAS_PANEL_ID;$("fields")?layoutModule.resizeOnClient("fields",e,"filters"):layoutModule.resizeOnClient("filters",e),layoutModule.panelStateWasManuallyChanged("filters",clientKey)||"true"===layoutModule.getPanelMinimizedState("filters")&&parseInt(layoutModule.getPanelWidth("filters"),10)<i.FILTERS_PANEL_MIN_WIDTH&&layoutModule.storePanelWidth("filters",i.FILTERS_PANEL_DEFAULT_WIDTH)},i.initFiltersPanel=function(){var e=$("filters"),t=i.isOlapMode()?OlapFiltersController:FiltersController,n=new FilterService({clientKey:clientKey,mode:i.getMode});enableSelection(e),i.filtersController=new t({el:e,service:n,clientKey:clientKey,onApply:function(e){localContext.standardOpCallback(e)},onStateUpdate:function(e){localContext.state.update?localContext.state.update(e):localContext.update(e),isDesignView&&i.enableCanUndoRedo(),!i.isOlapMode()&&i.updateFieldsInUse(o.pluck(e.existingFilters,"name"))},onFilterRemove:function(e){i.removeFromFieldsInUse(o.pluck(e,"name"))},resetFilterPanelState:i.resetFilterPanelState}),document.observe("dragger:sizer",function(e){var t=e.memo.element;t==i.filtersController.sizerEl&&i.filtersController.onPanelResize()})},i.initDroppables=function(){var e={filters:{accept:["draggable","wrap"],hoverclass:"dropTarget",onDrop:function(){var e=[];if(i.canShowFilterOption(e)){var t=i.getListOfSelectedFields();i.filtersController.addFilter(t)}else dialogs.systemConfirm.show(e.join(" "),5e3)}},mainTableContainer:{accept:["measure","dimension"],hoverclass:"dropTarget",onDrop:function(){switch(localContext.getMode()){case"table":AdHocTable.addFieldAsColumn(!0);break;case"chart":AdHocChart.addFieldAsMeasure(!0)}if(localContext.getMode().indexOf("ichart")>=0){var e=[],t=i.getSelectedTreeNodes();jQuery.each(t,function(t,i){e.push(i.param)});var n=jQuery("#olap_columns").children().length;AIC.lmHandlersMap.addItems(e,n,"column")}}},canvasTableFrame:{accept:["draggable","wrap"],hoverclass:"dropTarget",onDrop:function(){"table"==localContext.getMode()&&AdHocTable.addFieldAsColumn(!0)}}};for(var t in e)Droppables.remove(t),document.getElementById(t)&&Droppables.add(t,e[t])},i.getAvailableFieldsTree=function(e,t){function n(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("ItemGroupType")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_folders:folders"}return n.prototype=deepClone(dynamicTree.TreeNode.prototype),n.addMethod("refreshStyle",function(e){if(e=e||this._getElement()){dynamicTree.TreeNode.prototype.refreshStyle.call(this,e);var t=i.findFieldByName(this.param.id);t&&t.isCustomField?e.addClassName("calculatedField"):e.removeClassName("calculatedField")}}),new dynamicTree.TreeSupport(e,{providerId:t,rootUri:"/",showRoot:!1,resetStatesOnShow:!1,nodeClass:n,templateDomId:"list_responsive_collapsible_folders",dragPattern:isIPad()?void 0:".draggable",treeErrorHandlerFn:doNothing,selectOnMousedown:!isIPad(),regionID:e?e:designerBase.AVAILABLE_FIELDS_AREA})},i}),define("adhoc/designer.observers",["require","adhoc/designer"],function(e){var t=e("adhoc/designer");return t.observePointerEvents=function(){document.observe(layoutModule.ELEMENT_CONTEXTMENU,t.contextMenuHandler),jQuery("#dataSizeSelector").change(function(){t.toggleAdhocDataSetSize(jQuery(this).val())}).val(),jQuery("#dataModeSelector").change(function(){var e=localContext.getMode(),i=jQuery(this).val();if(e!==i){if(!(e!==designerBase.CROSSTAB&&e!=designerBase.OLAP_CROSSTAB&&e!==designerBase.TABLE||i!==designerBase.ICHART&&i!==designerBase.OLAP_ICHART)){var n=e===designerBase.CROSSTAB||e==designerBase.OLAP_CROSSTAB?AdHocCrosstab.state:AdHocTable.state;if(!t.switchModeEventCheck(n))return t.updateModeLabelSelection(e),void dialogs.systemConfirm.show(t.getMessage("ADH_1214_ICHARTS_NO_SWITCHMODE_DELETED_SUMMARIES"),5e3)}localContext.hide&&localContext.hide(),t.switchMode(i,null)}}),Event.observe(document.body,isSupportsTouch()?"touchend":"click",function(e){var i=e.element();matchAny(i,["li.node","li.leaf","ul#"+t.MEASURES_TREE_DOM_ID,"ul#"+t.DIMENSIONS_TREE_DOM_ID],!0)||(this.unSelectAvailableTreeNodes(),isSupportsTouch()&&(localContext.clickid==i.identify()&&e.timeStamp-localContext.clicktime<700&&(e.isEmulatedRightClick=!0,document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:e,node:i})),localContext.clicktime=e.timeStamp,localContext.clickid=i.identify()));var n=matchAny(i,[this.CANVAS_PATTERN,layoutModule.MENU_LIST_PATTERN,this.COLUMN_OVERLAY_PATTERN,this.SUMMARY_OVERLAY_PATTERN,this.ROW_GROUP_OVERLAY_PATTERN,this.COLUMN_GROUP_OVERLAY_PATTERN,this.ROW_GROUP_OVERLAY_PATTERN,this.COLUMN_GROUP_OVERLAY_PATTERN,this.XTAB_MEASURE_HEADER_OVERLAY_PATTERN,this.XTAB_MEASURE_OVERLAY_PATTERN,this.XTAB_GROUP_HEADER_PATTERN,this.ROW_GROUP_MEMBER_PATTERN,this.COLUMN_GROUP_MEMBER_PATTERN,this.XTAB_GROUP_HEADER_OVERLAY_PATTERN,this.GROUP_OVERLAY_PATTERN,this.MENU_PATTERN,this.FILTER_OPERATOR_MENU_PATTERN,this.FILTER_ITEM_MENU_PATTERN,this.FILTER_GENERAL_MENU_PATTERN],!0);n||(localContext.getMode()===designerBase.CROSSTAB&&crossTabMultiSelect&&crossTabMultiSelect.deselectAllGroupMembers(),(localContext.getMode()===designerBase.TABLE||localContext.getMode()===designerBase.CROSSTAB||localContext.getMode()===designerBase.CHART)&&localContext.deselectAllSelectedOverlays()),!isRightClick(e)&&!e.isEmulatedRightClick&&!n&&actionModel.hideMenu()}.bind(t))},t.switchModeEventCheck=function(e){if(e.columnGroups&&e.columnGroups.length>0)for(var t=0;t<e.columnGroups.length;t++)if("NULL Dimension"!==e.columnGroups[t].dimensionName&&e.columnGroups[t].isShowingSummary===!1)return!1;if(e.rowGroups&&e.rowGroups.length>0)for(var t=0;t<e.rowGroups.length;t++)if("NULL Dimension"!==e.rowGroups[t].dimensionName&&e.rowGroups[t].isShowingSummary===!1)return!1;return!0},t.observeKeyEvents=function(){document.stopObserving("key:save").observe("key:save",function(e){actionModel.hideMenu(),localContext.canSaveReport()&&designerBase.handleSave(),Event.stop(e.memo.targetEvent)}.bind(this)),document.stopObserving("key:undo").observe("key:undo",function(e){actionModel.hideMenu(),localContext.state.canUndo&&!buttonManager.isDisabled($("undo"))&&this.undo(),Event.stop(e.memo.targetEvent)}.bind(this)),document.stopObserving("key:redo").observe("key:redo",function(e){actionModel.hideMenu(),localContext.state.canRedo&&!buttonManager.isDisabled($("redo"))&&this.redo(),Event.stop(e.memo.targetEvent)}.bind(this)),document.stopObserving("key:escape").observe("key:escape",function(){actionModel.hideMenu();var e=Object.values(this.dialogESCFunctions);e.each(function(e){var t=$(e);t&&dialogs.popup.hide(t)}.bind(this)),localContext.getMode()==designerBase.CHART&&localContext.currentlyDragging&&(Event.stopObserving(document.body,"mousemove"),localContext.resizeChart(),localContext.currentlyDragging=!1)}.bind(this))},t.observeCustomEvents=function(){jQuery("body").on({layout_update:function(e,t){var i=jQuery("#adhocCanvasContainer"),n=i.prev(),o=parseInt(i.css("margin-top"))||0,s=n.height()-100,r=s-o;i.css("top",r+"px"),t&&t.elem&&"filters"==t.elem.id&&localContext.getMode().indexOf("ichart")>=0&&("panel-maximize"==t.type?AIC.ui.controls.dataLevelSelector.dock():AIC.ui.controls.dataLevelSelector.undock()),localContext.getMode().indexOf("ichart")>=0&&AIC.chart&&AIC.redraw()},report_name_update:function(e,i){t.ui.header_title.html(i)}}),jQuery("body").on({"actionmodel-mouseout":function(){jQuery("#tableOptions").removeClass("over").css("z-index",9)}}),jQuery(window).resize(function(){var e=jQuery("#adhocCanvasContainer");if(e.length){var t=e.prev(),i=parseInt(e.css("margin-top"))||0,n=t.height()-100,o=n-i;e.css("top",o+"px")}})},t.observeTableContainerEvents=function(){$("mainTableContainer").observe(isSupportsTouch()?"touchstart":"mousedown",function(e){localContext.mouseDownHandler(e)}),$("mainTableContainer").observe(isSupportsTouch()?"touchend":"mouseup",function(e){localContext.mouseUpHandler(e),t.adhocTitleEdit.call(this,e)}.bind(this)),$("mainTableContainer").observe("mouseover",function(e){localContext.mouseOverHandler(e)}),$("mainTableContainer").observe("mouseout",function(e){localContext.mouseOutHandler(e)}),$("mainTableContainer").observe("click",function(e){localContext.mouseClickHandler(e)}),Event.observe($("mainTableContainer"),isSupportsTouch()?"touchmove":"scroll",function(){localContext.getMode()===designerBase.TABLE&&localContext.tableScrolled(),actionModel.hideMenu()})},t.observeTreeEvents=function(e,i){e.observe("leaf:dblclick",function(t){if(this.isCrosstabMode){var i=localContext.getMode()==designerBase.ICHART||localContext.getMode()==designerBase.OLAP_ICHART?AdhocIntelligentChart:AdHocCrosstab;"dimension"==e.dragClasses?i.canAddLevelAsRowGroup()?i.appendDimensionToRowAxisWithLevel():i.canAddLevelAsColumnGroup()&&i.appendDimensionToColumnAxisWithLevel():i.canAddLevelAsColumnGroup()?i.appendMeasureToColumn():i.canAddLevelAsRowGroup()&&i.appendMeasureToRow()}else{var n=t.memo.targetEvent;this.addFieldToCanvas(n)}}.bind(this)),e.observe("leaf:selected",function(e){var t=e.memo.node,n=e.memo.targetEvent;i._deselectAllNodes(),this.selectFromAvailableFields(n,t)}.bind(this)),e.observe("node:selected",function(e){var t=e.memo.node,n=e.memo.targetEvent;i._deselectAllNodes(),this.selectFromAvailableFields(n,t)}.bind(this)),e.observe("leaf:unselected",function(e){var t=e.memo.node;this.isCrosstabMode&&this.removeSelectedObject(t),this.selectFromAvailableFields(e.memo.targetEvent,t)}.bind(this)),e.observe("node:unselected",function(e){var t=e.memo.node;this.isCrosstabMode&&this.removeSelectedObject(t),this.selectFromAvailableFields(e.memo.targetEvent,t)}.bind(this)),e.observe("items:unselected",function(){designerBase.unSelectAll()}.bind(this)),e.observe("node:dblclick",function(e){this._availableTreeLastOpened=e.memo.node.param.uri,new JSCookie(this._cookieName,this._availableTreeLastOpened,this._cookieTime)}.bind(this)),e.observe("node:click",function(e){this._availableTreeLastOpened=e.memo.node.param.uri,new JSCookie(this._cookieName,this._availableTreeLastOpened,this._cookieTime)}.bind(this)),e.observe("tree:loaded",function(){e.openAndSelectNode(this._availableTreeLastOpened,function(){this.updateAllFieldLabels()}.bind(this))}.bind(this)),e.observe("node:mouseup",function(e){localContext.treeMenuHandler(e)}),e.observe("leaf:mouseup",function(e){localContext.treeMenuHandler(e)}),e.observe("key:contextMenu",function(e){var i=e.memo.node,n=getBoxOffsets(i,!0);t.showDynamicMenu(e,designerBase.FIELD_MENU_LEVEL,{menuLeft:n[0]+100,menuTop:n[1]+20}),Event.stop(e)})},t.observeDisplayManagerEvents=function(){var e=jQuery("#"+t.DISPLAY_MANAGER_ID);e.unbind("lm:addItem"),e.unbind("lm:addItems"),e.unbind("lm:removeItem"),e.unbind("lm:moveItem"),e.unbind("lm:measureReorder"),e.unbind("lm:switchItem"),e.unbind("lm:contextMenu"),e.bind("lm:addItem",function(e,t){t=_.extend({index:-1,levelIndex:-1},t),localContext.lmHandlersMap[t.axis].addItem(t.dimensionId,t.index,t.level,t.levelIndex,t.isMeasure,t.uri,t.hierarchyName)}),e.bind("lm:removeItem",function(e,t){localContext.lmHandlersMap[t.axis].removeItem(t.item,t.index)}),e.bind("lm:addItems",function(e,t){localContext.lmHandlersMap.addItems(t.levels,t.index,t.axis)}),e.bind("lm:moveItem",function(e,t){localContext.lmHandlersMap[t.axis].moveItem(t.item,t.from,t.to)}),e.bind("lm:switchItem",function(e,t){localContext.lmHandlersMap[t.axis].switchItem(t.item,t.from,t.to)}),e.bind("lm:measureReorder",function(e,t){localContext.lmHandlersMap.measureReorder(t.measure,t.to)}),e.bind("lm:contextMenu",function(e,t){localContext.lmHandlersMap[t.extra.axis].contextMenu(e,t)})},t.observeCrossDocumentMessages=function(){window.addEventListener?(removeEventListener("message",t.crossDocumentListener),addEventListener("message",t.crossDocumentListener,!1)):(detachEvent("onmessage",t.crossDocumentListener),attachEvent("onmessage",t.crossDocumentListener))},t.observeCloseDesignerEvent=function(){jQuery("#closeDesigenr").on("mouseup",t.handleCancel)},window.addEventListener&&window.addEventListener("orientationchange",function(){t.hideOnePanel()}),t}),define("adhoc/designer.selection",["require","adhoc/designer"],function(e){var t=e("adhoc/designer");return t.addSelectedObject=function(e,t,i,n){i?n?this.removeSelectedObject(t):designerBase.addToSelected(t):(designerBase.unSelectAll(),designerBase.addToSelected(t))},t.selectSingleObject=function(e){designerBase.unSelectAll(),designerBase.addToSelected(e)},t.deselectSelectedObject=function(e){this.removeSelectedObject(e)},t.removeSelectedObject=function(e){designerBase.unSelectGiven(e)
},t.unSelectAvailableTreeNodes=function(){this.measuresTree&&this.measuresTree._deselectAllNodes(),this.dimensionsTree&&this.dimensionsTree._deselectAllNodes()},t.getNameForSelectedTreeNode=function(){var e=designerBase.getSelectedObject();return e?e.param.id:""},t.getSelectedTreeNodes=function(){return t.dimensionsTree.selectedNodes.length>0?t.dimensionsTree.selectedNodes:t.measuresTree.selectedNodes},t.isSelectedNode=function(e){if(!e||!e.getTreeId)return null;var t=dynamicTree.trees[e.getTreeId()];return t.isNodeSelected(e)},t.isSelectedTreeNodeAFolder=function(){var e=designerBase.getSelectedObject();return e?e.hasChilds():!0},t.isAlreadySelected=function(e){return designerBase.isInSelection(e)},t.isMultiSelect=function(e,t){var i=isMetaHeld(e),n=isShiftHeld(e),o=selectionCategory.area==t;return selectionCategory.area==designerBase.AVAILABLE_FIELDS_AREA?o&&(i||n):o&&i},t.hasSpacerInSelection=function(){for(var e=0;e<selObjects.length;e++)if(t.getNameForSelected(selObjects[e])===designerBase.SPACER_NAME)return!0;return!1},t.isSpacerSelected=function(e){return e=e||selObjects[0],t.getNameForSelected(e)===designerBase.SPACER_NAME},t.isConstantSelected=function(e){return t.getNameForSelected(e).startsWith(e?constantFieldsLevel+".":constantFieldsLevel+".")},t.isMeasureSelected=function(e){return e&&e.menuLevel?e.menuLevel.startsWith(this.OLAP_MEASURES_TREE):!1},t.isUsedAsGroup=function(e){var t=localContext.state.groups;if(null!=t)for(var i=0;i<t.length;i++)if(t[i].name==e)return!0;return!1},t.hasGroupInSelection=function(){for(var e=0;e<selObjects.length;e++)if(t.isUsedAsGroup(t.getNameForSelected(selObjects[e])))return!0;return!1},t}),define("common/enum/httpStatusCodes",{100:"continue",101:"switchingProtocols",200:"ok",201:"created",202:"accepted",203:"nonAuthoritativeInformation",204:"noContent",205:"resetContent",206:"partialContent",300:"multipleChoices",301:"movedPermanently",302:"found",303:"seeOther",304:"notModified",305:"useProxy",307:"temporaryRedirect",400:"badRequest",401:"unauthorized",402:"paymentRequired",403:"forbidden",404:"notFound",405:"methodNotAllowed",406:"notAcceptable",407:"proxyAuthenticationRequired",408:"requestTimeout",409:"conflict",410:"gone",411:"lengthRequired",412:"preconditionFailed",413:"requestEntityTooLarge",414:"requestUriTooLong",415:"unsupportedMediaType",416:"requestedRangeNotSatisfiable",417:"expectationFailed",500:"internalServerError",501:"notImplemented",502:"badGateway",503:"serviceUnavailable",504:"gatewayTimeout",505:"httpVersionNotSupported"}),define("common/enum/errorCodes",["require"],function(){return{UNEXPECTED_ERROR:"unexpected.error",INVALID_RESOURCE_TYPE:"invalid.resource.type"}}),define("common/model/BaseModel",["require","underscore","backbone","common/enum/httpStatusCodes","common/enum/errorCodes","json3"],function(e){var t=e("underscore"),i=e("backbone"),n=e("common/enum/httpStatusCodes"),o=e("common/enum/errorCodes"),s=e("json3"),r=i.Model.extend({initialize:function(){this.on("error",r.unifyServerErrors)},serialize:function(){return t.clone(this.attributes)}},{unifyServerErrors:function(e,t){var i=n[t.status],o=r.createServerError(t);e.trigger("error:"+i,e,o,t),e.trigger("error:all",e,o,t)},createServerError:function(e){var t;try{t=s.parse(e.responseText)}catch(i){t={message:"Can't parse server response",errorCode:o.UNEXPECTED_ERROR,parameters:[]}}return t}});return r}),define("common/util/i18nMessage",["require","common/util/classUtil"],function(e){var t=e("common/util/classUtil"),i=t.extend({constructor:function(e){this.code=e,this.args=Array.prototype.slice.call(arguments,1)},bundle:{}});return i.prototype.toString=function(){var e=this.bundle[this.code];if(!e)return this.code;for(var t=0,i=this.args.length;i>t;t++)e=e.replace("{"+t+"}",this.args[t]);return e},i}),define("common/validation/ValidationErrorMessage",["require","common/util/i18nMessage","bundle!ValidationBundle"],function(e){var t=e("common/util/i18nMessage");return t.extend({bundle:e("bundle!ValidationBundle")})}),define("common/enum/repositoryResourceTypes",{RESOURCE_LOOKUP:"resourceLookup",DASHBOARD:"dashboard",LEGACY_DASHBOARD:"legacyDashboard",REPORT_UNIT:"reportUnit",TOPIC:"topic",ADHOC_DATA_VIEW:"adhocDataView",FILE:"file",FOLDER:"folder",DATA_TYPE:"dataType",JDBC_DATA_SOURCE:"jdbcDataSource",AWS_DATA_SOURCE:"awsDataSource",JNDI_DATA_SOURCE:"jndiJdbcDataSource",VIRTUAL_DATA_SOURCE:"virtualDataSource",CUSTOM_DATA_SOURCE:"customDataSource",BEAN_DATA_SOURCE:"beanDataSource",XMLA_CONNECTION:"xmlaConnection",LIST_OF_VALUES:"listOfValues",REPORT_OPTIONS:"reportOptions",QUERY:"query",OLAP_UNIT:"olapUnit",DOMAIN_TOPIC:"domainTopic",SEMANTIC_LAYER_DATA_SOURCE:"semanticLayerDataSource",SECURE_MONDRIAN_CONNECTION:"secureMondrianConnection",MONDRIAN_XMLA_DEFINITION:"mondrianXmlaDefinition",MONDRIAN_CONNECTION:"mondrianConnection",INPUT_CONTROL:"inputControl"}),define("common/model/RepositoryResourceModel",["require","underscore","common/model/BaseModel","backbone.validation","common/validation/ValidationErrorMessage","common/enum/httpStatusCodes","common/transport/request","settings!globalConfiguration","common/enum/repositoryResourceTypes"],function(e){function t(e,t,i,n,o){return r({type:t,dataType:"json",url:e.contextPath+"/rest_v2/resources"+i+"?overwrite="+n+"&createFolders="+o,headers:{Accept:"application/json","Content-Location":e.get("uri")}}).done(function(t){e.set("uri",t.uri)})}var i=e("underscore"),n=e("common/model/BaseModel"),o=e("backbone.validation"),s=e("common/validation/ValidationErrorMessage"),r=(e("common/enum/httpStatusCodes"),e("common/transport/request")),a=e("settings!globalConfiguration"),l=(e("common/enum/repositoryResourceTypes"),100),c=100,d=250,u=/application\/repository\.([^\+]+)\+json/,h="<>",p="<>",m=a.resourceIdNotSupportedSymbols.slice(1,a.resourceIdNotSupportedSymbols.length-1),f=n.extend({idAttribute:"uri",type:void 0,urlRoot:function(){return(this.contextPath?this.contextPath+"/":"")+"rest_v2/resources"},defaults:{name:void 0,parentFolderUri:void 0,uri:void 0,label:void 0,description:void 0,permissionMask:void 0,creationDate:void 0,updateDate:void 0,version:void 0},validation:{name:[{required:!1},{maxLength:c,msg:new s("error.field.max.length","name",c)},{doesNotContainSymbols:m,msg:new s("error.field.bad.symbols","name",m)}],label:[{required:!0,msg:new s("error.field.required","label")},{maxLength:l,msg:new s("error.field.max.length","label",l)},{doesNotContainSymbols:h,msg:new s("error.field.bad.symbols","label",h)}],description:[{required:!1},{maxLength:d,msg:new s("error.field.max.length","description",d)},{doesNotContainSymbols:p,msg:new s("error.field.bad.symbols","description",p)}],parentFolderUri:[{required:!0,msg:new s("error.field.required","parentFolderUri")}]},url:function(){return this.isNew()?this.urlRoot()+this.get("parentFolderUri"):this.urlRoot()+this.id},constructor:function(e,t){t||(t={}),i.defaults(t,{parse:!0}),n.call(this,e,t)},initialize:function(e,t){this.contextPath=t.contextPath,t.type&&(this.type=t.type),this.on("change:parentFolderUri change:name",this._updateUri),this.on("change:uri",this._updateNameAndParentFolderUri),n.prototype.initialize.apply(this,arguments)},clone:function(){return new this.constructor(this.attributes,{contextPath:this.contextPath})},parse:function(e){return"undefined"!=typeof e.uri?(e.name=f.getNameFromUri(e.uri),e.parentFolderUri=f.getParentFolderFromUri(e.uri)):e.parentFolderUri&&e.name&&(e.uri=f.constructUri(e.parentFolderUri,e.name)),e},toJSON:function(){var e=this.serialize();return delete e.name,delete e.parentFolderUri,e},_updateUri:function(){var e=this.get("name"),t=this.get("parentFolderUri"),i=f.constructUri(t,e);i&&this.set("uri",i)},_updateNameAndParentFolderUri:function(){var e=this.get("uri"),t=f.getNameFromUri(e),i=f.getParentFolderFromUri(e);this.set({name:t,parentFolderUri:i})},fetch:function(e){return i.defaults(e||(e={}),{headers:{Accept:"application/json"}}),e.url=this.url()+"?expanded="+(e.expanded===!0),delete e.expanded,n.prototype.fetch.call(this,e)},sync:function(e,t,i){if("read"===e){var o=i.success,s=this;i.success=function(e,t,i){var n=i.getResponseHeader("Content-Type"),r=u.exec(n);if(!r||!r[1])throw new Error("Unsupported response content type: "+n);s.type=r[1],o&&o(e,t,i)}}return n.prototype.sync.call(this,e,t,i)},save:function(e,t,o){var s;if(i.isUndefined(e)||i.isNull(e)||i.isObject(e)?(s=e||{},o=t):(s={})[e]=t,!this.type)throw new Error("Resource type is unspecified. It's not possible to save a resource without it's type specified");return i.defaults(o||(o={}),{headers:{Accept:"application/json","Content-Type":"application/repository."+this.type+"+json; charset=UTF-8"}}),o.url=this.url()+"?createFolders="+(o.createFolders===!0),o.url+="&overwrite="+(o.overwrite===!0),o.url+="&expanded="+(o.expanded===!0),delete o.createFolders,delete o.overwrite,delete o.expanded,n.prototype.save.call(this,s,o)},isWritable:function(){var e=this.get("permissionMask"),t=!1;return i.isUndefined(e)||(t=1===e||4&e),t},copyTo:function(e,i,n){return t(this,"POST",e,!!i,arguments.length<3||n)},moveTo:function(e,i,n){return t(this,"PUT",e,!!i,arguments.length<3||n)}},{LABEL_MAX_LENGTH:l,NAME_MAX_LENGTH:c,DESCRIPTION_MAX_LENGTH:d,LABEL_NOT_SUPPORTED_SYMBOLS:h,DESCRIPTION_NOT_SUPPORTED_SYMBOLS:p,NAME_NOT_SUPPORTED_SYMBOLS:m,getNameFromUri:function(e){if(!e)return void 0;var t=e.split("/");return t[t.length-1]},getParentFolderFromUri:function(e){if(!e)return void 0;var t=e.split("/");return 2===t.length&&""!==t[1]?"/":t.slice(0,t.length-1).join("/")},constructUri:function(e,t){return t&&e?-1!==e.indexOf("/",e.length-1)?e+t:e+"/"+t:void 0},generateResourceName:function(e){var t="";return e&&(t=e.replace(new RegExp("["+f.NAME_NOT_SUPPORTED_SYMBOLS+"]","g"),"_")),t}});return i.extend(f.prototype,o.mixin),f}),define("common/util/identityUtil",["require","underscore"],function(e){var t=e("underscore");return{generateUniqueName:function(e){return e+(new Date).getTime()+"_"+String.fromCharCode.apply(null,t.times(4,t.partial(t.random,97,122)))}}}),define("adhoc/designer.obsolete",["require","adhoc/designer","jquery","underscore","common/model/RepositoryResourceModel","common/util/identityUtil","common/enum/repositoryResourceTypes"],function(e){var t=e("adhoc/designer"),i=e("jquery"),n=e("underscore"),o=e("common/model/RepositoryResourceModel"),s=e("common/util/identityUtil"),r=e("common/enum/repositoryResourceTypes");return t.handleBack=function(){var e=t.buildSaveRequestData();t.filtersController.hasNotAppliedFilters()?t.showSaveConfirmationDialog(function(){i(document).trigger("adhocDesigner:save",t.buildResourceMetadata(e))}):i(document).trigger("adhocDesigner:save",t.buildResourceMetadata(e))},t.handleCancel=function(){i(document).trigger("adhocDesigner:cancel")},t.buildSaveRequestData=function(){var e=!!saveUri,t=e?saveFolder:"/temp",i=e?saveLabel:s.generateUniqueName("tmpAdv_"),n=e?saveDesc:"Dashboard visualization.",r=e;return window.embeddedSaveAsUri&&(t=o.getParentFolderFromUri(embeddedSaveAsUri),i=o.getNameFromUri(embeddedSaveAsUri)),window.embeddedSaveAsOverwrite&&(r=embeddedSaveAsOverwrite),window.embeddedSaveAsUri&&(t=o.getParentFolderFromUri(embeddedSaveAsUri),i=o.getNameFromUri(embeddedSaveAsUri)),window.embeddedSaveAsOverwrite&&(r=embeddedSaveAsOverwrite),{aruLabel:i,aruFolder:t,aruDesc:n,allOverwrite:r}},t.buildResourceMetadata=function(e){var t=!!saveUri,i={uri:[e.aruFolder,e.aruLabel].join("/"),resourceType:r.ADHOC_DATA_VIEW,type:localContext.mode,label:e.aruLabel,version:1};return t||(i.dataSourceUri=reportUnitURI),i},t.saveEmbedded=function(){var e=t.buildSaveRequestData();designerBase.sendRequest(designerBase.getControllerPrefix()+"_save",e,function(o){var s=n.clone(e);s.viewType=o.viewType,i(document).trigger("adhocDesigner:saved",t.buildResourceMetadata(s))})},t.crossDocumentListener=function(e){"adhocDesigner:save"==e.data&&t.saveEmbedded()},t.saveAndRun=function(){windowPopUp=window.open("","jr"),buttonManager.disable(i("execute"));var e=function(e){t.render(e),windowPopUp.location="flow.html?_flowId=viewAdhocReportFlow&clientKey="+clientKey+"&reportUnit="+localContext.state.tempAruName+"&noReturn=true"};designerBase.sendRequest("co_saveTemp",[],e)},t.applyAdhocTheme=function(e,t){var n=null,o=e.element(),s=null;if(t){var r=t.childElements();n=matchAny(o,["li.button"],!0),n&&(s=n.identify(),r.each(function(e){buttonManager.unSelect(e)}),buttonManager.select(n)),s!==selectedThemeId&&(selectedThemeId=s,i(this.CANVAS_PARENT_ID)&&selectedThemeId&&(i(this.CANVAS_PARENT_ID).writeAttribute("class",s),this.toggleAdhocTheme()))}},t.orientationSelected=function(e){t.setPageOrientation(e),designerBase.unSelectAll()},t.getOrientation=function(){return localContext.state.pageOrientation},t.orientationEquals=function(e){return t.getOrientation()==e},t.getPaperSize=function(){return localContext.state.paperSize},t.paperSizeEquals=function(e){return t.getPaperSize()==e},t.paperSizeSelected=function(e,i){t.setPaperSize(e),designerBase.unSelectAll(i)},t.goToDesignView=function(){var e=document.location.href.parseQuery();delete e._flowId,delete e.viewReport,delete e.fromDesigner,primaryNavModule.setNewLocation("designer",Object.toQueryString(e))},t.goToPresentationView=function(){var e=document.location.href.parseQuery();delete e._flowId,e.viewReport=!0,e.fromDesigner=!0,primaryNavModule.setNewLocation("designer",Object.toQueryString(e))},t.getAllAvailableFolders=function(e){var t=new Array;if(!e){if(!this.availableTree)return t;e=this.availableTree.rootNode,t.push(e)}if(e.param.type===this.FOLDER_TYPE)for(var i=0;i<e.childs.length;i++){var n=e.childs[i];n.param.type===this.FOLDER_TYPE&&(t.push(n),t=t.concat(this.getAllAvailableFolders(n)))}return t},t.togglePagePropsRoller=function(){selectionObject.pagePropsRollDown=!selectionObject.pagePropsRollDown},t.setFieldValuesOnColumnSelection=function(){},t.setFieldValuesOnGroupSelection=function(){},t.selectReport=function(){designerBase.unSelectAll(),this.activateReportSelectionObject()},t.activateReportSelectionObject=function(){this.selectSingleObject(titleBar),selectionCategory.area=designerBase.TITLE_SELECT_AREA},t.isSingleFieldSelected=function(){return 1==designerBase.getSelectedObject().length},t.isInColumns=function(e){for(var t=0;t<localContext.state.columns.length;t++)if(e==localContext.state.columns[t])return!0;return!1},t.setPageOrientation=function(e){designerBase.sendRequest("co_setPageOrientation",["o="+e])},t.setPaperSize=function(e){designerBase.sendRequest("co_setPaperSize",["s="+e])},t}),define("adhoc/designer.contextmenu",["require","adhoc/designer","adhoc/designer.label.actions","adhoc/designer.field.actions","adhoc/designer.tree.actions","adhoc/designer.report.actions","adhoc/designer.ajax","adhoc/designer.helpers","adhoc/designer.init","adhoc/designer.observers","adhoc/designer.selection","adhoc/designer.obsolete"],function(e){{var t=e("adhoc/designer");e("adhoc/designer.label.actions"),e("adhoc/designer.field.actions"),e("adhoc/designer.tree.actions"),e("adhoc/designer.report.actions"),e("adhoc/designer.ajax"),e("adhoc/designer.helpers"),e("adhoc/designer.init"),e("adhoc/designer.observers"),e("adhoc/designer.selection"),e("adhoc/designer.obsolete")}return t.showDynamicMenu=function(e,t,i,n){var o=selObjects.length;if(o>0){var s=selObjects[o-1];s&&s.menuLevel&&(s.menuLevel=t)}actionModel.showDynamicMenu(t,e,null,i,localContext.state.actionmodel,n)},t.contextMenuHandler=function(e){var t=(e.memo.node,e.memo.targetEvent);localContext.contextMenuHandler&&localContext.contextMenuHandler(t)},t}),define("adhoc/adhoc.main",["require","!domReady","jrs.configs","report.view.base","controls.base","domain.chooser.fields","components.customTooltip","components.dependent.dialog","components.pickers","core.key.events","builder","dragdrop","tools.drag","dialog.definitions","adhoc/designer.contextmenu","adhoc/table.init","adhoc/chart.observers"],function(e){var t=e("!domReady"),i=e("jrs.configs"),n=e("report.view.base"),o=e("controls.base");e("domain.chooser.fields"),e("components.customTooltip"),e("components.dependent.dialog"),e("components.pickers"),e("core.key.events"),e("builder"),e("dragdrop"),e("tools.drag"),e("dialog.definitions");var s=e("adhoc/designer.contextmenu"),r=e("adhoc/table.init"),a=e("adhoc/chart.observers");t(function(){_.extend(o,i.inputControlsConstants),_.extend(s,i.adhocDesigner),_.extend(s,i.adhoc.adhocDesigner),s.messages=s.messages||{},_.extend(s.messages,i.adhoc.adhocDesignerMessages),_.extend(a,i.adhoc.AdHocChart),_.extend(r,i.adhoc.AdHocTable),n.reportUnitURI=i.Report.reportUnitURI,s.run(i.adhoc.adhocDesignerViewModelViewType)})}),define("adhoc/adhoc.page",["require","commons.main","adhoc/adhoc.main"],function(e){e("commons.main"),e("adhoc/adhoc.main")});