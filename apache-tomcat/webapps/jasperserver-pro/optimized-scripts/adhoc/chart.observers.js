AdHocChart.mouseDownHandler=function(e){var a=e.element(),t=null;if(isIPad()&&(t=matchAny(a,["div#chartBorder"],!0),t&&$("dragger").removeClassName("hidden"),e.preventDefault()),"dragger"==a.identify()&&(this.containerMovePosition={x:e.pointerX(),y:e.pointerY()},Event.observe(document.body,isSupportsTouch()?"touchmove":"mousemove",this.draggerListener)),t=matchAny(a,[adhocDesigner.LEGEND_OVERLAY_PATTERN],!0),t&&!isRightClick(e)){var d=null;if(t.hasClassName("legend")){var r=t.readAttribute("data-legendName");"data-legendName"!==r&&(d={id:t.identify(),legendName:r,index:t.readAttribute("data-index"),defaultName:t.readAttribute("data-defaultName"),userName:t.readAttribute("data-userName")},selectionCategory.area=designerBase.LEGEND_MENU_LEVEL,localContext.draggableLegend&&localContext.draggableLegend.destroy(),designerBase.unSelectAll(),AdHocChart.deselectAllSelectedOverlays(),designerBase.addToSelected(d),buttonManager.select(t))}isIPad()&&$("dragger").addClassName("hidden")}isIPad()&&e.preventDefault()},AdHocChart.mouseUpHandler=function(e){var a=e.element(),t=null,d=null;if(this.currentlyDragging)Event.stopObserving(document.body,isSupportsTouch()?"touchmove":"mousemove",this.draggerListener),this.resizeChart(),this.currentlyDragging=!1;else{var r=$("dragger");isIPad()&&r&&!matchAny(a,["div#chartBorder"],!0)&&r.addClassName("hidden")}t=matchAny(a,[adhocDesigner.LEGEND_OVERLAY_PATTERN],!0),t?(Draggables.dragging==designerBase.AVAILABLE_FIELDS_AREA?(d=t.readAttribute("data-index"),AdHocChart.hoverLegendIndex=parseInt(d)):(AdHocChart.deselectAllSelectedOverlays(),$(t).addClassName("selected")),isIPad()&&(it.clickid==a.identify()&&e.timeStamp-it.clicktime<700&&document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:e,node:a}),it.clicktime=e.timeStamp,it.clickid=a.identify())):isIPad()&&AdHocChart.deselectAllSelectedOverlays()},AdHocChart.mouseOverHandler=function(e){var a=e.element(),t=null;if(t=matchAny(a,["div#chartBorder"],!0)){var d=$("dragger");d.removeClassName("hidden")}if(t=matchAny(a,[AdHocChart.CHART_DRAGGER_PATTERN,adhocDesigner.LEGEND_OVERLAY_PATTERN],!0),t&&(AdHocChart.draggableChart&&AdHocChart.draggableChart.destroy(),t.match(adhocDesigner.LEGEND_OVERLAY_PATTERN))){var r=$(t).readAttribute("data-index");localContext.currentlyDraggingLegend&&(localContext.currentLegendIndex=r),localContext.state.inDesignView&&(localContext.draggableLegend=new Draggable(t.identify(),{ghosting:!0,onStart:function(e){Draggables.dragging=designerBase.CHART_LEGEND_AREA,localContext.currentlyDraggingLegend=!0,localContext.currentLegendIndex=$(e.element).readAttribute("data-index"),$(e.element).update($(e.element).readAttribute("data-defaultname")),$(e.element).setStyle({color:"#000","white-space":"nowrap"}),AdHocChart.draggableChart&&AdHocChart.draggableChart.destroy()},onEnd:function(e){var a=null;a=$(e.element).readAttribute("data-index"),$(e.element).update(),localContext.currentlyDraggingLegend=!1,localContext.dragginInLegendArea?isNaN(a)||isNaN(localContext.currentLegendIndex)||null==a||null==localContext.currentLegendIndex||AdHocChart.moveMeasure(a,localContext.currentLegendIndex):AdHocChart.removeMeasure(a),localContext.currentLegendIndex=null,localContext.dragginInLegendArea=!1},onDrag:function(e,a){var t=Event.pointer(a);if(AdHocChart.isInLegendArea(t.x,t.y)){localContext.dragginInLegendArea=!0;var d=$$("#chartBorder .overlay");d.each(function(a){if(a!==e.element){var d=Element.cumulativeOffset(a)[0],r=+a.style.width.replace("px","")+d;d<=t.x&&t.x<=r?(localContext.currentLegendIndex=a.readAttribute("data-index"),buttonManager.over(a)):buttonManager.out(a)}}),$(e.element).removeClassName("outside")}else localContext.dragginInLegendArea=!1,$(e.element).addClassName("outside")}}))}},AdHocChart.mouseOutHandler=function(e){var a=e.element(),t=null;if(t=matchAny(a,["div#chartBorder"],!0)){var d=$("dragger");d.addClassName("hidden")}AdHocChart.draggableChart&&AdHocChart.draggableChart.destroy()},AdHocChart.mouseClickHandler=function(){},AdHocChart.contextMenuHandler=function(e){var a=e.element(),t=!0,d=matchAny(a,[AdHocChart.CHART_CANVAS_PATTERN,adhocDesigner.LEGEND_OVERLAY_PATTERN],!0);if(d){var r=null;if(d.hasClassName("legend")){var n=d.readAttribute("data-legendName");"data-legendName"!==n?(r={id:d.identify(),legendName:n,index:d.readAttribute("data-index"),defaultName:d.readAttribute("data-defaultName"),userName:d.readAttribute("data-userName")},selectionCategory.area=designerBase.LEGEND_MENU_LEVEL):t=!1}else selectionCategory.area=designerBase.CHART_LEVEL,r=d;t&&(localContext.draggableLegend&&localContext.draggableLegend.destroy(),designerBase.unSelectAll(),AdHocChart.deselectAllSelectedOverlays(),designerBase.addToSelected(r),buttonManager.select(d),AdHocChart.showChartMenu(e,selectionCategory.area)),Event.stop(e)}},AdHocChart.lmHandlersMap={addItems:function(e,a,t){this[t].addItems(e,a)},group:{addItem:function(e,a,t){AdHocChart.setGroup(t)},addItems:AdHocChart.addFieldAsGroup,removeItem:function(e,a){AdHocChart.removeGroup(a)},switchItem:function(e,a){AdHocChart.switchToGroup(e,a)},contextMenu:function(e,a){var t=a.extra.name,d={legendName:t,index:0};designerBase.unSelectAll(),localContext.deselectAllSelectedOverlays(),designerBase.addToSelected(d),selectionCategory.area=designerBase.LEGEND_MENU_LEVEL,actionModel.setSelected(a.extra),adhocDesigner.showDynamicMenu(a.targetEvent,"displayManagerRow",null,null)}},measures:{addItem:function(e,a){AdHocChart.addFieldAsMeasure(!0,a)},addItems:function(e,a){AdHocChart.addFieldAsMeasure(!0,a)},removeItem:function(e,a){AdHocChart.removeMeasure(a)},moveItem:function(e,a,t){AdHocChart.moveMeasure(a,t)},switchItem:function(e,a,t){AdHocChart.switchToMeasure(e,a,t)},contextMenu:function(e,a){var t=a.extra.index,d=a.extra.name,r=AdHocChart.state.legendItems[t],n={id:"legendOverlay_"+t,legendName:d,index:t,defaultName:r?r.defaultName:"",userName:r?r.userName:"",chartMeasureId:d};designerBase.unSelectAll(),AdHocChart.deselectAllSelectedOverlays(),designerBase.addToSelected(n),selectionCategory.area=designerBase.LEGEND_MENU_LEVEL,actionModel.setSelected(a.extra),adhocDesigner.showDynamicMenu(a.targetEvent,"displayManagerColumn")}}};